{
"Runtime":
{"sourcePackage":
                {
                "sourceCode":"KGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT0iZnVuY3Rpb24iJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKCJDYW5ub3QgZmluZCBtb2R1bGUgJyIrbysiJyIpO3Rocm93IGYuY29kZT0iTU9EVUxFX05PVF9GT1VORCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT0iZnVuY3Rpb24iJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSh7MTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQoidXNlIHN0cmljdCI7DQoNCnJlcXVpcmUoImNvcmUtanMvc2hpbSIpOw0KDQpyZXF1aXJlKCJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUiKTsNCg0KcmVxdWlyZSgiY29yZS1qcy9mbi9yZWdleHAvZXNjYXBlIik7DQoNCi8qIGVzbGludCBtYXgtbGVuOiAwICovDQoNCmlmIChnbG9iYWwuX2JhYmVsUG9seWZpbGwpIHsNCiAgdGhyb3cgbmV3IEVycm9yKCJvbmx5IG9uZSBpbnN0YW5jZSBvZiBiYWJlbC1wb2x5ZmlsbCBpcyBhbGxvd2VkIik7DQp9DQpnbG9iYWwuX2JhYmVsUG9seWZpbGwgPSB0cnVlOw0KDQovLyBTaG91bGQgYmUgcmVtb3ZlZCBpbiB0aGUgbmV4dCBtYWpvciByZWxlYXNlOg0KDQp2YXIgREVGSU5FX1BST1BFUlRZID0gImRlZmluZVByb3BlcnR5IjsNCmZ1bmN0aW9uIGRlZmluZShPLCBrZXksIHZhbHVlKSB7DQogIE9ba2V5XSB8fCBPYmplY3RbREVGSU5FX1BST1BFUlRZXShPLCBrZXksIHsNCiAgICB3cml0YWJsZTogdHJ1ZSwNCiAgICBjb25maWd1cmFibGU6IHRydWUsDQogICAgdmFsdWU6IHZhbHVlDQogIH0pOw0KfQ0KDQpkZWZpbmUoU3RyaW5nLnByb3RvdHlwZSwgInBhZExlZnQiLCAiIi5wYWRTdGFydCk7DQpkZWZpbmUoU3RyaW5nLnByb3RvdHlwZSwgInBhZFJpZ2h0IiwgIiIucGFkRW5kKTsNCg0KInBvcCxyZXZlcnNlLHNoaWZ0LGtleXMsdmFsdWVzLGVudHJpZXMsaW5kZXhPZixldmVyeSxzb21lLGZvckVhY2gsbWFwLGZpbHRlcixmaW5kLGZpbmRJbmRleCxpbmNsdWRlcyxqb2luLHNsaWNlLGNvbmNhdCxwdXNoLHNwbGljZSx1bnNoaWZ0LHNvcnQsbGFzdEluZGV4T2YscmVkdWNlLHJlZHVjZVJpZ2h0LGNvcHlXaXRoaW4sZmlsbCIuc3BsaXQoIiwiKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsNCiAgW11ba2V5XSAmJiBkZWZpbmUoQXJyYXksIGtleSwgRnVuY3Rpb24uY2FsbC5iaW5kKFtdW2tleV0pKTsNCn0pOw0KfSx7ImNvcmUtanMvZm4vcmVnZXhwL2VzY2FwZSI6MiwiY29yZS1qcy9zaGltIjoyOTYsInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZSI6Mjk3fV0sMjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQpyZXF1aXJlKCcuLi8uLi9tb2R1bGVzL2NvcmUucmVnZXhwLmVzY2FwZScpOw0KbW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKCcuLi8uLi9tb2R1bGVzL19jb3JlJykuUmVnRXhwLmVzY2FwZTsNCn0seyIuLi8uLi9tb2R1bGVzL19jb3JlIjoyMywiLi4vLi4vbW9kdWxlcy9jb3JlLnJlZ2V4cC5lc2NhcGUiOjEyMH1dLDM6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7DQogIGlmKHR5cGVvZiBpdCAhPSAnZnVuY3Rpb24nKXRocm93IFR5cGVFcnJvcihpdCArICcgaXMgbm90IGEgZnVuY3Rpb24hJyk7DQogIHJldHVybiBpdDsNCn07DQp9LHt9XSw0OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCnZhciBjb2YgPSByZXF1aXJlKCcuL19jb2YnKTsNCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQsIG1zZyl7DQogIGlmKHR5cGVvZiBpdCAhPSAnbnVtYmVyJyAmJiBjb2YoaXQpICE9ICdOdW1iZXInKXRocm93IFR5cGVFcnJvcihtc2cpOw0KICByZXR1cm4gK2l0Ow0KfTsNCn0seyIuL19jb2YiOjE4fV0sNTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQovLyAyMi4xLjMuMzEgQXJyYXkucHJvdG90eXBlW0BAdW5zY29wYWJsZXNdDQp2YXIgVU5TQ09QQUJMRVMgPSByZXF1aXJlKCcuL193a3MnKSgndW5zY29wYWJsZXMnKQ0KICAsIEFycmF5UHJvdG8gID0gQXJyYXkucHJvdG90eXBlOw0KaWYoQXJyYXlQcm90b1tVTlNDT1BBQkxFU10gPT0gdW5kZWZpbmVkKXJlcXVpcmUoJy4vX2hpZGUnKShBcnJheVByb3RvLCBVTlNDT1BBQkxFUywge30pOw0KbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihrZXkpew0KICBBcnJheVByb3RvW1VOU0NPUEFCTEVTXVtrZXldID0gdHJ1ZTsNCn07DQp9LHsiLi9faGlkZSI6NDAsIi4vX3drcyI6MTE3fV0sNjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0LCBDb25zdHJ1Y3RvciwgbmFtZSwgZm9yYmlkZGVuRmllbGQpew0KICBpZighKGl0IGluc3RhbmNlb2YgQ29uc3RydWN0b3IpIHx8IChmb3JiaWRkZW5GaWVsZCAhPT0gdW5kZWZpbmVkICYmIGZvcmJpZGRlbkZpZWxkIGluIGl0KSl7DQogICAgdGhyb3cgVHlwZUVycm9yKG5hbWUgKyAnOiBpbmNvcnJlY3QgaW52b2NhdGlvbiEnKTsNCiAgfSByZXR1cm4gaXQ7DQp9Ow0KfSx7fV0sNzpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQp2YXIgaXNPYmplY3QgPSByZXF1aXJlKCcuL19pcy1vYmplY3QnKTsNCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQpew0KICBpZighaXNPYmplY3QoaXQpKXRocm93IFR5cGVFcnJvcihpdCArICcgaXMgbm90IGFuIG9iamVjdCEnKTsNCiAgcmV0dXJuIGl0Ow0KfTsNCn0seyIuL19pcy1vYmplY3QiOjQ5fV0sODpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQovLyAyMi4xLjMuMyBBcnJheS5wcm90b3R5cGUuY29weVdpdGhpbih0YXJnZXQsIHN0YXJ0LCBlbmQgPSB0aGlzLmxlbmd0aCkNCid1c2Ugc3RyaWN0JzsNCnZhciB0b09iamVjdCA9IHJlcXVpcmUoJy4vX3RvLW9iamVjdCcpDQogICwgdG9JbmRleCAgPSByZXF1aXJlKCcuL190by1pbmRleCcpDQogICwgdG9MZW5ndGggPSByZXF1aXJlKCcuL190by1sZW5ndGgnKTsNCg0KbW9kdWxlLmV4cG9ydHMgPSBbXS5jb3B5V2l0aGluIHx8IGZ1bmN0aW9uIGNvcHlXaXRoaW4odGFyZ2V0Lyo9IDAqLywgc3RhcnQvKj0gMCwgZW5kID0gQGxlbmd0aCovKXsNCiAgdmFyIE8gICAgID0gdG9PYmplY3QodGhpcykNCiAgICAsIGxlbiAgID0gdG9MZW5ndGgoTy5sZW5ndGgpDQogICAgLCB0byAgICA9IHRvSW5kZXgodGFyZ2V0LCBsZW4pDQogICAgLCBmcm9tICA9IHRvSW5kZXgoc3RhcnQsIGxlbikNCiAgICAsIGVuZCAgID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgPyBhcmd1bWVudHNbMl0gOiB1bmRlZmluZWQNCiAgICAsIGNvdW50ID0gTWF0aC5taW4oKGVuZCA9PT0gdW5kZWZpbmVkID8gbGVuIDogdG9JbmRleChlbmQsIGxlbikpIC0gZnJvbSwgbGVuIC0gdG8pDQogICAgLCBpbmMgICA9IDE7DQogIGlmKGZyb20gPCB0byAmJiB0byA8IGZyb20gKyBjb3VudCl7DQogICAgaW5jICA9IC0xOw0KICAgIGZyb20gKz0gY291bnQgLSAxOw0KICAgIHRvICAgKz0gY291bnQgLSAxOw0KICB9DQogIHdoaWxlKGNvdW50LS0gPiAwKXsNCiAgICBpZihmcm9tIGluIE8pT1t0b10gPSBPW2Zyb21dOw0KICAgIGVsc2UgZGVsZXRlIE9bdG9dOw0KICAgIHRvICAgKz0gaW5jOw0KICAgIGZyb20gKz0gaW5jOw0KICB9IHJldHVybiBPOw0KfTsNCn0seyIuL190by1pbmRleCI6MTA1LCIuL190by1sZW5ndGgiOjEwOCwiLi9fdG8tb2JqZWN0IjoxMDl9XSw5OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCi8vIDIyLjEuMy42IEFycmF5LnByb3RvdHlwZS5maWxsKHZhbHVlLCBzdGFydCA9IDAsIGVuZCA9IHRoaXMubGVuZ3RoKQ0KJ3VzZSBzdHJpY3QnOw0KdmFyIHRvT2JqZWN0ID0gcmVxdWlyZSgnLi9fdG8tb2JqZWN0JykNCiAgLCB0b0luZGV4ICA9IHJlcXVpcmUoJy4vX3RvLWluZGV4JykNCiAgLCB0b0xlbmd0aCA9IHJlcXVpcmUoJy4vX3RvLWxlbmd0aCcpOw0KbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBmaWxsKHZhbHVlIC8qLCBzdGFydCA9IDAsIGVuZCA9IEBsZW5ndGggKi8pew0KICB2YXIgTyAgICAgID0gdG9PYmplY3QodGhpcykNCiAgICAsIGxlbmd0aCA9IHRvTGVuZ3RoKE8ubGVuZ3RoKQ0KICAgICwgYUxlbiAgID0gYXJndW1lbnRzLmxlbmd0aA0KICAgICwgaW5kZXggID0gdG9JbmRleChhTGVuID4gMSA/IGFyZ3VtZW50c1sxXSA6IHVuZGVmaW5lZCwgbGVuZ3RoKQ0KICAgICwgZW5kICAgID0gYUxlbiA+IDIgPyBhcmd1bWVudHNbMl0gOiB1bmRlZmluZWQNCiAgICAsIGVuZFBvcyA9IGVuZCA9PT0gdW5kZWZpbmVkID8gbGVuZ3RoIDogdG9JbmRleChlbmQsIGxlbmd0aCk7DQogIHdoaWxlKGVuZFBvcyA+IGluZGV4KU9baW5kZXgrK10gPSB2YWx1ZTsNCiAgcmV0dXJuIE87DQp9Ow0KfSx7Ii4vX3RvLWluZGV4IjoxMDUsIi4vX3RvLWxlbmd0aCI6MTA4LCIuL190by1vYmplY3QiOjEwOX1dLDEwOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCnZhciBmb3JPZiA9IHJlcXVpcmUoJy4vX2Zvci1vZicpOw0KDQptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0ZXIsIElURVJBVE9SKXsNCiAgdmFyIHJlc3VsdCA9IFtdOw0KICBmb3JPZihpdGVyLCBmYWxzZSwgcmVzdWx0LnB1c2gsIHJlc3VsdCwgSVRFUkFUT1IpOw0KICByZXR1cm4gcmVzdWx0Ow0KfTsNCg0KfSx7Ii4vX2Zvci1vZiI6Mzd9XSwxMTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQovLyBmYWxzZSAtPiBBcnJheSNpbmRleE9mDQovLyB0cnVlICAtPiBBcnJheSNpbmNsdWRlcw0KdmFyIHRvSU9iamVjdCA9IHJlcXVpcmUoJy4vX3RvLWlvYmplY3QnKQ0KICAsIHRvTGVuZ3RoICA9IHJlcXVpcmUoJy4vX3RvLWxlbmd0aCcpDQogICwgdG9JbmRleCAgID0gcmVxdWlyZSgnLi9fdG8taW5kZXgnKTsNCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oSVNfSU5DTFVERVMpew0KICByZXR1cm4gZnVuY3Rpb24oJHRoaXMsIGVsLCBmcm9tSW5kZXgpew0KICAgIHZhciBPICAgICAgPSB0b0lPYmplY3QoJHRoaXMpDQogICAgICAsIGxlbmd0aCA9IHRvTGVuZ3RoKE8ubGVuZ3RoKQ0KICAgICAgLCBpbmRleCAgPSB0b0luZGV4KGZyb21JbmRleCwgbGVuZ3RoKQ0KICAgICAgLCB2YWx1ZTsNCiAgICAvLyBBcnJheSNpbmNsdWRlcyB1c2VzIFNhbWVWYWx1ZVplcm8gZXF1YWxpdHkgYWxnb3JpdGhtDQogICAgaWYoSVNfSU5DTFVERVMgJiYgZWwgIT0gZWwpd2hpbGUobGVuZ3RoID4gaW5kZXgpew0KICAgICAgdmFsdWUgPSBPW2luZGV4KytdOw0KICAgICAgaWYodmFsdWUgIT0gdmFsdWUpcmV0dXJuIHRydWU7DQogICAgLy8gQXJyYXkjdG9JbmRleCBpZ25vcmVzIGhvbGVzLCBBcnJheSNpbmNsdWRlcyAtIG5vdA0KICAgIH0gZWxzZSBmb3IoO2xlbmd0aCA+IGluZGV4OyBpbmRleCsrKWlmKElTX0lOQ0xVREVTIHx8IGluZGV4IGluIE8pew0KICAgICAgaWYoT1tpbmRleF0gPT09IGVsKXJldHVybiBJU19JTkNMVURFUyB8fCBpbmRleCB8fCAwOw0KICAgIH0gcmV0dXJuICFJU19JTkNMVURFUyAmJiAtMTsNCiAgfTsNCn07DQp9LHsiLi9fdG8taW5kZXgiOjEwNSwiLi9fdG8taW9iamVjdCI6MTA3LCIuL190by1sZW5ndGgiOjEwOH1dLDEyOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCi8vIDAgLT4gQXJyYXkjZm9yRWFjaA0KLy8gMSAtPiBBcnJheSNtYXANCi8vIDIgLT4gQXJyYXkjZmlsdGVyDQovLyAzIC0+IEFycmF5I3NvbWUNCi8vIDQgLT4gQXJyYXkjZXZlcnkNCi8vIDUgLT4gQXJyYXkjZmluZA0KLy8gNiAtPiBBcnJheSNmaW5kSW5kZXgNCnZhciBjdHggICAgICA9IHJlcXVpcmUoJy4vX2N0eCcpDQogICwgSU9iamVjdCAgPSByZXF1aXJlKCcuL19pb2JqZWN0JykNCiAgLCB0b09iamVjdCA9IHJlcXVpcmUoJy4vX3RvLW9iamVjdCcpDQogICwgdG9MZW5ndGggPSByZXF1aXJlKCcuL190by1sZW5ndGgnKQ0KICAsIGFzYyAgICAgID0gcmVxdWlyZSgnLi9fYXJyYXktc3BlY2llcy1jcmVhdGUnKTsNCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oVFlQRSwgJGNyZWF0ZSl7DQogIHZhciBJU19NQVAgICAgICAgID0gVFlQRSA9PSAxDQogICAgLCBJU19GSUxURVIgICAgID0gVFlQRSA9PSAyDQogICAgLCBJU19TT01FICAgICAgID0gVFlQRSA9PSAzDQogICAgLCBJU19FVkVSWSAgICAgID0gVFlQRSA9PSA0DQogICAgLCBJU19GSU5EX0lOREVYID0gVFlQRSA9PSA2DQogICAgLCBOT19IT0xFUyAgICAgID0gVFlQRSA9PSA1IHx8IElTX0ZJTkRfSU5ERVgNCiAgICAsIGNyZWF0ZSAgICAgICAgPSAkY3JlYXRlIHx8IGFzYzsNCiAgcmV0dXJuIGZ1bmN0aW9uKCR0aGlzLCBjYWxsYmFja2ZuLCB0aGF0KXsNCiAgICB2YXIgTyAgICAgID0gdG9PYmplY3QoJHRoaXMpDQogICAgICAsIHNlbGYgICA9IElPYmplY3QoTykNCiAgICAgICwgZiAgICAgID0gY3R4KGNhbGxiYWNrZm4sIHRoYXQsIDMpDQogICAgICAsIGxlbmd0aCA9IHRvTGVuZ3RoKHNlbGYubGVuZ3RoKQ0KICAgICAgLCBpbmRleCAgPSAwDQogICAgICAsIHJlc3VsdCA9IElTX01BUCA/IGNyZWF0ZSgkdGhpcywgbGVuZ3RoKSA6IElTX0ZJTFRFUiA/IGNyZWF0ZSgkdGhpcywgMCkgOiB1bmRlZmluZWQNCiAgICAgICwgdmFsLCByZXM7DQogICAgZm9yKDtsZW5ndGggPiBpbmRleDsgaW5kZXgrKylpZihOT19IT0xFUyB8fCBpbmRleCBpbiBzZWxmKXsNCiAgICAgIHZhbCA9IHNlbGZbaW5kZXhdOw0KICAgICAgcmVzID0gZih2YWwsIGluZGV4LCBPKTsNCiAgICAgIGlmKFRZUEUpew0KICAgICAgICBpZihJU19NQVApcmVzdWx0W2luZGV4XSA9IHJlczsgICAgICAgICAgICAvLyBtYXANCiAgICAgICAgZWxzZSBpZihyZXMpc3dpdGNoKFRZUEUpew0KICAgICAgICAgIGNhc2UgMzogcmV0dXJuIHRydWU7ICAgICAgICAgICAgICAgICAgICAvLyBzb21lDQogICAgICAgICAgY2FzZSA1OiByZXR1cm4gdmFsOyAgICAgICAgICAgICAgICAgICAgIC8vIGZpbmQNCiAgICAgICAgICBjYXNlIDY6IHJldHVybiBpbmRleDsgICAgICAgICAgICAgICAgICAgLy8gZmluZEluZGV4DQogICAgICAgICAgY2FzZSAyOiByZXN1bHQucHVzaCh2YWwpOyAgICAgICAgICAgICAgIC8vIGZpbHRlcg0KICAgICAgICB9IGVsc2UgaWYoSVNfRVZFUlkpcmV0dXJuIGZhbHNlOyAgICAgICAgICAvLyBldmVyeQ0KICAgICAgfQ0KICAgIH0NCiAgICByZXR1cm4gSVNfRklORF9JTkRFWCA/IC0xIDogSVNfU09NRSB8fCBJU19FVkVSWSA/IElTX0VWRVJZIDogcmVzdWx0Ow0KICB9Ow0KfTsNCn0seyIuL19hcnJheS1zcGVjaWVzLWNyZWF0ZSI6MTUsIi4vX2N0eCI6MjUsIi4vX2lvYmplY3QiOjQ1LCIuL190by1sZW5ndGgiOjEwOCwiLi9fdG8tb2JqZWN0IjoxMDl9XSwxMzpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQp2YXIgYUZ1bmN0aW9uID0gcmVxdWlyZSgnLi9fYS1mdW5jdGlvbicpDQogICwgdG9PYmplY3QgID0gcmVxdWlyZSgnLi9fdG8tb2JqZWN0JykNCiAgLCBJT2JqZWN0ICAgPSByZXF1aXJlKCcuL19pb2JqZWN0JykNCiAgLCB0b0xlbmd0aCAgPSByZXF1aXJlKCcuL190by1sZW5ndGgnKTsNCg0KbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbih0aGF0LCBjYWxsYmFja2ZuLCBhTGVuLCBtZW1vLCBpc1JpZ2h0KXsNCiAgYUZ1bmN0aW9uKGNhbGxiYWNrZm4pOw0KICB2YXIgTyAgICAgID0gdG9PYmplY3QodGhhdCkNCiAgICAsIHNlbGYgICA9IElPYmplY3QoTykNCiAgICAsIGxlbmd0aCA9IHRvTGVuZ3RoKE8ubGVuZ3RoKQ0KICAgICwgaW5kZXggID0gaXNSaWdodCA/IGxlbmd0aCAtIDEgOiAwDQogICAgLCBpICAgICAgPSBpc1JpZ2h0ID8gLTEgOiAxOw0KICBpZihhTGVuIDwgMilmb3IoOzspew0KICAgIGlmKGluZGV4IGluIHNlbGYpew0KICAgICAgbWVtbyA9IHNlbGZbaW5kZXhdOw0KICAgICAgaW5kZXggKz0gaTsNCiAgICAgIGJyZWFrOw0KICAgIH0NCiAgICBpbmRleCArPSBpOw0KICAgIGlmKGlzUmlnaHQgPyBpbmRleCA8IDAgOiBsZW5ndGggPD0gaW5kZXgpew0KICAgICAgdGhyb3cgVHlwZUVycm9yKCdSZWR1Y2Ugb2YgZW1wdHkgYXJyYXkgd2l0aCBubyBpbml0aWFsIHZhbHVlJyk7DQogICAgfQ0KICB9DQogIGZvcig7aXNSaWdodCA/IGluZGV4ID49IDAgOiBsZW5ndGggPiBpbmRleDsgaW5kZXggKz0gaSlpZihpbmRleCBpbiBzZWxmKXsNCiAgICBtZW1vID0gY2FsbGJhY2tmbihtZW1vLCBzZWxmW2luZGV4XSwgaW5kZXgsIE8pOw0KICB9DQogIHJldHVybiBtZW1vOw0KfTsNCn0seyIuL19hLWZ1bmN0aW9uIjozLCIuL19pb2JqZWN0Ijo0NSwiLi9fdG8tbGVuZ3RoIjoxMDgsIi4vX3RvLW9iamVjdCI6MTA5fV0sMTQ6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KdmFyIGlzT2JqZWN0ID0gcmVxdWlyZSgnLi9faXMtb2JqZWN0JykNCiAgLCBpc0FycmF5ICA9IHJlcXVpcmUoJy4vX2lzLWFycmF5JykNCiAgLCBTUEVDSUVTICA9IHJlcXVpcmUoJy4vX3drcycpKCdzcGVjaWVzJyk7DQoNCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24ob3JpZ2luYWwpew0KICB2YXIgQzsNCiAgaWYoaXNBcnJheShvcmlnaW5hbCkpew0KICAgIEMgPSBvcmlnaW5hbC5jb25zdHJ1Y3RvcjsNCiAgICAvLyBjcm9zcy1yZWFsbSBmYWxsYmFjaw0KICAgIGlmKHR5cGVvZiBDID09ICdmdW5jdGlvbicgJiYgKEMgPT09IEFycmF5IHx8IGlzQXJyYXkoQy5wcm90b3R5cGUpKSlDID0gdW5kZWZpbmVkOw0KICAgIGlmKGlzT2JqZWN0KEMpKXsNCiAgICAgIEMgPSBDW1NQRUNJRVNdOw0KICAgICAgaWYoQyA9PT0gbnVsbClDID0gdW5kZWZpbmVkOw0KICAgIH0NCiAgfSByZXR1cm4gQyA9PT0gdW5kZWZpbmVkID8gQXJyYXkgOiBDOw0KfTsNCn0seyIuL19pcy1hcnJheSI6NDcsIi4vX2lzLW9iamVjdCI6NDksIi4vX3drcyI6MTE3fV0sMTU6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KLy8gOS40LjIuMyBBcnJheVNwZWNpZXNDcmVhdGUob3JpZ2luYWxBcnJheSwgbGVuZ3RoKQ0KdmFyIHNwZWNpZXNDb25zdHJ1Y3RvciA9IHJlcXVpcmUoJy4vX2FycmF5LXNwZWNpZXMtY29uc3RydWN0b3InKTsNCg0KbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihvcmlnaW5hbCwgbGVuZ3RoKXsNCiAgcmV0dXJuIG5ldyAoc3BlY2llc0NvbnN0cnVjdG9yKG9yaWdpbmFsKSkobGVuZ3RoKTsNCn07DQp9LHsiLi9fYXJyYXktc3BlY2llcy1jb25zdHJ1Y3RvciI6MTR9XSwxNjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQondXNlIHN0cmljdCc7DQp2YXIgYUZ1bmN0aW9uICA9IHJlcXVpcmUoJy4vX2EtZnVuY3Rpb24nKQ0KICAsIGlzT2JqZWN0ICAgPSByZXF1aXJlKCcuL19pcy1vYmplY3QnKQ0KICAsIGludm9rZSAgICAgPSByZXF1aXJlKCcuL19pbnZva2UnKQ0KICAsIGFycmF5U2xpY2UgPSBbXS5zbGljZQ0KICAsIGZhY3RvcmllcyAgPSB7fTsNCg0KdmFyIGNvbnN0cnVjdCA9IGZ1bmN0aW9uKEYsIGxlbiwgYXJncyl7DQogIGlmKCEobGVuIGluIGZhY3Rvcmllcykpew0KICAgIGZvcih2YXIgbiA9IFtdLCBpID0gMDsgaSA8IGxlbjsgaSsrKW5baV0gPSAnYVsnICsgaSArICddJzsNCiAgICBmYWN0b3JpZXNbbGVuXSA9IEZ1bmN0aW9uKCdGLGEnLCAncmV0dXJuIG5ldyBGKCcgKyBuLmpvaW4oJywnKSArICcpJyk7DQogIH0gcmV0dXJuIGZhY3Rvcmllc1tsZW5dKEYsIGFyZ3MpOw0KfTsNCg0KbW9kdWxlLmV4cG9ydHMgPSBGdW5jdGlvbi5iaW5kIHx8IGZ1bmN0aW9uIGJpbmQodGhhdCAvKiwgYXJncy4uLiAqLyl7DQogIHZhciBmbiAgICAgICA9IGFGdW5jdGlvbih0aGlzKQ0KICAgICwgcGFydEFyZ3MgPSBhcnJheVNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKTsNCiAgdmFyIGJvdW5kID0gZnVuY3Rpb24oLyogYXJncy4uLiAqLyl7DQogICAgdmFyIGFyZ3MgPSBwYXJ0QXJncy5jb25jYXQoYXJyYXlTbGljZS5jYWxsKGFyZ3VtZW50cykpOw0KICAgIHJldHVybiB0aGlzIGluc3RhbmNlb2YgYm91bmQgPyBjb25zdHJ1Y3QoZm4sIGFyZ3MubGVuZ3RoLCBhcmdzKSA6IGludm9rZShmbiwgYXJncywgdGhhdCk7DQogIH07DQogIGlmKGlzT2JqZWN0KGZuLnByb3RvdHlwZSkpYm91bmQucHJvdG90eXBlID0gZm4ucHJvdG90eXBlOw0KICByZXR1cm4gYm91bmQ7DQp9Ow0KfSx7Ii4vX2EtZnVuY3Rpb24iOjMsIi4vX2ludm9rZSI6NDQsIi4vX2lzLW9iamVjdCI6NDl9XSwxNzpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQovLyBnZXR0aW5nIHRhZyBmcm9tIDE5LjEuMy42IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcoKQ0KdmFyIGNvZiA9IHJlcXVpcmUoJy4vX2NvZicpDQogICwgVEFHID0gcmVxdWlyZSgnLi9fd2tzJykoJ3RvU3RyaW5nVGFnJykNCiAgLy8gRVMzIHdyb25nIGhlcmUNCiAgLCBBUkcgPSBjb2YoZnVuY3Rpb24oKXsgcmV0dXJuIGFyZ3VtZW50czsgfSgpKSA9PSAnQXJndW1lbnRzJzsNCg0KLy8gZmFsbGJhY2sgZm9yIElFMTEgU2NyaXB0IEFjY2VzcyBEZW5pZWQgZXJyb3INCnZhciB0cnlHZXQgPSBmdW5jdGlvbihpdCwga2V5KXsNCiAgdHJ5IHsNCiAgICByZXR1cm4gaXRba2V5XTsNCiAgfSBjYXRjaChlKXsgLyogZW1wdHkgKi8gfQ0KfTsNCg0KbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7DQogIHZhciBPLCBULCBCOw0KICByZXR1cm4gaXQgPT09IHVuZGVmaW5lZCA/ICdVbmRlZmluZWQnIDogaXQgPT09IG51bGwgPyAnTnVsbCcNCiAgICAvLyBAQHRvU3RyaW5nVGFnIGNhc2UNCiAgICA6IHR5cGVvZiAoVCA9IHRyeUdldChPID0gT2JqZWN0KGl0KSwgVEFHKSkgPT0gJ3N0cmluZycgPyBUDQogICAgLy8gYnVpbHRpblRhZyBjYXNlDQogICAgOiBBUkcgPyBjb2YoTykNCiAgICAvLyBFUzMgYXJndW1lbnRzIGZhbGxiYWNrDQogICAgOiAoQiA9IGNvZihPKSkgPT0gJ09iamVjdCcgJiYgdHlwZW9mIE8uY2FsbGVlID09ICdmdW5jdGlvbicgPyAnQXJndW1lbnRzJyA6IEI7DQp9Ow0KfSx7Ii4vX2NvZiI6MTgsIi4vX3drcyI6MTE3fV0sMTg6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KdmFyIHRvU3RyaW5nID0ge30udG9TdHJpbmc7DQoNCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQpew0KICByZXR1cm4gdG9TdHJpbmcuY2FsbChpdCkuc2xpY2UoOCwgLTEpOw0KfTsNCn0se31dLDE5OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCid1c2Ugc3RyaWN0JzsNCnZhciBkUCAgICAgICAgICA9IHJlcXVpcmUoJy4vX29iamVjdC1kcCcpLmYNCiAgLCBjcmVhdGUgICAgICA9IHJlcXVpcmUoJy4vX29iamVjdC1jcmVhdGUnKQ0KICAsIGhpZGUgICAgICAgID0gcmVxdWlyZSgnLi9faGlkZScpDQogICwgcmVkZWZpbmVBbGwgPSByZXF1aXJlKCcuL19yZWRlZmluZS1hbGwnKQ0KICAsIGN0eCAgICAgICAgID0gcmVxdWlyZSgnLi9fY3R4JykNCiAgLCBhbkluc3RhbmNlICA9IHJlcXVpcmUoJy4vX2FuLWluc3RhbmNlJykNCiAgLCBkZWZpbmVkICAgICA9IHJlcXVpcmUoJy4vX2RlZmluZWQnKQ0KICAsIGZvck9mICAgICAgID0gcmVxdWlyZSgnLi9fZm9yLW9mJykNCiAgLCAkaXRlckRlZmluZSA9IHJlcXVpcmUoJy4vX2l0ZXItZGVmaW5lJykNCiAgLCBzdGVwICAgICAgICA9IHJlcXVpcmUoJy4vX2l0ZXItc3RlcCcpDQogICwgc2V0U3BlY2llcyAgPSByZXF1aXJlKCcuL19zZXQtc3BlY2llcycpDQogICwgREVTQ1JJUFRPUlMgPSByZXF1aXJlKCcuL19kZXNjcmlwdG9ycycpDQogICwgZmFzdEtleSAgICAgPSByZXF1aXJlKCcuL19tZXRhJykuZmFzdEtleQ0KICAsIFNJWkUgICAgICAgID0gREVTQ1JJUFRPUlMgPyAnX3MnIDogJ3NpemUnOw0KDQp2YXIgZ2V0RW50cnkgPSBmdW5jdGlvbih0aGF0LCBrZXkpew0KICAvLyBmYXN0IGNhc2UNCiAgdmFyIGluZGV4ID0gZmFzdEtleShrZXkpLCBlbnRyeTsNCiAgaWYoaW5kZXggIT09ICdGJylyZXR1cm4gdGhhdC5faVtpbmRleF07DQogIC8vIGZyb3plbiBvYmplY3QgY2FzZQ0KICBmb3IoZW50cnkgPSB0aGF0Ll9mOyBlbnRyeTsgZW50cnkgPSBlbnRyeS5uKXsNCiAgICBpZihlbnRyeS5rID09IGtleSlyZXR1cm4gZW50cnk7DQogIH0NCn07DQoNCm1vZHVsZS5leHBvcnRzID0gew0KICBnZXRDb25zdHJ1Y3RvcjogZnVuY3Rpb24od3JhcHBlciwgTkFNRSwgSVNfTUFQLCBBRERFUil7DQogICAgdmFyIEMgPSB3cmFwcGVyKGZ1bmN0aW9uKHRoYXQsIGl0ZXJhYmxlKXsNCiAgICAgIGFuSW5zdGFuY2UodGhhdCwgQywgTkFNRSwgJ19pJyk7DQogICAgICB0aGF0Ll9pID0gY3JlYXRlKG51bGwpOyAvLyBpbmRleA0KICAgICAgdGhhdC5fZiA9IHVuZGVmaW5lZDsgICAgLy8gZmlyc3QgZW50cnkNCiAgICAgIHRoYXQuX2wgPSB1bmRlZmluZWQ7ICAgIC8vIGxhc3QgZW50cnkNCiAgICAgIHRoYXRbU0laRV0gPSAwOyAgICAgICAgIC8vIHNpemUNCiAgICAgIGlmKGl0ZXJhYmxlICE9IHVuZGVmaW5lZClmb3JPZihpdGVyYWJsZSwgSVNfTUFQLCB0aGF0W0FEREVSXSwgdGhhdCk7DQogICAgfSk7DQogICAgcmVkZWZpbmVBbGwoQy5wcm90b3R5cGUsIHsNCiAgICAgIC8vIDIzLjEuMy4xIE1hcC5wcm90b3R5cGUuY2xlYXIoKQ0KICAgICAgLy8gMjMuMi4zLjIgU2V0LnByb3RvdHlwZS5jbGVhcigpDQogICAgICBjbGVhcjogZnVuY3Rpb24gY2xlYXIoKXsNCiAgICAgICAgZm9yKHZhciB0aGF0ID0gdGhpcywgZGF0YSA9IHRoYXQuX2ksIGVudHJ5ID0gdGhhdC5fZjsgZW50cnk7IGVudHJ5ID0gZW50cnkubil7DQogICAgICAgICAgZW50cnkuciA9IHRydWU7DQogICAgICAgICAgaWYoZW50cnkucCllbnRyeS5wID0gZW50cnkucC5uID0gdW5kZWZpbmVkOw0KICAgICAgICAgIGRlbGV0ZSBkYXRhW2VudHJ5LmldOw0KICAgICAgICB9DQogICAgICAgIHRoYXQuX2YgPSB0aGF0Ll9sID0gdW5kZWZpbmVkOw0KICAgICAgICB0aGF0W1NJWkVdID0gMDsNCiAgICAgIH0sDQogICAgICAvLyAyMy4xLjMuMyBNYXAucHJvdG90eXBlLmRlbGV0ZShrZXkpDQogICAgICAvLyAyMy4yLjMuNCBTZXQucHJvdG90eXBlLmRlbGV0ZSh2YWx1ZSkNCiAgICAgICdkZWxldGUnOiBmdW5jdGlvbihrZXkpew0KICAgICAgICB2YXIgdGhhdCAgPSB0aGlzDQogICAgICAgICAgLCBlbnRyeSA9IGdldEVudHJ5KHRoYXQsIGtleSk7DQogICAgICAgIGlmKGVudHJ5KXsNCiAgICAgICAgICB2YXIgbmV4dCA9IGVudHJ5Lm4NCiAgICAgICAgICAgICwgcHJldiA9IGVudHJ5LnA7DQogICAgICAgICAgZGVsZXRlIHRoYXQuX2lbZW50cnkuaV07DQogICAgICAgICAgZW50cnkuciA9IHRydWU7DQogICAgICAgICAgaWYocHJldilwcmV2Lm4gPSBuZXh0Ow0KICAgICAgICAgIGlmKG5leHQpbmV4dC5wID0gcHJldjsNCiAgICAgICAgICBpZih0aGF0Ll9mID09IGVudHJ5KXRoYXQuX2YgPSBuZXh0Ow0KICAgICAgICAgIGlmKHRoYXQuX2wgPT0gZW50cnkpdGhhdC5fbCA9IHByZXY7DQogICAgICAgICAgdGhhdFtTSVpFXS0tOw0KICAgICAgICB9IHJldHVybiAhIWVudHJ5Ow0KICAgICAgfSwNCiAgICAgIC8vIDIzLjIuMy42IFNldC5wcm90b3R5cGUuZm9yRWFjaChjYWxsYmFja2ZuLCB0aGlzQXJnID0gdW5kZWZpbmVkKQ0KICAgICAgLy8gMjMuMS4zLjUgTWFwLnByb3RvdHlwZS5mb3JFYWNoKGNhbGxiYWNrZm4sIHRoaXNBcmcgPSB1bmRlZmluZWQpDQogICAgICBmb3JFYWNoOiBmdW5jdGlvbiBmb3JFYWNoKGNhbGxiYWNrZm4gLyosIHRoYXQgPSB1bmRlZmluZWQgKi8pew0KICAgICAgICBhbkluc3RhbmNlKHRoaXMsIEMsICdmb3JFYWNoJyk7DQogICAgICAgIHZhciBmID0gY3R4KGNhbGxiYWNrZm4sIGFyZ3VtZW50cy5sZW5ndGggPiAxID8gYXJndW1lbnRzWzFdIDogdW5kZWZpbmVkLCAzKQ0KICAgICAgICAgICwgZW50cnk7DQogICAgICAgIHdoaWxlKGVudHJ5ID0gZW50cnkgPyBlbnRyeS5uIDogdGhpcy5fZil7DQogICAgICAgICAgZihlbnRyeS52LCBlbnRyeS5rLCB0aGlzKTsNCiAgICAgICAgICAvLyByZXZlcnQgdG8gdGhlIGxhc3QgZXhpc3RpbmcgZW50cnkNCiAgICAgICAgICB3aGlsZShlbnRyeSAmJiBlbnRyeS5yKWVudHJ5ID0gZW50cnkucDsNCiAgICAgICAgfQ0KICAgICAgfSwNCiAgICAgIC8vIDIzLjEuMy43IE1hcC5wcm90b3R5cGUuaGFzKGtleSkNCiAgICAgIC8vIDIzLjIuMy43IFNldC5wcm90b3R5cGUuaGFzKHZhbHVlKQ0KICAgICAgaGFzOiBmdW5jdGlvbiBoYXMoa2V5KXsNCiAgICAgICAgcmV0dXJuICEhZ2V0RW50cnkodGhpcywga2V5KTsNCiAgICAgIH0NCiAgICB9KTsNCiAgICBpZihERVNDUklQVE9SUylkUChDLnByb3RvdHlwZSwgJ3NpemUnLCB7DQogICAgICBnZXQ6IGZ1bmN0aW9uKCl7DQogICAgICAgIHJldHVybiBkZWZpbmVkKHRoaXNbU0laRV0pOw0KICAgICAgfQ0KICAgIH0pOw0KICAgIHJldHVybiBDOw0KICB9LA0KICBkZWY6IGZ1bmN0aW9uKHRoYXQsIGtleSwgdmFsdWUpew0KICAgIHZhciBlbnRyeSA9IGdldEVudHJ5KHRoYXQsIGtleSkNCiAgICAgICwgcHJldiwgaW5kZXg7DQogICAgLy8gY2hhbmdlIGV4aXN0aW5nIGVudHJ5DQogICAgaWYoZW50cnkpew0KICAgICAgZW50cnkudiA9IHZhbHVlOw0KICAgIC8vIGNyZWF0ZSBuZXcgZW50cnkNCiAgICB9IGVsc2Ugew0KICAgICAgdGhhdC5fbCA9IGVudHJ5ID0gew0KICAgICAgICBpOiBpbmRleCA9IGZhc3RLZXkoa2V5LCB0cnVlKSwgLy8gPC0gaW5kZXgNCiAgICAgICAgazoga2V5LCAgICAgICAgICAgICAgICAgICAgICAgIC8vIDwtIGtleQ0KICAgICAgICB2OiB2YWx1ZSwgICAgICAgICAgICAgICAgICAgICAgLy8gPC0gdmFsdWUNCiAgICAgICAgcDogcHJldiA9IHRoYXQuX2wsICAgICAgICAgICAgIC8vIDwtIHByZXZpb3VzIGVudHJ5DQogICAgICAgIG46IHVuZGVmaW5lZCwgICAgICAgICAgICAgICAgICAvLyA8LSBuZXh0IGVudHJ5DQogICAgICAgIHI6IGZhbHNlICAgICAgICAgICAgICAgICAgICAgICAvLyA8LSByZW1vdmVkDQogICAgICB9Ow0KICAgICAgaWYoIXRoYXQuX2YpdGhhdC5fZiA9IGVudHJ5Ow0KICAgICAgaWYocHJldilwcmV2Lm4gPSBlbnRyeTsNCiAgICAgIHRoYXRbU0laRV0rKzsNCiAgICAgIC8vIGFkZCB0byBpbmRleA0KICAgICAgaWYoaW5kZXggIT09ICdGJyl0aGF0Ll9pW2luZGV4XSA9IGVudHJ5Ow0KICAgIH0gcmV0dXJuIHRoYXQ7DQogIH0sDQogIGdldEVudHJ5OiBnZXRFbnRyeSwNCiAgc2V0U3Ryb25nOiBmdW5jdGlvbihDLCBOQU1FLCBJU19NQVApew0KICAgIC8vIGFkZCAua2V5cywgLnZhbHVlcywgLmVudHJpZXMsIFtAQGl0ZXJhdG9yXQ0KICAgIC8vIDIzLjEuMy40LCAyMy4xLjMuOCwgMjMuMS4zLjExLCAyMy4xLjMuMTIsIDIzLjIuMy41LCAyMy4yLjMuOCwgMjMuMi4zLjEwLCAyMy4yLjMuMTENCiAgICAkaXRlckRlZmluZShDLCBOQU1FLCBmdW5jdGlvbihpdGVyYXRlZCwga2luZCl7DQogICAgICB0aGlzLl90ID0gaXRlcmF0ZWQ7ICAvLyB0YXJnZXQNCiAgICAgIHRoaXMuX2sgPSBraW5kOyAgICAgIC8vIGtpbmQNCiAgICAgIHRoaXMuX2wgPSB1bmRlZmluZWQ7IC8vIHByZXZpb3VzDQogICAgfSwgZnVuY3Rpb24oKXsNCiAgICAgIHZhciB0aGF0ICA9IHRoaXMNCiAgICAgICAgLCBraW5kICA9IHRoYXQuX2sNCiAgICAgICAgLCBlbnRyeSA9IHRoYXQuX2w7DQogICAgICAvLyByZXZlcnQgdG8gdGhlIGxhc3QgZXhpc3RpbmcgZW50cnkNCiAgICAgIHdoaWxlKGVudHJ5ICYmIGVudHJ5LnIpZW50cnkgPSBlbnRyeS5wOw0KICAgICAgLy8gZ2V0IG5leHQgZW50cnkNCiAgICAgIGlmKCF0aGF0Ll90IHx8ICEodGhhdC5fbCA9IGVudHJ5ID0gZW50cnkgPyBlbnRyeS5uIDogdGhhdC5fdC5fZikpew0KICAgICAgICAvLyBvciBmaW5pc2ggdGhlIGl0ZXJhdGlvbg0KICAgICAgICB0aGF0Ll90ID0gdW5kZWZpbmVkOw0KICAgICAgICByZXR1cm4gc3RlcCgxKTsNCiAgICAgIH0NCiAgICAgIC8vIHJldHVybiBzdGVwIGJ5IGtpbmQNCiAgICAgIGlmKGtpbmQgPT0gJ2tleXMnICApcmV0dXJuIHN0ZXAoMCwgZW50cnkuayk7DQogICAgICBpZihraW5kID09ICd2YWx1ZXMnKXJldHVybiBzdGVwKDAsIGVudHJ5LnYpOw0KICAgICAgcmV0dXJuIHN0ZXAoMCwgW2VudHJ5LmssIGVudHJ5LnZdKTsNCiAgICB9LCBJU19NQVAgPyAnZW50cmllcycgOiAndmFsdWVzJyAsICFJU19NQVAsIHRydWUpOw0KDQogICAgLy8gYWRkIFtAQHNwZWNpZXNdLCAyMy4xLjIuMiwgMjMuMi4yLjINCiAgICBzZXRTcGVjaWVzKE5BTUUpOw0KICB9DQp9Ow0KfSx7Ii4vX2FuLWluc3RhbmNlIjo2LCIuL19jdHgiOjI1LCIuL19kZWZpbmVkIjoyNywiLi9fZGVzY3JpcHRvcnMiOjI4LCIuL19mb3Itb2YiOjM3LCIuL19oaWRlIjo0MCwiLi9faXRlci1kZWZpbmUiOjUzLCIuL19pdGVyLXN0ZXAiOjU1LCIuL19tZXRhIjo2MiwiLi9fb2JqZWN0LWNyZWF0ZSI6NjYsIi4vX29iamVjdC1kcCI6NjcsIi4vX3JlZGVmaW5lLWFsbCI6ODYsIi4vX3NldC1zcGVjaWVzIjo5MX1dLDIwOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCi8vIGh0dHBzOi8vZ2l0aHViLmNvbS9EYXZpZEJydWFudC9NYXAtU2V0LnByb3RvdHlwZS50b0pTT04NCnZhciBjbGFzc29mID0gcmVxdWlyZSgnLi9fY2xhc3NvZicpDQogICwgZnJvbSAgICA9IHJlcXVpcmUoJy4vX2FycmF5LWZyb20taXRlcmFibGUnKTsNCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oTkFNRSl7DQogIHJldHVybiBmdW5jdGlvbiB0b0pTT04oKXsNCiAgICBpZihjbGFzc29mKHRoaXMpICE9IE5BTUUpdGhyb3cgVHlwZUVycm9yKE5BTUUgKyAiI3RvSlNPTiBpc24ndCBnZW5lcmljIik7DQogICAgcmV0dXJuIGZyb20odGhpcyk7DQogIH07DQp9Ow0KfSx7Ii4vX2FycmF5LWZyb20taXRlcmFibGUiOjEwLCIuL19jbGFzc29mIjoxN31dLDIxOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCid1c2Ugc3RyaWN0JzsNCnZhciByZWRlZmluZUFsbCAgICAgICA9IHJlcXVpcmUoJy4vX3JlZGVmaW5lLWFsbCcpDQogICwgZ2V0V2VhayAgICAgICAgICAgPSByZXF1aXJlKCcuL19tZXRhJykuZ2V0V2Vhaw0KICAsIGFuT2JqZWN0ICAgICAgICAgID0gcmVxdWlyZSgnLi9fYW4tb2JqZWN0JykNCiAgLCBpc09iamVjdCAgICAgICAgICA9IHJlcXVpcmUoJy4vX2lzLW9iamVjdCcpDQogICwgYW5JbnN0YW5jZSAgICAgICAgPSByZXF1aXJlKCcuL19hbi1pbnN0YW5jZScpDQogICwgZm9yT2YgICAgICAgICAgICAgPSByZXF1aXJlKCcuL19mb3Itb2YnKQ0KICAsIGNyZWF0ZUFycmF5TWV0aG9kID0gcmVxdWlyZSgnLi9fYXJyYXktbWV0aG9kcycpDQogICwgJGhhcyAgICAgICAgICAgICAgPSByZXF1aXJlKCcuL19oYXMnKQ0KICAsIGFycmF5RmluZCAgICAgICAgID0gY3JlYXRlQXJyYXlNZXRob2QoNSkNCiAgLCBhcnJheUZpbmRJbmRleCAgICA9IGNyZWF0ZUFycmF5TWV0aG9kKDYpDQogICwgaWQgICAgICAgICAgICAgICAgPSAwOw0KDQovLyBmYWxsYmFjayBmb3IgdW5jYXVnaHQgZnJvemVuIGtleXMNCnZhciB1bmNhdWdodEZyb3plblN0b3JlID0gZnVuY3Rpb24odGhhdCl7DQogIHJldHVybiB0aGF0Ll9sIHx8ICh0aGF0Ll9sID0gbmV3IFVuY2F1Z2h0RnJvemVuU3RvcmUpOw0KfTsNCnZhciBVbmNhdWdodEZyb3plblN0b3JlID0gZnVuY3Rpb24oKXsNCiAgdGhpcy5hID0gW107DQp9Ow0KdmFyIGZpbmRVbmNhdWdodEZyb3plbiA9IGZ1bmN0aW9uKHN0b3JlLCBrZXkpew0KICByZXR1cm4gYXJyYXlGaW5kKHN0b3JlLmEsIGZ1bmN0aW9uKGl0KXsNCiAgICByZXR1cm4gaXRbMF0gPT09IGtleTsNCiAgfSk7DQp9Ow0KVW5jYXVnaHRGcm96ZW5TdG9yZS5wcm90b3R5cGUgPSB7DQogIGdldDogZnVuY3Rpb24oa2V5KXsNCiAgICB2YXIgZW50cnkgPSBmaW5kVW5jYXVnaHRGcm96ZW4odGhpcywga2V5KTsNCiAgICBpZihlbnRyeSlyZXR1cm4gZW50cnlbMV07DQogIH0sDQogIGhhczogZnVuY3Rpb24oa2V5KXsNCiAgICByZXR1cm4gISFmaW5kVW5jYXVnaHRGcm96ZW4odGhpcywga2V5KTsNCiAgfSwNCiAgc2V0OiBmdW5jdGlvbihrZXksIHZhbHVlKXsNCiAgICB2YXIgZW50cnkgPSBmaW5kVW5jYXVnaHRGcm96ZW4odGhpcywga2V5KTsNCiAgICBpZihlbnRyeSllbnRyeVsxXSA9IHZhbHVlOw0KICAgIGVsc2UgdGhpcy5hLnB1c2goW2tleSwgdmFsdWVdKTsNCiAgfSwNCiAgJ2RlbGV0ZSc6IGZ1bmN0aW9uKGtleSl7DQogICAgdmFyIGluZGV4ID0gYXJyYXlGaW5kSW5kZXgodGhpcy5hLCBmdW5jdGlvbihpdCl7DQogICAgICByZXR1cm4gaXRbMF0gPT09IGtleTsNCiAgICB9KTsNCiAgICBpZih+aW5kZXgpdGhpcy5hLnNwbGljZShpbmRleCwgMSk7DQogICAgcmV0dXJuICEhfmluZGV4Ow0KICB9DQp9Ow0KDQptb2R1bGUuZXhwb3J0cyA9IHsNCiAgZ2V0Q29uc3RydWN0b3I6IGZ1bmN0aW9uKHdyYXBwZXIsIE5BTUUsIElTX01BUCwgQURERVIpew0KICAgIHZhciBDID0gd3JhcHBlcihmdW5jdGlvbih0aGF0LCBpdGVyYWJsZSl7DQogICAgICBhbkluc3RhbmNlKHRoYXQsIEMsIE5BTUUsICdfaScpOw0KICAgICAgdGhhdC5faSA9IGlkKys7ICAgICAgLy8gY29sbGVjdGlvbiBpZA0KICAgICAgdGhhdC5fbCA9IHVuZGVmaW5lZDsgLy8gbGVhayBzdG9yZSBmb3IgdW5jYXVnaHQgZnJvemVuIG9iamVjdHMNCiAgICAgIGlmKGl0ZXJhYmxlICE9IHVuZGVmaW5lZClmb3JPZihpdGVyYWJsZSwgSVNfTUFQLCB0aGF0W0FEREVSXSwgdGhhdCk7DQogICAgfSk7DQogICAgcmVkZWZpbmVBbGwoQy5wcm90b3R5cGUsIHsNCiAgICAgIC8vIDIzLjMuMy4yIFdlYWtNYXAucHJvdG90eXBlLmRlbGV0ZShrZXkpDQogICAgICAvLyAyMy40LjMuMyBXZWFrU2V0LnByb3RvdHlwZS5kZWxldGUodmFsdWUpDQogICAgICAnZGVsZXRlJzogZnVuY3Rpb24oa2V5KXsNCiAgICAgICAgaWYoIWlzT2JqZWN0KGtleSkpcmV0dXJuIGZhbHNlOw0KICAgICAgICB2YXIgZGF0YSA9IGdldFdlYWsoa2V5KTsNCiAgICAgICAgaWYoZGF0YSA9PT0gdHJ1ZSlyZXR1cm4gdW5jYXVnaHRGcm96ZW5TdG9yZSh0aGlzKVsnZGVsZXRlJ10oa2V5KTsNCiAgICAgICAgcmV0dXJuIGRhdGEgJiYgJGhhcyhkYXRhLCB0aGlzLl9pKSAmJiBkZWxldGUgZGF0YVt0aGlzLl9pXTsNCiAgICAgIH0sDQogICAgICAvLyAyMy4zLjMuNCBXZWFrTWFwLnByb3RvdHlwZS5oYXMoa2V5KQ0KICAgICAgLy8gMjMuNC4zLjQgV2Vha1NldC5wcm90b3R5cGUuaGFzKHZhbHVlKQ0KICAgICAgaGFzOiBmdW5jdGlvbiBoYXMoa2V5KXsNCiAgICAgICAgaWYoIWlzT2JqZWN0KGtleSkpcmV0dXJuIGZhbHNlOw0KICAgICAgICB2YXIgZGF0YSA9IGdldFdlYWsoa2V5KTsNCiAgICAgICAgaWYoZGF0YSA9PT0gdHJ1ZSlyZXR1cm4gdW5jYXVnaHRGcm96ZW5TdG9yZSh0aGlzKS5oYXMoa2V5KTsNCiAgICAgICAgcmV0dXJuIGRhdGEgJiYgJGhhcyhkYXRhLCB0aGlzLl9pKTsNCiAgICAgIH0NCiAgICB9KTsNCiAgICByZXR1cm4gQzsNCiAgfSwNCiAgZGVmOiBmdW5jdGlvbih0aGF0LCBrZXksIHZhbHVlKXsNCiAgICB2YXIgZGF0YSA9IGdldFdlYWsoYW5PYmplY3Qoa2V5KSwgdHJ1ZSk7DQogICAgaWYoZGF0YSA9PT0gdHJ1ZSl1bmNhdWdodEZyb3plblN0b3JlKHRoYXQpLnNldChrZXksIHZhbHVlKTsNCiAgICBlbHNlIGRhdGFbdGhhdC5faV0gPSB2YWx1ZTsNCiAgICByZXR1cm4gdGhhdDsNCiAgfSwNCiAgdWZzdG9yZTogdW5jYXVnaHRGcm96ZW5TdG9yZQ0KfTsNCn0seyIuL19hbi1pbnN0YW5jZSI6NiwiLi9fYW4tb2JqZWN0Ijo3LCIuL19hcnJheS1tZXRob2RzIjoxMiwiLi9fZm9yLW9mIjozNywiLi9faGFzIjozOSwiLi9faXMtb2JqZWN0Ijo0OSwiLi9fbWV0YSI6NjIsIi4vX3JlZGVmaW5lLWFsbCI6ODZ9XSwyMjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQondXNlIHN0cmljdCc7DQp2YXIgZ2xvYmFsICAgICAgICAgICAgPSByZXF1aXJlKCcuL19nbG9iYWwnKQ0KICAsICRleHBvcnQgICAgICAgICAgID0gcmVxdWlyZSgnLi9fZXhwb3J0JykNCiAgLCByZWRlZmluZSAgICAgICAgICA9IHJlcXVpcmUoJy4vX3JlZGVmaW5lJykNCiAgLCByZWRlZmluZUFsbCAgICAgICA9IHJlcXVpcmUoJy4vX3JlZGVmaW5lLWFsbCcpDQogICwgbWV0YSAgICAgICAgICAgICAgPSByZXF1aXJlKCcuL19tZXRhJykNCiAgLCBmb3JPZiAgICAgICAgICAgICA9IHJlcXVpcmUoJy4vX2Zvci1vZicpDQogICwgYW5JbnN0YW5jZSAgICAgICAgPSByZXF1aXJlKCcuL19hbi1pbnN0YW5jZScpDQogICwgaXNPYmplY3QgICAgICAgICAgPSByZXF1aXJlKCcuL19pcy1vYmplY3QnKQ0KICAsIGZhaWxzICAgICAgICAgICAgID0gcmVxdWlyZSgnLi9fZmFpbHMnKQ0KICAsICRpdGVyRGV0ZWN0ICAgICAgID0gcmVxdWlyZSgnLi9faXRlci1kZXRlY3QnKQ0KICAsIHNldFRvU3RyaW5nVGFnICAgID0gcmVxdWlyZSgnLi9fc2V0LXRvLXN0cmluZy10YWcnKQ0KICAsIGluaGVyaXRJZlJlcXVpcmVkID0gcmVxdWlyZSgnLi9faW5oZXJpdC1pZi1yZXF1aXJlZCcpOw0KDQptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKE5BTUUsIHdyYXBwZXIsIG1ldGhvZHMsIGNvbW1vbiwgSVNfTUFQLCBJU19XRUFLKXsNCiAgdmFyIEJhc2UgID0gZ2xvYmFsW05BTUVdDQogICAgLCBDICAgICA9IEJhc2UNCiAgICAsIEFEREVSID0gSVNfTUFQID8gJ3NldCcgOiAnYWRkJw0KICAgICwgcHJvdG8gPSBDICYmIEMucHJvdG90eXBlDQogICAgLCBPICAgICA9IHt9Ow0KICB2YXIgZml4TWV0aG9kID0gZnVuY3Rpb24oS0VZKXsNCiAgICB2YXIgZm4gPSBwcm90b1tLRVldOw0KICAgIHJlZGVmaW5lKHByb3RvLCBLRVksDQogICAgICBLRVkgPT0gJ2RlbGV0ZScgPyBmdW5jdGlvbihhKXsNCiAgICAgICAgcmV0dXJuIElTX1dFQUsgJiYgIWlzT2JqZWN0KGEpID8gZmFsc2UgOiBmbi5jYWxsKHRoaXMsIGEgPT09IDAgPyAwIDogYSk7DQogICAgICB9IDogS0VZID09ICdoYXMnID8gZnVuY3Rpb24gaGFzKGEpew0KICAgICAgICByZXR1cm4gSVNfV0VBSyAmJiAhaXNPYmplY3QoYSkgPyBmYWxzZSA6IGZuLmNhbGwodGhpcywgYSA9PT0gMCA/IDAgOiBhKTsNCiAgICAgIH0gOiBLRVkgPT0gJ2dldCcgPyBmdW5jdGlvbiBnZXQoYSl7DQogICAgICAgIHJldHVybiBJU19XRUFLICYmICFpc09iamVjdChhKSA/IHVuZGVmaW5lZCA6IGZuLmNhbGwodGhpcywgYSA9PT0gMCA/IDAgOiBhKTsNCiAgICAgIH0gOiBLRVkgPT0gJ2FkZCcgPyBmdW5jdGlvbiBhZGQoYSl7IGZuLmNhbGwodGhpcywgYSA9PT0gMCA/IDAgOiBhKTsgcmV0dXJuIHRoaXM7IH0NCiAgICAgICAgOiBmdW5jdGlvbiBzZXQoYSwgYil7IGZuLmNhbGwodGhpcywgYSA9PT0gMCA/IDAgOiBhLCBiKTsgcmV0dXJuIHRoaXM7IH0NCiAgICApOw0KICB9Ow0KICBpZih0eXBlb2YgQyAhPSAnZnVuY3Rpb24nIHx8ICEoSVNfV0VBSyB8fCBwcm90by5mb3JFYWNoICYmICFmYWlscyhmdW5jdGlvbigpew0KICAgIG5ldyBDKCkuZW50cmllcygpLm5leHQoKTsNCiAgfSkpKXsNCiAgICAvLyBjcmVhdGUgY29sbGVjdGlvbiBjb25zdHJ1Y3Rvcg0KICAgIEMgPSBjb21tb24uZ2V0Q29uc3RydWN0b3Iod3JhcHBlciwgTkFNRSwgSVNfTUFQLCBBRERFUik7DQogICAgcmVkZWZpbmVBbGwoQy5wcm90b3R5cGUsIG1ldGhvZHMpOw0KICAgIG1ldGEuTkVFRCA9IHRydWU7DQogIH0gZWxzZSB7DQogICAgdmFyIGluc3RhbmNlICAgICAgICAgICAgID0gbmV3IEMNCiAgICAgIC8vIGVhcmx5IGltcGxlbWVudGF0aW9ucyBub3Qgc3VwcG9ydHMgY2hhaW5pbmcNCiAgICAgICwgSEFTTlRfQ0hBSU5JTkcgICAgICAgPSBpbnN0YW5jZVtBRERFUl0oSVNfV0VBSyA/IHt9IDogLTAsIDEpICE9IGluc3RhbmNlDQogICAgICAvLyBWOCB+ICBDaHJvbWl1bSA0MC0gd2Vhay1jb2xsZWN0aW9ucyB0aHJvd3Mgb24gcHJpbWl0aXZlcywgYnV0IHNob3VsZCByZXR1cm4gZmFsc2UNCiAgICAgICwgVEhST1dTX09OX1BSSU1JVElWRVMgPSBmYWlscyhmdW5jdGlvbigpeyBpbnN0YW5jZS5oYXMoMSk7IH0pDQogICAgICAvLyBtb3N0IGVhcmx5IGltcGxlbWVudGF0aW9ucyBkb2Vzbid0IHN1cHBvcnRzIGl0ZXJhYmxlcywgbW9zdCBtb2Rlcm4gLSBub3QgY2xvc2UgaXQgY29ycmVjdGx5DQogICAgICAsIEFDQ0VQVF9JVEVSQUJMRVMgICAgID0gJGl0ZXJEZXRlY3QoZnVuY3Rpb24oaXRlcil7IG5ldyBDKGl0ZXIpOyB9KSAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLW5ldw0KICAgICAgLy8gZm9yIGVhcmx5IGltcGxlbWVudGF0aW9ucyAtMCBhbmQgKzAgbm90IHRoZSBzYW1lDQogICAgICAsIEJVR0dZX1pFUk8gPSAhSVNfV0VBSyAmJiBmYWlscyhmdW5jdGlvbigpew0KICAgICAgICAvLyBWOCB+IENocm9taXVtIDQyLSBmYWlscyBvbmx5IHdpdGggNSsgZWxlbWVudHMNCiAgICAgICAgdmFyICRpbnN0YW5jZSA9IG5ldyBDKCkNCiAgICAgICAgICAsIGluZGV4ICAgICA9IDU7DQogICAgICAgIHdoaWxlKGluZGV4LS0pJGluc3RhbmNlW0FEREVSXShpbmRleCwgaW5kZXgpOw0KICAgICAgICByZXR1cm4gISRpbnN0YW5jZS5oYXMoLTApOw0KICAgICAgfSk7DQogICAgaWYoIUFDQ0VQVF9JVEVSQUJMRVMpeyANCiAgICAgIEMgPSB3cmFwcGVyKGZ1bmN0aW9uKHRhcmdldCwgaXRlcmFibGUpew0KICAgICAgICBhbkluc3RhbmNlKHRhcmdldCwgQywgTkFNRSk7DQogICAgICAgIHZhciB0aGF0ID0gaW5oZXJpdElmUmVxdWlyZWQobmV3IEJhc2UsIHRhcmdldCwgQyk7DQogICAgICAgIGlmKGl0ZXJhYmxlICE9IHVuZGVmaW5lZClmb3JPZihpdGVyYWJsZSwgSVNfTUFQLCB0aGF0W0FEREVSXSwgdGhhdCk7DQogICAgICAgIHJldHVybiB0aGF0Ow0KICAgICAgfSk7DQogICAgICBDLnByb3RvdHlwZSA9IHByb3RvOw0KICAgICAgcHJvdG8uY29uc3RydWN0b3IgPSBDOw0KICAgIH0NCiAgICBpZihUSFJPV1NfT05fUFJJTUlUSVZFUyB8fCBCVUdHWV9aRVJPKXsNCiAgICAgIGZpeE1ldGhvZCgnZGVsZXRlJyk7DQogICAgICBmaXhNZXRob2QoJ2hhcycpOw0KICAgICAgSVNfTUFQICYmIGZpeE1ldGhvZCgnZ2V0Jyk7DQogICAgfQ0KICAgIGlmKEJVR0dZX1pFUk8gfHwgSEFTTlRfQ0hBSU5JTkcpZml4TWV0aG9kKEFEREVSKTsNCiAgICAvLyB3ZWFrIGNvbGxlY3Rpb25zIHNob3VsZCBub3QgY29udGFpbnMgLmNsZWFyIG1ldGhvZA0KICAgIGlmKElTX1dFQUsgJiYgcHJvdG8uY2xlYXIpZGVsZXRlIHByb3RvLmNsZWFyOw0KICB9DQoNCiAgc2V0VG9TdHJpbmdUYWcoQywgTkFNRSk7DQoNCiAgT1tOQU1FXSA9IEM7DQogICRleHBvcnQoJGV4cG9ydC5HICsgJGV4cG9ydC5XICsgJGV4cG9ydC5GICogKEMgIT0gQmFzZSksIE8pOw0KDQogIGlmKCFJU19XRUFLKWNvbW1vbi5zZXRTdHJvbmcoQywgTkFNRSwgSVNfTUFQKTsNCg0KICByZXR1cm4gQzsNCn07DQp9LHsiLi9fYW4taW5zdGFuY2UiOjYsIi4vX2V4cG9ydCI6MzIsIi4vX2ZhaWxzIjozNCwiLi9fZm9yLW9mIjozNywiLi9fZ2xvYmFsIjozOCwiLi9faW5oZXJpdC1pZi1yZXF1aXJlZCI6NDMsIi4vX2lzLW9iamVjdCI6NDksIi4vX2l0ZXItZGV0ZWN0Ijo1NCwiLi9fbWV0YSI6NjIsIi4vX3JlZGVmaW5lIjo4NywiLi9fcmVkZWZpbmUtYWxsIjo4NiwiLi9fc2V0LXRvLXN0cmluZy10YWciOjkyfV0sMjM6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KdmFyIGNvcmUgPSBtb2R1bGUuZXhwb3J0cyA9IHt2ZXJzaW9uOiAnMi40LjAnfTsNCmlmKHR5cGVvZiBfX2UgPT0gJ251bWJlcicpX19lID0gY29yZTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby11bmRlZg0KfSx7fV0sMjQ6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KJ3VzZSBzdHJpY3QnOw0KdmFyICRkZWZpbmVQcm9wZXJ0eSA9IHJlcXVpcmUoJy4vX29iamVjdC1kcCcpDQogICwgY3JlYXRlRGVzYyAgICAgID0gcmVxdWlyZSgnLi9fcHJvcGVydHktZGVzYycpOw0KDQptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKG9iamVjdCwgaW5kZXgsIHZhbHVlKXsNCiAgaWYoaW5kZXggaW4gb2JqZWN0KSRkZWZpbmVQcm9wZXJ0eS5mKG9iamVjdCwgaW5kZXgsIGNyZWF0ZURlc2MoMCwgdmFsdWUpKTsNCiAgZWxzZSBvYmplY3RbaW5kZXhdID0gdmFsdWU7DQp9Ow0KfSx7Ii4vX29iamVjdC1kcCI6NjcsIi4vX3Byb3BlcnR5LWRlc2MiOjg1fV0sMjU6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KLy8gb3B0aW9uYWwgLyBzaW1wbGUgY29udGV4dCBiaW5kaW5nDQp2YXIgYUZ1bmN0aW9uID0gcmVxdWlyZSgnLi9fYS1mdW5jdGlvbicpOw0KbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihmbiwgdGhhdCwgbGVuZ3RoKXsNCiAgYUZ1bmN0aW9uKGZuKTsNCiAgaWYodGhhdCA9PT0gdW5kZWZpbmVkKXJldHVybiBmbjsNCiAgc3dpdGNoKGxlbmd0aCl7DQogICAgY2FzZSAxOiByZXR1cm4gZnVuY3Rpb24oYSl7DQogICAgICByZXR1cm4gZm4uY2FsbCh0aGF0LCBhKTsNCiAgICB9Ow0KICAgIGNhc2UgMjogcmV0dXJuIGZ1bmN0aW9uKGEsIGIpew0KICAgICAgcmV0dXJuIGZuLmNhbGwodGhhdCwgYSwgYik7DQogICAgfTsNCiAgICBjYXNlIDM6IHJldHVybiBmdW5jdGlvbihhLCBiLCBjKXsNCiAgICAgIHJldHVybiBmbi5jYWxsKHRoYXQsIGEsIGIsIGMpOw0KICAgIH07DQogIH0NCiAgcmV0dXJuIGZ1bmN0aW9uKC8qIC4uLmFyZ3MgKi8pew0KICAgIHJldHVybiBmbi5hcHBseSh0aGF0LCBhcmd1bWVudHMpOw0KICB9Ow0KfTsNCn0seyIuL19hLWZ1bmN0aW9uIjozfV0sMjY6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KJ3VzZSBzdHJpY3QnOw0KdmFyIGFuT2JqZWN0ICAgID0gcmVxdWlyZSgnLi9fYW4tb2JqZWN0JykNCiAgLCB0b1ByaW1pdGl2ZSA9IHJlcXVpcmUoJy4vX3RvLXByaW1pdGl2ZScpDQogICwgTlVNQkVSICAgICAgPSAnbnVtYmVyJzsNCg0KbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihoaW50KXsNCiAgaWYoaGludCAhPT0gJ3N0cmluZycgJiYgaGludCAhPT0gTlVNQkVSICYmIGhpbnQgIT09ICdkZWZhdWx0Jyl0aHJvdyBUeXBlRXJyb3IoJ0luY29ycmVjdCBoaW50Jyk7DQogIHJldHVybiB0b1ByaW1pdGl2ZShhbk9iamVjdCh0aGlzKSwgaGludCAhPSBOVU1CRVIpOw0KfTsNCn0seyIuL19hbi1vYmplY3QiOjcsIi4vX3RvLXByaW1pdGl2ZSI6MTEwfV0sMjc6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KLy8gNy4yLjEgUmVxdWlyZU9iamVjdENvZXJjaWJsZShhcmd1bWVudCkNCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQpew0KICBpZihpdCA9PSB1bmRlZmluZWQpdGhyb3cgVHlwZUVycm9yKCJDYW4ndCBjYWxsIG1ldGhvZCBvbiAgIiArIGl0KTsNCiAgcmV0dXJuIGl0Ow0KfTsNCn0se31dLDI4OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCi8vIFRoYW5rJ3MgSUU4IGZvciBoaXMgZnVubnkgZGVmaW5lUHJvcGVydHkNCm1vZHVsZS5leHBvcnRzID0gIXJlcXVpcmUoJy4vX2ZhaWxzJykoZnVuY3Rpb24oKXsNCiAgcmV0dXJuIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh7fSwgJ2EnLCB7Z2V0OiBmdW5jdGlvbigpeyByZXR1cm4gNzsgfX0pLmEgIT0gNzsNCn0pOw0KfSx7Ii4vX2ZhaWxzIjozNH1dLDI5OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCnZhciBpc09iamVjdCA9IHJlcXVpcmUoJy4vX2lzLW9iamVjdCcpDQogICwgZG9jdW1lbnQgPSByZXF1aXJlKCcuL19nbG9iYWwnKS5kb2N1bWVudA0KICAvLyBpbiBvbGQgSUUgdHlwZW9mIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQgaXMgJ29iamVjdCcNCiAgLCBpcyA9IGlzT2JqZWN0KGRvY3VtZW50KSAmJiBpc09iamVjdChkb2N1bWVudC5jcmVhdGVFbGVtZW50KTsNCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQpew0KICByZXR1cm4gaXMgPyBkb2N1bWVudC5jcmVhdGVFbGVtZW50KGl0KSA6IHt9Ow0KfTsNCn0seyIuL19nbG9iYWwiOjM4LCIuL19pcy1vYmplY3QiOjQ5fV0sMzA6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KLy8gSUUgOC0gZG9uJ3QgZW51bSBidWcga2V5cw0KbW9kdWxlLmV4cG9ydHMgPSAoDQogICdjb25zdHJ1Y3RvcixoYXNPd25Qcm9wZXJ0eSxpc1Byb3RvdHlwZU9mLHByb3BlcnR5SXNFbnVtZXJhYmxlLHRvTG9jYWxlU3RyaW5nLHRvU3RyaW5nLHZhbHVlT2YnDQopLnNwbGl0KCcsJyk7DQp9LHt9XSwzMTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQovLyBhbGwgZW51bWVyYWJsZSBvYmplY3Qga2V5cywgaW5jbHVkZXMgc3ltYm9scw0KdmFyIGdldEtleXMgPSByZXF1aXJlKCcuL19vYmplY3Qta2V5cycpDQogICwgZ09QUyAgICA9IHJlcXVpcmUoJy4vX29iamVjdC1nb3BzJykNCiAgLCBwSUUgICAgID0gcmVxdWlyZSgnLi9fb2JqZWN0LXBpZScpOw0KbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7DQogIHZhciByZXN1bHQgICAgID0gZ2V0S2V5cyhpdCkNCiAgICAsIGdldFN5bWJvbHMgPSBnT1BTLmY7DQogIGlmKGdldFN5bWJvbHMpew0KICAgIHZhciBzeW1ib2xzID0gZ2V0U3ltYm9scyhpdCkNCiAgICAgICwgaXNFbnVtICA9IHBJRS5mDQogICAgICAsIGkgICAgICAgPSAwDQogICAgICAsIGtleTsNCiAgICB3aGlsZShzeW1ib2xzLmxlbmd0aCA+IGkpaWYoaXNFbnVtLmNhbGwoaXQsIGtleSA9IHN5bWJvbHNbaSsrXSkpcmVzdWx0LnB1c2goa2V5KTsNCiAgfSByZXR1cm4gcmVzdWx0Ow0KfTsNCn0seyIuL19vYmplY3QtZ29wcyI6NzMsIi4vX29iamVjdC1rZXlzIjo3NiwiLi9fb2JqZWN0LXBpZSI6Nzd9XSwzMjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQp2YXIgZ2xvYmFsICAgID0gcmVxdWlyZSgnLi9fZ2xvYmFsJykNCiAgLCBjb3JlICAgICAgPSByZXF1aXJlKCcuL19jb3JlJykNCiAgLCBoaWRlICAgICAgPSByZXF1aXJlKCcuL19oaWRlJykNCiAgLCByZWRlZmluZSAgPSByZXF1aXJlKCcuL19yZWRlZmluZScpDQogICwgY3R4ICAgICAgID0gcmVxdWlyZSgnLi9fY3R4JykNCiAgLCBQUk9UT1RZUEUgPSAncHJvdG90eXBlJzsNCg0KdmFyICRleHBvcnQgPSBmdW5jdGlvbih0eXBlLCBuYW1lLCBzb3VyY2Upew0KICB2YXIgSVNfRk9SQ0VEID0gdHlwZSAmICRleHBvcnQuRg0KICAgICwgSVNfR0xPQkFMID0gdHlwZSAmICRleHBvcnQuRw0KICAgICwgSVNfU1RBVElDID0gdHlwZSAmICRleHBvcnQuUw0KICAgICwgSVNfUFJPVE8gID0gdHlwZSAmICRleHBvcnQuUA0KICAgICwgSVNfQklORCAgID0gdHlwZSAmICRleHBvcnQuQg0KICAgICwgdGFyZ2V0ICAgID0gSVNfR0xPQkFMID8gZ2xvYmFsIDogSVNfU1RBVElDID8gZ2xvYmFsW25hbWVdIHx8IChnbG9iYWxbbmFtZV0gPSB7fSkgOiAoZ2xvYmFsW25hbWVdIHx8IHt9KVtQUk9UT1RZUEVdDQogICAgLCBleHBvcnRzICAgPSBJU19HTE9CQUwgPyBjb3JlIDogY29yZVtuYW1lXSB8fCAoY29yZVtuYW1lXSA9IHt9KQ0KICAgICwgZXhwUHJvdG8gID0gZXhwb3J0c1tQUk9UT1RZUEVdIHx8IChleHBvcnRzW1BST1RPVFlQRV0gPSB7fSkNCiAgICAsIGtleSwgb3duLCBvdXQsIGV4cDsNCiAgaWYoSVNfR0xPQkFMKXNvdXJjZSA9IG5hbWU7DQogIGZvcihrZXkgaW4gc291cmNlKXsNCiAgICAvLyBjb250YWlucyBpbiBuYXRpdmUNCiAgICBvd24gPSAhSVNfRk9SQ0VEICYmIHRhcmdldCAmJiB0YXJnZXRba2V5XSAhPT0gdW5kZWZpbmVkOw0KICAgIC8vIGV4cG9ydCBuYXRpdmUgb3IgcGFzc2VkDQogICAgb3V0ID0gKG93biA/IHRhcmdldCA6IHNvdXJjZSlba2V5XTsNCiAgICAvLyBiaW5kIHRpbWVycyB0byBnbG9iYWwgZm9yIGNhbGwgZnJvbSBleHBvcnQgY29udGV4dA0KICAgIGV4cCA9IElTX0JJTkQgJiYgb3duID8gY3R4KG91dCwgZ2xvYmFsKSA6IElTX1BST1RPICYmIHR5cGVvZiBvdXQgPT0gJ2Z1bmN0aW9uJyA/IGN0eChGdW5jdGlvbi5jYWxsLCBvdXQpIDogb3V0Ow0KICAgIC8vIGV4dGVuZCBnbG9iYWwNCiAgICBpZih0YXJnZXQpcmVkZWZpbmUodGFyZ2V0LCBrZXksIG91dCwgdHlwZSAmICRleHBvcnQuVSk7DQogICAgLy8gZXhwb3J0DQogICAgaWYoZXhwb3J0c1trZXldICE9IG91dCloaWRlKGV4cG9ydHMsIGtleSwgZXhwKTsNCiAgICBpZihJU19QUk9UTyAmJiBleHBQcm90b1trZXldICE9IG91dClleHBQcm90b1trZXldID0gb3V0Ow0KICB9DQp9Ow0KZ2xvYmFsLmNvcmUgPSBjb3JlOw0KLy8gdHlwZSBiaXRtYXANCiRleHBvcnQuRiA9IDE7ICAgLy8gZm9yY2VkDQokZXhwb3J0LkcgPSAyOyAgIC8vIGdsb2JhbA0KJGV4cG9ydC5TID0gNDsgICAvLyBzdGF0aWMNCiRleHBvcnQuUCA9IDg7ICAgLy8gcHJvdG8NCiRleHBvcnQuQiA9IDE2OyAgLy8gYmluZA0KJGV4cG9ydC5XID0gMzI7ICAvLyB3cmFwDQokZXhwb3J0LlUgPSA2NDsgIC8vIHNhZmUNCiRleHBvcnQuUiA9IDEyODsgLy8gcmVhbCBwcm90byBtZXRob2QgZm9yIGBsaWJyYXJ5YCANCm1vZHVsZS5leHBvcnRzID0gJGV4cG9ydDsNCn0seyIuL19jb3JlIjoyMywiLi9fY3R4IjoyNSwiLi9fZ2xvYmFsIjozOCwiLi9faGlkZSI6NDAsIi4vX3JlZGVmaW5lIjo4N31dLDMzOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCnZhciBNQVRDSCA9IHJlcXVpcmUoJy4vX3drcycpKCdtYXRjaCcpOw0KbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihLRVkpew0KICB2YXIgcmUgPSAvLi87DQogIHRyeSB7DQogICAgJy8uLydbS0VZXShyZSk7DQogIH0gY2F0Y2goZSl7DQogICAgdHJ5IHsNCiAgICAgIHJlW01BVENIXSA9IGZhbHNlOw0KICAgICAgcmV0dXJuICEnLy4vJ1tLRVldKHJlKTsNCiAgICB9IGNhdGNoKGYpeyAvKiBlbXB0eSAqLyB9DQogIH0gcmV0dXJuIHRydWU7DQp9Ow0KfSx7Ii4vX3drcyI6MTE3fV0sMzQ6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihleGVjKXsNCiAgdHJ5IHsNCiAgICByZXR1cm4gISFleGVjKCk7DQogIH0gY2F0Y2goZSl7DQogICAgcmV0dXJuIHRydWU7DQogIH0NCn07DQp9LHt9XSwzNTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQondXNlIHN0cmljdCc7DQp2YXIgaGlkZSAgICAgPSByZXF1aXJlKCcuL19oaWRlJykNCiAgLCByZWRlZmluZSA9IHJlcXVpcmUoJy4vX3JlZGVmaW5lJykNCiAgLCBmYWlscyAgICA9IHJlcXVpcmUoJy4vX2ZhaWxzJykNCiAgLCBkZWZpbmVkICA9IHJlcXVpcmUoJy4vX2RlZmluZWQnKQ0KICAsIHdrcyAgICAgID0gcmVxdWlyZSgnLi9fd2tzJyk7DQoNCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oS0VZLCBsZW5ndGgsIGV4ZWMpew0KICB2YXIgU1lNQk9MICAgPSB3a3MoS0VZKQ0KICAgICwgZm5zICAgICAgPSBleGVjKGRlZmluZWQsIFNZTUJPTCwgJydbS0VZXSkNCiAgICAsIHN0cmZuICAgID0gZm5zWzBdDQogICAgLCByeGZuICAgICA9IGZuc1sxXTsNCiAgaWYoZmFpbHMoZnVuY3Rpb24oKXsNCiAgICB2YXIgTyA9IHt9Ow0KICAgIE9bU1lNQk9MXSA9IGZ1bmN0aW9uKCl7IHJldHVybiA3OyB9Ow0KICAgIHJldHVybiAnJ1tLRVldKE8pICE9IDc7DQogIH0pKXsNCiAgICByZWRlZmluZShTdHJpbmcucHJvdG90eXBlLCBLRVksIHN0cmZuKTsNCiAgICBoaWRlKFJlZ0V4cC5wcm90b3R5cGUsIFNZTUJPTCwgbGVuZ3RoID09IDINCiAgICAgIC8vIDIxLjIuNS44IFJlZ0V4cC5wcm90b3R5cGVbQEByZXBsYWNlXShzdHJpbmcsIHJlcGxhY2VWYWx1ZSkNCiAgICAgIC8vIDIxLjIuNS4xMSBSZWdFeHAucHJvdG90eXBlW0BAc3BsaXRdKHN0cmluZywgbGltaXQpDQogICAgICA/IGZ1bmN0aW9uKHN0cmluZywgYXJnKXsgcmV0dXJuIHJ4Zm4uY2FsbChzdHJpbmcsIHRoaXMsIGFyZyk7IH0NCiAgICAgIC8vIDIxLjIuNS42IFJlZ0V4cC5wcm90b3R5cGVbQEBtYXRjaF0oc3RyaW5nKQ0KICAgICAgLy8gMjEuMi41LjkgUmVnRXhwLnByb3RvdHlwZVtAQHNlYXJjaF0oc3RyaW5nKQ0KICAgICAgOiBmdW5jdGlvbihzdHJpbmcpeyByZXR1cm4gcnhmbi5jYWxsKHN0cmluZywgdGhpcyk7IH0NCiAgICApOw0KICB9DQp9Ow0KfSx7Ii4vX2RlZmluZWQiOjI3LCIuL19mYWlscyI6MzQsIi4vX2hpZGUiOjQwLCIuL19yZWRlZmluZSI6ODcsIi4vX3drcyI6MTE3fV0sMzY6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KJ3VzZSBzdHJpY3QnOw0KLy8gMjEuMi41LjMgZ2V0IFJlZ0V4cC5wcm90b3R5cGUuZmxhZ3MNCnZhciBhbk9iamVjdCA9IHJlcXVpcmUoJy4vX2FuLW9iamVjdCcpOw0KbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbigpew0KICB2YXIgdGhhdCAgID0gYW5PYmplY3QodGhpcykNCiAgICAsIHJlc3VsdCA9ICcnOw0KICBpZih0aGF0Lmdsb2JhbCkgICAgIHJlc3VsdCArPSAnZyc7DQogIGlmKHRoYXQuaWdub3JlQ2FzZSkgcmVzdWx0ICs9ICdpJzsNCiAgaWYodGhhdC5tdWx0aWxpbmUpICByZXN1bHQgKz0gJ20nOw0KICBpZih0aGF0LnVuaWNvZGUpICAgIHJlc3VsdCArPSAndSc7DQogIGlmKHRoYXQuc3RpY2t5KSAgICAgcmVzdWx0ICs9ICd5JzsNCiAgcmV0dXJuIHJlc3VsdDsNCn07DQp9LHsiLi9fYW4tb2JqZWN0Ijo3fV0sMzc6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KdmFyIGN0eCAgICAgICAgID0gcmVxdWlyZSgnLi9fY3R4JykNCiAgLCBjYWxsICAgICAgICA9IHJlcXVpcmUoJy4vX2l0ZXItY2FsbCcpDQogICwgaXNBcnJheUl0ZXIgPSByZXF1aXJlKCcuL19pcy1hcnJheS1pdGVyJykNCiAgLCBhbk9iamVjdCAgICA9IHJlcXVpcmUoJy4vX2FuLW9iamVjdCcpDQogICwgdG9MZW5ndGggICAgPSByZXF1aXJlKCcuL190by1sZW5ndGgnKQ0KICAsIGdldEl0ZXJGbiAgID0gcmVxdWlyZSgnLi9jb3JlLmdldC1pdGVyYXRvci1tZXRob2QnKQ0KICAsIEJSRUFLICAgICAgID0ge30NCiAgLCBSRVRVUk4gICAgICA9IHt9Ow0KdmFyIGV4cG9ydHMgPSBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0ZXJhYmxlLCBlbnRyaWVzLCBmbiwgdGhhdCwgSVRFUkFUT1Ipew0KICB2YXIgaXRlckZuID0gSVRFUkFUT1IgPyBmdW5jdGlvbigpeyByZXR1cm4gaXRlcmFibGU7IH0gOiBnZXRJdGVyRm4oaXRlcmFibGUpDQogICAgLCBmICAgICAgPSBjdHgoZm4sIHRoYXQsIGVudHJpZXMgPyAyIDogMSkNCiAgICAsIGluZGV4ICA9IDANCiAgICAsIGxlbmd0aCwgc3RlcCwgaXRlcmF0b3IsIHJlc3VsdDsNCiAgaWYodHlwZW9mIGl0ZXJGbiAhPSAnZnVuY3Rpb24nKXRocm93IFR5cGVFcnJvcihpdGVyYWJsZSArICcgaXMgbm90IGl0ZXJhYmxlIScpOw0KICAvLyBmYXN0IGNhc2UgZm9yIGFycmF5cyB3aXRoIGRlZmF1bHQgaXRlcmF0b3INCiAgaWYoaXNBcnJheUl0ZXIoaXRlckZuKSlmb3IobGVuZ3RoID0gdG9MZW5ndGgoaXRlcmFibGUubGVuZ3RoKTsgbGVuZ3RoID4gaW5kZXg7IGluZGV4Kyspew0KICAgIHJlc3VsdCA9IGVudHJpZXMgPyBmKGFuT2JqZWN0KHN0ZXAgPSBpdGVyYWJsZVtpbmRleF0pWzBdLCBzdGVwWzFdKSA6IGYoaXRlcmFibGVbaW5kZXhdKTsNCiAgICBpZihyZXN1bHQgPT09IEJSRUFLIHx8IHJlc3VsdCA9PT0gUkVUVVJOKXJldHVybiByZXN1bHQ7DQogIH0gZWxzZSBmb3IoaXRlcmF0b3IgPSBpdGVyRm4uY2FsbChpdGVyYWJsZSk7ICEoc3RlcCA9IGl0ZXJhdG9yLm5leHQoKSkuZG9uZTsgKXsNCiAgICByZXN1bHQgPSBjYWxsKGl0ZXJhdG9yLCBmLCBzdGVwLnZhbHVlLCBlbnRyaWVzKTsNCiAgICBpZihyZXN1bHQgPT09IEJSRUFLIHx8IHJlc3VsdCA9PT0gUkVUVVJOKXJldHVybiByZXN1bHQ7DQogIH0NCn07DQpleHBvcnRzLkJSRUFLICA9IEJSRUFLOw0KZXhwb3J0cy5SRVRVUk4gPSBSRVRVUk47DQp9LHsiLi9fYW4tb2JqZWN0Ijo3LCIuL19jdHgiOjI1LCIuL19pcy1hcnJheS1pdGVyIjo0NiwiLi9faXRlci1jYWxsIjo1MSwiLi9fdG8tbGVuZ3RoIjoxMDgsIi4vY29yZS5nZXQtaXRlcmF0b3ItbWV0aG9kIjoxMTh9XSwzODpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQovLyBodHRwczovL2dpdGh1Yi5jb20vemxvaXJvY2svY29yZS1qcy9pc3N1ZXMvODYjaXNzdWVjb21tZW50LTExNTc1OTAyOA0KdmFyIGdsb2JhbCA9IG1vZHVsZS5leHBvcnRzID0gdHlwZW9mIHdpbmRvdyAhPSAndW5kZWZpbmVkJyAmJiB3aW5kb3cuTWF0aCA9PSBNYXRoDQogID8gd2luZG93IDogdHlwZW9mIHNlbGYgIT0gJ3VuZGVmaW5lZCcgJiYgc2VsZi5NYXRoID09IE1hdGggPyBzZWxmIDogRnVuY3Rpb24oJ3JldHVybiB0aGlzJykoKTsNCmlmKHR5cGVvZiBfX2cgPT0gJ251bWJlcicpX19nID0gZ2xvYmFsOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXVuZGVmDQp9LHt9XSwzOTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQp2YXIgaGFzT3duUHJvcGVydHkgPSB7fS5oYXNPd25Qcm9wZXJ0eTsNCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQsIGtleSl7DQogIHJldHVybiBoYXNPd25Qcm9wZXJ0eS5jYWxsKGl0LCBrZXkpOw0KfTsNCn0se31dLDQwOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCnZhciBkUCAgICAgICAgID0gcmVxdWlyZSgnLi9fb2JqZWN0LWRwJykNCiAgLCBjcmVhdGVEZXNjID0gcmVxdWlyZSgnLi9fcHJvcGVydHktZGVzYycpOw0KbW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKCcuL19kZXNjcmlwdG9ycycpID8gZnVuY3Rpb24ob2JqZWN0LCBrZXksIHZhbHVlKXsNCiAgcmV0dXJuIGRQLmYob2JqZWN0LCBrZXksIGNyZWF0ZURlc2MoMSwgdmFsdWUpKTsNCn0gOiBmdW5jdGlvbihvYmplY3QsIGtleSwgdmFsdWUpew0KICBvYmplY3Rba2V5XSA9IHZhbHVlOw0KICByZXR1cm4gb2JqZWN0Ow0KfTsNCn0seyIuL19kZXNjcmlwdG9ycyI6MjgsIi4vX29iamVjdC1kcCI6NjcsIi4vX3Byb3BlcnR5LWRlc2MiOjg1fV0sNDE6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KbW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKCcuL19nbG9iYWwnKS5kb2N1bWVudCAmJiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7DQp9LHsiLi9fZ2xvYmFsIjozOH1dLDQyOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCm1vZHVsZS5leHBvcnRzID0gIXJlcXVpcmUoJy4vX2Rlc2NyaXB0b3JzJykgJiYgIXJlcXVpcmUoJy4vX2ZhaWxzJykoZnVuY3Rpb24oKXsNCiAgcmV0dXJuIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShyZXF1aXJlKCcuL19kb20tY3JlYXRlJykoJ2RpdicpLCAnYScsIHtnZXQ6IGZ1bmN0aW9uKCl7IHJldHVybiA3OyB9fSkuYSAhPSA3Ow0KfSk7DQp9LHsiLi9fZGVzY3JpcHRvcnMiOjI4LCIuL19kb20tY3JlYXRlIjoyOSwiLi9fZmFpbHMiOjM0fV0sNDM6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KdmFyIGlzT2JqZWN0ICAgICAgID0gcmVxdWlyZSgnLi9faXMtb2JqZWN0JykNCiAgLCBzZXRQcm90b3R5cGVPZiA9IHJlcXVpcmUoJy4vX3NldC1wcm90bycpLnNldDsNCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24odGhhdCwgdGFyZ2V0LCBDKXsNCiAgdmFyIFAsIFMgPSB0YXJnZXQuY29uc3RydWN0b3I7DQogIGlmKFMgIT09IEMgJiYgdHlwZW9mIFMgPT0gJ2Z1bmN0aW9uJyAmJiAoUCA9IFMucHJvdG90eXBlKSAhPT0gQy5wcm90b3R5cGUgJiYgaXNPYmplY3QoUCkgJiYgc2V0UHJvdG90eXBlT2Ypew0KICAgIHNldFByb3RvdHlwZU9mKHRoYXQsIFApOw0KICB9IHJldHVybiB0aGF0Ow0KfTsNCn0seyIuL19pcy1vYmplY3QiOjQ5LCIuL19zZXQtcHJvdG8iOjkwfV0sNDQ6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KLy8gZmFzdCBhcHBseSwgaHR0cDovL2pzcGVyZi5sbmtpdC5jb20vZmFzdC1hcHBseS81DQptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGZuLCBhcmdzLCB0aGF0KXsNCiAgdmFyIHVuID0gdGhhdCA9PT0gdW5kZWZpbmVkOw0KICBzd2l0Y2goYXJncy5sZW5ndGgpew0KICAgIGNhc2UgMDogcmV0dXJuIHVuID8gZm4oKQ0KICAgICAgICAgICAgICAgICAgICAgIDogZm4uY2FsbCh0aGF0KTsNCiAgICBjYXNlIDE6IHJldHVybiB1biA/IGZuKGFyZ3NbMF0pDQogICAgICAgICAgICAgICAgICAgICAgOiBmbi5jYWxsKHRoYXQsIGFyZ3NbMF0pOw0KICAgIGNhc2UgMjogcmV0dXJuIHVuID8gZm4oYXJnc1swXSwgYXJnc1sxXSkNCiAgICAgICAgICAgICAgICAgICAgICA6IGZuLmNhbGwodGhhdCwgYXJnc1swXSwgYXJnc1sxXSk7DQogICAgY2FzZSAzOiByZXR1cm4gdW4gPyBmbihhcmdzWzBdLCBhcmdzWzFdLCBhcmdzWzJdKQ0KICAgICAgICAgICAgICAgICAgICAgIDogZm4uY2FsbCh0aGF0LCBhcmdzWzBdLCBhcmdzWzFdLCBhcmdzWzJdKTsNCiAgICBjYXNlIDQ6IHJldHVybiB1biA/IGZuKGFyZ3NbMF0sIGFyZ3NbMV0sIGFyZ3NbMl0sIGFyZ3NbM10pDQogICAgICAgICAgICAgICAgICAgICAgOiBmbi5jYWxsKHRoYXQsIGFyZ3NbMF0sIGFyZ3NbMV0sIGFyZ3NbMl0sIGFyZ3NbM10pOw0KICB9IHJldHVybiAgICAgICAgICAgICAgZm4uYXBwbHkodGhhdCwgYXJncyk7DQp9Ow0KfSx7fV0sNDU6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KLy8gZmFsbGJhY2sgZm9yIG5vbi1hcnJheS1saWtlIEVTMyBhbmQgbm9uLWVudW1lcmFibGUgb2xkIFY4IHN0cmluZ3MNCnZhciBjb2YgPSByZXF1aXJlKCcuL19jb2YnKTsNCm1vZHVsZS5leHBvcnRzID0gT2JqZWN0KCd6JykucHJvcGVydHlJc0VudW1lcmFibGUoMCkgPyBPYmplY3QgOiBmdW5jdGlvbihpdCl7DQogIHJldHVybiBjb2YoaXQpID09ICdTdHJpbmcnID8gaXQuc3BsaXQoJycpIDogT2JqZWN0KGl0KTsNCn07DQp9LHsiLi9fY29mIjoxOH1dLDQ2OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCi8vIGNoZWNrIG9uIGRlZmF1bHQgQXJyYXkgaXRlcmF0b3INCnZhciBJdGVyYXRvcnMgID0gcmVxdWlyZSgnLi9faXRlcmF0b3JzJykNCiAgLCBJVEVSQVRPUiAgID0gcmVxdWlyZSgnLi9fd2tzJykoJ2l0ZXJhdG9yJykNCiAgLCBBcnJheVByb3RvID0gQXJyYXkucHJvdG90eXBlOw0KDQptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsNCiAgcmV0dXJuIGl0ICE9PSB1bmRlZmluZWQgJiYgKEl0ZXJhdG9ycy5BcnJheSA9PT0gaXQgfHwgQXJyYXlQcm90b1tJVEVSQVRPUl0gPT09IGl0KTsNCn07DQp9LHsiLi9faXRlcmF0b3JzIjo1NiwiLi9fd2tzIjoxMTd9XSw0NzpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQovLyA3LjIuMiBJc0FycmF5KGFyZ3VtZW50KQ0KdmFyIGNvZiA9IHJlcXVpcmUoJy4vX2NvZicpOw0KbW9kdWxlLmV4cG9ydHMgPSBBcnJheS5pc0FycmF5IHx8IGZ1bmN0aW9uIGlzQXJyYXkoYXJnKXsNCiAgcmV0dXJuIGNvZihhcmcpID09ICdBcnJheSc7DQp9Ow0KfSx7Ii4vX2NvZiI6MTh9XSw0ODpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQovLyAyMC4xLjIuMyBOdW1iZXIuaXNJbnRlZ2VyKG51bWJlcikNCnZhciBpc09iamVjdCA9IHJlcXVpcmUoJy4vX2lzLW9iamVjdCcpDQogICwgZmxvb3IgICAgPSBNYXRoLmZsb29yOw0KbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBpc0ludGVnZXIoaXQpew0KICByZXR1cm4gIWlzT2JqZWN0KGl0KSAmJiBpc0Zpbml0ZShpdCkgJiYgZmxvb3IoaXQpID09PSBpdDsNCn07DQp9LHsiLi9faXMtb2JqZWN0Ijo0OX1dLDQ5OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQpew0KICByZXR1cm4gdHlwZW9mIGl0ID09PSAnb2JqZWN0JyA/IGl0ICE9PSBudWxsIDogdHlwZW9mIGl0ID09PSAnZnVuY3Rpb24nOw0KfTsNCn0se31dLDUwOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCi8vIDcuMi44IElzUmVnRXhwKGFyZ3VtZW50KQ0KdmFyIGlzT2JqZWN0ID0gcmVxdWlyZSgnLi9faXMtb2JqZWN0JykNCiAgLCBjb2YgICAgICA9IHJlcXVpcmUoJy4vX2NvZicpDQogICwgTUFUQ0ggICAgPSByZXF1aXJlKCcuL193a3MnKSgnbWF0Y2gnKTsNCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQpew0KICB2YXIgaXNSZWdFeHA7DQogIHJldHVybiBpc09iamVjdChpdCkgJiYgKChpc1JlZ0V4cCA9IGl0W01BVENIXSkgIT09IHVuZGVmaW5lZCA/ICEhaXNSZWdFeHAgOiBjb2YoaXQpID09ICdSZWdFeHAnKTsNCn07DQp9LHsiLi9fY29mIjoxOCwiLi9faXMtb2JqZWN0Ijo0OSwiLi9fd2tzIjoxMTd9XSw1MTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQovLyBjYWxsIHNvbWV0aGluZyBvbiBpdGVyYXRvciBzdGVwIHdpdGggc2FmZSBjbG9zaW5nIG9uIGVycm9yDQp2YXIgYW5PYmplY3QgPSByZXF1aXJlKCcuL19hbi1vYmplY3QnKTsNCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXRlcmF0b3IsIGZuLCB2YWx1ZSwgZW50cmllcyl7DQogIHRyeSB7DQogICAgcmV0dXJuIGVudHJpZXMgPyBmbihhbk9iamVjdCh2YWx1ZSlbMF0sIHZhbHVlWzFdKSA6IGZuKHZhbHVlKTsNCiAgLy8gNy40LjYgSXRlcmF0b3JDbG9zZShpdGVyYXRvciwgY29tcGxldGlvbikNCiAgfSBjYXRjaChlKXsNCiAgICB2YXIgcmV0ID0gaXRlcmF0b3JbJ3JldHVybiddOw0KICAgIGlmKHJldCAhPT0gdW5kZWZpbmVkKWFuT2JqZWN0KHJldC5jYWxsKGl0ZXJhdG9yKSk7DQogICAgdGhyb3cgZTsNCiAgfQ0KfTsNCn0seyIuL19hbi1vYmplY3QiOjd9XSw1MjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQondXNlIHN0cmljdCc7DQp2YXIgY3JlYXRlICAgICAgICAgPSByZXF1aXJlKCcuL19vYmplY3QtY3JlYXRlJykNCiAgLCBkZXNjcmlwdG9yICAgICA9IHJlcXVpcmUoJy4vX3Byb3BlcnR5LWRlc2MnKQ0KICAsIHNldFRvU3RyaW5nVGFnID0gcmVxdWlyZSgnLi9fc2V0LXRvLXN0cmluZy10YWcnKQ0KICAsIEl0ZXJhdG9yUHJvdG90eXBlID0ge307DQoNCi8vIDI1LjEuMi4xLjEgJUl0ZXJhdG9yUHJvdG90eXBlJVtAQGl0ZXJhdG9yXSgpDQpyZXF1aXJlKCcuL19oaWRlJykoSXRlcmF0b3JQcm90b3R5cGUsIHJlcXVpcmUoJy4vX3drcycpKCdpdGVyYXRvcicpLCBmdW5jdGlvbigpeyByZXR1cm4gdGhpczsgfSk7DQoNCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oQ29uc3RydWN0b3IsIE5BTUUsIG5leHQpew0KICBDb25zdHJ1Y3Rvci5wcm90b3R5cGUgPSBjcmVhdGUoSXRlcmF0b3JQcm90b3R5cGUsIHtuZXh0OiBkZXNjcmlwdG9yKDEsIG5leHQpfSk7DQogIHNldFRvU3RyaW5nVGFnKENvbnN0cnVjdG9yLCBOQU1FICsgJyBJdGVyYXRvcicpOw0KfTsNCn0seyIuL19oaWRlIjo0MCwiLi9fb2JqZWN0LWNyZWF0ZSI6NjYsIi4vX3Byb3BlcnR5LWRlc2MiOjg1LCIuL19zZXQtdG8tc3RyaW5nLXRhZyI6OTIsIi4vX3drcyI6MTE3fV0sNTM6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KJ3VzZSBzdHJpY3QnOw0KdmFyIExJQlJBUlkgICAgICAgID0gcmVxdWlyZSgnLi9fbGlicmFyeScpDQogICwgJGV4cG9ydCAgICAgICAgPSByZXF1aXJlKCcuL19leHBvcnQnKQ0KICAsIHJlZGVmaW5lICAgICAgID0gcmVxdWlyZSgnLi9fcmVkZWZpbmUnKQ0KICAsIGhpZGUgICAgICAgICAgID0gcmVxdWlyZSgnLi9faGlkZScpDQogICwgaGFzICAgICAgICAgICAgPSByZXF1aXJlKCcuL19oYXMnKQ0KICAsIEl0ZXJhdG9ycyAgICAgID0gcmVxdWlyZSgnLi9faXRlcmF0b3JzJykNCiAgLCAkaXRlckNyZWF0ZSAgICA9IHJlcXVpcmUoJy4vX2l0ZXItY3JlYXRlJykNCiAgLCBzZXRUb1N0cmluZ1RhZyA9IHJlcXVpcmUoJy4vX3NldC10by1zdHJpbmctdGFnJykNCiAgLCBnZXRQcm90b3R5cGVPZiA9IHJlcXVpcmUoJy4vX29iamVjdC1ncG8nKQ0KICAsIElURVJBVE9SICAgICAgID0gcmVxdWlyZSgnLi9fd2tzJykoJ2l0ZXJhdG9yJykNCiAgLCBCVUdHWSAgICAgICAgICA9ICEoW10ua2V5cyAmJiAnbmV4dCcgaW4gW10ua2V5cygpKSAvLyBTYWZhcmkgaGFzIGJ1Z2d5IGl0ZXJhdG9ycyB3L28gYG5leHRgDQogICwgRkZfSVRFUkFUT1IgICAgPSAnQEBpdGVyYXRvcicNCiAgLCBLRVlTICAgICAgICAgICA9ICdrZXlzJw0KICAsIFZBTFVFUyAgICAgICAgID0gJ3ZhbHVlcyc7DQoNCnZhciByZXR1cm5UaGlzID0gZnVuY3Rpb24oKXsgcmV0dXJuIHRoaXM7IH07DQoNCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oQmFzZSwgTkFNRSwgQ29uc3RydWN0b3IsIG5leHQsIERFRkFVTFQsIElTX1NFVCwgRk9SQ0VEKXsNCiAgJGl0ZXJDcmVhdGUoQ29uc3RydWN0b3IsIE5BTUUsIG5leHQpOw0KICB2YXIgZ2V0TWV0aG9kID0gZnVuY3Rpb24oa2luZCl7DQogICAgaWYoIUJVR0dZICYmIGtpbmQgaW4gcHJvdG8pcmV0dXJuIHByb3RvW2tpbmRdOw0KICAgIHN3aXRjaChraW5kKXsNCiAgICAgIGNhc2UgS0VZUzogcmV0dXJuIGZ1bmN0aW9uIGtleXMoKXsgcmV0dXJuIG5ldyBDb25zdHJ1Y3Rvcih0aGlzLCBraW5kKTsgfTsNCiAgICAgIGNhc2UgVkFMVUVTOiByZXR1cm4gZnVuY3Rpb24gdmFsdWVzKCl7IHJldHVybiBuZXcgQ29uc3RydWN0b3IodGhpcywga2luZCk7IH07DQogICAgfSByZXR1cm4gZnVuY3Rpb24gZW50cmllcygpeyByZXR1cm4gbmV3IENvbnN0cnVjdG9yKHRoaXMsIGtpbmQpOyB9Ow0KICB9Ow0KICB2YXIgVEFHICAgICAgICA9IE5BTUUgKyAnIEl0ZXJhdG9yJw0KICAgICwgREVGX1ZBTFVFUyA9IERFRkFVTFQgPT0gVkFMVUVTDQogICAgLCBWQUxVRVNfQlVHID0gZmFsc2UNCiAgICAsIHByb3RvICAgICAgPSBCYXNlLnByb3RvdHlwZQ0KICAgICwgJG5hdGl2ZSAgICA9IHByb3RvW0lURVJBVE9SXSB8fCBwcm90b1tGRl9JVEVSQVRPUl0gfHwgREVGQVVMVCAmJiBwcm90b1tERUZBVUxUXQ0KICAgICwgJGRlZmF1bHQgICA9ICRuYXRpdmUgfHwgZ2V0TWV0aG9kKERFRkFVTFQpDQogICAgLCAkZW50cmllcyAgID0gREVGQVVMVCA/ICFERUZfVkFMVUVTID8gJGRlZmF1bHQgOiBnZXRNZXRob2QoJ2VudHJpZXMnKSA6IHVuZGVmaW5lZA0KICAgICwgJGFueU5hdGl2ZSA9IE5BTUUgPT0gJ0FycmF5JyA/IHByb3RvLmVudHJpZXMgfHwgJG5hdGl2ZSA6ICRuYXRpdmUNCiAgICAsIG1ldGhvZHMsIGtleSwgSXRlcmF0b3JQcm90b3R5cGU7DQogIC8vIEZpeCBuYXRpdmUNCiAgaWYoJGFueU5hdGl2ZSl7DQogICAgSXRlcmF0b3JQcm90b3R5cGUgPSBnZXRQcm90b3R5cGVPZigkYW55TmF0aXZlLmNhbGwobmV3IEJhc2UpKTsNCiAgICBpZihJdGVyYXRvclByb3RvdHlwZSAhPT0gT2JqZWN0LnByb3RvdHlwZSl7DQogICAgICAvLyBTZXQgQEB0b1N0cmluZ1RhZyB0byBuYXRpdmUgaXRlcmF0b3JzDQogICAgICBzZXRUb1N0cmluZ1RhZyhJdGVyYXRvclByb3RvdHlwZSwgVEFHLCB0cnVlKTsNCiAgICAgIC8vIGZpeCBmb3Igc29tZSBvbGQgZW5naW5lcw0KICAgICAgaWYoIUxJQlJBUlkgJiYgIWhhcyhJdGVyYXRvclByb3RvdHlwZSwgSVRFUkFUT1IpKWhpZGUoSXRlcmF0b3JQcm90b3R5cGUsIElURVJBVE9SLCByZXR1cm5UaGlzKTsNCiAgICB9DQogIH0NCiAgLy8gZml4IEFycmF5I3t2YWx1ZXMsIEBAaXRlcmF0b3J9Lm5hbWUgaW4gVjggLyBGRg0KICBpZihERUZfVkFMVUVTICYmICRuYXRpdmUgJiYgJG5hdGl2ZS5uYW1lICE9PSBWQUxVRVMpew0KICAgIFZBTFVFU19CVUcgPSB0cnVlOw0KICAgICRkZWZhdWx0ID0gZnVuY3Rpb24gdmFsdWVzKCl7IHJldHVybiAkbmF0aXZlLmNhbGwodGhpcyk7IH07DQogIH0NCiAgLy8gRGVmaW5lIGl0ZXJhdG9yDQogIGlmKCghTElCUkFSWSB8fCBGT1JDRUQpICYmIChCVUdHWSB8fCBWQUxVRVNfQlVHIHx8ICFwcm90b1tJVEVSQVRPUl0pKXsNCiAgICBoaWRlKHByb3RvLCBJVEVSQVRPUiwgJGRlZmF1bHQpOw0KICB9DQogIC8vIFBsdWcgZm9yIGxpYnJhcnkNCiAgSXRlcmF0b3JzW05BTUVdID0gJGRlZmF1bHQ7DQogIEl0ZXJhdG9yc1tUQUddICA9IHJldHVyblRoaXM7DQogIGlmKERFRkFVTFQpew0KICAgIG1ldGhvZHMgPSB7DQogICAgICB2YWx1ZXM6ICBERUZfVkFMVUVTID8gJGRlZmF1bHQgOiBnZXRNZXRob2QoVkFMVUVTKSwNCiAgICAgIGtleXM6ICAgIElTX1NFVCAgICAgPyAkZGVmYXVsdCA6IGdldE1ldGhvZChLRVlTKSwNCiAgICAgIGVudHJpZXM6ICRlbnRyaWVzDQogICAgfTsNCiAgICBpZihGT1JDRUQpZm9yKGtleSBpbiBtZXRob2RzKXsNCiAgICAgIGlmKCEoa2V5IGluIHByb3RvKSlyZWRlZmluZShwcm90bywga2V5LCBtZXRob2RzW2tleV0pOw0KICAgIH0gZWxzZSAkZXhwb3J0KCRleHBvcnQuUCArICRleHBvcnQuRiAqIChCVUdHWSB8fCBWQUxVRVNfQlVHKSwgTkFNRSwgbWV0aG9kcyk7DQogIH0NCiAgcmV0dXJuIG1ldGhvZHM7DQp9Ow0KfSx7Ii4vX2V4cG9ydCI6MzIsIi4vX2hhcyI6MzksIi4vX2hpZGUiOjQwLCIuL19pdGVyLWNyZWF0ZSI6NTIsIi4vX2l0ZXJhdG9ycyI6NTYsIi4vX2xpYnJhcnkiOjU4LCIuL19vYmplY3QtZ3BvIjo3NCwiLi9fcmVkZWZpbmUiOjg3LCIuL19zZXQtdG8tc3RyaW5nLXRhZyI6OTIsIi4vX3drcyI6MTE3fV0sNTQ6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KdmFyIElURVJBVE9SICAgICA9IHJlcXVpcmUoJy4vX3drcycpKCdpdGVyYXRvcicpDQogICwgU0FGRV9DTE9TSU5HID0gZmFsc2U7DQoNCnRyeSB7DQogIHZhciByaXRlciA9IFs3XVtJVEVSQVRPUl0oKTsNCiAgcml0ZXJbJ3JldHVybiddID0gZnVuY3Rpb24oKXsgU0FGRV9DTE9TSU5HID0gdHJ1ZTsgfTsNCiAgQXJyYXkuZnJvbShyaXRlciwgZnVuY3Rpb24oKXsgdGhyb3cgMjsgfSk7DQp9IGNhdGNoKGUpeyAvKiBlbXB0eSAqLyB9DQoNCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oZXhlYywgc2tpcENsb3Npbmcpew0KICBpZighc2tpcENsb3NpbmcgJiYgIVNBRkVfQ0xPU0lORylyZXR1cm4gZmFsc2U7DQogIHZhciBzYWZlID0gZmFsc2U7DQogIHRyeSB7DQogICAgdmFyIGFyciAgPSBbN10NCiAgICAgICwgaXRlciA9IGFycltJVEVSQVRPUl0oKTsNCiAgICBpdGVyLm5leHQgPSBmdW5jdGlvbigpeyByZXR1cm4ge2RvbmU6IHNhZmUgPSB0cnVlfTsgfTsNCiAgICBhcnJbSVRFUkFUT1JdID0gZnVuY3Rpb24oKXsgcmV0dXJuIGl0ZXI7IH07DQogICAgZXhlYyhhcnIpOw0KICB9IGNhdGNoKGUpeyAvKiBlbXB0eSAqLyB9DQogIHJldHVybiBzYWZlOw0KfTsNCn0seyIuL193a3MiOjExN31dLDU1OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oZG9uZSwgdmFsdWUpew0KICByZXR1cm4ge3ZhbHVlOiB2YWx1ZSwgZG9uZTogISFkb25lfTsNCn07DQp9LHt9XSw1NjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQptb2R1bGUuZXhwb3J0cyA9IHt9Ow0KfSx7fV0sNTc6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KdmFyIGdldEtleXMgICA9IHJlcXVpcmUoJy4vX29iamVjdC1rZXlzJykNCiAgLCB0b0lPYmplY3QgPSByZXF1aXJlKCcuL190by1pb2JqZWN0Jyk7DQptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKG9iamVjdCwgZWwpew0KICB2YXIgTyAgICAgID0gdG9JT2JqZWN0KG9iamVjdCkNCiAgICAsIGtleXMgICA9IGdldEtleXMoTykNCiAgICAsIGxlbmd0aCA9IGtleXMubGVuZ3RoDQogICAgLCBpbmRleCAgPSAwDQogICAgLCBrZXk7DQogIHdoaWxlKGxlbmd0aCA+IGluZGV4KWlmKE9ba2V5ID0ga2V5c1tpbmRleCsrXV0gPT09IGVsKXJldHVybiBrZXk7DQp9Ow0KfSx7Ii4vX29iamVjdC1rZXlzIjo3NiwiLi9fdG8taW9iamVjdCI6MTA3fV0sNTg6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KbW9kdWxlLmV4cG9ydHMgPSBmYWxzZTsNCn0se31dLDU5OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCi8vIDIwLjIuMi4xNCBNYXRoLmV4cG0xKHgpDQp2YXIgJGV4cG0xID0gTWF0aC5leHBtMTsNCm1vZHVsZS5leHBvcnRzID0gKCEkZXhwbTENCiAgLy8gT2xkIEZGIGJ1Zw0KICB8fCAkZXhwbTEoMTApID4gMjIwMjUuNDY1Nzk0ODA2NzE5IHx8ICRleHBtMSgxMCkgPCAyMjAyNS40NjU3OTQ4MDY3MTY1MTY4DQogIC8vIFRvciBCcm93c2VyIGJ1Zw0KICB8fCAkZXhwbTEoLTJlLTE3KSAhPSAtMmUtMTcNCikgPyBmdW5jdGlvbiBleHBtMSh4KXsNCiAgcmV0dXJuICh4ID0gK3gpID09IDAgPyB4IDogeCA+IC0xZS02ICYmIHggPCAxZS02ID8geCArIHggKiB4IC8gMiA6IE1hdGguZXhwKHgpIC0gMTsNCn0gOiAkZXhwbTE7DQp9LHt9XSw2MDpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQovLyAyMC4yLjIuMjAgTWF0aC5sb2cxcCh4KQ0KbW9kdWxlLmV4cG9ydHMgPSBNYXRoLmxvZzFwIHx8IGZ1bmN0aW9uIGxvZzFwKHgpew0KICByZXR1cm4gKHggPSAreCkgPiAtMWUtOCAmJiB4IDwgMWUtOCA/IHggLSB4ICogeCAvIDIgOiBNYXRoLmxvZygxICsgeCk7DQp9Ow0KfSx7fV0sNjE6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KLy8gMjAuMi4yLjI4IE1hdGguc2lnbih4KQ0KbW9kdWxlLmV4cG9ydHMgPSBNYXRoLnNpZ24gfHwgZnVuY3Rpb24gc2lnbih4KXsNCiAgcmV0dXJuICh4ID0gK3gpID09IDAgfHwgeCAhPSB4ID8geCA6IHggPCAwID8gLTEgOiAxOw0KfTsNCn0se31dLDYyOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCnZhciBNRVRBICAgICA9IHJlcXVpcmUoJy4vX3VpZCcpKCdtZXRhJykNCiAgLCBpc09iamVjdCA9IHJlcXVpcmUoJy4vX2lzLW9iamVjdCcpDQogICwgaGFzICAgICAgPSByZXF1aXJlKCcuL19oYXMnKQ0KICAsIHNldERlc2MgID0gcmVxdWlyZSgnLi9fb2JqZWN0LWRwJykuZg0KICAsIGlkICAgICAgID0gMDsNCnZhciBpc0V4dGVuc2libGUgPSBPYmplY3QuaXNFeHRlbnNpYmxlIHx8IGZ1bmN0aW9uKCl7DQogIHJldHVybiB0cnVlOw0KfTsNCnZhciBGUkVFWkUgPSAhcmVxdWlyZSgnLi9fZmFpbHMnKShmdW5jdGlvbigpew0KICByZXR1cm4gaXNFeHRlbnNpYmxlKE9iamVjdC5wcmV2ZW50RXh0ZW5zaW9ucyh7fSkpOw0KfSk7DQp2YXIgc2V0TWV0YSA9IGZ1bmN0aW9uKGl0KXsNCiAgc2V0RGVzYyhpdCwgTUVUQSwge3ZhbHVlOiB7DQogICAgaTogJ08nICsgKytpZCwgLy8gb2JqZWN0IElEDQogICAgdzoge30gICAgICAgICAgLy8gd2VhayBjb2xsZWN0aW9ucyBJRHMNCiAgfX0pOw0KfTsNCnZhciBmYXN0S2V5ID0gZnVuY3Rpb24oaXQsIGNyZWF0ZSl7DQogIC8vIHJldHVybiBwcmltaXRpdmUgd2l0aCBwcmVmaXgNCiAgaWYoIWlzT2JqZWN0KGl0KSlyZXR1cm4gdHlwZW9mIGl0ID09ICdzeW1ib2wnID8gaXQgOiAodHlwZW9mIGl0ID09ICdzdHJpbmcnID8gJ1MnIDogJ1AnKSArIGl0Ow0KICBpZighaGFzKGl0LCBNRVRBKSl7DQogICAgLy8gY2FuJ3Qgc2V0IG1ldGFkYXRhIHRvIHVuY2F1Z2h0IGZyb3plbiBvYmplY3QNCiAgICBpZighaXNFeHRlbnNpYmxlKGl0KSlyZXR1cm4gJ0YnOw0KICAgIC8vIG5vdCBuZWNlc3NhcnkgdG8gYWRkIG1ldGFkYXRhDQogICAgaWYoIWNyZWF0ZSlyZXR1cm4gJ0UnOw0KICAgIC8vIGFkZCBtaXNzaW5nIG1ldGFkYXRhDQogICAgc2V0TWV0YShpdCk7DQogIC8vIHJldHVybiBvYmplY3QgSUQNCiAgfSByZXR1cm4gaXRbTUVUQV0uaTsNCn07DQp2YXIgZ2V0V2VhayA9IGZ1bmN0aW9uKGl0LCBjcmVhdGUpew0KICBpZighaGFzKGl0LCBNRVRBKSl7DQogICAgLy8gY2FuJ3Qgc2V0IG1ldGFkYXRhIHRvIHVuY2F1Z2h0IGZyb3plbiBvYmplY3QNCiAgICBpZighaXNFeHRlbnNpYmxlKGl0KSlyZXR1cm4gdHJ1ZTsNCiAgICAvLyBub3QgbmVjZXNzYXJ5IHRvIGFkZCBtZXRhZGF0YQ0KICAgIGlmKCFjcmVhdGUpcmV0dXJuIGZhbHNlOw0KICAgIC8vIGFkZCBtaXNzaW5nIG1ldGFkYXRhDQogICAgc2V0TWV0YShpdCk7DQogIC8vIHJldHVybiBoYXNoIHdlYWsgY29sbGVjdGlvbnMgSURzDQogIH0gcmV0dXJuIGl0W01FVEFdLnc7DQp9Ow0KLy8gYWRkIG1ldGFkYXRhIG9uIGZyZWV6ZS1mYW1pbHkgbWV0aG9kcyBjYWxsaW5nDQp2YXIgb25GcmVlemUgPSBmdW5jdGlvbihpdCl7DQogIGlmKEZSRUVaRSAmJiBtZXRhLk5FRUQgJiYgaXNFeHRlbnNpYmxlKGl0KSAmJiAhaGFzKGl0LCBNRVRBKSlzZXRNZXRhKGl0KTsNCiAgcmV0dXJuIGl0Ow0KfTsNCnZhciBtZXRhID0gbW9kdWxlLmV4cG9ydHMgPSB7DQogIEtFWTogICAgICBNRVRBLA0KICBORUVEOiAgICAgZmFsc2UsDQogIGZhc3RLZXk6ICBmYXN0S2V5LA0KICBnZXRXZWFrOiAgZ2V0V2VhaywNCiAgb25GcmVlemU6IG9uRnJlZXplDQp9Ow0KfSx7Ii4vX2ZhaWxzIjozNCwiLi9faGFzIjozOSwiLi9faXMtb2JqZWN0Ijo0OSwiLi9fb2JqZWN0LWRwIjo2NywiLi9fdWlkIjoxMTR9XSw2MzpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQp2YXIgTWFwICAgICA9IHJlcXVpcmUoJy4vZXM2Lm1hcCcpDQogICwgJGV4cG9ydCA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpDQogICwgc2hhcmVkICA9IHJlcXVpcmUoJy4vX3NoYXJlZCcpKCdtZXRhZGF0YScpDQogICwgc3RvcmUgICA9IHNoYXJlZC5zdG9yZSB8fCAoc2hhcmVkLnN0b3JlID0gbmV3IChyZXF1aXJlKCcuL2VzNi53ZWFrLW1hcCcpKSk7DQoNCnZhciBnZXRPckNyZWF0ZU1ldGFkYXRhTWFwID0gZnVuY3Rpb24odGFyZ2V0LCB0YXJnZXRLZXksIGNyZWF0ZSl7DQogIHZhciB0YXJnZXRNZXRhZGF0YSA9IHN0b3JlLmdldCh0YXJnZXQpOw0KICBpZighdGFyZ2V0TWV0YWRhdGEpew0KICAgIGlmKCFjcmVhdGUpcmV0dXJuIHVuZGVmaW5lZDsNCiAgICBzdG9yZS5zZXQodGFyZ2V0LCB0YXJnZXRNZXRhZGF0YSA9IG5ldyBNYXApOw0KICB9DQogIHZhciBrZXlNZXRhZGF0YSA9IHRhcmdldE1ldGFkYXRhLmdldCh0YXJnZXRLZXkpOw0KICBpZigha2V5TWV0YWRhdGEpew0KICAgIGlmKCFjcmVhdGUpcmV0dXJuIHVuZGVmaW5lZDsNCiAgICB0YXJnZXRNZXRhZGF0YS5zZXQodGFyZ2V0S2V5LCBrZXlNZXRhZGF0YSA9IG5ldyBNYXApOw0KICB9IHJldHVybiBrZXlNZXRhZGF0YTsNCn07DQp2YXIgb3JkaW5hcnlIYXNPd25NZXRhZGF0YSA9IGZ1bmN0aW9uKE1ldGFkYXRhS2V5LCBPLCBQKXsNCiAgdmFyIG1ldGFkYXRhTWFwID0gZ2V0T3JDcmVhdGVNZXRhZGF0YU1hcChPLCBQLCBmYWxzZSk7DQogIHJldHVybiBtZXRhZGF0YU1hcCA9PT0gdW5kZWZpbmVkID8gZmFsc2UgOiBtZXRhZGF0YU1hcC5oYXMoTWV0YWRhdGFLZXkpOw0KfTsNCnZhciBvcmRpbmFyeUdldE93bk1ldGFkYXRhID0gZnVuY3Rpb24oTWV0YWRhdGFLZXksIE8sIFApew0KICB2YXIgbWV0YWRhdGFNYXAgPSBnZXRPckNyZWF0ZU1ldGFkYXRhTWFwKE8sIFAsIGZhbHNlKTsNCiAgcmV0dXJuIG1ldGFkYXRhTWFwID09PSB1bmRlZmluZWQgPyB1bmRlZmluZWQgOiBtZXRhZGF0YU1hcC5nZXQoTWV0YWRhdGFLZXkpOw0KfTsNCnZhciBvcmRpbmFyeURlZmluZU93bk1ldGFkYXRhID0gZnVuY3Rpb24oTWV0YWRhdGFLZXksIE1ldGFkYXRhVmFsdWUsIE8sIFApew0KICBnZXRPckNyZWF0ZU1ldGFkYXRhTWFwKE8sIFAsIHRydWUpLnNldChNZXRhZGF0YUtleSwgTWV0YWRhdGFWYWx1ZSk7DQp9Ow0KdmFyIG9yZGluYXJ5T3duTWV0YWRhdGFLZXlzID0gZnVuY3Rpb24odGFyZ2V0LCB0YXJnZXRLZXkpew0KICB2YXIgbWV0YWRhdGFNYXAgPSBnZXRPckNyZWF0ZU1ldGFkYXRhTWFwKHRhcmdldCwgdGFyZ2V0S2V5LCBmYWxzZSkNCiAgICAsIGtleXMgICAgICAgID0gW107DQogIGlmKG1ldGFkYXRhTWFwKW1ldGFkYXRhTWFwLmZvckVhY2goZnVuY3Rpb24oXywga2V5KXsga2V5cy5wdXNoKGtleSk7IH0pOw0KICByZXR1cm4ga2V5czsNCn07DQp2YXIgdG9NZXRhS2V5ID0gZnVuY3Rpb24oaXQpew0KICByZXR1cm4gaXQgPT09IHVuZGVmaW5lZCB8fCB0eXBlb2YgaXQgPT0gJ3N5bWJvbCcgPyBpdCA6IFN0cmluZyhpdCk7DQp9Ow0KdmFyIGV4cCA9IGZ1bmN0aW9uKE8pew0KICAkZXhwb3J0KCRleHBvcnQuUywgJ1JlZmxlY3QnLCBPKTsNCn07DQoNCm1vZHVsZS5leHBvcnRzID0gew0KICBzdG9yZTogc3RvcmUsDQogIG1hcDogZ2V0T3JDcmVhdGVNZXRhZGF0YU1hcCwNCiAgaGFzOiBvcmRpbmFyeUhhc093bk1ldGFkYXRhLA0KICBnZXQ6IG9yZGluYXJ5R2V0T3duTWV0YWRhdGEsDQogIHNldDogb3JkaW5hcnlEZWZpbmVPd25NZXRhZGF0YSwNCiAga2V5czogb3JkaW5hcnlPd25NZXRhZGF0YUtleXMsDQogIGtleTogdG9NZXRhS2V5LA0KICBleHA6IGV4cA0KfTsNCn0seyIuL19leHBvcnQiOjMyLCIuL19zaGFyZWQiOjk0LCIuL2VzNi5tYXAiOjE1MCwiLi9lczYud2Vhay1tYXAiOjI1Nn1dLDY0OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCnZhciBnbG9iYWwgICAgPSByZXF1aXJlKCcuL19nbG9iYWwnKQ0KICAsIG1hY3JvdGFzayA9IHJlcXVpcmUoJy4vX3Rhc2snKS5zZXQNCiAgLCBPYnNlcnZlciAgPSBnbG9iYWwuTXV0YXRpb25PYnNlcnZlciB8fCBnbG9iYWwuV2ViS2l0TXV0YXRpb25PYnNlcnZlcg0KICAsIHByb2Nlc3MgICA9IGdsb2JhbC5wcm9jZXNzDQogICwgUHJvbWlzZSAgID0gZ2xvYmFsLlByb21pc2UNCiAgLCBpc05vZGUgICAgPSByZXF1aXJlKCcuL19jb2YnKShwcm9jZXNzKSA9PSAncHJvY2Vzcyc7DQoNCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oKXsNCiAgdmFyIGhlYWQsIGxhc3QsIG5vdGlmeTsNCg0KICB2YXIgZmx1c2ggPSBmdW5jdGlvbigpew0KICAgIHZhciBwYXJlbnQsIGZuOw0KICAgIGlmKGlzTm9kZSAmJiAocGFyZW50ID0gcHJvY2Vzcy5kb21haW4pKXBhcmVudC5leGl0KCk7DQogICAgd2hpbGUoaGVhZCl7DQogICAgICBmbiAgID0gaGVhZC5mbjsNCiAgICAgIGhlYWQgPSBoZWFkLm5leHQ7DQogICAgICB0cnkgew0KICAgICAgICBmbigpOw0KICAgICAgfSBjYXRjaChlKXsNCiAgICAgICAgaWYoaGVhZClub3RpZnkoKTsNCiAgICAgICAgZWxzZSBsYXN0ID0gdW5kZWZpbmVkOw0KICAgICAgICB0aHJvdyBlOw0KICAgICAgfQ0KICAgIH0gbGFzdCA9IHVuZGVmaW5lZDsNCiAgICBpZihwYXJlbnQpcGFyZW50LmVudGVyKCk7DQogIH07DQoNCiAgLy8gTm9kZS5qcw0KICBpZihpc05vZGUpew0KICAgIG5vdGlmeSA9IGZ1bmN0aW9uKCl7DQogICAgICBwcm9jZXNzLm5leHRUaWNrKGZsdXNoKTsNCiAgICB9Ow0KICAvLyBicm93c2VycyB3aXRoIE11dGF0aW9uT2JzZXJ2ZXINCiAgfSBlbHNlIGlmKE9ic2VydmVyKXsNCiAgICB2YXIgdG9nZ2xlID0gdHJ1ZQ0KICAgICAgLCBub2RlICAgPSBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSgnJyk7DQogICAgbmV3IE9ic2VydmVyKGZsdXNoKS5vYnNlcnZlKG5vZGUsIHtjaGFyYWN0ZXJEYXRhOiB0cnVlfSk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tbmV3DQogICAgbm90aWZ5ID0gZnVuY3Rpb24oKXsNCiAgICAgIG5vZGUuZGF0YSA9IHRvZ2dsZSA9ICF0b2dnbGU7DQogICAgfTsNCiAgLy8gZW52aXJvbm1lbnRzIHdpdGggbWF5YmUgbm9uLWNvbXBsZXRlbHkgY29ycmVjdCwgYnV0IGV4aXN0ZW50IFByb21pc2UNCiAgfSBlbHNlIGlmKFByb21pc2UgJiYgUHJvbWlzZS5yZXNvbHZlKXsNCiAgICB2YXIgcHJvbWlzZSA9IFByb21pc2UucmVzb2x2ZSgpOw0KICAgIG5vdGlmeSA9IGZ1bmN0aW9uKCl7DQogICAgICBwcm9taXNlLnRoZW4oZmx1c2gpOw0KICAgIH07DQogIC8vIGZvciBvdGhlciBlbnZpcm9ubWVudHMgLSBtYWNyb3Rhc2sgYmFzZWQgb246DQogIC8vIC0gc2V0SW1tZWRpYXRlDQogIC8vIC0gTWVzc2FnZUNoYW5uZWwNCiAgLy8gLSB3aW5kb3cucG9zdE1lc3NhZw0KICAvLyAtIG9ucmVhZHlzdGF0ZWNoYW5nZQ0KICAvLyAtIHNldFRpbWVvdXQNCiAgfSBlbHNlIHsNCiAgICBub3RpZnkgPSBmdW5jdGlvbigpew0KICAgICAgLy8gc3RyYW5nZSBJRSArIHdlYnBhY2sgZGV2IHNlcnZlciBidWcgLSB1c2UgLmNhbGwoZ2xvYmFsKQ0KICAgICAgbWFjcm90YXNrLmNhbGwoZ2xvYmFsLCBmbHVzaCk7DQogICAgfTsNCiAgfQ0KDQogIHJldHVybiBmdW5jdGlvbihmbil7DQogICAgdmFyIHRhc2sgPSB7Zm46IGZuLCBuZXh0OiB1bmRlZmluZWR9Ow0KICAgIGlmKGxhc3QpbGFzdC5uZXh0ID0gdGFzazsNCiAgICBpZighaGVhZCl7DQogICAgICBoZWFkID0gdGFzazsNCiAgICAgIG5vdGlmeSgpOw0KICAgIH0gbGFzdCA9IHRhc2s7DQogIH07DQp9Ow0KfSx7Ii4vX2NvZiI6MTgsIi4vX2dsb2JhbCI6MzgsIi4vX3Rhc2siOjEwNH1dLDY1OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCid1c2Ugc3RyaWN0JzsNCi8vIDE5LjEuMi4xIE9iamVjdC5hc3NpZ24odGFyZ2V0LCBzb3VyY2UsIC4uLikNCnZhciBnZXRLZXlzICA9IHJlcXVpcmUoJy4vX29iamVjdC1rZXlzJykNCiAgLCBnT1BTICAgICA9IHJlcXVpcmUoJy4vX29iamVjdC1nb3BzJykNCiAgLCBwSUUgICAgICA9IHJlcXVpcmUoJy4vX29iamVjdC1waWUnKQ0KICAsIHRvT2JqZWN0ID0gcmVxdWlyZSgnLi9fdG8tb2JqZWN0JykNCiAgLCBJT2JqZWN0ICA9IHJlcXVpcmUoJy4vX2lvYmplY3QnKQ0KICAsICRhc3NpZ24gID0gT2JqZWN0LmFzc2lnbjsNCg0KLy8gc2hvdWxkIHdvcmsgd2l0aCBzeW1ib2xzIGFuZCBzaG91bGQgaGF2ZSBkZXRlcm1pbmlzdGljIHByb3BlcnR5IG9yZGVyIChWOCBidWcpDQptb2R1bGUuZXhwb3J0cyA9ICEkYXNzaWduIHx8IHJlcXVpcmUoJy4vX2ZhaWxzJykoZnVuY3Rpb24oKXsNCiAgdmFyIEEgPSB7fQ0KICAgICwgQiA9IHt9DQogICAgLCBTID0gU3ltYm9sKCkNCiAgICAsIEsgPSAnYWJjZGVmZ2hpamtsbW5vcHFyc3QnOw0KICBBW1NdID0gNzsNCiAgSy5zcGxpdCgnJykuZm9yRWFjaChmdW5jdGlvbihrKXsgQltrXSA9IGs7IH0pOw0KICByZXR1cm4gJGFzc2lnbih7fSwgQSlbU10gIT0gNyB8fCBPYmplY3Qua2V5cygkYXNzaWduKHt9LCBCKSkuam9pbignJykgIT0gSzsNCn0pID8gZnVuY3Rpb24gYXNzaWduKHRhcmdldCwgc291cmNlKXsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby11bnVzZWQtdmFycw0KICB2YXIgVCAgICAgPSB0b09iamVjdCh0YXJnZXQpDQogICAgLCBhTGVuICA9IGFyZ3VtZW50cy5sZW5ndGgNCiAgICAsIGluZGV4ID0gMQ0KICAgICwgZ2V0U3ltYm9scyA9IGdPUFMuZg0KICAgICwgaXNFbnVtICAgICA9IHBJRS5mOw0KICB3aGlsZShhTGVuID4gaW5kZXgpew0KICAgIHZhciBTICAgICAgPSBJT2JqZWN0KGFyZ3VtZW50c1tpbmRleCsrXSkNCiAgICAgICwga2V5cyAgID0gZ2V0U3ltYm9scyA/IGdldEtleXMoUykuY29uY2F0KGdldFN5bWJvbHMoUykpIDogZ2V0S2V5cyhTKQ0KICAgICAgLCBsZW5ndGggPSBrZXlzLmxlbmd0aA0KICAgICAgLCBqICAgICAgPSAwDQogICAgICAsIGtleTsNCiAgICB3aGlsZShsZW5ndGggPiBqKWlmKGlzRW51bS5jYWxsKFMsIGtleSA9IGtleXNbaisrXSkpVFtrZXldID0gU1trZXldOw0KICB9IHJldHVybiBUOw0KfSA6ICRhc3NpZ247DQp9LHsiLi9fZmFpbHMiOjM0LCIuL19pb2JqZWN0Ijo0NSwiLi9fb2JqZWN0LWdvcHMiOjczLCIuL19vYmplY3Qta2V5cyI6NzYsIi4vX29iamVjdC1waWUiOjc3LCIuL190by1vYmplY3QiOjEwOX1dLDY2OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCi8vIDE5LjEuMi4yIC8gMTUuMi4zLjUgT2JqZWN0LmNyZWF0ZShPIFssIFByb3BlcnRpZXNdKQ0KdmFyIGFuT2JqZWN0ICAgID0gcmVxdWlyZSgnLi9fYW4tb2JqZWN0JykNCiAgLCBkUHMgICAgICAgICA9IHJlcXVpcmUoJy4vX29iamVjdC1kcHMnKQ0KICAsIGVudW1CdWdLZXlzID0gcmVxdWlyZSgnLi9fZW51bS1idWcta2V5cycpDQogICwgSUVfUFJPVE8gICAgPSByZXF1aXJlKCcuL19zaGFyZWQta2V5JykoJ0lFX1BST1RPJykNCiAgLCBFbXB0eSAgICAgICA9IGZ1bmN0aW9uKCl7IC8qIGVtcHR5ICovIH0NCiAgLCBQUk9UT1RZUEUgICA9ICdwcm90b3R5cGUnOw0KDQovLyBDcmVhdGUgb2JqZWN0IHdpdGggZmFrZSBgbnVsbGAgcHJvdG90eXBlOiB1c2UgaWZyYW1lIE9iamVjdCB3aXRoIGNsZWFyZWQgcHJvdG90eXBlDQp2YXIgY3JlYXRlRGljdCA9IGZ1bmN0aW9uKCl7DQogIC8vIFRocmFzaCwgd2FzdGUgYW5kIHNvZG9teTogSUUgR0MgYnVnDQogIHZhciBpZnJhbWUgPSByZXF1aXJlKCcuL19kb20tY3JlYXRlJykoJ2lmcmFtZScpDQogICAgLCBpICAgICAgPSBlbnVtQnVnS2V5cy5sZW5ndGgNCiAgICAsIGd0ICAgICA9ICc+Jw0KICAgICwgaWZyYW1lRG9jdW1lbnQ7DQogIGlmcmFtZS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICByZXF1aXJlKCcuL19odG1sJykuYXBwZW5kQ2hpbGQoaWZyYW1lKTsNCiAgaWZyYW1lLnNyYyA9ICdqYXZhc2NyaXB0Oic7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tc2NyaXB0LXVybA0KICAvLyBjcmVhdGVEaWN0ID0gaWZyYW1lLmNvbnRlbnRXaW5kb3cuT2JqZWN0Ow0KICAvLyBodG1sLnJlbW92ZUNoaWxkKGlmcmFtZSk7DQogIGlmcmFtZURvY3VtZW50ID0gaWZyYW1lLmNvbnRlbnRXaW5kb3cuZG9jdW1lbnQ7DQogIGlmcmFtZURvY3VtZW50Lm9wZW4oKTsNCiAgaWZyYW1lRG9jdW1lbnQud3JpdGUoJzxzY3JpcHQ+ZG9jdW1lbnQuRj1PYmplY3Q8L3NjcmlwdCcgKyBndCk7DQogIGlmcmFtZURvY3VtZW50LmNsb3NlKCk7DQogIGNyZWF0ZURpY3QgPSBpZnJhbWVEb2N1bWVudC5GOw0KICB3aGlsZShpLS0pZGVsZXRlIGNyZWF0ZURpY3RbUFJPVE9UWVBFXVtlbnVtQnVnS2V5c1tpXV07DQogIHJldHVybiBjcmVhdGVEaWN0KCk7DQp9Ow0KDQptb2R1bGUuZXhwb3J0cyA9IE9iamVjdC5jcmVhdGUgfHwgZnVuY3Rpb24gY3JlYXRlKE8sIFByb3BlcnRpZXMpew0KICB2YXIgcmVzdWx0Ow0KICBpZihPICE9PSBudWxsKXsNCiAgICBFbXB0eVtQUk9UT1RZUEVdID0gYW5PYmplY3QoTyk7DQogICAgcmVzdWx0ID0gbmV3IEVtcHR5Ow0KICAgIEVtcHR5W1BST1RPVFlQRV0gPSBudWxsOw0KICAgIC8vIGFkZCAiX19wcm90b19fIiBmb3IgT2JqZWN0LmdldFByb3RvdHlwZU9mIHBvbHlmaWxsDQogICAgcmVzdWx0W0lFX1BST1RPXSA9IE87DQogIH0gZWxzZSByZXN1bHQgPSBjcmVhdGVEaWN0KCk7DQogIHJldHVybiBQcm9wZXJ0aWVzID09PSB1bmRlZmluZWQgPyByZXN1bHQgOiBkUHMocmVzdWx0LCBQcm9wZXJ0aWVzKTsNCn07DQp9LHsiLi9fYW4tb2JqZWN0Ijo3LCIuL19kb20tY3JlYXRlIjoyOSwiLi9fZW51bS1idWcta2V5cyI6MzAsIi4vX2h0bWwiOjQxLCIuL19vYmplY3QtZHBzIjo2OCwiLi9fc2hhcmVkLWtleSI6OTN9XSw2NzpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQp2YXIgYW5PYmplY3QgICAgICAgPSByZXF1aXJlKCcuL19hbi1vYmplY3QnKQ0KICAsIElFOF9ET01fREVGSU5FID0gcmVxdWlyZSgnLi9faWU4LWRvbS1kZWZpbmUnKQ0KICAsIHRvUHJpbWl0aXZlICAgID0gcmVxdWlyZSgnLi9fdG8tcHJpbWl0aXZlJykNCiAgLCBkUCAgICAgICAgICAgICA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eTsNCg0KZXhwb3J0cy5mID0gcmVxdWlyZSgnLi9fZGVzY3JpcHRvcnMnKSA/IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSA6IGZ1bmN0aW9uIGRlZmluZVByb3BlcnR5KE8sIFAsIEF0dHJpYnV0ZXMpew0KICBhbk9iamVjdChPKTsNCiAgUCA9IHRvUHJpbWl0aXZlKFAsIHRydWUpOw0KICBhbk9iamVjdChBdHRyaWJ1dGVzKTsNCiAgaWYoSUU4X0RPTV9ERUZJTkUpdHJ5IHsNCiAgICByZXR1cm4gZFAoTywgUCwgQXR0cmlidXRlcyk7DQogIH0gY2F0Y2goZSl7IC8qIGVtcHR5ICovIH0NCiAgaWYoJ2dldCcgaW4gQXR0cmlidXRlcyB8fCAnc2V0JyBpbiBBdHRyaWJ1dGVzKXRocm93IFR5cGVFcnJvcignQWNjZXNzb3JzIG5vdCBzdXBwb3J0ZWQhJyk7DQogIGlmKCd2YWx1ZScgaW4gQXR0cmlidXRlcylPW1BdID0gQXR0cmlidXRlcy52YWx1ZTsNCiAgcmV0dXJuIE87DQp9Ow0KfSx7Ii4vX2FuLW9iamVjdCI6NywiLi9fZGVzY3JpcHRvcnMiOjI4LCIuL19pZTgtZG9tLWRlZmluZSI6NDIsIi4vX3RvLXByaW1pdGl2ZSI6MTEwfV0sNjg6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KdmFyIGRQICAgICAgID0gcmVxdWlyZSgnLi9fb2JqZWN0LWRwJykNCiAgLCBhbk9iamVjdCA9IHJlcXVpcmUoJy4vX2FuLW9iamVjdCcpDQogICwgZ2V0S2V5cyAgPSByZXF1aXJlKCcuL19vYmplY3Qta2V5cycpOw0KDQptb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoJy4vX2Rlc2NyaXB0b3JzJykgPyBPYmplY3QuZGVmaW5lUHJvcGVydGllcyA6IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXMoTywgUHJvcGVydGllcyl7DQogIGFuT2JqZWN0KE8pOw0KICB2YXIga2V5cyAgID0gZ2V0S2V5cyhQcm9wZXJ0aWVzKQ0KICAgICwgbGVuZ3RoID0ga2V5cy5sZW5ndGgNCiAgICAsIGkgPSAwDQogICAgLCBQOw0KICB3aGlsZShsZW5ndGggPiBpKWRQLmYoTywgUCA9IGtleXNbaSsrXSwgUHJvcGVydGllc1tQXSk7DQogIHJldHVybiBPOw0KfTsNCn0seyIuL19hbi1vYmplY3QiOjcsIi4vX2Rlc2NyaXB0b3JzIjoyOCwiLi9fb2JqZWN0LWRwIjo2NywiLi9fb2JqZWN0LWtleXMiOjc2fV0sNjk6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KLy8gRm9yY2VkIHJlcGxhY2VtZW50IHByb3RvdHlwZSBhY2Nlc3NvcnMgbWV0aG9kcw0KbW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKCcuL19saWJyYXJ5Jyl8fCAhcmVxdWlyZSgnLi9fZmFpbHMnKShmdW5jdGlvbigpew0KICB2YXIgSyA9IE1hdGgucmFuZG9tKCk7DQogIC8vIEluIEZGIHRocm93cyBvbmx5IGRlZmluZSBtZXRob2RzDQogIF9fZGVmaW5lU2V0dGVyX18uY2FsbChudWxsLCBLLCBmdW5jdGlvbigpeyAvKiBlbXB0eSAqL30pOw0KICBkZWxldGUgcmVxdWlyZSgnLi9fZ2xvYmFsJylbS107DQp9KTsNCn0seyIuL19mYWlscyI6MzQsIi4vX2dsb2JhbCI6MzgsIi4vX2xpYnJhcnkiOjU4fV0sNzA6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KdmFyIHBJRSAgICAgICAgICAgID0gcmVxdWlyZSgnLi9fb2JqZWN0LXBpZScpDQogICwgY3JlYXRlRGVzYyAgICAgPSByZXF1aXJlKCcuL19wcm9wZXJ0eS1kZXNjJykNCiAgLCB0b0lPYmplY3QgICAgICA9IHJlcXVpcmUoJy4vX3RvLWlvYmplY3QnKQ0KICAsIHRvUHJpbWl0aXZlICAgID0gcmVxdWlyZSgnLi9fdG8tcHJpbWl0aXZlJykNCiAgLCBoYXMgICAgICAgICAgICA9IHJlcXVpcmUoJy4vX2hhcycpDQogICwgSUU4X0RPTV9ERUZJTkUgPSByZXF1aXJlKCcuL19pZTgtZG9tLWRlZmluZScpDQogICwgZ09QRCAgICAgICAgICAgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yOw0KDQpleHBvcnRzLmYgPSByZXF1aXJlKCcuL19kZXNjcmlwdG9ycycpID8gZ09QRCA6IGZ1bmN0aW9uIGdldE93blByb3BlcnR5RGVzY3JpcHRvcihPLCBQKXsNCiAgTyA9IHRvSU9iamVjdChPKTsNCiAgUCA9IHRvUHJpbWl0aXZlKFAsIHRydWUpOw0KICBpZihJRThfRE9NX0RFRklORSl0cnkgew0KICAgIHJldHVybiBnT1BEKE8sIFApOw0KICB9IGNhdGNoKGUpeyAvKiBlbXB0eSAqLyB9DQogIGlmKGhhcyhPLCBQKSlyZXR1cm4gY3JlYXRlRGVzYyghcElFLmYuY2FsbChPLCBQKSwgT1tQXSk7DQp9Ow0KfSx7Ii4vX2Rlc2NyaXB0b3JzIjoyOCwiLi9faGFzIjozOSwiLi9faWU4LWRvbS1kZWZpbmUiOjQyLCIuL19vYmplY3QtcGllIjo3NywiLi9fcHJvcGVydHktZGVzYyI6ODUsIi4vX3RvLWlvYmplY3QiOjEwNywiLi9fdG8tcHJpbWl0aXZlIjoxMTB9XSw3MTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQovLyBmYWxsYmFjayBmb3IgSUUxMSBidWdneSBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyB3aXRoIGlmcmFtZSBhbmQgd2luZG93DQp2YXIgdG9JT2JqZWN0ID0gcmVxdWlyZSgnLi9fdG8taW9iamVjdCcpDQogICwgZ09QTiAgICAgID0gcmVxdWlyZSgnLi9fb2JqZWN0LWdvcG4nKS5mDQogICwgdG9TdHJpbmcgID0ge30udG9TdHJpbmc7DQoNCnZhciB3aW5kb3dOYW1lcyA9IHR5cGVvZiB3aW5kb3cgPT0gJ29iamVjdCcgJiYgd2luZG93ICYmIE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzDQogID8gT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMod2luZG93KSA6IFtdOw0KDQp2YXIgZ2V0V2luZG93TmFtZXMgPSBmdW5jdGlvbihpdCl7DQogIHRyeSB7DQogICAgcmV0dXJuIGdPUE4oaXQpOw0KICB9IGNhdGNoKGUpew0KICAgIHJldHVybiB3aW5kb3dOYW1lcy5zbGljZSgpOw0KICB9DQp9Ow0KDQptb2R1bGUuZXhwb3J0cy5mID0gZnVuY3Rpb24gZ2V0T3duUHJvcGVydHlOYW1lcyhpdCl7DQogIHJldHVybiB3aW5kb3dOYW1lcyAmJiB0b1N0cmluZy5jYWxsKGl0KSA9PSAnW29iamVjdCBXaW5kb3ddJyA/IGdldFdpbmRvd05hbWVzKGl0KSA6IGdPUE4odG9JT2JqZWN0KGl0KSk7DQp9Ow0KDQp9LHsiLi9fb2JqZWN0LWdvcG4iOjcyLCIuL190by1pb2JqZWN0IjoxMDd9XSw3MjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQovLyAxOS4xLjIuNyAvIDE1LjIuMy40IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKE8pDQp2YXIgJGtleXMgICAgICA9IHJlcXVpcmUoJy4vX29iamVjdC1rZXlzLWludGVybmFsJykNCiAgLCBoaWRkZW5LZXlzID0gcmVxdWlyZSgnLi9fZW51bS1idWcta2V5cycpLmNvbmNhdCgnbGVuZ3RoJywgJ3Byb3RvdHlwZScpOw0KDQpleHBvcnRzLmYgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyB8fCBmdW5jdGlvbiBnZXRPd25Qcm9wZXJ0eU5hbWVzKE8pew0KICByZXR1cm4gJGtleXMoTywgaGlkZGVuS2V5cyk7DQp9Ow0KfSx7Ii4vX2VudW0tYnVnLWtleXMiOjMwLCIuL19vYmplY3Qta2V5cy1pbnRlcm5hbCI6NzV9XSw3MzpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQpleHBvcnRzLmYgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzOw0KfSx7fV0sNzQ6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KLy8gMTkuMS4yLjkgLyAxNS4yLjMuMiBPYmplY3QuZ2V0UHJvdG90eXBlT2YoTykNCnZhciBoYXMgICAgICAgICA9IHJlcXVpcmUoJy4vX2hhcycpDQogICwgdG9PYmplY3QgICAgPSByZXF1aXJlKCcuL190by1vYmplY3QnKQ0KICAsIElFX1BST1RPICAgID0gcmVxdWlyZSgnLi9fc2hhcmVkLWtleScpKCdJRV9QUk9UTycpDQogICwgT2JqZWN0UHJvdG8gPSBPYmplY3QucHJvdG90eXBlOw0KDQptb2R1bGUuZXhwb3J0cyA9IE9iamVjdC5nZXRQcm90b3R5cGVPZiB8fCBmdW5jdGlvbihPKXsNCiAgTyA9IHRvT2JqZWN0KE8pOw0KICBpZihoYXMoTywgSUVfUFJPVE8pKXJldHVybiBPW0lFX1BST1RPXTsNCiAgaWYodHlwZW9mIE8uY29uc3RydWN0b3IgPT0gJ2Z1bmN0aW9uJyAmJiBPIGluc3RhbmNlb2YgTy5jb25zdHJ1Y3Rvcil7DQogICAgcmV0dXJuIE8uY29uc3RydWN0b3IucHJvdG90eXBlOw0KICB9IHJldHVybiBPIGluc3RhbmNlb2YgT2JqZWN0ID8gT2JqZWN0UHJvdG8gOiBudWxsOw0KfTsNCn0seyIuL19oYXMiOjM5LCIuL19zaGFyZWQta2V5Ijo5MywiLi9fdG8tb2JqZWN0IjoxMDl9XSw3NTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQp2YXIgaGFzICAgICAgICAgID0gcmVxdWlyZSgnLi9faGFzJykNCiAgLCB0b0lPYmplY3QgICAgPSByZXF1aXJlKCcuL190by1pb2JqZWN0JykNCiAgLCBhcnJheUluZGV4T2YgPSByZXF1aXJlKCcuL19hcnJheS1pbmNsdWRlcycpKGZhbHNlKQ0KICAsIElFX1BST1RPICAgICA9IHJlcXVpcmUoJy4vX3NoYXJlZC1rZXknKSgnSUVfUFJPVE8nKTsNCg0KbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihvYmplY3QsIG5hbWVzKXsNCiAgdmFyIE8gICAgICA9IHRvSU9iamVjdChvYmplY3QpDQogICAgLCBpICAgICAgPSAwDQogICAgLCByZXN1bHQgPSBbXQ0KICAgICwga2V5Ow0KICBmb3Ioa2V5IGluIE8paWYoa2V5ICE9IElFX1BST1RPKWhhcyhPLCBrZXkpICYmIHJlc3VsdC5wdXNoKGtleSk7DQogIC8vIERvbid0IGVudW0gYnVnICYgaGlkZGVuIGtleXMNCiAgd2hpbGUobmFtZXMubGVuZ3RoID4gaSlpZihoYXMoTywga2V5ID0gbmFtZXNbaSsrXSkpew0KICAgIH5hcnJheUluZGV4T2YocmVzdWx0LCBrZXkpIHx8IHJlc3VsdC5wdXNoKGtleSk7DQogIH0NCiAgcmV0dXJuIHJlc3VsdDsNCn07DQp9LHsiLi9fYXJyYXktaW5jbHVkZXMiOjExLCIuL19oYXMiOjM5LCIuL19zaGFyZWQta2V5Ijo5MywiLi9fdG8taW9iamVjdCI6MTA3fV0sNzY6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KLy8gMTkuMS4yLjE0IC8gMTUuMi4zLjE0IE9iamVjdC5rZXlzKE8pDQp2YXIgJGtleXMgICAgICAgPSByZXF1aXJlKCcuL19vYmplY3Qta2V5cy1pbnRlcm5hbCcpDQogICwgZW51bUJ1Z0tleXMgPSByZXF1aXJlKCcuL19lbnVtLWJ1Zy1rZXlzJyk7DQoNCm1vZHVsZS5leHBvcnRzID0gT2JqZWN0LmtleXMgfHwgZnVuY3Rpb24ga2V5cyhPKXsNCiAgcmV0dXJuICRrZXlzKE8sIGVudW1CdWdLZXlzKTsNCn07DQp9LHsiLi9fZW51bS1idWcta2V5cyI6MzAsIi4vX29iamVjdC1rZXlzLWludGVybmFsIjo3NX1dLDc3OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCmV4cG9ydHMuZiA9IHt9LnByb3BlcnR5SXNFbnVtZXJhYmxlOw0KfSx7fV0sNzg6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KLy8gbW9zdCBPYmplY3QgbWV0aG9kcyBieSBFUzYgc2hvdWxkIGFjY2VwdCBwcmltaXRpdmVzDQp2YXIgJGV4cG9ydCA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpDQogICwgY29yZSAgICA9IHJlcXVpcmUoJy4vX2NvcmUnKQ0KICAsIGZhaWxzICAgPSByZXF1aXJlKCcuL19mYWlscycpOw0KbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihLRVksIGV4ZWMpew0KICB2YXIgZm4gID0gKGNvcmUuT2JqZWN0IHx8IHt9KVtLRVldIHx8IE9iamVjdFtLRVldDQogICAgLCBleHAgPSB7fTsNCiAgZXhwW0tFWV0gPSBleGVjKGZuKTsNCiAgJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYgKiBmYWlscyhmdW5jdGlvbigpeyBmbigxKTsgfSksICdPYmplY3QnLCBleHApOw0KfTsNCn0seyIuL19jb3JlIjoyMywiLi9fZXhwb3J0IjozMiwiLi9fZmFpbHMiOjM0fV0sNzk6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KdmFyIGdldEtleXMgICA9IHJlcXVpcmUoJy4vX29iamVjdC1rZXlzJykNCiAgLCB0b0lPYmplY3QgPSByZXF1aXJlKCcuL190by1pb2JqZWN0JykNCiAgLCBpc0VudW0gICAgPSByZXF1aXJlKCcuL19vYmplY3QtcGllJykuZjsNCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXNFbnRyaWVzKXsNCiAgcmV0dXJuIGZ1bmN0aW9uKGl0KXsNCiAgICB2YXIgTyAgICAgID0gdG9JT2JqZWN0KGl0KQ0KICAgICAgLCBrZXlzICAgPSBnZXRLZXlzKE8pDQogICAgICAsIGxlbmd0aCA9IGtleXMubGVuZ3RoDQogICAgICAsIGkgICAgICA9IDANCiAgICAgICwgcmVzdWx0ID0gW10NCiAgICAgICwga2V5Ow0KICAgIHdoaWxlKGxlbmd0aCA+IGkpaWYoaXNFbnVtLmNhbGwoTywga2V5ID0ga2V5c1tpKytdKSl7DQogICAgICByZXN1bHQucHVzaChpc0VudHJpZXMgPyBba2V5LCBPW2tleV1dIDogT1trZXldKTsNCiAgICB9IHJldHVybiByZXN1bHQ7DQogIH07DQp9Ow0KfSx7Ii4vX29iamVjdC1rZXlzIjo3NiwiLi9fb2JqZWN0LXBpZSI6NzcsIi4vX3RvLWlvYmplY3QiOjEwN31dLDgwOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCi8vIGFsbCBvYmplY3Qga2V5cywgaW5jbHVkZXMgbm9uLWVudW1lcmFibGUgYW5kIHN5bWJvbHMNCnZhciBnT1BOICAgICA9IHJlcXVpcmUoJy4vX29iamVjdC1nb3BuJykNCiAgLCBnT1BTICAgICA9IHJlcXVpcmUoJy4vX29iamVjdC1nb3BzJykNCiAgLCBhbk9iamVjdCA9IHJlcXVpcmUoJy4vX2FuLW9iamVjdCcpDQogICwgUmVmbGVjdCAgPSByZXF1aXJlKCcuL19nbG9iYWwnKS5SZWZsZWN0Ow0KbW9kdWxlLmV4cG9ydHMgPSBSZWZsZWN0ICYmIFJlZmxlY3Qub3duS2V5cyB8fCBmdW5jdGlvbiBvd25LZXlzKGl0KXsNCiAgdmFyIGtleXMgICAgICAgPSBnT1BOLmYoYW5PYmplY3QoaXQpKQ0KICAgICwgZ2V0U3ltYm9scyA9IGdPUFMuZjsNCiAgcmV0dXJuIGdldFN5bWJvbHMgPyBrZXlzLmNvbmNhdChnZXRTeW1ib2xzKGl0KSkgOiBrZXlzOw0KfTsNCn0seyIuL19hbi1vYmplY3QiOjcsIi4vX2dsb2JhbCI6MzgsIi4vX29iamVjdC1nb3BuIjo3MiwiLi9fb2JqZWN0LWdvcHMiOjczfV0sODE6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KdmFyICRwYXJzZUZsb2F0ID0gcmVxdWlyZSgnLi9fZ2xvYmFsJykucGFyc2VGbG9hdA0KICAsICR0cmltICAgICAgID0gcmVxdWlyZSgnLi9fc3RyaW5nLXRyaW0nKS50cmltOw0KDQptb2R1bGUuZXhwb3J0cyA9IDEgLyAkcGFyc2VGbG9hdChyZXF1aXJlKCcuL19zdHJpbmctd3MnKSArICctMCcpICE9PSAtSW5maW5pdHkgPyBmdW5jdGlvbiBwYXJzZUZsb2F0KHN0cil7DQogIHZhciBzdHJpbmcgPSAkdHJpbShTdHJpbmcoc3RyKSwgMykNCiAgICAsIHJlc3VsdCA9ICRwYXJzZUZsb2F0KHN0cmluZyk7DQogIHJldHVybiByZXN1bHQgPT09IDAgJiYgc3RyaW5nLmNoYXJBdCgwKSA9PSAnLScgPyAtMCA6IHJlc3VsdDsNCn0gOiAkcGFyc2VGbG9hdDsNCn0seyIuL19nbG9iYWwiOjM4LCIuL19zdHJpbmctdHJpbSI6MTAyLCIuL19zdHJpbmctd3MiOjEwM31dLDgyOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCnZhciAkcGFyc2VJbnQgPSByZXF1aXJlKCcuL19nbG9iYWwnKS5wYXJzZUludA0KICAsICR0cmltICAgICA9IHJlcXVpcmUoJy4vX3N0cmluZy10cmltJykudHJpbQ0KICAsIHdzICAgICAgICA9IHJlcXVpcmUoJy4vX3N0cmluZy13cycpDQogICwgaGV4ICAgICAgID0gL15bXC0rXT8wW3hYXS87DQoNCm1vZHVsZS5leHBvcnRzID0gJHBhcnNlSW50KHdzICsgJzA4JykgIT09IDggfHwgJHBhcnNlSW50KHdzICsgJzB4MTYnKSAhPT0gMjIgPyBmdW5jdGlvbiBwYXJzZUludChzdHIsIHJhZGl4KXsNCiAgdmFyIHN0cmluZyA9ICR0cmltKFN0cmluZyhzdHIpLCAzKTsNCiAgcmV0dXJuICRwYXJzZUludChzdHJpbmcsIChyYWRpeCA+Pj4gMCkgfHwgKGhleC50ZXN0KHN0cmluZykgPyAxNiA6IDEwKSk7DQp9IDogJHBhcnNlSW50Ow0KfSx7Ii4vX2dsb2JhbCI6MzgsIi4vX3N0cmluZy10cmltIjoxMDIsIi4vX3N0cmluZy13cyI6MTAzfV0sODM6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KJ3VzZSBzdHJpY3QnOw0KdmFyIHBhdGggICAgICA9IHJlcXVpcmUoJy4vX3BhdGgnKQ0KICAsIGludm9rZSAgICA9IHJlcXVpcmUoJy4vX2ludm9rZScpDQogICwgYUZ1bmN0aW9uID0gcmVxdWlyZSgnLi9fYS1mdW5jdGlvbicpOw0KbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbigvKiAuLi5wYXJncyAqLyl7DQogIHZhciBmbiAgICAgPSBhRnVuY3Rpb24odGhpcykNCiAgICAsIGxlbmd0aCA9IGFyZ3VtZW50cy5sZW5ndGgNCiAgICAsIHBhcmdzICA9IEFycmF5KGxlbmd0aCkNCiAgICAsIGkgICAgICA9IDANCiAgICAsIF8gICAgICA9IHBhdGguXw0KICAgICwgaG9sZGVyID0gZmFsc2U7DQogIHdoaWxlKGxlbmd0aCA+IGkpaWYoKHBhcmdzW2ldID0gYXJndW1lbnRzW2krK10pID09PSBfKWhvbGRlciA9IHRydWU7DQogIHJldHVybiBmdW5jdGlvbigvKiAuLi5hcmdzICovKXsNCiAgICB2YXIgdGhhdCA9IHRoaXMNCiAgICAgICwgYUxlbiA9IGFyZ3VtZW50cy5sZW5ndGgNCiAgICAgICwgaiA9IDAsIGsgPSAwLCBhcmdzOw0KICAgIGlmKCFob2xkZXIgJiYgIWFMZW4pcmV0dXJuIGludm9rZShmbiwgcGFyZ3MsIHRoYXQpOw0KICAgIGFyZ3MgPSBwYXJncy5zbGljZSgpOw0KICAgIGlmKGhvbGRlcilmb3IoO2xlbmd0aCA+IGo7IGorKylpZihhcmdzW2pdID09PSBfKWFyZ3Nbal0gPSBhcmd1bWVudHNbaysrXTsNCiAgICB3aGlsZShhTGVuID4gaylhcmdzLnB1c2goYXJndW1lbnRzW2srK10pOw0KICAgIHJldHVybiBpbnZva2UoZm4sIGFyZ3MsIHRoYXQpOw0KICB9Ow0KfTsNCn0seyIuL19hLWZ1bmN0aW9uIjozLCIuL19pbnZva2UiOjQ0LCIuL19wYXRoIjo4NH1dLDg0OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZSgnLi9fZ2xvYmFsJyk7DQp9LHsiLi9fZ2xvYmFsIjozOH1dLDg1OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oYml0bWFwLCB2YWx1ZSl7DQogIHJldHVybiB7DQogICAgZW51bWVyYWJsZSAgOiAhKGJpdG1hcCAmIDEpLA0KICAgIGNvbmZpZ3VyYWJsZTogIShiaXRtYXAgJiAyKSwNCiAgICB3cml0YWJsZSAgICA6ICEoYml0bWFwICYgNCksDQogICAgdmFsdWUgICAgICAgOiB2YWx1ZQ0KICB9Ow0KfTsNCn0se31dLDg2OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCnZhciByZWRlZmluZSA9IHJlcXVpcmUoJy4vX3JlZGVmaW5lJyk7DQptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHRhcmdldCwgc3JjLCBzYWZlKXsNCiAgZm9yKHZhciBrZXkgaW4gc3JjKXJlZGVmaW5lKHRhcmdldCwga2V5LCBzcmNba2V5XSwgc2FmZSk7DQogIHJldHVybiB0YXJnZXQ7DQp9Ow0KfSx7Ii4vX3JlZGVmaW5lIjo4N31dLDg3OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCnZhciBnbG9iYWwgICAgPSByZXF1aXJlKCcuL19nbG9iYWwnKQ0KICAsIGhpZGUgICAgICA9IHJlcXVpcmUoJy4vX2hpZGUnKQ0KICAsIGhhcyAgICAgICA9IHJlcXVpcmUoJy4vX2hhcycpDQogICwgU1JDICAgICAgID0gcmVxdWlyZSgnLi9fdWlkJykoJ3NyYycpDQogICwgVE9fU1RSSU5HID0gJ3RvU3RyaW5nJw0KICAsICR0b1N0cmluZyA9IEZ1bmN0aW9uW1RPX1NUUklOR10NCiAgLCBUUEwgICAgICAgPSAoJycgKyAkdG9TdHJpbmcpLnNwbGl0KFRPX1NUUklORyk7DQoNCnJlcXVpcmUoJy4vX2NvcmUnKS5pbnNwZWN0U291cmNlID0gZnVuY3Rpb24oaXQpew0KICByZXR1cm4gJHRvU3RyaW5nLmNhbGwoaXQpOw0KfTsNCg0KKG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oTywga2V5LCB2YWwsIHNhZmUpew0KICB2YXIgaXNGdW5jdGlvbiA9IHR5cGVvZiB2YWwgPT0gJ2Z1bmN0aW9uJzsNCiAgaWYoaXNGdW5jdGlvbiloYXModmFsLCAnbmFtZScpIHx8IGhpZGUodmFsLCAnbmFtZScsIGtleSk7DQogIGlmKE9ba2V5XSA9PT0gdmFsKXJldHVybjsNCiAgaWYoaXNGdW5jdGlvbiloYXModmFsLCBTUkMpIHx8IGhpZGUodmFsLCBTUkMsIE9ba2V5XSA/ICcnICsgT1trZXldIDogVFBMLmpvaW4oU3RyaW5nKGtleSkpKTsNCiAgaWYoTyA9PT0gZ2xvYmFsKXsNCiAgICBPW2tleV0gPSB2YWw7DQogIH0gZWxzZSB7DQogICAgaWYoIXNhZmUpew0KICAgICAgZGVsZXRlIE9ba2V5XTsNCiAgICAgIGhpZGUoTywga2V5LCB2YWwpOw0KICAgIH0gZWxzZSB7DQogICAgICBpZihPW2tleV0pT1trZXldID0gdmFsOw0KICAgICAgZWxzZSBoaWRlKE8sIGtleSwgdmFsKTsNCiAgICB9DQogIH0NCi8vIGFkZCBmYWtlIEZ1bmN0aW9uI3RvU3RyaW5nIGZvciBjb3JyZWN0IHdvcmsgd3JhcHBlZCBtZXRob2RzIC8gY29uc3RydWN0b3JzIHdpdGggbWV0aG9kcyBsaWtlIExvRGFzaCBpc05hdGl2ZQ0KfSkoRnVuY3Rpb24ucHJvdG90eXBlLCBUT19TVFJJTkcsIGZ1bmN0aW9uIHRvU3RyaW5nKCl7DQogIHJldHVybiB0eXBlb2YgdGhpcyA9PSAnZnVuY3Rpb24nICYmIHRoaXNbU1JDXSB8fCAkdG9TdHJpbmcuY2FsbCh0aGlzKTsNCn0pOw0KfSx7Ii4vX2NvcmUiOjIzLCIuL19nbG9iYWwiOjM4LCIuL19oYXMiOjM5LCIuL19oaWRlIjo0MCwiLi9fdWlkIjoxMTR9XSw4ODpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHJlZ0V4cCwgcmVwbGFjZSl7DQogIHZhciByZXBsYWNlciA9IHJlcGxhY2UgPT09IE9iamVjdChyZXBsYWNlKSA/IGZ1bmN0aW9uKHBhcnQpew0KICAgIHJldHVybiByZXBsYWNlW3BhcnRdOw0KICB9IDogcmVwbGFjZTsNCiAgcmV0dXJuIGZ1bmN0aW9uKGl0KXsNCiAgICByZXR1cm4gU3RyaW5nKGl0KS5yZXBsYWNlKHJlZ0V4cCwgcmVwbGFjZXIpOw0KICB9Ow0KfTsNCn0se31dLDg5OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCi8vIDcuMi45IFNhbWVWYWx1ZSh4LCB5KQ0KbW9kdWxlLmV4cG9ydHMgPSBPYmplY3QuaXMgfHwgZnVuY3Rpb24gaXMoeCwgeSl7DQogIHJldHVybiB4ID09PSB5ID8geCAhPT0gMCB8fCAxIC8geCA9PT0gMSAvIHkgOiB4ICE9IHggJiYgeSAhPSB5Ow0KfTsNCn0se31dLDkwOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCi8vIFdvcmtzIHdpdGggX19wcm90b19fIG9ubHkuIE9sZCB2OCBjYW4ndCB3b3JrIHdpdGggbnVsbCBwcm90byBvYmplY3RzLg0KLyogZXNsaW50LWRpc2FibGUgbm8tcHJvdG8gKi8NCnZhciBpc09iamVjdCA9IHJlcXVpcmUoJy4vX2lzLW9iamVjdCcpDQogICwgYW5PYmplY3QgPSByZXF1aXJlKCcuL19hbi1vYmplY3QnKTsNCnZhciBjaGVjayA9IGZ1bmN0aW9uKE8sIHByb3RvKXsNCiAgYW5PYmplY3QoTyk7DQogIGlmKCFpc09iamVjdChwcm90bykgJiYgcHJvdG8gIT09IG51bGwpdGhyb3cgVHlwZUVycm9yKHByb3RvICsgIjogY2FuJ3Qgc2V0IGFzIHByb3RvdHlwZSEiKTsNCn07DQptb2R1bGUuZXhwb3J0cyA9IHsNCiAgc2V0OiBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwgKCdfX3Byb3RvX18nIGluIHt9ID8gLy8gZXNsaW50LWRpc2FibGUtbGluZQ0KICAgIGZ1bmN0aW9uKHRlc3QsIGJ1Z2d5LCBzZXQpew0KICAgICAgdHJ5IHsNCiAgICAgICAgc2V0ID0gcmVxdWlyZSgnLi9fY3R4JykoRnVuY3Rpb24uY2FsbCwgcmVxdWlyZSgnLi9fb2JqZWN0LWdvcGQnKS5mKE9iamVjdC5wcm90b3R5cGUsICdfX3Byb3RvX18nKS5zZXQsIDIpOw0KICAgICAgICBzZXQodGVzdCwgW10pOw0KICAgICAgICBidWdneSA9ICEodGVzdCBpbnN0YW5jZW9mIEFycmF5KTsNCiAgICAgIH0gY2F0Y2goZSl7IGJ1Z2d5ID0gdHJ1ZTsgfQ0KICAgICAgcmV0dXJuIGZ1bmN0aW9uIHNldFByb3RvdHlwZU9mKE8sIHByb3RvKXsNCiAgICAgICAgY2hlY2soTywgcHJvdG8pOw0KICAgICAgICBpZihidWdneSlPLl9fcHJvdG9fXyA9IHByb3RvOw0KICAgICAgICBlbHNlIHNldChPLCBwcm90byk7DQogICAgICAgIHJldHVybiBPOw0KICAgICAgfTsNCiAgICB9KHt9LCBmYWxzZSkgOiB1bmRlZmluZWQpLA0KICBjaGVjazogY2hlY2sNCn07DQp9LHsiLi9fYW4tb2JqZWN0Ijo3LCIuL19jdHgiOjI1LCIuL19pcy1vYmplY3QiOjQ5LCIuL19vYmplY3QtZ29wZCI6NzB9XSw5MTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQondXNlIHN0cmljdCc7DQp2YXIgZ2xvYmFsICAgICAgPSByZXF1aXJlKCcuL19nbG9iYWwnKQ0KICAsIGRQICAgICAgICAgID0gcmVxdWlyZSgnLi9fb2JqZWN0LWRwJykNCiAgLCBERVNDUklQVE9SUyA9IHJlcXVpcmUoJy4vX2Rlc2NyaXB0b3JzJykNCiAgLCBTUEVDSUVTICAgICA9IHJlcXVpcmUoJy4vX3drcycpKCdzcGVjaWVzJyk7DQoNCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oS0VZKXsNCiAgdmFyIEMgPSBnbG9iYWxbS0VZXTsNCiAgaWYoREVTQ1JJUFRPUlMgJiYgQyAmJiAhQ1tTUEVDSUVTXSlkUC5mKEMsIFNQRUNJRVMsIHsNCiAgICBjb25maWd1cmFibGU6IHRydWUsDQogICAgZ2V0OiBmdW5jdGlvbigpeyByZXR1cm4gdGhpczsgfQ0KICB9KTsNCn07DQp9LHsiLi9fZGVzY3JpcHRvcnMiOjI4LCIuL19nbG9iYWwiOjM4LCIuL19vYmplY3QtZHAiOjY3LCIuL193a3MiOjExN31dLDkyOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCnZhciBkZWYgPSByZXF1aXJlKCcuL19vYmplY3QtZHAnKS5mDQogICwgaGFzID0gcmVxdWlyZSgnLi9faGFzJykNCiAgLCBUQUcgPSByZXF1aXJlKCcuL193a3MnKSgndG9TdHJpbmdUYWcnKTsNCg0KbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCwgdGFnLCBzdGF0KXsNCiAgaWYoaXQgJiYgIWhhcyhpdCA9IHN0YXQgPyBpdCA6IGl0LnByb3RvdHlwZSwgVEFHKSlkZWYoaXQsIFRBRywge2NvbmZpZ3VyYWJsZTogdHJ1ZSwgdmFsdWU6IHRhZ30pOw0KfTsNCn0seyIuL19oYXMiOjM5LCIuL19vYmplY3QtZHAiOjY3LCIuL193a3MiOjExN31dLDkzOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCnZhciBzaGFyZWQgPSByZXF1aXJlKCcuL19zaGFyZWQnKSgna2V5cycpDQogICwgdWlkICAgID0gcmVxdWlyZSgnLi9fdWlkJyk7DQptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGtleSl7DQogIHJldHVybiBzaGFyZWRba2V5XSB8fCAoc2hhcmVkW2tleV0gPSB1aWQoa2V5KSk7DQp9Ow0KfSx7Ii4vX3NoYXJlZCI6OTQsIi4vX3VpZCI6MTE0fV0sOTQ6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KdmFyIGdsb2JhbCA9IHJlcXVpcmUoJy4vX2dsb2JhbCcpDQogICwgU0hBUkVEID0gJ19fY29yZS1qc19zaGFyZWRfXycNCiAgLCBzdG9yZSAgPSBnbG9iYWxbU0hBUkVEXSB8fCAoZ2xvYmFsW1NIQVJFRF0gPSB7fSk7DQptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGtleSl7DQogIHJldHVybiBzdG9yZVtrZXldIHx8IChzdG9yZVtrZXldID0ge30pOw0KfTsNCn0seyIuL19nbG9iYWwiOjM4fV0sOTU6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KLy8gNy4zLjIwIFNwZWNpZXNDb25zdHJ1Y3RvcihPLCBkZWZhdWx0Q29uc3RydWN0b3IpDQp2YXIgYW5PYmplY3QgID0gcmVxdWlyZSgnLi9fYW4tb2JqZWN0JykNCiAgLCBhRnVuY3Rpb24gPSByZXF1aXJlKCcuL19hLWZ1bmN0aW9uJykNCiAgLCBTUEVDSUVTICAgPSByZXF1aXJlKCcuL193a3MnKSgnc3BlY2llcycpOw0KbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihPLCBEKXsNCiAgdmFyIEMgPSBhbk9iamVjdChPKS5jb25zdHJ1Y3RvciwgUzsNCiAgcmV0dXJuIEMgPT09IHVuZGVmaW5lZCB8fCAoUyA9IGFuT2JqZWN0KEMpW1NQRUNJRVNdKSA9PSB1bmRlZmluZWQgPyBEIDogYUZ1bmN0aW9uKFMpOw0KfTsNCn0seyIuL19hLWZ1bmN0aW9uIjozLCIuL19hbi1vYmplY3QiOjcsIi4vX3drcyI6MTE3fV0sOTY6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KdmFyIGZhaWxzID0gcmVxdWlyZSgnLi9fZmFpbHMnKTsNCg0KbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihtZXRob2QsIGFyZyl7DQogIHJldHVybiAhIW1ldGhvZCAmJiBmYWlscyhmdW5jdGlvbigpew0KICAgIGFyZyA/IG1ldGhvZC5jYWxsKG51bGwsIGZ1bmN0aW9uKCl7fSwgMSkgOiBtZXRob2QuY2FsbChudWxsKTsNCiAgfSk7DQp9Ow0KfSx7Ii4vX2ZhaWxzIjozNH1dLDk3OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCnZhciB0b0ludGVnZXIgPSByZXF1aXJlKCcuL190by1pbnRlZ2VyJykNCiAgLCBkZWZpbmVkICAgPSByZXF1aXJlKCcuL19kZWZpbmVkJyk7DQovLyB0cnVlICAtPiBTdHJpbmcjYXQNCi8vIGZhbHNlIC0+IFN0cmluZyNjb2RlUG9pbnRBdA0KbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihUT19TVFJJTkcpew0KICByZXR1cm4gZnVuY3Rpb24odGhhdCwgcG9zKXsNCiAgICB2YXIgcyA9IFN0cmluZyhkZWZpbmVkKHRoYXQpKQ0KICAgICAgLCBpID0gdG9JbnRlZ2VyKHBvcykNCiAgICAgICwgbCA9IHMubGVuZ3RoDQogICAgICAsIGEsIGI7DQogICAgaWYoaSA8IDAgfHwgaSA+PSBsKXJldHVybiBUT19TVFJJTkcgPyAnJyA6IHVuZGVmaW5lZDsNCiAgICBhID0gcy5jaGFyQ29kZUF0KGkpOw0KICAgIHJldHVybiBhIDwgMHhkODAwIHx8IGEgPiAweGRiZmYgfHwgaSArIDEgPT09IGwgfHwgKGIgPSBzLmNoYXJDb2RlQXQoaSArIDEpKSA8IDB4ZGMwMCB8fCBiID4gMHhkZmZmDQogICAgICA/IFRPX1NUUklORyA/IHMuY2hhckF0KGkpIDogYQ0KICAgICAgOiBUT19TVFJJTkcgPyBzLnNsaWNlKGksIGkgKyAyKSA6IChhIC0gMHhkODAwIDw8IDEwKSArIChiIC0gMHhkYzAwKSArIDB4MTAwMDA7DQogIH07DQp9Ow0KfSx7Ii4vX2RlZmluZWQiOjI3LCIuL190by1pbnRlZ2VyIjoxMDZ9XSw5ODpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQovLyBoZWxwZXIgZm9yIFN0cmluZyN7c3RhcnRzV2l0aCwgZW5kc1dpdGgsIGluY2x1ZGVzfQ0KdmFyIGlzUmVnRXhwID0gcmVxdWlyZSgnLi9faXMtcmVnZXhwJykNCiAgLCBkZWZpbmVkICA9IHJlcXVpcmUoJy4vX2RlZmluZWQnKTsNCg0KbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbih0aGF0LCBzZWFyY2hTdHJpbmcsIE5BTUUpew0KICBpZihpc1JlZ0V4cChzZWFyY2hTdHJpbmcpKXRocm93IFR5cGVFcnJvcignU3RyaW5nIycgKyBOQU1FICsgIiBkb2Vzbid0IGFjY2VwdCByZWdleCEiKTsNCiAgcmV0dXJuIFN0cmluZyhkZWZpbmVkKHRoYXQpKTsNCn07DQp9LHsiLi9fZGVmaW5lZCI6MjcsIi4vX2lzLXJlZ2V4cCI6NTB9XSw5OTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQp2YXIgJGV4cG9ydCA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpDQogICwgZmFpbHMgICA9IHJlcXVpcmUoJy4vX2ZhaWxzJykNCiAgLCBkZWZpbmVkID0gcmVxdWlyZSgnLi9fZGVmaW5lZCcpDQogICwgcXVvdCAgICA9IC8iL2c7DQovLyBCLjIuMy4yLjEgQ3JlYXRlSFRNTChzdHJpbmcsIHRhZywgYXR0cmlidXRlLCB2YWx1ZSkNCnZhciBjcmVhdGVIVE1MID0gZnVuY3Rpb24oc3RyaW5nLCB0YWcsIGF0dHJpYnV0ZSwgdmFsdWUpIHsNCiAgdmFyIFMgID0gU3RyaW5nKGRlZmluZWQoc3RyaW5nKSkNCiAgICAsIHAxID0gJzwnICsgdGFnOw0KICBpZihhdHRyaWJ1dGUgIT09ICcnKXAxICs9ICcgJyArIGF0dHJpYnV0ZSArICc9IicgKyBTdHJpbmcodmFsdWUpLnJlcGxhY2UocXVvdCwgJyZxdW90OycpICsgJyInOw0KICByZXR1cm4gcDEgKyAnPicgKyBTICsgJzwvJyArIHRhZyArICc+JzsNCn07DQptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKE5BTUUsIGV4ZWMpew0KICB2YXIgTyA9IHt9Ow0KICBPW05BTUVdID0gZXhlYyhjcmVhdGVIVE1MKTsNCiAgJGV4cG9ydCgkZXhwb3J0LlAgKyAkZXhwb3J0LkYgKiBmYWlscyhmdW5jdGlvbigpew0KICAgIHZhciB0ZXN0ID0gJydbTkFNRV0oJyInKTsNCiAgICByZXR1cm4gdGVzdCAhPT0gdGVzdC50b0xvd2VyQ2FzZSgpIHx8IHRlc3Quc3BsaXQoJyInKS5sZW5ndGggPiAzOw0KICB9KSwgJ1N0cmluZycsIE8pOw0KfTsNCn0seyIuL19kZWZpbmVkIjoyNywiLi9fZXhwb3J0IjozMiwiLi9fZmFpbHMiOjM0fV0sMTAwOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCi8vIGh0dHBzOi8vZ2l0aHViLmNvbS90YzM5L3Byb3Bvc2FsLXN0cmluZy1wYWQtc3RhcnQtZW5kDQp2YXIgdG9MZW5ndGggPSByZXF1aXJlKCcuL190by1sZW5ndGgnKQ0KICAsIHJlcGVhdCAgID0gcmVxdWlyZSgnLi9fc3RyaW5nLXJlcGVhdCcpDQogICwgZGVmaW5lZCAgPSByZXF1aXJlKCcuL19kZWZpbmVkJyk7DQoNCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24odGhhdCwgbWF4TGVuZ3RoLCBmaWxsU3RyaW5nLCBsZWZ0KXsNCiAgdmFyIFMgICAgICAgICAgICA9IFN0cmluZyhkZWZpbmVkKHRoYXQpKQ0KICAgICwgc3RyaW5nTGVuZ3RoID0gUy5sZW5ndGgNCiAgICAsIGZpbGxTdHIgICAgICA9IGZpbGxTdHJpbmcgPT09IHVuZGVmaW5lZCA/ICcgJyA6IFN0cmluZyhmaWxsU3RyaW5nKQ0KICAgICwgaW50TWF4TGVuZ3RoID0gdG9MZW5ndGgobWF4TGVuZ3RoKTsNCiAgaWYoaW50TWF4TGVuZ3RoIDw9IHN0cmluZ0xlbmd0aCB8fCBmaWxsU3RyID09ICcnKXJldHVybiBTOw0KICB2YXIgZmlsbExlbiA9IGludE1heExlbmd0aCAtIHN0cmluZ0xlbmd0aA0KICAgICwgc3RyaW5nRmlsbGVyID0gcmVwZWF0LmNhbGwoZmlsbFN0ciwgTWF0aC5jZWlsKGZpbGxMZW4gLyBmaWxsU3RyLmxlbmd0aCkpOw0KICBpZihzdHJpbmdGaWxsZXIubGVuZ3RoID4gZmlsbExlbilzdHJpbmdGaWxsZXIgPSBzdHJpbmdGaWxsZXIuc2xpY2UoMCwgZmlsbExlbik7DQogIHJldHVybiBsZWZ0ID8gc3RyaW5nRmlsbGVyICsgUyA6IFMgKyBzdHJpbmdGaWxsZXI7DQp9Ow0KDQp9LHsiLi9fZGVmaW5lZCI6MjcsIi4vX3N0cmluZy1yZXBlYXQiOjEwMSwiLi9fdG8tbGVuZ3RoIjoxMDh9XSwxMDE6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KJ3VzZSBzdHJpY3QnOw0KdmFyIHRvSW50ZWdlciA9IHJlcXVpcmUoJy4vX3RvLWludGVnZXInKQ0KICAsIGRlZmluZWQgICA9IHJlcXVpcmUoJy4vX2RlZmluZWQnKTsNCg0KbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiByZXBlYXQoY291bnQpew0KICB2YXIgc3RyID0gU3RyaW5nKGRlZmluZWQodGhpcykpDQogICAgLCByZXMgPSAnJw0KICAgICwgbiAgID0gdG9JbnRlZ2VyKGNvdW50KTsNCiAgaWYobiA8IDAgfHwgbiA9PSBJbmZpbml0eSl0aHJvdyBSYW5nZUVycm9yKCJDb3VudCBjYW4ndCBiZSBuZWdhdGl2ZSIpOw0KICBmb3IoO24gPiAwOyAobiA+Pj49IDEpICYmIChzdHIgKz0gc3RyKSlpZihuICYgMSlyZXMgKz0gc3RyOw0KICByZXR1cm4gcmVzOw0KfTsNCn0seyIuL19kZWZpbmVkIjoyNywiLi9fdG8taW50ZWdlciI6MTA2fV0sMTAyOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCnZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0JykNCiAgLCBkZWZpbmVkID0gcmVxdWlyZSgnLi9fZGVmaW5lZCcpDQogICwgZmFpbHMgICA9IHJlcXVpcmUoJy4vX2ZhaWxzJykNCiAgLCBzcGFjZXMgID0gcmVxdWlyZSgnLi9fc3RyaW5nLXdzJykNCiAgLCBzcGFjZSAgID0gJ1snICsgc3BhY2VzICsgJ10nDQogICwgbm9uICAgICA9ICdcdTIwMGJcdTAwODUnDQogICwgbHRyaW0gICA9IFJlZ0V4cCgnXicgKyBzcGFjZSArIHNwYWNlICsgJyonKQ0KICAsIHJ0cmltICAgPSBSZWdFeHAoc3BhY2UgKyBzcGFjZSArICcqJCcpOw0KDQp2YXIgZXhwb3J0ZXIgPSBmdW5jdGlvbihLRVksIGV4ZWMsIEFMSUFTKXsNCiAgdmFyIGV4cCAgID0ge307DQogIHZhciBGT1JDRSA9IGZhaWxzKGZ1bmN0aW9uKCl7DQogICAgcmV0dXJuICEhc3BhY2VzW0tFWV0oKSB8fCBub25bS0VZXSgpICE9IG5vbjsNCiAgfSk7DQogIHZhciBmbiA9IGV4cFtLRVldID0gRk9SQ0UgPyBleGVjKHRyaW0pIDogc3BhY2VzW0tFWV07DQogIGlmKEFMSUFTKWV4cFtBTElBU10gPSBmbjsNCiAgJGV4cG9ydCgkZXhwb3J0LlAgKyAkZXhwb3J0LkYgKiBGT1JDRSwgJ1N0cmluZycsIGV4cCk7DQp9Ow0KDQovLyAxIC0+IFN0cmluZyN0cmltTGVmdA0KLy8gMiAtPiBTdHJpbmcjdHJpbVJpZ2h0DQovLyAzIC0+IFN0cmluZyN0cmltDQp2YXIgdHJpbSA9IGV4cG9ydGVyLnRyaW0gPSBmdW5jdGlvbihzdHJpbmcsIFRZUEUpew0KICBzdHJpbmcgPSBTdHJpbmcoZGVmaW5lZChzdHJpbmcpKTsNCiAgaWYoVFlQRSAmIDEpc3RyaW5nID0gc3RyaW5nLnJlcGxhY2UobHRyaW0sICcnKTsNCiAgaWYoVFlQRSAmIDIpc3RyaW5nID0gc3RyaW5nLnJlcGxhY2UocnRyaW0sICcnKTsNCiAgcmV0dXJuIHN0cmluZzsNCn07DQoNCm1vZHVsZS5leHBvcnRzID0gZXhwb3J0ZXI7DQp9LHsiLi9fZGVmaW5lZCI6MjcsIi4vX2V4cG9ydCI6MzIsIi4vX2ZhaWxzIjozNCwiLi9fc3RyaW5nLXdzIjoxMDN9XSwxMDM6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KbW9kdWxlLmV4cG9ydHMgPSAnXHgwOVx4MEFceDBCXHgwQ1x4MERceDIwXHhBMFx1MTY4MFx1MTgwRVx1MjAwMFx1MjAwMVx1MjAwMlx1MjAwMycgKw0KICAnXHUyMDA0XHUyMDA1XHUyMDA2XHUyMDA3XHUyMDA4XHUyMDA5XHUyMDBBXHUyMDJGXHUyMDVGXHUzMDAwXHUyMDI4XHUyMDI5XHVGRUZGJzsNCn0se31dLDEwNDpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQp2YXIgY3R4ICAgICAgICAgICAgICAgID0gcmVxdWlyZSgnLi9fY3R4JykNCiAgLCBpbnZva2UgICAgICAgICAgICAgPSByZXF1aXJlKCcuL19pbnZva2UnKQ0KICAsIGh0bWwgICAgICAgICAgICAgICA9IHJlcXVpcmUoJy4vX2h0bWwnKQ0KICAsIGNlbCAgICAgICAgICAgICAgICA9IHJlcXVpcmUoJy4vX2RvbS1jcmVhdGUnKQ0KICAsIGdsb2JhbCAgICAgICAgICAgICA9IHJlcXVpcmUoJy4vX2dsb2JhbCcpDQogICwgcHJvY2VzcyAgICAgICAgICAgID0gZ2xvYmFsLnByb2Nlc3MNCiAgLCBzZXRUYXNrICAgICAgICAgICAgPSBnbG9iYWwuc2V0SW1tZWRpYXRlDQogICwgY2xlYXJUYXNrICAgICAgICAgID0gZ2xvYmFsLmNsZWFySW1tZWRpYXRlDQogICwgTWVzc2FnZUNoYW5uZWwgICAgID0gZ2xvYmFsLk1lc3NhZ2VDaGFubmVsDQogICwgY291bnRlciAgICAgICAgICAgID0gMA0KICAsIHF1ZXVlICAgICAgICAgICAgICA9IHt9DQogICwgT05SRUFEWVNUQVRFQ0hBTkdFID0gJ29ucmVhZHlzdGF0ZWNoYW5nZScNCiAgLCBkZWZlciwgY2hhbm5lbCwgcG9ydDsNCnZhciBydW4gPSBmdW5jdGlvbigpew0KICB2YXIgaWQgPSArdGhpczsNCiAgaWYocXVldWUuaGFzT3duUHJvcGVydHkoaWQpKXsNCiAgICB2YXIgZm4gPSBxdWV1ZVtpZF07DQogICAgZGVsZXRlIHF1ZXVlW2lkXTsNCiAgICBmbigpOw0KICB9DQp9Ow0KdmFyIGxpc3RlbmVyID0gZnVuY3Rpb24oZXZlbnQpew0KICBydW4uY2FsbChldmVudC5kYXRhKTsNCn07DQovLyBOb2RlLmpzIDAuOSsgJiBJRTEwKyBoYXMgc2V0SW1tZWRpYXRlLCBvdGhlcndpc2U6DQppZighc2V0VGFzayB8fCAhY2xlYXJUYXNrKXsNCiAgc2V0VGFzayA9IGZ1bmN0aW9uIHNldEltbWVkaWF0ZShmbil7DQogICAgdmFyIGFyZ3MgPSBbXSwgaSA9IDE7DQogICAgd2hpbGUoYXJndW1lbnRzLmxlbmd0aCA+IGkpYXJncy5wdXNoKGFyZ3VtZW50c1tpKytdKTsNCiAgICBxdWV1ZVsrK2NvdW50ZXJdID0gZnVuY3Rpb24oKXsNCiAgICAgIGludm9rZSh0eXBlb2YgZm4gPT0gJ2Z1bmN0aW9uJyA/IGZuIDogRnVuY3Rpb24oZm4pLCBhcmdzKTsNCiAgICB9Ow0KICAgIGRlZmVyKGNvdW50ZXIpOw0KICAgIHJldHVybiBjb3VudGVyOw0KICB9Ow0KICBjbGVhclRhc2sgPSBmdW5jdGlvbiBjbGVhckltbWVkaWF0ZShpZCl7DQogICAgZGVsZXRlIHF1ZXVlW2lkXTsNCiAgfTsNCiAgLy8gTm9kZS5qcyAwLjgtDQogIGlmKHJlcXVpcmUoJy4vX2NvZicpKHByb2Nlc3MpID09ICdwcm9jZXNzJyl7DQogICAgZGVmZXIgPSBmdW5jdGlvbihpZCl7DQogICAgICBwcm9jZXNzLm5leHRUaWNrKGN0eChydW4sIGlkLCAxKSk7DQogICAgfTsNCiAgLy8gQnJvd3NlcnMgd2l0aCBNZXNzYWdlQ2hhbm5lbCwgaW5jbHVkZXMgV2ViV29ya2Vycw0KICB9IGVsc2UgaWYoTWVzc2FnZUNoYW5uZWwpew0KICAgIGNoYW5uZWwgPSBuZXcgTWVzc2FnZUNoYW5uZWw7DQogICAgcG9ydCAgICA9IGNoYW5uZWwucG9ydDI7DQogICAgY2hhbm5lbC5wb3J0MS5vbm1lc3NhZ2UgPSBsaXN0ZW5lcjsNCiAgICBkZWZlciA9IGN0eChwb3J0LnBvc3RNZXNzYWdlLCBwb3J0LCAxKTsNCiAgLy8gQnJvd3NlcnMgd2l0aCBwb3N0TWVzc2FnZSwgc2tpcCBXZWJXb3JrZXJzDQogIC8vIElFOCBoYXMgcG9zdE1lc3NhZ2UsIGJ1dCBpdCdzIHN5bmMgJiB0eXBlb2YgaXRzIHBvc3RNZXNzYWdlIGlzICdvYmplY3QnDQogIH0gZWxzZSBpZihnbG9iYWwuYWRkRXZlbnRMaXN0ZW5lciAmJiB0eXBlb2YgcG9zdE1lc3NhZ2UgPT0gJ2Z1bmN0aW9uJyAmJiAhZ2xvYmFsLmltcG9ydFNjcmlwdHMpew0KICAgIGRlZmVyID0gZnVuY3Rpb24oaWQpew0KICAgICAgZ2xvYmFsLnBvc3RNZXNzYWdlKGlkICsgJycsICcqJyk7DQogICAgfTsNCiAgICBnbG9iYWwuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIGxpc3RlbmVyLCBmYWxzZSk7DQogIC8vIElFOC0NCiAgfSBlbHNlIGlmKE9OUkVBRFlTVEFURUNIQU5HRSBpbiBjZWwoJ3NjcmlwdCcpKXsNCiAgICBkZWZlciA9IGZ1bmN0aW9uKGlkKXsNCiAgICAgIGh0bWwuYXBwZW5kQ2hpbGQoY2VsKCdzY3JpcHQnKSlbT05SRUFEWVNUQVRFQ0hBTkdFXSA9IGZ1bmN0aW9uKCl7DQogICAgICAgIGh0bWwucmVtb3ZlQ2hpbGQodGhpcyk7DQogICAgICAgIHJ1bi5jYWxsKGlkKTsNCiAgICAgIH07DQogICAgfTsNCiAgLy8gUmVzdCBvbGQgYnJvd3NlcnMNCiAgfSBlbHNlIHsNCiAgICBkZWZlciA9IGZ1bmN0aW9uKGlkKXsNCiAgICAgIHNldFRpbWVvdXQoY3R4KHJ1biwgaWQsIDEpLCAwKTsNCiAgICB9Ow0KICB9DQp9DQptb2R1bGUuZXhwb3J0cyA9IHsNCiAgc2V0OiAgIHNldFRhc2ssDQogIGNsZWFyOiBjbGVhclRhc2sNCn07DQp9LHsiLi9fY29mIjoxOCwiLi9fY3R4IjoyNSwiLi9fZG9tLWNyZWF0ZSI6MjksIi4vX2dsb2JhbCI6MzgsIi4vX2h0bWwiOjQxLCIuL19pbnZva2UiOjQ0fV0sMTA1OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCnZhciB0b0ludGVnZXIgPSByZXF1aXJlKCcuL190by1pbnRlZ2VyJykNCiAgLCBtYXggICAgICAgPSBNYXRoLm1heA0KICAsIG1pbiAgICAgICA9IE1hdGgubWluOw0KbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpbmRleCwgbGVuZ3RoKXsNCiAgaW5kZXggPSB0b0ludGVnZXIoaW5kZXgpOw0KICByZXR1cm4gaW5kZXggPCAwID8gbWF4KGluZGV4ICsgbGVuZ3RoLCAwKSA6IG1pbihpbmRleCwgbGVuZ3RoKTsNCn07DQp9LHsiLi9fdG8taW50ZWdlciI6MTA2fV0sMTA2OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCi8vIDcuMS40IFRvSW50ZWdlcg0KdmFyIGNlaWwgID0gTWF0aC5jZWlsDQogICwgZmxvb3IgPSBNYXRoLmZsb29yOw0KbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpdCl7DQogIHJldHVybiBpc05hTihpdCA9ICtpdCkgPyAwIDogKGl0ID4gMCA/IGZsb29yIDogY2VpbCkoaXQpOw0KfTsNCn0se31dLDEwNzpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQovLyB0byBpbmRleGVkIG9iamVjdCwgdG9PYmplY3Qgd2l0aCBmYWxsYmFjayBmb3Igbm9uLWFycmF5LWxpa2UgRVMzIHN0cmluZ3MNCnZhciBJT2JqZWN0ID0gcmVxdWlyZSgnLi9faW9iamVjdCcpDQogICwgZGVmaW5lZCA9IHJlcXVpcmUoJy4vX2RlZmluZWQnKTsNCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQpew0KICByZXR1cm4gSU9iamVjdChkZWZpbmVkKGl0KSk7DQp9Ow0KfSx7Ii4vX2RlZmluZWQiOjI3LCIuL19pb2JqZWN0Ijo0NX1dLDEwODpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQovLyA3LjEuMTUgVG9MZW5ndGgNCnZhciB0b0ludGVnZXIgPSByZXF1aXJlKCcuL190by1pbnRlZ2VyJykNCiAgLCBtaW4gICAgICAgPSBNYXRoLm1pbjsNCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQpew0KICByZXR1cm4gaXQgPiAwID8gbWluKHRvSW50ZWdlcihpdCksIDB4MWZmZmZmZmZmZmZmZmYpIDogMDsgLy8gcG93KDIsIDUzKSAtIDEgPT0gOTAwNzE5OTI1NDc0MDk5MQ0KfTsNCn0seyIuL190by1pbnRlZ2VyIjoxMDZ9XSwxMDk6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KLy8gNy4xLjEzIFRvT2JqZWN0KGFyZ3VtZW50KQ0KdmFyIGRlZmluZWQgPSByZXF1aXJlKCcuL19kZWZpbmVkJyk7DQptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGl0KXsNCiAgcmV0dXJuIE9iamVjdChkZWZpbmVkKGl0KSk7DQp9Ow0KfSx7Ii4vX2RlZmluZWQiOjI3fV0sMTEwOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCi8vIDcuMS4xIFRvUHJpbWl0aXZlKGlucHV0IFssIFByZWZlcnJlZFR5cGVdKQ0KdmFyIGlzT2JqZWN0ID0gcmVxdWlyZSgnLi9faXMtb2JqZWN0Jyk7DQovLyBpbnN0ZWFkIG9mIHRoZSBFUzYgc3BlYyB2ZXJzaW9uLCB3ZSBkaWRuJ3QgaW1wbGVtZW50IEBAdG9QcmltaXRpdmUgY2FzZQ0KLy8gYW5kIHRoZSBzZWNvbmQgYXJndW1lbnQgLSBmbGFnIC0gcHJlZmVycmVkIHR5cGUgaXMgYSBzdHJpbmcNCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaXQsIFMpew0KICBpZighaXNPYmplY3QoaXQpKXJldHVybiBpdDsNCiAgdmFyIGZuLCB2YWw7DQogIGlmKFMgJiYgdHlwZW9mIChmbiA9IGl0LnRvU3RyaW5nKSA9PSAnZnVuY3Rpb24nICYmICFpc09iamVjdCh2YWwgPSBmbi5jYWxsKGl0KSkpcmV0dXJuIHZhbDsNCiAgaWYodHlwZW9mIChmbiA9IGl0LnZhbHVlT2YpID09ICdmdW5jdGlvbicgJiYgIWlzT2JqZWN0KHZhbCA9IGZuLmNhbGwoaXQpKSlyZXR1cm4gdmFsOw0KICBpZighUyAmJiB0eXBlb2YgKGZuID0gaXQudG9TdHJpbmcpID09ICdmdW5jdGlvbicgJiYgIWlzT2JqZWN0KHZhbCA9IGZuLmNhbGwoaXQpKSlyZXR1cm4gdmFsOw0KICB0aHJvdyBUeXBlRXJyb3IoIkNhbid0IGNvbnZlcnQgb2JqZWN0IHRvIHByaW1pdGl2ZSB2YWx1ZSIpOw0KfTsNCn0seyIuL19pcy1vYmplY3QiOjQ5fV0sMTExOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCid1c2Ugc3RyaWN0JzsNCmlmKHJlcXVpcmUoJy4vX2Rlc2NyaXB0b3JzJykpew0KICB2YXIgTElCUkFSWSAgICAgICAgICAgICA9IHJlcXVpcmUoJy4vX2xpYnJhcnknKQ0KICAgICwgZ2xvYmFsICAgICAgICAgICAgICA9IHJlcXVpcmUoJy4vX2dsb2JhbCcpDQogICAgLCBmYWlscyAgICAgICAgICAgICAgID0gcmVxdWlyZSgnLi9fZmFpbHMnKQ0KICAgICwgJGV4cG9ydCAgICAgICAgICAgICA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpDQogICAgLCAkdHlwZWQgICAgICAgICAgICAgID0gcmVxdWlyZSgnLi9fdHlwZWQnKQ0KICAgICwgJGJ1ZmZlciAgICAgICAgICAgICA9IHJlcXVpcmUoJy4vX3R5cGVkLWJ1ZmZlcicpDQogICAgLCBjdHggICAgICAgICAgICAgICAgID0gcmVxdWlyZSgnLi9fY3R4JykNCiAgICAsIGFuSW5zdGFuY2UgICAgICAgICAgPSByZXF1aXJlKCcuL19hbi1pbnN0YW5jZScpDQogICAgLCBwcm9wZXJ0eURlc2MgICAgICAgID0gcmVxdWlyZSgnLi9fcHJvcGVydHktZGVzYycpDQogICAgLCBoaWRlICAgICAgICAgICAgICAgID0gcmVxdWlyZSgnLi9faGlkZScpDQogICAgLCByZWRlZmluZUFsbCAgICAgICAgID0gcmVxdWlyZSgnLi9fcmVkZWZpbmUtYWxsJykNCiAgICAsIGlzSW50ZWdlciAgICAgICAgICAgPSByZXF1aXJlKCcuL19pcy1pbnRlZ2VyJykNCiAgICAsIHRvSW50ZWdlciAgICAgICAgICAgPSByZXF1aXJlKCcuL190by1pbnRlZ2VyJykNCiAgICAsIHRvTGVuZ3RoICAgICAgICAgICAgPSByZXF1aXJlKCcuL190by1sZW5ndGgnKQ0KICAgICwgdG9JbmRleCAgICAgICAgICAgICA9IHJlcXVpcmUoJy4vX3RvLWluZGV4JykNCiAgICAsIHRvUHJpbWl0aXZlICAgICAgICAgPSByZXF1aXJlKCcuL190by1wcmltaXRpdmUnKQ0KICAgICwgaGFzICAgICAgICAgICAgICAgICA9IHJlcXVpcmUoJy4vX2hhcycpDQogICAgLCBzYW1lICAgICAgICAgICAgICAgID0gcmVxdWlyZSgnLi9fc2FtZS12YWx1ZScpDQogICAgLCBjbGFzc29mICAgICAgICAgICAgID0gcmVxdWlyZSgnLi9fY2xhc3NvZicpDQogICAgLCBpc09iamVjdCAgICAgICAgICAgID0gcmVxdWlyZSgnLi9faXMtb2JqZWN0JykNCiAgICAsIHRvT2JqZWN0ICAgICAgICAgICAgPSByZXF1aXJlKCcuL190by1vYmplY3QnKQ0KICAgICwgaXNBcnJheUl0ZXIgICAgICAgICA9IHJlcXVpcmUoJy4vX2lzLWFycmF5LWl0ZXInKQ0KICAgICwgY3JlYXRlICAgICAgICAgICAgICA9IHJlcXVpcmUoJy4vX29iamVjdC1jcmVhdGUnKQ0KICAgICwgZ2V0UHJvdG90eXBlT2YgICAgICA9IHJlcXVpcmUoJy4vX29iamVjdC1ncG8nKQ0KICAgICwgZ09QTiAgICAgICAgICAgICAgICA9IHJlcXVpcmUoJy4vX29iamVjdC1nb3BuJykuZg0KICAgICwgaXNJdGVyYWJsZSAgICAgICAgICA9IHJlcXVpcmUoJy4vY29yZS5pcy1pdGVyYWJsZScpDQogICAgLCBnZXRJdGVyRm4gICAgICAgICAgID0gcmVxdWlyZSgnLi9jb3JlLmdldC1pdGVyYXRvci1tZXRob2QnKQ0KICAgICwgdWlkICAgICAgICAgICAgICAgICA9IHJlcXVpcmUoJy4vX3VpZCcpDQogICAgLCB3a3MgICAgICAgICAgICAgICAgID0gcmVxdWlyZSgnLi9fd2tzJykNCiAgICAsIGNyZWF0ZUFycmF5TWV0aG9kICAgPSByZXF1aXJlKCcuL19hcnJheS1tZXRob2RzJykNCiAgICAsIGNyZWF0ZUFycmF5SW5jbHVkZXMgPSByZXF1aXJlKCcuL19hcnJheS1pbmNsdWRlcycpDQogICAgLCBzcGVjaWVzQ29uc3RydWN0b3IgID0gcmVxdWlyZSgnLi9fc3BlY2llcy1jb25zdHJ1Y3RvcicpDQogICAgLCBBcnJheUl0ZXJhdG9ycyAgICAgID0gcmVxdWlyZSgnLi9lczYuYXJyYXkuaXRlcmF0b3InKQ0KICAgICwgSXRlcmF0b3JzICAgICAgICAgICA9IHJlcXVpcmUoJy4vX2l0ZXJhdG9ycycpDQogICAgLCAkaXRlckRldGVjdCAgICAgICAgID0gcmVxdWlyZSgnLi9faXRlci1kZXRlY3QnKQ0KICAgICwgc2V0U3BlY2llcyAgICAgICAgICA9IHJlcXVpcmUoJy4vX3NldC1zcGVjaWVzJykNCiAgICAsIGFycmF5RmlsbCAgICAgICAgICAgPSByZXF1aXJlKCcuL19hcnJheS1maWxsJykNCiAgICAsIGFycmF5Q29weVdpdGhpbiAgICAgPSByZXF1aXJlKCcuL19hcnJheS1jb3B5LXdpdGhpbicpDQogICAgLCAkRFAgICAgICAgICAgICAgICAgID0gcmVxdWlyZSgnLi9fb2JqZWN0LWRwJykNCiAgICAsICRHT1BEICAgICAgICAgICAgICAgPSByZXF1aXJlKCcuL19vYmplY3QtZ29wZCcpDQogICAgLCBkUCAgICAgICAgICAgICAgICAgID0gJERQLmYNCiAgICAsIGdPUEQgICAgICAgICAgICAgICAgPSAkR09QRC5mDQogICAgLCBSYW5nZUVycm9yICAgICAgICAgID0gZ2xvYmFsLlJhbmdlRXJyb3INCiAgICAsIFR5cGVFcnJvciAgICAgICAgICAgPSBnbG9iYWwuVHlwZUVycm9yDQogICAgLCBVaW50OEFycmF5ICAgICAgICAgID0gZ2xvYmFsLlVpbnQ4QXJyYXkNCiAgICAsIEFSUkFZX0JVRkZFUiAgICAgICAgPSAnQXJyYXlCdWZmZXInDQogICAgLCBTSEFSRURfQlVGRkVSICAgICAgID0gJ1NoYXJlZCcgKyBBUlJBWV9CVUZGRVINCiAgICAsIEJZVEVTX1BFUl9FTEVNRU5UICAgPSAnQllURVNfUEVSX0VMRU1FTlQnDQogICAgLCBQUk9UT1RZUEUgICAgICAgICAgID0gJ3Byb3RvdHlwZScNCiAgICAsIEFycmF5UHJvdG8gICAgICAgICAgPSBBcnJheVtQUk9UT1RZUEVdDQogICAgLCAkQXJyYXlCdWZmZXIgICAgICAgID0gJGJ1ZmZlci5BcnJheUJ1ZmZlcg0KICAgICwgJERhdGFWaWV3ICAgICAgICAgICA9ICRidWZmZXIuRGF0YVZpZXcNCiAgICAsIGFycmF5Rm9yRWFjaCAgICAgICAgPSBjcmVhdGVBcnJheU1ldGhvZCgwKQ0KICAgICwgYXJyYXlGaWx0ZXIgICAgICAgICA9IGNyZWF0ZUFycmF5TWV0aG9kKDIpDQogICAgLCBhcnJheVNvbWUgICAgICAgICAgID0gY3JlYXRlQXJyYXlNZXRob2QoMykNCiAgICAsIGFycmF5RXZlcnkgICAgICAgICAgPSBjcmVhdGVBcnJheU1ldGhvZCg0KQ0KICAgICwgYXJyYXlGaW5kICAgICAgICAgICA9IGNyZWF0ZUFycmF5TWV0aG9kKDUpDQogICAgLCBhcnJheUZpbmRJbmRleCAgICAgID0gY3JlYXRlQXJyYXlNZXRob2QoNikNCiAgICAsIGFycmF5SW5jbHVkZXMgICAgICAgPSBjcmVhdGVBcnJheUluY2x1ZGVzKHRydWUpDQogICAgLCBhcnJheUluZGV4T2YgICAgICAgID0gY3JlYXRlQXJyYXlJbmNsdWRlcyhmYWxzZSkNCiAgICAsIGFycmF5VmFsdWVzICAgICAgICAgPSBBcnJheUl0ZXJhdG9ycy52YWx1ZXMNCiAgICAsIGFycmF5S2V5cyAgICAgICAgICAgPSBBcnJheUl0ZXJhdG9ycy5rZXlzDQogICAgLCBhcnJheUVudHJpZXMgICAgICAgID0gQXJyYXlJdGVyYXRvcnMuZW50cmllcw0KICAgICwgYXJyYXlMYXN0SW5kZXhPZiAgICA9IEFycmF5UHJvdG8ubGFzdEluZGV4T2YNCiAgICAsIGFycmF5UmVkdWNlICAgICAgICAgPSBBcnJheVByb3RvLnJlZHVjZQ0KICAgICwgYXJyYXlSZWR1Y2VSaWdodCAgICA9IEFycmF5UHJvdG8ucmVkdWNlUmlnaHQNCiAgICAsIGFycmF5Sm9pbiAgICAgICAgICAgPSBBcnJheVByb3RvLmpvaW4NCiAgICAsIGFycmF5U29ydCAgICAgICAgICAgPSBBcnJheVByb3RvLnNvcnQNCiAgICAsIGFycmF5U2xpY2UgICAgICAgICAgPSBBcnJheVByb3RvLnNsaWNlDQogICAgLCBhcnJheVRvU3RyaW5nICAgICAgID0gQXJyYXlQcm90by50b1N0cmluZw0KICAgICwgYXJyYXlUb0xvY2FsZVN0cmluZyA9IEFycmF5UHJvdG8udG9Mb2NhbGVTdHJpbmcNCiAgICAsIElURVJBVE9SICAgICAgICAgICAgPSB3a3MoJ2l0ZXJhdG9yJykNCiAgICAsIFRBRyAgICAgICAgICAgICAgICAgPSB3a3MoJ3RvU3RyaW5nVGFnJykNCiAgICAsIFRZUEVEX0NPTlNUUlVDVE9SICAgPSB1aWQoJ3R5cGVkX2NvbnN0cnVjdG9yJykNCiAgICAsIERFRl9DT05TVFJVQ1RPUiAgICAgPSB1aWQoJ2RlZl9jb25zdHJ1Y3RvcicpDQogICAgLCBBTExfQ09OU1RSVUNUT1JTICAgID0gJHR5cGVkLkNPTlNUUg0KICAgICwgVFlQRURfQVJSQVkgICAgICAgICA9ICR0eXBlZC5UWVBFRA0KICAgICwgVklFVyAgICAgICAgICAgICAgICA9ICR0eXBlZC5WSUVXDQogICAgLCBXUk9OR19MRU5HVEggICAgICAgID0gJ1dyb25nIGxlbmd0aCEnOw0KDQogIHZhciAkbWFwID0gY3JlYXRlQXJyYXlNZXRob2QoMSwgZnVuY3Rpb24oTywgbGVuZ3RoKXsNCiAgICByZXR1cm4gYWxsb2NhdGUoc3BlY2llc0NvbnN0cnVjdG9yKE8sIE9bREVGX0NPTlNUUlVDVE9SXSksIGxlbmd0aCk7DQogIH0pOw0KDQogIHZhciBMSVRUTEVfRU5ESUFOID0gZmFpbHMoZnVuY3Rpb24oKXsNCiAgICByZXR1cm4gbmV3IFVpbnQ4QXJyYXkobmV3IFVpbnQxNkFycmF5KFsxXSkuYnVmZmVyKVswXSA9PT0gMTsNCiAgfSk7DQoNCiAgdmFyIEZPUkNFRF9TRVQgPSAhIVVpbnQ4QXJyYXkgJiYgISFVaW50OEFycmF5W1BST1RPVFlQRV0uc2V0ICYmIGZhaWxzKGZ1bmN0aW9uKCl7DQogICAgbmV3IFVpbnQ4QXJyYXkoMSkuc2V0KHt9KTsNCiAgfSk7DQoNCiAgdmFyIHN0cmljdFRvTGVuZ3RoID0gZnVuY3Rpb24oaXQsIFNBTUUpew0KICAgIGlmKGl0ID09PSB1bmRlZmluZWQpdGhyb3cgVHlwZUVycm9yKFdST05HX0xFTkdUSCk7DQogICAgdmFyIG51bWJlciA9ICtpdA0KICAgICAgLCBsZW5ndGggPSB0b0xlbmd0aChpdCk7DQogICAgaWYoU0FNRSAmJiAhc2FtZShudW1iZXIsIGxlbmd0aCkpdGhyb3cgUmFuZ2VFcnJvcihXUk9OR19MRU5HVEgpOw0KICAgIHJldHVybiBsZW5ndGg7DQogIH07DQoNCiAgdmFyIHRvT2Zmc2V0ID0gZnVuY3Rpb24oaXQsIEJZVEVTKXsNCiAgICB2YXIgb2Zmc2V0ID0gdG9JbnRlZ2VyKGl0KTsNCiAgICBpZihvZmZzZXQgPCAwIHx8IG9mZnNldCAlIEJZVEVTKXRocm93IFJhbmdlRXJyb3IoJ1dyb25nIG9mZnNldCEnKTsNCiAgICByZXR1cm4gb2Zmc2V0Ow0KICB9Ow0KDQogIHZhciB2YWxpZGF0ZSA9IGZ1bmN0aW9uKGl0KXsNCiAgICBpZihpc09iamVjdChpdCkgJiYgVFlQRURfQVJSQVkgaW4gaXQpcmV0dXJuIGl0Ow0KICAgIHRocm93IFR5cGVFcnJvcihpdCArICcgaXMgbm90IGEgdHlwZWQgYXJyYXkhJyk7DQogIH07DQoNCiAgdmFyIGFsbG9jYXRlID0gZnVuY3Rpb24oQywgbGVuZ3RoKXsNCiAgICBpZighKGlzT2JqZWN0KEMpICYmIFRZUEVEX0NPTlNUUlVDVE9SIGluIEMpKXsNCiAgICAgIHRocm93IFR5cGVFcnJvcignSXQgaXMgbm90IGEgdHlwZWQgYXJyYXkgY29uc3RydWN0b3IhJyk7DQogICAgfSByZXR1cm4gbmV3IEMobGVuZ3RoKTsNCiAgfTsNCg0KICB2YXIgc3BlY2llc0Zyb21MaXN0ID0gZnVuY3Rpb24oTywgbGlzdCl7DQogICAgcmV0dXJuIGZyb21MaXN0KHNwZWNpZXNDb25zdHJ1Y3RvcihPLCBPW0RFRl9DT05TVFJVQ1RPUl0pLCBsaXN0KTsNCiAgfTsNCg0KICB2YXIgZnJvbUxpc3QgPSBmdW5jdGlvbihDLCBsaXN0KXsNCiAgICB2YXIgaW5kZXggID0gMA0KICAgICAgLCBsZW5ndGggPSBsaXN0Lmxlbmd0aA0KICAgICAgLCByZXN1bHQgPSBhbGxvY2F0ZShDLCBsZW5ndGgpOw0KICAgIHdoaWxlKGxlbmd0aCA+IGluZGV4KXJlc3VsdFtpbmRleF0gPSBsaXN0W2luZGV4KytdOw0KICAgIHJldHVybiByZXN1bHQ7DQogIH07DQoNCiAgdmFyIGFkZEdldHRlciA9IGZ1bmN0aW9uKGl0LCBrZXksIGludGVybmFsKXsNCiAgICBkUChpdCwga2V5LCB7Z2V0OiBmdW5jdGlvbigpeyByZXR1cm4gdGhpcy5fZFtpbnRlcm5hbF07IH19KTsNCiAgfTsNCg0KICB2YXIgJGZyb20gPSBmdW5jdGlvbiBmcm9tKHNvdXJjZSAvKiwgbWFwZm4sIHRoaXNBcmcgKi8pew0KICAgIHZhciBPICAgICAgID0gdG9PYmplY3Qoc291cmNlKQ0KICAgICAgLCBhTGVuICAgID0gYXJndW1lbnRzLmxlbmd0aA0KICAgICAgLCBtYXBmbiAgID0gYUxlbiA+IDEgPyBhcmd1bWVudHNbMV0gOiB1bmRlZmluZWQNCiAgICAgICwgbWFwcGluZyA9IG1hcGZuICE9PSB1bmRlZmluZWQNCiAgICAgICwgaXRlckZuICA9IGdldEl0ZXJGbihPKQ0KICAgICAgLCBpLCBsZW5ndGgsIHZhbHVlcywgcmVzdWx0LCBzdGVwLCBpdGVyYXRvcjsNCiAgICBpZihpdGVyRm4gIT0gdW5kZWZpbmVkICYmICFpc0FycmF5SXRlcihpdGVyRm4pKXsNCiAgICAgIGZvcihpdGVyYXRvciA9IGl0ZXJGbi5jYWxsKE8pLCB2YWx1ZXMgPSBbXSwgaSA9IDA7ICEoc3RlcCA9IGl0ZXJhdG9yLm5leHQoKSkuZG9uZTsgaSsrKXsNCiAgICAgICAgdmFsdWVzLnB1c2goc3RlcC52YWx1ZSk7DQogICAgICB9IE8gPSB2YWx1ZXM7DQogICAgfQ0KICAgIGlmKG1hcHBpbmcgJiYgYUxlbiA+IDIpbWFwZm4gPSBjdHgobWFwZm4sIGFyZ3VtZW50c1syXSwgMik7DQogICAgZm9yKGkgPSAwLCBsZW5ndGggPSB0b0xlbmd0aChPLmxlbmd0aCksIHJlc3VsdCA9IGFsbG9jYXRlKHRoaXMsIGxlbmd0aCk7IGxlbmd0aCA+IGk7IGkrKyl7DQogICAgICByZXN1bHRbaV0gPSBtYXBwaW5nID8gbWFwZm4oT1tpXSwgaSkgOiBPW2ldOw0KICAgIH0NCiAgICByZXR1cm4gcmVzdWx0Ow0KICB9Ow0KDQogIHZhciAkb2YgPSBmdW5jdGlvbiBvZigvKi4uLml0ZW1zKi8pew0KICAgIHZhciBpbmRleCAgPSAwDQogICAgICAsIGxlbmd0aCA9IGFyZ3VtZW50cy5sZW5ndGgNCiAgICAgICwgcmVzdWx0ID0gYWxsb2NhdGUodGhpcywgbGVuZ3RoKTsNCiAgICB3aGlsZShsZW5ndGggPiBpbmRleClyZXN1bHRbaW5kZXhdID0gYXJndW1lbnRzW2luZGV4KytdOw0KICAgIHJldHVybiByZXN1bHQ7DQogIH07DQoNCiAgLy8gaU9TIFNhZmFyaSA2LnggZmFpbHMgaGVyZQ0KICB2YXIgVE9fTE9DQUxFX0JVRyA9ICEhVWludDhBcnJheSAmJiBmYWlscyhmdW5jdGlvbigpeyBhcnJheVRvTG9jYWxlU3RyaW5nLmNhbGwobmV3IFVpbnQ4QXJyYXkoMSkpOyB9KTsNCg0KICB2YXIgJHRvTG9jYWxlU3RyaW5nID0gZnVuY3Rpb24gdG9Mb2NhbGVTdHJpbmcoKXsNCiAgICByZXR1cm4gYXJyYXlUb0xvY2FsZVN0cmluZy5hcHBseShUT19MT0NBTEVfQlVHID8gYXJyYXlTbGljZS5jYWxsKHZhbGlkYXRlKHRoaXMpKSA6IHZhbGlkYXRlKHRoaXMpLCBhcmd1bWVudHMpOw0KICB9Ow0KDQogIHZhciBwcm90byA9IHsNCiAgICBjb3B5V2l0aGluOiBmdW5jdGlvbiBjb3B5V2l0aGluKHRhcmdldCwgc3RhcnQgLyosIGVuZCAqLyl7DQogICAgICByZXR1cm4gYXJyYXlDb3B5V2l0aGluLmNhbGwodmFsaWRhdGUodGhpcyksIHRhcmdldCwgc3RhcnQsIGFyZ3VtZW50cy5sZW5ndGggPiAyID8gYXJndW1lbnRzWzJdIDogdW5kZWZpbmVkKTsNCiAgICB9LA0KICAgIGV2ZXJ5OiBmdW5jdGlvbiBldmVyeShjYWxsYmFja2ZuIC8qLCB0aGlzQXJnICovKXsNCiAgICAgIHJldHVybiBhcnJheUV2ZXJ5KHZhbGlkYXRlKHRoaXMpLCBjYWxsYmFja2ZuLCBhcmd1bWVudHMubGVuZ3RoID4gMSA/IGFyZ3VtZW50c1sxXSA6IHVuZGVmaW5lZCk7DQogICAgfSwNCiAgICBmaWxsOiBmdW5jdGlvbiBmaWxsKHZhbHVlIC8qLCBzdGFydCwgZW5kICovKXsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby11bnVzZWQtdmFycw0KICAgICAgcmV0dXJuIGFycmF5RmlsbC5hcHBseSh2YWxpZGF0ZSh0aGlzKSwgYXJndW1lbnRzKTsNCiAgICB9LA0KICAgIGZpbHRlcjogZnVuY3Rpb24gZmlsdGVyKGNhbGxiYWNrZm4gLyosIHRoaXNBcmcgKi8pew0KICAgICAgcmV0dXJuIHNwZWNpZXNGcm9tTGlzdCh0aGlzLCBhcnJheUZpbHRlcih2YWxpZGF0ZSh0aGlzKSwgY2FsbGJhY2tmbiwNCiAgICAgICAgYXJndW1lbnRzLmxlbmd0aCA+IDEgPyBhcmd1bWVudHNbMV0gOiB1bmRlZmluZWQpKTsNCiAgICB9LA0KICAgIGZpbmQ6IGZ1bmN0aW9uIGZpbmQocHJlZGljYXRlIC8qLCB0aGlzQXJnICovKXsNCiAgICAgIHJldHVybiBhcnJheUZpbmQodmFsaWRhdGUodGhpcyksIHByZWRpY2F0ZSwgYXJndW1lbnRzLmxlbmd0aCA+IDEgPyBhcmd1bWVudHNbMV0gOiB1bmRlZmluZWQpOw0KICAgIH0sDQogICAgZmluZEluZGV4OiBmdW5jdGlvbiBmaW5kSW5kZXgocHJlZGljYXRlIC8qLCB0aGlzQXJnICovKXsNCiAgICAgIHJldHVybiBhcnJheUZpbmRJbmRleCh2YWxpZGF0ZSh0aGlzKSwgcHJlZGljYXRlLCBhcmd1bWVudHMubGVuZ3RoID4gMSA/IGFyZ3VtZW50c1sxXSA6IHVuZGVmaW5lZCk7DQogICAgfSwNCiAgICBmb3JFYWNoOiBmdW5jdGlvbiBmb3JFYWNoKGNhbGxiYWNrZm4gLyosIHRoaXNBcmcgKi8pew0KICAgICAgYXJyYXlGb3JFYWNoKHZhbGlkYXRlKHRoaXMpLCBjYWxsYmFja2ZuLCBhcmd1bWVudHMubGVuZ3RoID4gMSA/IGFyZ3VtZW50c1sxXSA6IHVuZGVmaW5lZCk7DQogICAgfSwNCiAgICBpbmRleE9mOiBmdW5jdGlvbiBpbmRleE9mKHNlYXJjaEVsZW1lbnQgLyosIGZyb21JbmRleCAqLyl7DQogICAgICByZXR1cm4gYXJyYXlJbmRleE9mKHZhbGlkYXRlKHRoaXMpLCBzZWFyY2hFbGVtZW50LCBhcmd1bWVudHMubGVuZ3RoID4gMSA/IGFyZ3VtZW50c1sxXSA6IHVuZGVmaW5lZCk7DQogICAgfSwNCiAgICBpbmNsdWRlczogZnVuY3Rpb24gaW5jbHVkZXMoc2VhcmNoRWxlbWVudCAvKiwgZnJvbUluZGV4ICovKXsNCiAgICAgIHJldHVybiBhcnJheUluY2x1ZGVzKHZhbGlkYXRlKHRoaXMpLCBzZWFyY2hFbGVtZW50LCBhcmd1bWVudHMubGVuZ3RoID4gMSA/IGFyZ3VtZW50c1sxXSA6IHVuZGVmaW5lZCk7DQogICAgfSwNCiAgICBqb2luOiBmdW5jdGlvbiBqb2luKHNlcGFyYXRvcil7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW51c2VkLXZhcnMNCiAgICAgIHJldHVybiBhcnJheUpvaW4uYXBwbHkodmFsaWRhdGUodGhpcyksIGFyZ3VtZW50cyk7DQogICAgfSwNCiAgICBsYXN0SW5kZXhPZjogZnVuY3Rpb24gbGFzdEluZGV4T2Yoc2VhcmNoRWxlbWVudCAvKiwgZnJvbUluZGV4ICovKXsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby11bnVzZWQtdmFycw0KICAgICAgcmV0dXJuIGFycmF5TGFzdEluZGV4T2YuYXBwbHkodmFsaWRhdGUodGhpcyksIGFyZ3VtZW50cyk7DQogICAgfSwNCiAgICBtYXA6IGZ1bmN0aW9uIG1hcChtYXBmbiAvKiwgdGhpc0FyZyAqLyl7DQogICAgICByZXR1cm4gJG1hcCh2YWxpZGF0ZSh0aGlzKSwgbWFwZm4sIGFyZ3VtZW50cy5sZW5ndGggPiAxID8gYXJndW1lbnRzWzFdIDogdW5kZWZpbmVkKTsNCiAgICB9LA0KICAgIHJlZHVjZTogZnVuY3Rpb24gcmVkdWNlKGNhbGxiYWNrZm4gLyosIGluaXRpYWxWYWx1ZSAqLyl7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tdW51c2VkLXZhcnMNCiAgICAgIHJldHVybiBhcnJheVJlZHVjZS5hcHBseSh2YWxpZGF0ZSh0aGlzKSwgYXJndW1lbnRzKTsNCiAgICB9LA0KICAgIHJlZHVjZVJpZ2h0OiBmdW5jdGlvbiByZWR1Y2VSaWdodChjYWxsYmFja2ZuIC8qLCBpbml0aWFsVmFsdWUgKi8peyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLXVudXNlZC12YXJzDQogICAgICByZXR1cm4gYXJyYXlSZWR1Y2VSaWdodC5hcHBseSh2YWxpZGF0ZSh0aGlzKSwgYXJndW1lbnRzKTsNCiAgICB9LA0KICAgIHJldmVyc2U6IGZ1bmN0aW9uIHJldmVyc2UoKXsNCiAgICAgIHZhciB0aGF0ICAgPSB0aGlzDQogICAgICAgICwgbGVuZ3RoID0gdmFsaWRhdGUodGhhdCkubGVuZ3RoDQogICAgICAgICwgbWlkZGxlID0gTWF0aC5mbG9vcihsZW5ndGggLyAyKQ0KICAgICAgICAsIGluZGV4ICA9IDANCiAgICAgICAgLCB2YWx1ZTsNCiAgICAgIHdoaWxlKGluZGV4IDwgbWlkZGxlKXsNCiAgICAgICAgdmFsdWUgICAgICAgICA9IHRoYXRbaW5kZXhdOw0KICAgICAgICB0aGF0W2luZGV4KytdID0gdGhhdFstLWxlbmd0aF07DQogICAgICAgIHRoYXRbbGVuZ3RoXSAgPSB2YWx1ZTsNCiAgICAgIH0gcmV0dXJuIHRoYXQ7DQogICAgfSwNCiAgICBzb21lOiBmdW5jdGlvbiBzb21lKGNhbGxiYWNrZm4gLyosIHRoaXNBcmcgKi8pew0KICAgICAgcmV0dXJuIGFycmF5U29tZSh2YWxpZGF0ZSh0aGlzKSwgY2FsbGJhY2tmbiwgYXJndW1lbnRzLmxlbmd0aCA+IDEgPyBhcmd1bWVudHNbMV0gOiB1bmRlZmluZWQpOw0KICAgIH0sDQogICAgc29ydDogZnVuY3Rpb24gc29ydChjb21wYXJlZm4pew0KICAgICAgcmV0dXJuIGFycmF5U29ydC5jYWxsKHZhbGlkYXRlKHRoaXMpLCBjb21wYXJlZm4pOw0KICAgIH0sDQogICAgc3ViYXJyYXk6IGZ1bmN0aW9uIHN1YmFycmF5KGJlZ2luLCBlbmQpew0KICAgICAgdmFyIE8gICAgICA9IHZhbGlkYXRlKHRoaXMpDQogICAgICAgICwgbGVuZ3RoID0gTy5sZW5ndGgNCiAgICAgICAgLCAkYmVnaW4gPSB0b0luZGV4KGJlZ2luLCBsZW5ndGgpOw0KICAgICAgcmV0dXJuIG5ldyAoc3BlY2llc0NvbnN0cnVjdG9yKE8sIE9bREVGX0NPTlNUUlVDVE9SXSkpKA0KICAgICAgICBPLmJ1ZmZlciwNCiAgICAgICAgTy5ieXRlT2Zmc2V0ICsgJGJlZ2luICogTy5CWVRFU19QRVJfRUxFTUVOVCwNCiAgICAgICAgdG9MZW5ndGgoKGVuZCA9PT0gdW5kZWZpbmVkID8gbGVuZ3RoIDogdG9JbmRleChlbmQsIGxlbmd0aCkpIC0gJGJlZ2luKQ0KICAgICAgKTsNCiAgICB9DQogIH07DQoNCiAgdmFyICRzbGljZSA9IGZ1bmN0aW9uIHNsaWNlKHN0YXJ0LCBlbmQpew0KICAgIHJldHVybiBzcGVjaWVzRnJvbUxpc3QodGhpcywgYXJyYXlTbGljZS5jYWxsKHZhbGlkYXRlKHRoaXMpLCBzdGFydCwgZW5kKSk7DQogIH07DQoNCiAgdmFyICRzZXQgPSBmdW5jdGlvbiBzZXQoYXJyYXlMaWtlIC8qLCBvZmZzZXQgKi8pew0KICAgIHZhbGlkYXRlKHRoaXMpOw0KICAgIHZhciBvZmZzZXQgPSB0b09mZnNldChhcmd1bWVudHNbMV0sIDEpDQogICAgICAsIGxlbmd0aCA9IHRoaXMubGVuZ3RoDQogICAgICAsIHNyYyAgICA9IHRvT2JqZWN0KGFycmF5TGlrZSkNCiAgICAgICwgbGVuICAgID0gdG9MZW5ndGgoc3JjLmxlbmd0aCkNCiAgICAgICwgaW5kZXggID0gMDsNCiAgICBpZihsZW4gKyBvZmZzZXQgPiBsZW5ndGgpdGhyb3cgUmFuZ2VFcnJvcihXUk9OR19MRU5HVEgpOw0KICAgIHdoaWxlKGluZGV4IDwgbGVuKXRoaXNbb2Zmc2V0ICsgaW5kZXhdID0gc3JjW2luZGV4KytdOw0KICB9Ow0KDQogIHZhciAkaXRlcmF0b3JzID0gew0KICAgIGVudHJpZXM6IGZ1bmN0aW9uIGVudHJpZXMoKXsNCiAgICAgIHJldHVybiBhcnJheUVudHJpZXMuY2FsbCh2YWxpZGF0ZSh0aGlzKSk7DQogICAgfSwNCiAgICBrZXlzOiBmdW5jdGlvbiBrZXlzKCl7DQogICAgICByZXR1cm4gYXJyYXlLZXlzLmNhbGwodmFsaWRhdGUodGhpcykpOw0KICAgIH0sDQogICAgdmFsdWVzOiBmdW5jdGlvbiB2YWx1ZXMoKXsNCiAgICAgIHJldHVybiBhcnJheVZhbHVlcy5jYWxsKHZhbGlkYXRlKHRoaXMpKTsNCiAgICB9DQogIH07DQoNCiAgdmFyIGlzVEFJbmRleCA9IGZ1bmN0aW9uKHRhcmdldCwga2V5KXsNCiAgICByZXR1cm4gaXNPYmplY3QodGFyZ2V0KQ0KICAgICAgJiYgdGFyZ2V0W1RZUEVEX0FSUkFZXQ0KICAgICAgJiYgdHlwZW9mIGtleSAhPSAnc3ltYm9sJw0KICAgICAgJiYga2V5IGluIHRhcmdldA0KICAgICAgJiYgU3RyaW5nKCtrZXkpID09IFN0cmluZyhrZXkpOw0KICB9Ow0KICB2YXIgJGdldERlc2MgPSBmdW5jdGlvbiBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpew0KICAgIHJldHVybiBpc1RBSW5kZXgodGFyZ2V0LCBrZXkgPSB0b1ByaW1pdGl2ZShrZXksIHRydWUpKQ0KICAgICAgPyBwcm9wZXJ0eURlc2MoMiwgdGFyZ2V0W2tleV0pDQogICAgICA6IGdPUEQodGFyZ2V0LCBrZXkpOw0KICB9Ow0KICB2YXIgJHNldERlc2MgPSBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgZGVzYyl7DQogICAgaWYoaXNUQUluZGV4KHRhcmdldCwga2V5ID0gdG9QcmltaXRpdmUoa2V5LCB0cnVlKSkNCiAgICAgICYmIGlzT2JqZWN0KGRlc2MpDQogICAgICAmJiBoYXMoZGVzYywgJ3ZhbHVlJykNCiAgICAgICYmICFoYXMoZGVzYywgJ2dldCcpDQogICAgICAmJiAhaGFzKGRlc2MsICdzZXQnKQ0KICAgICAgLy8gVE9ETzogYWRkIHZhbGlkYXRpb24gZGVzY3JpcHRvciB3L28gY2FsbGluZyBhY2Nlc3NvcnMNCiAgICAgICYmICFkZXNjLmNvbmZpZ3VyYWJsZQ0KICAgICAgJiYgKCFoYXMoZGVzYywgJ3dyaXRhYmxlJykgfHwgZGVzYy53cml0YWJsZSkNCiAgICAgICYmICghaGFzKGRlc2MsICdlbnVtZXJhYmxlJykgfHwgZGVzYy5lbnVtZXJhYmxlKQ0KICAgICl7DQogICAgICB0YXJnZXRba2V5XSA9IGRlc2MudmFsdWU7DQogICAgICByZXR1cm4gdGFyZ2V0Ow0KICAgIH0gZWxzZSByZXR1cm4gZFAodGFyZ2V0LCBrZXksIGRlc2MpOw0KICB9Ow0KDQogIGlmKCFBTExfQ09OU1RSVUNUT1JTKXsNCiAgICAkR09QRC5mID0gJGdldERlc2M7DQogICAgJERQLmYgICA9ICRzZXREZXNjOw0KICB9DQoNCiAgJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYgKiAhQUxMX0NPTlNUUlVDVE9SUywgJ09iamVjdCcsIHsNCiAgICBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3I6ICRnZXREZXNjLA0KICAgIGRlZmluZVByb3BlcnR5OiAgICAgICAgICAgJHNldERlc2MNCiAgfSk7DQoNCiAgaWYoZmFpbHMoZnVuY3Rpb24oKXsgYXJyYXlUb1N0cmluZy5jYWxsKHt9KTsgfSkpew0KICAgIGFycmF5VG9TdHJpbmcgPSBhcnJheVRvTG9jYWxlU3RyaW5nID0gZnVuY3Rpb24gdG9TdHJpbmcoKXsNCiAgICAgIHJldHVybiBhcnJheUpvaW4uY2FsbCh0aGlzKTsNCiAgICB9DQogIH0NCg0KICB2YXIgJFR5cGVkQXJyYXlQcm90b3R5cGUkID0gcmVkZWZpbmVBbGwoe30sIHByb3RvKTsNCiAgcmVkZWZpbmVBbGwoJFR5cGVkQXJyYXlQcm90b3R5cGUkLCAkaXRlcmF0b3JzKTsNCiAgaGlkZSgkVHlwZWRBcnJheVByb3RvdHlwZSQsIElURVJBVE9SLCAkaXRlcmF0b3JzLnZhbHVlcyk7DQogIHJlZGVmaW5lQWxsKCRUeXBlZEFycmF5UHJvdG90eXBlJCwgew0KICAgIHNsaWNlOiAgICAgICAgICAkc2xpY2UsDQogICAgc2V0OiAgICAgICAgICAgICRzZXQsDQogICAgY29uc3RydWN0b3I6ICAgIGZ1bmN0aW9uKCl7IC8qIG5vb3AgKi8gfSwNCiAgICB0b1N0cmluZzogICAgICAgYXJyYXlUb1N0cmluZywNCiAgICB0b0xvY2FsZVN0cmluZzogJHRvTG9jYWxlU3RyaW5nDQogIH0pOw0KICBhZGRHZXR0ZXIoJFR5cGVkQXJyYXlQcm90b3R5cGUkLCAnYnVmZmVyJywgJ2InKTsNCiAgYWRkR2V0dGVyKCRUeXBlZEFycmF5UHJvdG90eXBlJCwgJ2J5dGVPZmZzZXQnLCAnbycpOw0KICBhZGRHZXR0ZXIoJFR5cGVkQXJyYXlQcm90b3R5cGUkLCAnYnl0ZUxlbmd0aCcsICdsJyk7DQogIGFkZEdldHRlcigkVHlwZWRBcnJheVByb3RvdHlwZSQsICdsZW5ndGgnLCAnZScpOw0KICBkUCgkVHlwZWRBcnJheVByb3RvdHlwZSQsIFRBRywgew0KICAgIGdldDogZnVuY3Rpb24oKXsgcmV0dXJuIHRoaXNbVFlQRURfQVJSQVldOyB9DQogIH0pOw0KDQogIG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oS0VZLCBCWVRFUywgd3JhcHBlciwgQ0xBTVBFRCl7DQogICAgQ0xBTVBFRCA9ICEhQ0xBTVBFRDsNCiAgICB2YXIgTkFNRSAgICAgICA9IEtFWSArIChDTEFNUEVEID8gJ0NsYW1wZWQnIDogJycpICsgJ0FycmF5Jw0KICAgICAgLCBJU05UX1VJTlQ4ID0gTkFNRSAhPSAnVWludDhBcnJheScNCiAgICAgICwgR0VUVEVSICAgICA9ICdnZXQnICsgS0VZDQogICAgICAsIFNFVFRFUiAgICAgPSAnc2V0JyArIEtFWQ0KICAgICAgLCBUeXBlZEFycmF5ID0gZ2xvYmFsW05BTUVdDQogICAgICAsIEJhc2UgICAgICAgPSBUeXBlZEFycmF5IHx8IHt9DQogICAgICAsIFRBQyAgICAgICAgPSBUeXBlZEFycmF5ICYmIGdldFByb3RvdHlwZU9mKFR5cGVkQXJyYXkpDQogICAgICAsIEZPUkNFRCAgICAgPSAhVHlwZWRBcnJheSB8fCAhJHR5cGVkLkFCVg0KICAgICAgLCBPICAgICAgICAgID0ge30NCiAgICAgICwgVHlwZWRBcnJheVByb3RvdHlwZSA9IFR5cGVkQXJyYXkgJiYgVHlwZWRBcnJheVtQUk9UT1RZUEVdOw0KICAgIHZhciBnZXR0ZXIgPSBmdW5jdGlvbih0aGF0LCBpbmRleCl7DQogICAgICB2YXIgZGF0YSA9IHRoYXQuX2Q7DQogICAgICByZXR1cm4gZGF0YS52W0dFVFRFUl0oaW5kZXggKiBCWVRFUyArIGRhdGEubywgTElUVExFX0VORElBTik7DQogICAgfTsNCiAgICB2YXIgc2V0dGVyID0gZnVuY3Rpb24odGhhdCwgaW5kZXgsIHZhbHVlKXsNCiAgICAgIHZhciBkYXRhID0gdGhhdC5fZDsNCiAgICAgIGlmKENMQU1QRUQpdmFsdWUgPSAodmFsdWUgPSBNYXRoLnJvdW5kKHZhbHVlKSkgPCAwID8gMCA6IHZhbHVlID4gMHhmZiA/IDB4ZmYgOiB2YWx1ZSAmIDB4ZmY7DQogICAgICBkYXRhLnZbU0VUVEVSXShpbmRleCAqIEJZVEVTICsgZGF0YS5vLCB2YWx1ZSwgTElUVExFX0VORElBTik7DQogICAgfTsNCiAgICB2YXIgYWRkRWxlbWVudCA9IGZ1bmN0aW9uKHRoYXQsIGluZGV4KXsNCiAgICAgIGRQKHRoYXQsIGluZGV4LCB7DQogICAgICAgIGdldDogZnVuY3Rpb24oKXsNCiAgICAgICAgICByZXR1cm4gZ2V0dGVyKHRoaXMsIGluZGV4KTsNCiAgICAgICAgfSwNCiAgICAgICAgc2V0OiBmdW5jdGlvbih2YWx1ZSl7DQogICAgICAgICAgcmV0dXJuIHNldHRlcih0aGlzLCBpbmRleCwgdmFsdWUpOw0KICAgICAgICB9LA0KICAgICAgICBlbnVtZXJhYmxlOiB0cnVlDQogICAgICB9KTsNCiAgICB9Ow0KICAgIGlmKEZPUkNFRCl7DQogICAgICBUeXBlZEFycmF5ID0gd3JhcHBlcihmdW5jdGlvbih0aGF0LCBkYXRhLCAkb2Zmc2V0LCAkbGVuZ3RoKXsNCiAgICAgICAgYW5JbnN0YW5jZSh0aGF0LCBUeXBlZEFycmF5LCBOQU1FLCAnX2QnKTsNCiAgICAgICAgdmFyIGluZGV4ICA9IDANCiAgICAgICAgICAsIG9mZnNldCA9IDANCiAgICAgICAgICAsIGJ1ZmZlciwgYnl0ZUxlbmd0aCwgbGVuZ3RoLCBrbGFzczsNCiAgICAgICAgaWYoIWlzT2JqZWN0KGRhdGEpKXsNCiAgICAgICAgICBsZW5ndGggICAgID0gc3RyaWN0VG9MZW5ndGgoZGF0YSwgdHJ1ZSkNCiAgICAgICAgICBieXRlTGVuZ3RoID0gbGVuZ3RoICogQllURVM7DQogICAgICAgICAgYnVmZmVyICAgICA9IG5ldyAkQXJyYXlCdWZmZXIoYnl0ZUxlbmd0aCk7DQogICAgICAgIH0gZWxzZSBpZihkYXRhIGluc3RhbmNlb2YgJEFycmF5QnVmZmVyIHx8IChrbGFzcyA9IGNsYXNzb2YoZGF0YSkpID09IEFSUkFZX0JVRkZFUiB8fCBrbGFzcyA9PSBTSEFSRURfQlVGRkVSKXsNCiAgICAgICAgICBidWZmZXIgPSBkYXRhOw0KICAgICAgICAgIG9mZnNldCA9IHRvT2Zmc2V0KCRvZmZzZXQsIEJZVEVTKTsNCiAgICAgICAgICB2YXIgJGxlbiA9IGRhdGEuYnl0ZUxlbmd0aDsNCiAgICAgICAgICBpZigkbGVuZ3RoID09PSB1bmRlZmluZWQpew0KICAgICAgICAgICAgaWYoJGxlbiAlIEJZVEVTKXRocm93IFJhbmdlRXJyb3IoV1JPTkdfTEVOR1RIKTsNCiAgICAgICAgICAgIGJ5dGVMZW5ndGggPSAkbGVuIC0gb2Zmc2V0Ow0KICAgICAgICAgICAgaWYoYnl0ZUxlbmd0aCA8IDApdGhyb3cgUmFuZ2VFcnJvcihXUk9OR19MRU5HVEgpOw0KICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBieXRlTGVuZ3RoID0gdG9MZW5ndGgoJGxlbmd0aCkgKiBCWVRFUzsNCiAgICAgICAgICAgIGlmKGJ5dGVMZW5ndGggKyBvZmZzZXQgPiAkbGVuKXRocm93IFJhbmdlRXJyb3IoV1JPTkdfTEVOR1RIKTsNCiAgICAgICAgICB9DQogICAgICAgICAgbGVuZ3RoID0gYnl0ZUxlbmd0aCAvIEJZVEVTOw0KICAgICAgICB9IGVsc2UgaWYoVFlQRURfQVJSQVkgaW4gZGF0YSl7DQogICAgICAgICAgcmV0dXJuIGZyb21MaXN0KFR5cGVkQXJyYXksIGRhdGEpOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgIHJldHVybiAkZnJvbS5jYWxsKFR5cGVkQXJyYXksIGRhdGEpOw0KICAgICAgICB9DQogICAgICAgIGhpZGUodGhhdCwgJ19kJywgew0KICAgICAgICAgIGI6IGJ1ZmZlciwNCiAgICAgICAgICBvOiBvZmZzZXQsDQogICAgICAgICAgbDogYnl0ZUxlbmd0aCwNCiAgICAgICAgICBlOiBsZW5ndGgsDQogICAgICAgICAgdjogbmV3ICREYXRhVmlldyhidWZmZXIpDQogICAgICAgIH0pOw0KICAgICAgICB3aGlsZShpbmRleCA8IGxlbmd0aClhZGRFbGVtZW50KHRoYXQsIGluZGV4KyspOw0KICAgICAgfSk7DQogICAgICBUeXBlZEFycmF5UHJvdG90eXBlID0gVHlwZWRBcnJheVtQUk9UT1RZUEVdID0gY3JlYXRlKCRUeXBlZEFycmF5UHJvdG90eXBlJCk7DQogICAgICBoaWRlKFR5cGVkQXJyYXlQcm90b3R5cGUsICdjb25zdHJ1Y3RvcicsIFR5cGVkQXJyYXkpOw0KICAgIH0gZWxzZSBpZighJGl0ZXJEZXRlY3QoZnVuY3Rpb24oaXRlcil7DQogICAgICAvLyBWOCB3b3JrcyB3aXRoIGl0ZXJhdG9ycywgYnV0IGZhaWxzIGluIG1hbnkgb3RoZXIgY2FzZXMNCiAgICAgIC8vIGh0dHBzOi8vY29kZS5nb29nbGUuY29tL3AvdjgvaXNzdWVzL2RldGFpbD9pZD00NTUyDQogICAgICBuZXcgVHlwZWRBcnJheShudWxsKTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1uZXcNCiAgICAgIG5ldyBUeXBlZEFycmF5KGl0ZXIpOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLW5ldw0KICAgIH0sIHRydWUpKXsNCiAgICAgIFR5cGVkQXJyYXkgPSB3cmFwcGVyKGZ1bmN0aW9uKHRoYXQsIGRhdGEsICRvZmZzZXQsICRsZW5ndGgpew0KICAgICAgICBhbkluc3RhbmNlKHRoYXQsIFR5cGVkQXJyYXksIE5BTUUpOw0KICAgICAgICB2YXIga2xhc3M7DQogICAgICAgIC8vIGB3c2AgbW9kdWxlIGJ1ZywgdGVtcG9yYXJpbHkgcmVtb3ZlIHZhbGlkYXRpb24gbGVuZ3RoIGZvciBVaW50OEFycmF5DQogICAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS93ZWJzb2NrZXRzL3dzL3B1bGwvNjQ1DQogICAgICAgIGlmKCFpc09iamVjdChkYXRhKSlyZXR1cm4gbmV3IEJhc2Uoc3RyaWN0VG9MZW5ndGgoZGF0YSwgSVNOVF9VSU5UOCkpOw0KICAgICAgICBpZihkYXRhIGluc3RhbmNlb2YgJEFycmF5QnVmZmVyIHx8IChrbGFzcyA9IGNsYXNzb2YoZGF0YSkpID09IEFSUkFZX0JVRkZFUiB8fCBrbGFzcyA9PSBTSEFSRURfQlVGRkVSKXsNCiAgICAgICAgICByZXR1cm4gJGxlbmd0aCAhPT0gdW5kZWZpbmVkDQogICAgICAgICAgICA/IG5ldyBCYXNlKGRhdGEsIHRvT2Zmc2V0KCRvZmZzZXQsIEJZVEVTKSwgJGxlbmd0aCkNCiAgICAgICAgICAgIDogJG9mZnNldCAhPT0gdW5kZWZpbmVkDQogICAgICAgICAgICAgID8gbmV3IEJhc2UoZGF0YSwgdG9PZmZzZXQoJG9mZnNldCwgQllURVMpKQ0KICAgICAgICAgICAgICA6IG5ldyBCYXNlKGRhdGEpOw0KICAgICAgICB9DQogICAgICAgIGlmKFRZUEVEX0FSUkFZIGluIGRhdGEpcmV0dXJuIGZyb21MaXN0KFR5cGVkQXJyYXksIGRhdGEpOw0KICAgICAgICByZXR1cm4gJGZyb20uY2FsbChUeXBlZEFycmF5LCBkYXRhKTsNCiAgICAgIH0pOw0KICAgICAgYXJyYXlGb3JFYWNoKFRBQyAhPT0gRnVuY3Rpb24ucHJvdG90eXBlID8gZ09QTihCYXNlKS5jb25jYXQoZ09QTihUQUMpKSA6IGdPUE4oQmFzZSksIGZ1bmN0aW9uKGtleSl7DQogICAgICAgIGlmKCEoa2V5IGluIFR5cGVkQXJyYXkpKWhpZGUoVHlwZWRBcnJheSwga2V5LCBCYXNlW2tleV0pOw0KICAgICAgfSk7DQogICAgICBUeXBlZEFycmF5W1BST1RPVFlQRV0gPSBUeXBlZEFycmF5UHJvdG90eXBlOw0KICAgICAgaWYoIUxJQlJBUlkpVHlwZWRBcnJheVByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IFR5cGVkQXJyYXk7DQogICAgfQ0KICAgIHZhciAkbmF0aXZlSXRlcmF0b3IgICA9IFR5cGVkQXJyYXlQcm90b3R5cGVbSVRFUkFUT1JdDQogICAgICAsIENPUlJFQ1RfSVRFUl9OQU1FID0gISEkbmF0aXZlSXRlcmF0b3IgJiYgKCRuYXRpdmVJdGVyYXRvci5uYW1lID09ICd2YWx1ZXMnIHx8ICRuYXRpdmVJdGVyYXRvci5uYW1lID09IHVuZGVmaW5lZCkNCiAgICAgICwgJGl0ZXJhdG9yICAgICAgICAgPSAkaXRlcmF0b3JzLnZhbHVlczsNCiAgICBoaWRlKFR5cGVkQXJyYXksIFRZUEVEX0NPTlNUUlVDVE9SLCB0cnVlKTsNCiAgICBoaWRlKFR5cGVkQXJyYXlQcm90b3R5cGUsIFRZUEVEX0FSUkFZLCBOQU1FKTsNCiAgICBoaWRlKFR5cGVkQXJyYXlQcm90b3R5cGUsIFZJRVcsIHRydWUpOw0KICAgIGhpZGUoVHlwZWRBcnJheVByb3RvdHlwZSwgREVGX0NPTlNUUlVDVE9SLCBUeXBlZEFycmF5KTsNCg0KICAgIGlmKENMQU1QRUQgPyBuZXcgVHlwZWRBcnJheSgxKVtUQUddICE9IE5BTUUgOiAhKFRBRyBpbiBUeXBlZEFycmF5UHJvdG90eXBlKSl7DQogICAgICBkUChUeXBlZEFycmF5UHJvdG90eXBlLCBUQUcsIHsNCiAgICAgICAgZ2V0OiBmdW5jdGlvbigpeyByZXR1cm4gTkFNRTsgfQ0KICAgICAgfSk7DQogICAgfQ0KDQogICAgT1tOQU1FXSA9IFR5cGVkQXJyYXk7DQoNCiAgICAkZXhwb3J0KCRleHBvcnQuRyArICRleHBvcnQuVyArICRleHBvcnQuRiAqIChUeXBlZEFycmF5ICE9IEJhc2UpLCBPKTsNCg0KICAgICRleHBvcnQoJGV4cG9ydC5TLCBOQU1FLCB7DQogICAgICBCWVRFU19QRVJfRUxFTUVOVDogQllURVMsDQogICAgICBmcm9tOiAkZnJvbSwNCiAgICAgIG9mOiAkb2YNCiAgICB9KTsNCg0KICAgIGlmKCEoQllURVNfUEVSX0VMRU1FTlQgaW4gVHlwZWRBcnJheVByb3RvdHlwZSkpaGlkZShUeXBlZEFycmF5UHJvdG90eXBlLCBCWVRFU19QRVJfRUxFTUVOVCwgQllURVMpOw0KDQogICAgJGV4cG9ydCgkZXhwb3J0LlAsIE5BTUUsIHByb3RvKTsNCg0KICAgIHNldFNwZWNpZXMoTkFNRSk7DQoNCiAgICAkZXhwb3J0KCRleHBvcnQuUCArICRleHBvcnQuRiAqIEZPUkNFRF9TRVQsIE5BTUUsIHtzZXQ6ICRzZXR9KTsNCg0KICAgICRleHBvcnQoJGV4cG9ydC5QICsgJGV4cG9ydC5GICogIUNPUlJFQ1RfSVRFUl9OQU1FLCBOQU1FLCAkaXRlcmF0b3JzKTsNCg0KICAgICRleHBvcnQoJGV4cG9ydC5QICsgJGV4cG9ydC5GICogKFR5cGVkQXJyYXlQcm90b3R5cGUudG9TdHJpbmcgIT0gYXJyYXlUb1N0cmluZyksIE5BTUUsIHt0b1N0cmluZzogYXJyYXlUb1N0cmluZ30pOw0KDQogICAgJGV4cG9ydCgkZXhwb3J0LlAgKyAkZXhwb3J0LkYgKiBmYWlscyhmdW5jdGlvbigpew0KICAgICAgbmV3IFR5cGVkQXJyYXkoMSkuc2xpY2UoKTsNCiAgICB9KSwgTkFNRSwge3NsaWNlOiAkc2xpY2V9KTsNCg0KICAgICRleHBvcnQoJGV4cG9ydC5QICsgJGV4cG9ydC5GICogKGZhaWxzKGZ1bmN0aW9uKCl7DQogICAgICByZXR1cm4gWzEsIDJdLnRvTG9jYWxlU3RyaW5nKCkgIT0gbmV3IFR5cGVkQXJyYXkoWzEsIDJdKS50b0xvY2FsZVN0cmluZygpDQogICAgfSkgfHwgIWZhaWxzKGZ1bmN0aW9uKCl7DQogICAgICBUeXBlZEFycmF5UHJvdG90eXBlLnRvTG9jYWxlU3RyaW5nLmNhbGwoWzEsIDJdKTsNCiAgICB9KSksIE5BTUUsIHt0b0xvY2FsZVN0cmluZzogJHRvTG9jYWxlU3RyaW5nfSk7DQoNCiAgICBJdGVyYXRvcnNbTkFNRV0gPSBDT1JSRUNUX0lURVJfTkFNRSA/ICRuYXRpdmVJdGVyYXRvciA6ICRpdGVyYXRvcjsNCiAgICBpZighTElCUkFSWSAmJiAhQ09SUkVDVF9JVEVSX05BTUUpaGlkZShUeXBlZEFycmF5UHJvdG90eXBlLCBJVEVSQVRPUiwgJGl0ZXJhdG9yKTsNCiAgfTsNCn0gZWxzZSBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKCl7IC8qIGVtcHR5ICovIH07DQp9LHsiLi9fYW4taW5zdGFuY2UiOjYsIi4vX2FycmF5LWNvcHktd2l0aGluIjo4LCIuL19hcnJheS1maWxsIjo5LCIuL19hcnJheS1pbmNsdWRlcyI6MTEsIi4vX2FycmF5LW1ldGhvZHMiOjEyLCIuL19jbGFzc29mIjoxNywiLi9fY3R4IjoyNSwiLi9fZGVzY3JpcHRvcnMiOjI4LCIuL19leHBvcnQiOjMyLCIuL19mYWlscyI6MzQsIi4vX2dsb2JhbCI6MzgsIi4vX2hhcyI6MzksIi4vX2hpZGUiOjQwLCIuL19pcy1hcnJheS1pdGVyIjo0NiwiLi9faXMtaW50ZWdlciI6NDgsIi4vX2lzLW9iamVjdCI6NDksIi4vX2l0ZXItZGV0ZWN0Ijo1NCwiLi9faXRlcmF0b3JzIjo1NiwiLi9fbGlicmFyeSI6NTgsIi4vX29iamVjdC1jcmVhdGUiOjY2LCIuL19vYmplY3QtZHAiOjY3LCIuL19vYmplY3QtZ29wZCI6NzAsIi4vX29iamVjdC1nb3BuIjo3MiwiLi9fb2JqZWN0LWdwbyI6NzQsIi4vX3Byb3BlcnR5LWRlc2MiOjg1LCIuL19yZWRlZmluZS1hbGwiOjg2LCIuL19zYW1lLXZhbHVlIjo4OSwiLi9fc2V0LXNwZWNpZXMiOjkxLCIuL19zcGVjaWVzLWNvbnN0cnVjdG9yIjo5NSwiLi9fdG8taW5kZXgiOjEwNSwiLi9fdG8taW50ZWdlciI6MTA2LCIuL190by1sZW5ndGgiOjEwOCwiLi9fdG8tb2JqZWN0IjoxMDksIi4vX3RvLXByaW1pdGl2ZSI6MTEwLCIuL190eXBlZCI6MTEzLCIuL190eXBlZC1idWZmZXIiOjExMiwiLi9fdWlkIjoxMTQsIi4vX3drcyI6MTE3LCIuL2NvcmUuZ2V0LWl0ZXJhdG9yLW1ldGhvZCI6MTE4LCIuL2NvcmUuaXMtaXRlcmFibGUiOjExOSwiLi9lczYuYXJyYXkuaXRlcmF0b3IiOjEzMX1dLDExMjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQondXNlIHN0cmljdCc7DQp2YXIgZ2xvYmFsICAgICAgICAgPSByZXF1aXJlKCcuL19nbG9iYWwnKQ0KICAsIERFU0NSSVBUT1JTICAgID0gcmVxdWlyZSgnLi9fZGVzY3JpcHRvcnMnKQ0KICAsIExJQlJBUlkgICAgICAgID0gcmVxdWlyZSgnLi9fbGlicmFyeScpDQogICwgJHR5cGVkICAgICAgICAgPSByZXF1aXJlKCcuL190eXBlZCcpDQogICwgaGlkZSAgICAgICAgICAgPSByZXF1aXJlKCcuL19oaWRlJykNCiAgLCByZWRlZmluZUFsbCAgICA9IHJlcXVpcmUoJy4vX3JlZGVmaW5lLWFsbCcpDQogICwgZmFpbHMgICAgICAgICAgPSByZXF1aXJlKCcuL19mYWlscycpDQogICwgYW5JbnN0YW5jZSAgICAgPSByZXF1aXJlKCcuL19hbi1pbnN0YW5jZScpDQogICwgdG9JbnRlZ2VyICAgICAgPSByZXF1aXJlKCcuL190by1pbnRlZ2VyJykNCiAgLCB0b0xlbmd0aCAgICAgICA9IHJlcXVpcmUoJy4vX3RvLWxlbmd0aCcpDQogICwgZ09QTiAgICAgICAgICAgPSByZXF1aXJlKCcuL19vYmplY3QtZ29wbicpLmYNCiAgLCBkUCAgICAgICAgICAgICA9IHJlcXVpcmUoJy4vX29iamVjdC1kcCcpLmYNCiAgLCBhcnJheUZpbGwgICAgICA9IHJlcXVpcmUoJy4vX2FycmF5LWZpbGwnKQ0KICAsIHNldFRvU3RyaW5nVGFnID0gcmVxdWlyZSgnLi9fc2V0LXRvLXN0cmluZy10YWcnKQ0KICAsIEFSUkFZX0JVRkZFUiAgID0gJ0FycmF5QnVmZmVyJw0KICAsIERBVEFfVklFVyAgICAgID0gJ0RhdGFWaWV3Jw0KICAsIFBST1RPVFlQRSAgICAgID0gJ3Byb3RvdHlwZScNCiAgLCBXUk9OR19MRU5HVEggICA9ICdXcm9uZyBsZW5ndGghJw0KICAsIFdST05HX0lOREVYICAgID0gJ1dyb25nIGluZGV4IScNCiAgLCAkQXJyYXlCdWZmZXIgICA9IGdsb2JhbFtBUlJBWV9CVUZGRVJdDQogICwgJERhdGFWaWV3ICAgICAgPSBnbG9iYWxbREFUQV9WSUVXXQ0KICAsIE1hdGggICAgICAgICAgID0gZ2xvYmFsLk1hdGgNCiAgLCBwYXJzZUludCAgICAgICA9IGdsb2JhbC5wYXJzZUludA0KICAsIFJhbmdlRXJyb3IgICAgID0gZ2xvYmFsLlJhbmdlRXJyb3INCiAgLCBJbmZpbml0eSAgICAgICA9IGdsb2JhbC5JbmZpbml0eQ0KICAsIEJhc2VCdWZmZXIgICAgID0gJEFycmF5QnVmZmVyDQogICwgYWJzICAgICAgICAgICAgPSBNYXRoLmFicw0KICAsIHBvdyAgICAgICAgICAgID0gTWF0aC5wb3cNCiAgLCBtaW4gICAgICAgICAgICA9IE1hdGgubWluDQogICwgZmxvb3IgICAgICAgICAgPSBNYXRoLmZsb29yDQogICwgbG9nICAgICAgICAgICAgPSBNYXRoLmxvZw0KICAsIExOMiAgICAgICAgICAgID0gTWF0aC5MTjINCiAgLCBCVUZGRVIgICAgICAgICA9ICdidWZmZXInDQogICwgQllURV9MRU5HVEggICAgPSAnYnl0ZUxlbmd0aCcNCiAgLCBCWVRFX09GRlNFVCAgICA9ICdieXRlT2Zmc2V0Jw0KICAsICRCVUZGRVIgICAgICAgID0gREVTQ1JJUFRPUlMgPyAnX2InIDogQlVGRkVSDQogICwgJExFTkdUSCAgICAgICAgPSBERVNDUklQVE9SUyA/ICdfbCcgOiBCWVRFX0xFTkdUSA0KICAsICRPRkZTRVQgICAgICAgID0gREVTQ1JJUFRPUlMgPyAnX28nIDogQllURV9PRkZTRVQ7DQoNCi8vIElFRUU3NTQgY29udmVyc2lvbnMgYmFzZWQgb24gaHR0cHM6Ly9naXRodWIuY29tL2Zlcm9zcy9pZWVlNzU0DQp2YXIgcGFja0lFRUU3NTQgPSBmdW5jdGlvbih2YWx1ZSwgbUxlbiwgbkJ5dGVzKXsNCiAgdmFyIGJ1ZmZlciA9IEFycmF5KG5CeXRlcykNCiAgICAsIGVMZW4gICA9IG5CeXRlcyAqIDggLSBtTGVuIC0gMQ0KICAgICwgZU1heCAgID0gKDEgPDwgZUxlbikgLSAxDQogICAgLCBlQmlhcyAgPSBlTWF4ID4+IDENCiAgICAsIHJ0ICAgICA9IG1MZW4gPT09IDIzID8gcG93KDIsIC0yNCkgLSBwb3coMiwgLTc3KSA6IDANCiAgICAsIGkgICAgICA9IDANCiAgICAsIHMgICAgICA9IHZhbHVlIDwgMCB8fCB2YWx1ZSA9PT0gMCAmJiAxIC8gdmFsdWUgPCAwID8gMSA6IDANCiAgICAsIGUsIG0sIGM7DQogIHZhbHVlID0gYWJzKHZhbHVlKQ0KICBpZih2YWx1ZSAhPSB2YWx1ZSB8fCB2YWx1ZSA9PT0gSW5maW5pdHkpew0KICAgIG0gPSB2YWx1ZSAhPSB2YWx1ZSA/IDEgOiAwOw0KICAgIGUgPSBlTWF4Ow0KICB9IGVsc2Ugew0KICAgIGUgPSBmbG9vcihsb2codmFsdWUpIC8gTE4yKTsNCiAgICBpZih2YWx1ZSAqIChjID0gcG93KDIsIC1lKSkgPCAxKXsNCiAgICAgIGUtLTsNCiAgICAgIGMgKj0gMjsNCiAgICB9DQogICAgaWYoZSArIGVCaWFzID49IDEpew0KICAgICAgdmFsdWUgKz0gcnQgLyBjOw0KICAgIH0gZWxzZSB7DQogICAgICB2YWx1ZSArPSBydCAqIHBvdygyLCAxIC0gZUJpYXMpOw0KICAgIH0NCiAgICBpZih2YWx1ZSAqIGMgPj0gMil7DQogICAgICBlKys7DQogICAgICBjIC89IDI7DQogICAgfQ0KICAgIGlmKGUgKyBlQmlhcyA+PSBlTWF4KXsNCiAgICAgIG0gPSAwOw0KICAgICAgZSA9IGVNYXg7DQogICAgfSBlbHNlIGlmKGUgKyBlQmlhcyA+PSAxKXsNCiAgICAgIG0gPSAodmFsdWUgKiBjIC0gMSkgKiBwb3coMiwgbUxlbik7DQogICAgICBlID0gZSArIGVCaWFzOw0KICAgIH0gZWxzZSB7DQogICAgICBtID0gdmFsdWUgKiBwb3coMiwgZUJpYXMgLSAxKSAqIHBvdygyLCBtTGVuKTsNCiAgICAgIGUgPSAwOw0KICAgIH0NCiAgfQ0KICBmb3IoOyBtTGVuID49IDg7IGJ1ZmZlcltpKytdID0gbSAmIDI1NSwgbSAvPSAyNTYsIG1MZW4gLT0gOCk7DQogIGUgPSBlIDw8IG1MZW4gfCBtOw0KICBlTGVuICs9IG1MZW47DQogIGZvcig7IGVMZW4gPiAwOyBidWZmZXJbaSsrXSA9IGUgJiAyNTUsIGUgLz0gMjU2LCBlTGVuIC09IDgpOw0KICBidWZmZXJbLS1pXSB8PSBzICogMTI4Ow0KICByZXR1cm4gYnVmZmVyOw0KfTsNCnZhciB1bnBhY2tJRUVFNzU0ID0gZnVuY3Rpb24oYnVmZmVyLCBtTGVuLCBuQnl0ZXMpew0KICB2YXIgZUxlbiAgPSBuQnl0ZXMgKiA4IC0gbUxlbiAtIDENCiAgICAsIGVNYXggID0gKDEgPDwgZUxlbikgLSAxDQogICAgLCBlQmlhcyA9IGVNYXggPj4gMQ0KICAgICwgbkJpdHMgPSBlTGVuIC0gNw0KICAgICwgaSAgICAgPSBuQnl0ZXMgLSAxDQogICAgLCBzICAgICA9IGJ1ZmZlcltpLS1dDQogICAgLCBlICAgICA9IHMgJiAxMjcNCiAgICAsIG07DQogIHMgPj49IDc7DQogIGZvcig7IG5CaXRzID4gMDsgZSA9IGUgKiAyNTYgKyBidWZmZXJbaV0sIGktLSwgbkJpdHMgLT0gOCk7DQogIG0gPSBlICYgKDEgPDwgLW5CaXRzKSAtIDE7DQogIGUgPj49IC1uQml0czsNCiAgbkJpdHMgKz0gbUxlbjsNCiAgZm9yKDsgbkJpdHMgPiAwOyBtID0gbSAqIDI1NiArIGJ1ZmZlcltpXSwgaS0tLCBuQml0cyAtPSA4KTsNCiAgaWYoZSA9PT0gMCl7DQogICAgZSA9IDEgLSBlQmlhczsNCiAgfSBlbHNlIGlmKGUgPT09IGVNYXgpew0KICAgIHJldHVybiBtID8gTmFOIDogcyA/IC1JbmZpbml0eSA6IEluZmluaXR5Ow0KICB9IGVsc2Ugew0KICAgIG0gPSBtICsgcG93KDIsIG1MZW4pOw0KICAgIGUgPSBlIC0gZUJpYXM7DQogIH0gcmV0dXJuIChzID8gLTEgOiAxKSAqIG0gKiBwb3coMiwgZSAtIG1MZW4pOw0KfTsNCg0KdmFyIHVucGFja0kzMiA9IGZ1bmN0aW9uKGJ5dGVzKXsNCiAgcmV0dXJuIGJ5dGVzWzNdIDw8IDI0IHwgYnl0ZXNbMl0gPDwgMTYgfCBieXRlc1sxXSA8PCA4IHwgYnl0ZXNbMF07DQp9Ow0KdmFyIHBhY2tJOCA9IGZ1bmN0aW9uKGl0KXsNCiAgcmV0dXJuIFtpdCAmIDB4ZmZdOw0KfTsNCnZhciBwYWNrSTE2ID0gZnVuY3Rpb24oaXQpew0KICByZXR1cm4gW2l0ICYgMHhmZiwgaXQgPj4gOCAmIDB4ZmZdOw0KfTsNCnZhciBwYWNrSTMyID0gZnVuY3Rpb24oaXQpew0KICByZXR1cm4gW2l0ICYgMHhmZiwgaXQgPj4gOCAmIDB4ZmYsIGl0ID4+IDE2ICYgMHhmZiwgaXQgPj4gMjQgJiAweGZmXTsNCn07DQp2YXIgcGFja0Y2NCA9IGZ1bmN0aW9uKGl0KXsNCiAgcmV0dXJuIHBhY2tJRUVFNzU0KGl0LCA1MiwgOCk7DQp9Ow0KdmFyIHBhY2tGMzIgPSBmdW5jdGlvbihpdCl7DQogIHJldHVybiBwYWNrSUVFRTc1NChpdCwgMjMsIDQpOw0KfTsNCg0KdmFyIGFkZEdldHRlciA9IGZ1bmN0aW9uKEMsIGtleSwgaW50ZXJuYWwpew0KICBkUChDW1BST1RPVFlQRV0sIGtleSwge2dldDogZnVuY3Rpb24oKXsgcmV0dXJuIHRoaXNbaW50ZXJuYWxdOyB9fSk7DQp9Ow0KDQp2YXIgZ2V0ID0gZnVuY3Rpb24odmlldywgYnl0ZXMsIGluZGV4LCBpc0xpdHRsZUVuZGlhbil7DQogIHZhciBudW1JbmRleCA9ICtpbmRleA0KICAgICwgaW50SW5kZXggPSB0b0ludGVnZXIobnVtSW5kZXgpOw0KICBpZihudW1JbmRleCAhPSBpbnRJbmRleCB8fCBpbnRJbmRleCA8IDAgfHwgaW50SW5kZXggKyBieXRlcyA+IHZpZXdbJExFTkdUSF0pdGhyb3cgUmFuZ2VFcnJvcihXUk9OR19JTkRFWCk7DQogIHZhciBzdG9yZSA9IHZpZXdbJEJVRkZFUl0uX2INCiAgICAsIHN0YXJ0ID0gaW50SW5kZXggKyB2aWV3WyRPRkZTRVRdDQogICAgLCBwYWNrICA9IHN0b3JlLnNsaWNlKHN0YXJ0LCBzdGFydCArIGJ5dGVzKTsNCiAgcmV0dXJuIGlzTGl0dGxlRW5kaWFuID8gcGFjayA6IHBhY2sucmV2ZXJzZSgpOw0KfTsNCnZhciBzZXQgPSBmdW5jdGlvbih2aWV3LCBieXRlcywgaW5kZXgsIGNvbnZlcnNpb24sIHZhbHVlLCBpc0xpdHRsZUVuZGlhbil7DQogIHZhciBudW1JbmRleCA9ICtpbmRleA0KICAgICwgaW50SW5kZXggPSB0b0ludGVnZXIobnVtSW5kZXgpOw0KICBpZihudW1JbmRleCAhPSBpbnRJbmRleCB8fCBpbnRJbmRleCA8IDAgfHwgaW50SW5kZXggKyBieXRlcyA+IHZpZXdbJExFTkdUSF0pdGhyb3cgUmFuZ2VFcnJvcihXUk9OR19JTkRFWCk7DQogIHZhciBzdG9yZSA9IHZpZXdbJEJVRkZFUl0uX2INCiAgICAsIHN0YXJ0ID0gaW50SW5kZXggKyB2aWV3WyRPRkZTRVRdDQogICAgLCBwYWNrICA9IGNvbnZlcnNpb24oK3ZhbHVlKTsNCiAgZm9yKHZhciBpID0gMDsgaSA8IGJ5dGVzOyBpKyspc3RvcmVbc3RhcnQgKyBpXSA9IHBhY2tbaXNMaXR0bGVFbmRpYW4gPyBpIDogYnl0ZXMgLSBpIC0gMV07DQp9Ow0KDQp2YXIgdmFsaWRhdGVBcnJheUJ1ZmZlckFyZ3VtZW50cyA9IGZ1bmN0aW9uKHRoYXQsIGxlbmd0aCl7DQogIGFuSW5zdGFuY2UodGhhdCwgJEFycmF5QnVmZmVyLCBBUlJBWV9CVUZGRVIpOw0KICB2YXIgbnVtYmVyTGVuZ3RoID0gK2xlbmd0aA0KICAgICwgYnl0ZUxlbmd0aCAgID0gdG9MZW5ndGgobnVtYmVyTGVuZ3RoKTsNCiAgaWYobnVtYmVyTGVuZ3RoICE9IGJ5dGVMZW5ndGgpdGhyb3cgUmFuZ2VFcnJvcihXUk9OR19MRU5HVEgpOw0KICByZXR1cm4gYnl0ZUxlbmd0aDsNCn07DQoNCmlmKCEkdHlwZWQuQUJWKXsNCiAgJEFycmF5QnVmZmVyID0gZnVuY3Rpb24gQXJyYXlCdWZmZXIobGVuZ3RoKXsNCiAgICB2YXIgYnl0ZUxlbmd0aCA9IHZhbGlkYXRlQXJyYXlCdWZmZXJBcmd1bWVudHModGhpcywgbGVuZ3RoKTsNCiAgICB0aGlzLl9iICAgICAgID0gYXJyYXlGaWxsLmNhbGwoQXJyYXkoYnl0ZUxlbmd0aCksIDApOw0KICAgIHRoaXNbJExFTkdUSF0gPSBieXRlTGVuZ3RoOw0KICB9Ow0KDQogICREYXRhVmlldyA9IGZ1bmN0aW9uIERhdGFWaWV3KGJ1ZmZlciwgYnl0ZU9mZnNldCwgYnl0ZUxlbmd0aCl7DQogICAgYW5JbnN0YW5jZSh0aGlzLCAkRGF0YVZpZXcsIERBVEFfVklFVyk7DQogICAgYW5JbnN0YW5jZShidWZmZXIsICRBcnJheUJ1ZmZlciwgREFUQV9WSUVXKTsNCiAgICB2YXIgYnVmZmVyTGVuZ3RoID0gYnVmZmVyWyRMRU5HVEhdDQogICAgICAsIG9mZnNldCAgICAgICA9IHRvSW50ZWdlcihieXRlT2Zmc2V0KTsNCiAgICBpZihvZmZzZXQgPCAwIHx8IG9mZnNldCA+IGJ1ZmZlckxlbmd0aCl0aHJvdyBSYW5nZUVycm9yKCdXcm9uZyBvZmZzZXQhJyk7DQogICAgYnl0ZUxlbmd0aCA9IGJ5dGVMZW5ndGggPT09IHVuZGVmaW5lZCA/IGJ1ZmZlckxlbmd0aCAtIG9mZnNldCA6IHRvTGVuZ3RoKGJ5dGVMZW5ndGgpOw0KICAgIGlmKG9mZnNldCArIGJ5dGVMZW5ndGggPiBidWZmZXJMZW5ndGgpdGhyb3cgUmFuZ2VFcnJvcihXUk9OR19MRU5HVEgpOw0KICAgIHRoaXNbJEJVRkZFUl0gPSBidWZmZXI7DQogICAgdGhpc1skT0ZGU0VUXSA9IG9mZnNldDsNCiAgICB0aGlzWyRMRU5HVEhdID0gYnl0ZUxlbmd0aDsNCiAgfTsNCg0KICBpZihERVNDUklQVE9SUyl7DQogICAgYWRkR2V0dGVyKCRBcnJheUJ1ZmZlciwgQllURV9MRU5HVEgsICdfbCcpOw0KICAgIGFkZEdldHRlcigkRGF0YVZpZXcsIEJVRkZFUiwgJ19iJyk7DQogICAgYWRkR2V0dGVyKCREYXRhVmlldywgQllURV9MRU5HVEgsICdfbCcpOw0KICAgIGFkZEdldHRlcigkRGF0YVZpZXcsIEJZVEVfT0ZGU0VULCAnX28nKTsNCiAgfQ0KDQogIHJlZGVmaW5lQWxsKCREYXRhVmlld1tQUk9UT1RZUEVdLCB7DQogICAgZ2V0SW50ODogZnVuY3Rpb24gZ2V0SW50OChieXRlT2Zmc2V0KXsNCiAgICAgIHJldHVybiBnZXQodGhpcywgMSwgYnl0ZU9mZnNldClbMF0gPDwgMjQgPj4gMjQ7DQogICAgfSwNCiAgICBnZXRVaW50ODogZnVuY3Rpb24gZ2V0VWludDgoYnl0ZU9mZnNldCl7DQogICAgICByZXR1cm4gZ2V0KHRoaXMsIDEsIGJ5dGVPZmZzZXQpWzBdOw0KICAgIH0sDQogICAgZ2V0SW50MTY6IGZ1bmN0aW9uIGdldEludDE2KGJ5dGVPZmZzZXQgLyosIGxpdHRsZUVuZGlhbiAqLyl7DQogICAgICB2YXIgYnl0ZXMgPSBnZXQodGhpcywgMiwgYnl0ZU9mZnNldCwgYXJndW1lbnRzWzFdKTsNCiAgICAgIHJldHVybiAoYnl0ZXNbMV0gPDwgOCB8IGJ5dGVzWzBdKSA8PCAxNiA+PiAxNjsNCiAgICB9LA0KICAgIGdldFVpbnQxNjogZnVuY3Rpb24gZ2V0VWludDE2KGJ5dGVPZmZzZXQgLyosIGxpdHRsZUVuZGlhbiAqLyl7DQogICAgICB2YXIgYnl0ZXMgPSBnZXQodGhpcywgMiwgYnl0ZU9mZnNldCwgYXJndW1lbnRzWzFdKTsNCiAgICAgIHJldHVybiBieXRlc1sxXSA8PCA4IHwgYnl0ZXNbMF07DQogICAgfSwNCiAgICBnZXRJbnQzMjogZnVuY3Rpb24gZ2V0SW50MzIoYnl0ZU9mZnNldCAvKiwgbGl0dGxlRW5kaWFuICovKXsNCiAgICAgIHJldHVybiB1bnBhY2tJMzIoZ2V0KHRoaXMsIDQsIGJ5dGVPZmZzZXQsIGFyZ3VtZW50c1sxXSkpOw0KICAgIH0sDQogICAgZ2V0VWludDMyOiBmdW5jdGlvbiBnZXRVaW50MzIoYnl0ZU9mZnNldCAvKiwgbGl0dGxlRW5kaWFuICovKXsNCiAgICAgIHJldHVybiB1bnBhY2tJMzIoZ2V0KHRoaXMsIDQsIGJ5dGVPZmZzZXQsIGFyZ3VtZW50c1sxXSkpID4+PiAwOw0KICAgIH0sDQogICAgZ2V0RmxvYXQzMjogZnVuY3Rpb24gZ2V0RmxvYXQzMihieXRlT2Zmc2V0IC8qLCBsaXR0bGVFbmRpYW4gKi8pew0KICAgICAgcmV0dXJuIHVucGFja0lFRUU3NTQoZ2V0KHRoaXMsIDQsIGJ5dGVPZmZzZXQsIGFyZ3VtZW50c1sxXSksIDIzLCA0KTsNCiAgICB9LA0KICAgIGdldEZsb2F0NjQ6IGZ1bmN0aW9uIGdldEZsb2F0NjQoYnl0ZU9mZnNldCAvKiwgbGl0dGxlRW5kaWFuICovKXsNCiAgICAgIHJldHVybiB1bnBhY2tJRUVFNzU0KGdldCh0aGlzLCA4LCBieXRlT2Zmc2V0LCBhcmd1bWVudHNbMV0pLCA1MiwgOCk7DQogICAgfSwNCiAgICBzZXRJbnQ4OiBmdW5jdGlvbiBzZXRJbnQ4KGJ5dGVPZmZzZXQsIHZhbHVlKXsNCiAgICAgIHNldCh0aGlzLCAxLCBieXRlT2Zmc2V0LCBwYWNrSTgsIHZhbHVlKTsNCiAgICB9LA0KICAgIHNldFVpbnQ4OiBmdW5jdGlvbiBzZXRVaW50OChieXRlT2Zmc2V0LCB2YWx1ZSl7DQogICAgICBzZXQodGhpcywgMSwgYnl0ZU9mZnNldCwgcGFja0k4LCB2YWx1ZSk7DQogICAgfSwNCiAgICBzZXRJbnQxNjogZnVuY3Rpb24gc2V0SW50MTYoYnl0ZU9mZnNldCwgdmFsdWUgLyosIGxpdHRsZUVuZGlhbiAqLyl7DQogICAgICBzZXQodGhpcywgMiwgYnl0ZU9mZnNldCwgcGFja0kxNiwgdmFsdWUsIGFyZ3VtZW50c1syXSk7DQogICAgfSwNCiAgICBzZXRVaW50MTY6IGZ1bmN0aW9uIHNldFVpbnQxNihieXRlT2Zmc2V0LCB2YWx1ZSAvKiwgbGl0dGxlRW5kaWFuICovKXsNCiAgICAgIHNldCh0aGlzLCAyLCBieXRlT2Zmc2V0LCBwYWNrSTE2LCB2YWx1ZSwgYXJndW1lbnRzWzJdKTsNCiAgICB9LA0KICAgIHNldEludDMyOiBmdW5jdGlvbiBzZXRJbnQzMihieXRlT2Zmc2V0LCB2YWx1ZSAvKiwgbGl0dGxlRW5kaWFuICovKXsNCiAgICAgIHNldCh0aGlzLCA0LCBieXRlT2Zmc2V0LCBwYWNrSTMyLCB2YWx1ZSwgYXJndW1lbnRzWzJdKTsNCiAgICB9LA0KICAgIHNldFVpbnQzMjogZnVuY3Rpb24gc2V0VWludDMyKGJ5dGVPZmZzZXQsIHZhbHVlIC8qLCBsaXR0bGVFbmRpYW4gKi8pew0KICAgICAgc2V0KHRoaXMsIDQsIGJ5dGVPZmZzZXQsIHBhY2tJMzIsIHZhbHVlLCBhcmd1bWVudHNbMl0pOw0KICAgIH0sDQogICAgc2V0RmxvYXQzMjogZnVuY3Rpb24gc2V0RmxvYXQzMihieXRlT2Zmc2V0LCB2YWx1ZSAvKiwgbGl0dGxlRW5kaWFuICovKXsNCiAgICAgIHNldCh0aGlzLCA0LCBieXRlT2Zmc2V0LCBwYWNrRjMyLCB2YWx1ZSwgYXJndW1lbnRzWzJdKTsNCiAgICB9LA0KICAgIHNldEZsb2F0NjQ6IGZ1bmN0aW9uIHNldEZsb2F0NjQoYnl0ZU9mZnNldCwgdmFsdWUgLyosIGxpdHRsZUVuZGlhbiAqLyl7DQogICAgICBzZXQodGhpcywgOCwgYnl0ZU9mZnNldCwgcGFja0Y2NCwgdmFsdWUsIGFyZ3VtZW50c1syXSk7DQogICAgfQ0KICB9KTsNCn0gZWxzZSB7DQogIGlmKCFmYWlscyhmdW5jdGlvbigpew0KICAgIG5ldyAkQXJyYXlCdWZmZXI7ICAgICAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLW5ldw0KICB9KSB8fCAhZmFpbHMoZnVuY3Rpb24oKXsNCiAgICBuZXcgJEFycmF5QnVmZmVyKC41KTsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1uZXcNCiAgfSkpew0KICAgICRBcnJheUJ1ZmZlciA9IGZ1bmN0aW9uIEFycmF5QnVmZmVyKGxlbmd0aCl7DQogICAgICByZXR1cm4gbmV3IEJhc2VCdWZmZXIodmFsaWRhdGVBcnJheUJ1ZmZlckFyZ3VtZW50cyh0aGlzLCBsZW5ndGgpKTsNCiAgICB9Ow0KICAgIHZhciBBcnJheUJ1ZmZlclByb3RvID0gJEFycmF5QnVmZmVyW1BST1RPVFlQRV0gPSBCYXNlQnVmZmVyW1BST1RPVFlQRV07DQogICAgZm9yKHZhciBrZXlzID0gZ09QTihCYXNlQnVmZmVyKSwgaiA9IDAsIGtleTsga2V5cy5sZW5ndGggPiBqOyApew0KICAgICAgaWYoISgoa2V5ID0ga2V5c1tqKytdKSBpbiAkQXJyYXlCdWZmZXIpKWhpZGUoJEFycmF5QnVmZmVyLCBrZXksIEJhc2VCdWZmZXJba2V5XSk7DQogICAgfTsNCiAgICBpZighTElCUkFSWSlBcnJheUJ1ZmZlclByb3RvLmNvbnN0cnVjdG9yID0gJEFycmF5QnVmZmVyOw0KICB9DQogIC8vIGlPUyBTYWZhcmkgNy54IGJ1Zw0KICB2YXIgdmlldyA9IG5ldyAkRGF0YVZpZXcobmV3ICRBcnJheUJ1ZmZlcigyKSkNCiAgICAsICRzZXRJbnQ4ID0gJERhdGFWaWV3W1BST1RPVFlQRV0uc2V0SW50ODsNCiAgdmlldy5zZXRJbnQ4KDAsIDIxNDc0ODM2NDgpOw0KICB2aWV3LnNldEludDgoMSwgMjE0NzQ4MzY0OSk7DQogIGlmKHZpZXcuZ2V0SW50OCgwKSB8fCAhdmlldy5nZXRJbnQ4KDEpKXJlZGVmaW5lQWxsKCREYXRhVmlld1tQUk9UT1RZUEVdLCB7DQogICAgc2V0SW50ODogZnVuY3Rpb24gc2V0SW50OChieXRlT2Zmc2V0LCB2YWx1ZSl7DQogICAgICAkc2V0SW50OC5jYWxsKHRoaXMsIGJ5dGVPZmZzZXQsIHZhbHVlIDw8IDI0ID4+IDI0KTsNCiAgICB9LA0KICAgIHNldFVpbnQ4OiBmdW5jdGlvbiBzZXRVaW50OChieXRlT2Zmc2V0LCB2YWx1ZSl7DQogICAgICAkc2V0SW50OC5jYWxsKHRoaXMsIGJ5dGVPZmZzZXQsIHZhbHVlIDw8IDI0ID4+IDI0KTsNCiAgICB9DQogIH0sIHRydWUpOw0KfQ0Kc2V0VG9TdHJpbmdUYWcoJEFycmF5QnVmZmVyLCBBUlJBWV9CVUZGRVIpOw0Kc2V0VG9TdHJpbmdUYWcoJERhdGFWaWV3LCBEQVRBX1ZJRVcpOw0KaGlkZSgkRGF0YVZpZXdbUFJPVE9UWVBFXSwgJHR5cGVkLlZJRVcsIHRydWUpOw0KZXhwb3J0c1tBUlJBWV9CVUZGRVJdID0gJEFycmF5QnVmZmVyOw0KZXhwb3J0c1tEQVRBX1ZJRVddID0gJERhdGFWaWV3Ow0KfSx7Ii4vX2FuLWluc3RhbmNlIjo2LCIuL19hcnJheS1maWxsIjo5LCIuL19kZXNjcmlwdG9ycyI6MjgsIi4vX2ZhaWxzIjozNCwiLi9fZ2xvYmFsIjozOCwiLi9faGlkZSI6NDAsIi4vX2xpYnJhcnkiOjU4LCIuL19vYmplY3QtZHAiOjY3LCIuL19vYmplY3QtZ29wbiI6NzIsIi4vX3JlZGVmaW5lLWFsbCI6ODYsIi4vX3NldC10by1zdHJpbmctdGFnIjo5MiwiLi9fdG8taW50ZWdlciI6MTA2LCIuL190by1sZW5ndGgiOjEwOCwiLi9fdHlwZWQiOjExM31dLDExMzpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQp2YXIgZ2xvYmFsID0gcmVxdWlyZSgnLi9fZ2xvYmFsJykNCiAgLCBoaWRlICAgPSByZXF1aXJlKCcuL19oaWRlJykNCiAgLCB1aWQgICAgPSByZXF1aXJlKCcuL191aWQnKQ0KICAsIFRZUEVEICA9IHVpZCgndHlwZWRfYXJyYXknKQ0KICAsIFZJRVcgICA9IHVpZCgndmlldycpDQogICwgQUJWICAgID0gISEoZ2xvYmFsLkFycmF5QnVmZmVyICYmIGdsb2JhbC5EYXRhVmlldykNCiAgLCBDT05TVFIgPSBBQlYNCiAgLCBpID0gMCwgbCA9IDksIFR5cGVkOw0KDQp2YXIgVHlwZWRBcnJheUNvbnN0cnVjdG9ycyA9ICgNCiAgJ0ludDhBcnJheSxVaW50OEFycmF5LFVpbnQ4Q2xhbXBlZEFycmF5LEludDE2QXJyYXksVWludDE2QXJyYXksSW50MzJBcnJheSxVaW50MzJBcnJheSxGbG9hdDMyQXJyYXksRmxvYXQ2NEFycmF5Jw0KKS5zcGxpdCgnLCcpOw0KDQp3aGlsZShpIDwgbCl7DQogIGlmKFR5cGVkID0gZ2xvYmFsW1R5cGVkQXJyYXlDb25zdHJ1Y3RvcnNbaSsrXV0pew0KICAgIGhpZGUoVHlwZWQucHJvdG90eXBlLCBUWVBFRCwgdHJ1ZSk7DQogICAgaGlkZShUeXBlZC5wcm90b3R5cGUsIFZJRVcsIHRydWUpOw0KICB9IGVsc2UgQ09OU1RSID0gZmFsc2U7DQp9DQoNCm1vZHVsZS5leHBvcnRzID0gew0KICBBQlY6ICAgIEFCViwNCiAgQ09OU1RSOiBDT05TVFIsDQogIFRZUEVEOiAgVFlQRUQsDQogIFZJRVc6ICAgVklFVw0KfTsNCn0seyIuL19nbG9iYWwiOjM4LCIuL19oaWRlIjo0MCwiLi9fdWlkIjoxMTR9XSwxMTQ6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KdmFyIGlkID0gMA0KICAsIHB4ID0gTWF0aC5yYW5kb20oKTsNCm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oa2V5KXsNCiAgcmV0dXJuICdTeW1ib2woJy5jb25jYXQoa2V5ID09PSB1bmRlZmluZWQgPyAnJyA6IGtleSwgJylfJywgKCsraWQgKyBweCkudG9TdHJpbmcoMzYpKTsNCn07DQp9LHt9XSwxMTU6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KdmFyIGdsb2JhbCAgICAgICAgID0gcmVxdWlyZSgnLi9fZ2xvYmFsJykNCiAgLCBjb3JlICAgICAgICAgICA9IHJlcXVpcmUoJy4vX2NvcmUnKQ0KICAsIExJQlJBUlkgICAgICAgID0gcmVxdWlyZSgnLi9fbGlicmFyeScpDQogICwgd2tzRXh0ICAgICAgICAgPSByZXF1aXJlKCcuL193a3MtZXh0JykNCiAgLCBkZWZpbmVQcm9wZXJ0eSA9IHJlcXVpcmUoJy4vX29iamVjdC1kcCcpLmY7DQptb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKG5hbWUpew0KICB2YXIgJFN5bWJvbCA9IGNvcmUuU3ltYm9sIHx8IChjb3JlLlN5bWJvbCA9IExJQlJBUlkgPyB7fSA6IGdsb2JhbC5TeW1ib2wgfHwge30pOw0KICBpZihuYW1lLmNoYXJBdCgwKSAhPSAnXycgJiYgIShuYW1lIGluICRTeW1ib2wpKWRlZmluZVByb3BlcnR5KCRTeW1ib2wsIG5hbWUsIHt2YWx1ZTogd2tzRXh0LmYobmFtZSl9KTsNCn07DQp9LHsiLi9fY29yZSI6MjMsIi4vX2dsb2JhbCI6MzgsIi4vX2xpYnJhcnkiOjU4LCIuL19vYmplY3QtZHAiOjY3LCIuL193a3MtZXh0IjoxMTZ9XSwxMTY6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KZXhwb3J0cy5mID0gcmVxdWlyZSgnLi9fd2tzJyk7DQp9LHsiLi9fd2tzIjoxMTd9XSwxMTc6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KdmFyIHN0b3JlICAgICAgPSByZXF1aXJlKCcuL19zaGFyZWQnKSgnd2tzJykNCiAgLCB1aWQgICAgICAgID0gcmVxdWlyZSgnLi9fdWlkJykNCiAgLCBTeW1ib2wgICAgID0gcmVxdWlyZSgnLi9fZ2xvYmFsJykuU3ltYm9sDQogICwgVVNFX1NZTUJPTCA9IHR5cGVvZiBTeW1ib2wgPT0gJ2Z1bmN0aW9uJzsNCg0KdmFyICRleHBvcnRzID0gbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihuYW1lKXsNCiAgcmV0dXJuIHN0b3JlW25hbWVdIHx8IChzdG9yZVtuYW1lXSA9DQogICAgVVNFX1NZTUJPTCAmJiBTeW1ib2xbbmFtZV0gfHwgKFVTRV9TWU1CT0wgPyBTeW1ib2wgOiB1aWQpKCdTeW1ib2wuJyArIG5hbWUpKTsNCn07DQoNCiRleHBvcnRzLnN0b3JlID0gc3RvcmU7DQp9LHsiLi9fZ2xvYmFsIjozOCwiLi9fc2hhcmVkIjo5NCwiLi9fdWlkIjoxMTR9XSwxMTg6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KdmFyIGNsYXNzb2YgICA9IHJlcXVpcmUoJy4vX2NsYXNzb2YnKQ0KICAsIElURVJBVE9SICA9IHJlcXVpcmUoJy4vX3drcycpKCdpdGVyYXRvcicpDQogICwgSXRlcmF0b3JzID0gcmVxdWlyZSgnLi9faXRlcmF0b3JzJyk7DQptb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoJy4vX2NvcmUnKS5nZXRJdGVyYXRvck1ldGhvZCA9IGZ1bmN0aW9uKGl0KXsNCiAgaWYoaXQgIT0gdW5kZWZpbmVkKXJldHVybiBpdFtJVEVSQVRPUl0NCiAgICB8fCBpdFsnQEBpdGVyYXRvciddDQogICAgfHwgSXRlcmF0b3JzW2NsYXNzb2YoaXQpXTsNCn07DQp9LHsiLi9fY2xhc3NvZiI6MTcsIi4vX2NvcmUiOjIzLCIuL19pdGVyYXRvcnMiOjU2LCIuL193a3MiOjExN31dLDExOTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQp2YXIgY2xhc3NvZiAgID0gcmVxdWlyZSgnLi9fY2xhc3NvZicpDQogICwgSVRFUkFUT1IgID0gcmVxdWlyZSgnLi9fd2tzJykoJ2l0ZXJhdG9yJykNCiAgLCBJdGVyYXRvcnMgPSByZXF1aXJlKCcuL19pdGVyYXRvcnMnKTsNCm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZSgnLi9fY29yZScpLmlzSXRlcmFibGUgPSBmdW5jdGlvbihpdCl7DQogIHZhciBPID0gT2JqZWN0KGl0KTsNCiAgcmV0dXJuIE9bSVRFUkFUT1JdICE9PSB1bmRlZmluZWQNCiAgICB8fCAnQEBpdGVyYXRvcicgaW4gTw0KICAgIHx8IEl0ZXJhdG9ycy5oYXNPd25Qcm9wZXJ0eShjbGFzc29mKE8pKTsNCn07DQp9LHsiLi9fY2xhc3NvZiI6MTcsIi4vX2NvcmUiOjIzLCIuL19pdGVyYXRvcnMiOjU2LCIuL193a3MiOjExN31dLDEyMDpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQovLyBodHRwczovL2dpdGh1Yi5jb20vYmVuamFtaW5nci9SZXhFeHAuZXNjYXBlDQp2YXIgJGV4cG9ydCA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpDQogICwgJHJlICAgICA9IHJlcXVpcmUoJy4vX3JlcGxhY2VyJykoL1tcXF4kKis/LigpfFtcXXt9XS9nLCAnXFwkJicpOw0KDQokZXhwb3J0KCRleHBvcnQuUywgJ1JlZ0V4cCcsIHtlc2NhcGU6IGZ1bmN0aW9uIGVzY2FwZShpdCl7IHJldHVybiAkcmUoaXQpOyB9fSk7DQoNCn0seyIuL19leHBvcnQiOjMyLCIuL19yZXBsYWNlciI6ODh9XSwxMjE6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KLy8gMjIuMS4zLjMgQXJyYXkucHJvdG90eXBlLmNvcHlXaXRoaW4odGFyZ2V0LCBzdGFydCwgZW5kID0gdGhpcy5sZW5ndGgpDQp2YXIgJGV4cG9ydCA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpOw0KDQokZXhwb3J0KCRleHBvcnQuUCwgJ0FycmF5Jywge2NvcHlXaXRoaW46IHJlcXVpcmUoJy4vX2FycmF5LWNvcHktd2l0aGluJyl9KTsNCg0KcmVxdWlyZSgnLi9fYWRkLXRvLXVuc2NvcGFibGVzJykoJ2NvcHlXaXRoaW4nKTsNCn0seyIuL19hZGQtdG8tdW5zY29wYWJsZXMiOjUsIi4vX2FycmF5LWNvcHktd2l0aGluIjo4LCIuL19leHBvcnQiOjMyfV0sMTIyOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCid1c2Ugc3RyaWN0JzsNCnZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0JykNCiAgLCAkZXZlcnkgID0gcmVxdWlyZSgnLi9fYXJyYXktbWV0aG9kcycpKDQpOw0KDQokZXhwb3J0KCRleHBvcnQuUCArICRleHBvcnQuRiAqICFyZXF1aXJlKCcuL19zdHJpY3QtbWV0aG9kJykoW10uZXZlcnksIHRydWUpLCAnQXJyYXknLCB7DQogIC8vIDIyLjEuMy41IC8gMTUuNC40LjE2IEFycmF5LnByb3RvdHlwZS5ldmVyeShjYWxsYmFja2ZuIFssIHRoaXNBcmddKQ0KICBldmVyeTogZnVuY3Rpb24gZXZlcnkoY2FsbGJhY2tmbiAvKiAsIHRoaXNBcmcgKi8pew0KICAgIHJldHVybiAkZXZlcnkodGhpcywgY2FsbGJhY2tmbiwgYXJndW1lbnRzWzFdKTsNCiAgfQ0KfSk7DQp9LHsiLi9fYXJyYXktbWV0aG9kcyI6MTIsIi4vX2V4cG9ydCI6MzIsIi4vX3N0cmljdC1tZXRob2QiOjk2fV0sMTIzOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCi8vIDIyLjEuMy42IEFycmF5LnByb3RvdHlwZS5maWxsKHZhbHVlLCBzdGFydCA9IDAsIGVuZCA9IHRoaXMubGVuZ3RoKQ0KdmFyICRleHBvcnQgPSByZXF1aXJlKCcuL19leHBvcnQnKTsNCg0KJGV4cG9ydCgkZXhwb3J0LlAsICdBcnJheScsIHtmaWxsOiByZXF1aXJlKCcuL19hcnJheS1maWxsJyl9KTsNCg0KcmVxdWlyZSgnLi9fYWRkLXRvLXVuc2NvcGFibGVzJykoJ2ZpbGwnKTsNCn0seyIuL19hZGQtdG8tdW5zY29wYWJsZXMiOjUsIi4vX2FycmF5LWZpbGwiOjksIi4vX2V4cG9ydCI6MzJ9XSwxMjQ6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KJ3VzZSBzdHJpY3QnOw0KdmFyICRleHBvcnQgPSByZXF1aXJlKCcuL19leHBvcnQnKQ0KICAsICRmaWx0ZXIgPSByZXF1aXJlKCcuL19hcnJheS1tZXRob2RzJykoMik7DQoNCiRleHBvcnQoJGV4cG9ydC5QICsgJGV4cG9ydC5GICogIXJlcXVpcmUoJy4vX3N0cmljdC1tZXRob2QnKShbXS5maWx0ZXIsIHRydWUpLCAnQXJyYXknLCB7DQogIC8vIDIyLjEuMy43IC8gMTUuNC40LjIwIEFycmF5LnByb3RvdHlwZS5maWx0ZXIoY2FsbGJhY2tmbiBbLCB0aGlzQXJnXSkNCiAgZmlsdGVyOiBmdW5jdGlvbiBmaWx0ZXIoY2FsbGJhY2tmbiAvKiAsIHRoaXNBcmcgKi8pew0KICAgIHJldHVybiAkZmlsdGVyKHRoaXMsIGNhbGxiYWNrZm4sIGFyZ3VtZW50c1sxXSk7DQogIH0NCn0pOw0KfSx7Ii4vX2FycmF5LW1ldGhvZHMiOjEyLCIuL19leHBvcnQiOjMyLCIuL19zdHJpY3QtbWV0aG9kIjo5Nn1dLDEyNTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQondXNlIHN0cmljdCc7DQovLyAyMi4xLjMuOSBBcnJheS5wcm90b3R5cGUuZmluZEluZGV4KHByZWRpY2F0ZSwgdGhpc0FyZyA9IHVuZGVmaW5lZCkNCnZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0JykNCiAgLCAkZmluZCAgID0gcmVxdWlyZSgnLi9fYXJyYXktbWV0aG9kcycpKDYpDQogICwgS0VZICAgICA9ICdmaW5kSW5kZXgnDQogICwgZm9yY2VkICA9IHRydWU7DQovLyBTaG91bGRuJ3Qgc2tpcCBob2xlcw0KaWYoS0VZIGluIFtdKUFycmF5KDEpW0tFWV0oZnVuY3Rpb24oKXsgZm9yY2VkID0gZmFsc2U7IH0pOw0KJGV4cG9ydCgkZXhwb3J0LlAgKyAkZXhwb3J0LkYgKiBmb3JjZWQsICdBcnJheScsIHsNCiAgZmluZEluZGV4OiBmdW5jdGlvbiBmaW5kSW5kZXgoY2FsbGJhY2tmbi8qLCB0aGF0ID0gdW5kZWZpbmVkICovKXsNCiAgICByZXR1cm4gJGZpbmQodGhpcywgY2FsbGJhY2tmbiwgYXJndW1lbnRzLmxlbmd0aCA+IDEgPyBhcmd1bWVudHNbMV0gOiB1bmRlZmluZWQpOw0KICB9DQp9KTsNCnJlcXVpcmUoJy4vX2FkZC10by11bnNjb3BhYmxlcycpKEtFWSk7DQp9LHsiLi9fYWRkLXRvLXVuc2NvcGFibGVzIjo1LCIuL19hcnJheS1tZXRob2RzIjoxMiwiLi9fZXhwb3J0IjozMn1dLDEyNjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQondXNlIHN0cmljdCc7DQovLyAyMi4xLjMuOCBBcnJheS5wcm90b3R5cGUuZmluZChwcmVkaWNhdGUsIHRoaXNBcmcgPSB1bmRlZmluZWQpDQp2YXIgJGV4cG9ydCA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpDQogICwgJGZpbmQgICA9IHJlcXVpcmUoJy4vX2FycmF5LW1ldGhvZHMnKSg1KQ0KICAsIEtFWSAgICAgPSAnZmluZCcNCiAgLCBmb3JjZWQgID0gdHJ1ZTsNCi8vIFNob3VsZG4ndCBza2lwIGhvbGVzDQppZihLRVkgaW4gW10pQXJyYXkoMSlbS0VZXShmdW5jdGlvbigpeyBmb3JjZWQgPSBmYWxzZTsgfSk7DQokZXhwb3J0KCRleHBvcnQuUCArICRleHBvcnQuRiAqIGZvcmNlZCwgJ0FycmF5Jywgew0KICBmaW5kOiBmdW5jdGlvbiBmaW5kKGNhbGxiYWNrZm4vKiwgdGhhdCA9IHVuZGVmaW5lZCAqLyl7DQogICAgcmV0dXJuICRmaW5kKHRoaXMsIGNhbGxiYWNrZm4sIGFyZ3VtZW50cy5sZW5ndGggPiAxID8gYXJndW1lbnRzWzFdIDogdW5kZWZpbmVkKTsNCiAgfQ0KfSk7DQpyZXF1aXJlKCcuL19hZGQtdG8tdW5zY29wYWJsZXMnKShLRVkpOw0KfSx7Ii4vX2FkZC10by11bnNjb3BhYmxlcyI6NSwiLi9fYXJyYXktbWV0aG9kcyI6MTIsIi4vX2V4cG9ydCI6MzJ9XSwxMjc6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KJ3VzZSBzdHJpY3QnOw0KdmFyICRleHBvcnQgID0gcmVxdWlyZSgnLi9fZXhwb3J0JykNCiAgLCAkZm9yRWFjaCA9IHJlcXVpcmUoJy4vX2FycmF5LW1ldGhvZHMnKSgwKQ0KICAsIFNUUklDVCAgID0gcmVxdWlyZSgnLi9fc3RyaWN0LW1ldGhvZCcpKFtdLmZvckVhY2gsIHRydWUpOw0KDQokZXhwb3J0KCRleHBvcnQuUCArICRleHBvcnQuRiAqICFTVFJJQ1QsICdBcnJheScsIHsNCiAgLy8gMjIuMS4zLjEwIC8gMTUuNC40LjE4IEFycmF5LnByb3RvdHlwZS5mb3JFYWNoKGNhbGxiYWNrZm4gWywgdGhpc0FyZ10pDQogIGZvckVhY2g6IGZ1bmN0aW9uIGZvckVhY2goY2FsbGJhY2tmbiAvKiAsIHRoaXNBcmcgKi8pew0KICAgIHJldHVybiAkZm9yRWFjaCh0aGlzLCBjYWxsYmFja2ZuLCBhcmd1bWVudHNbMV0pOw0KICB9DQp9KTsNCn0seyIuL19hcnJheS1tZXRob2RzIjoxMiwiLi9fZXhwb3J0IjozMiwiLi9fc3RyaWN0LW1ldGhvZCI6OTZ9XSwxMjg6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KJ3VzZSBzdHJpY3QnOw0KdmFyIGN0eCAgICAgICAgICAgID0gcmVxdWlyZSgnLi9fY3R4JykNCiAgLCAkZXhwb3J0ICAgICAgICA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpDQogICwgdG9PYmplY3QgICAgICAgPSByZXF1aXJlKCcuL190by1vYmplY3QnKQ0KICAsIGNhbGwgICAgICAgICAgID0gcmVxdWlyZSgnLi9faXRlci1jYWxsJykNCiAgLCBpc0FycmF5SXRlciAgICA9IHJlcXVpcmUoJy4vX2lzLWFycmF5LWl0ZXInKQ0KICAsIHRvTGVuZ3RoICAgICAgID0gcmVxdWlyZSgnLi9fdG8tbGVuZ3RoJykNCiAgLCBjcmVhdGVQcm9wZXJ0eSA9IHJlcXVpcmUoJy4vX2NyZWF0ZS1wcm9wZXJ0eScpDQogICwgZ2V0SXRlckZuICAgICAgPSByZXF1aXJlKCcuL2NvcmUuZ2V0LWl0ZXJhdG9yLW1ldGhvZCcpOw0KDQokZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqICFyZXF1aXJlKCcuL19pdGVyLWRldGVjdCcpKGZ1bmN0aW9uKGl0ZXIpeyBBcnJheS5mcm9tKGl0ZXIpOyB9KSwgJ0FycmF5Jywgew0KICAvLyAyMi4xLjIuMSBBcnJheS5mcm9tKGFycmF5TGlrZSwgbWFwZm4gPSB1bmRlZmluZWQsIHRoaXNBcmcgPSB1bmRlZmluZWQpDQogIGZyb206IGZ1bmN0aW9uIGZyb20oYXJyYXlMaWtlLyosIG1hcGZuID0gdW5kZWZpbmVkLCB0aGlzQXJnID0gdW5kZWZpbmVkKi8pew0KICAgIHZhciBPICAgICAgID0gdG9PYmplY3QoYXJyYXlMaWtlKQ0KICAgICAgLCBDICAgICAgID0gdHlwZW9mIHRoaXMgPT0gJ2Z1bmN0aW9uJyA/IHRoaXMgOiBBcnJheQ0KICAgICAgLCBhTGVuICAgID0gYXJndW1lbnRzLmxlbmd0aA0KICAgICAgLCBtYXBmbiAgID0gYUxlbiA+IDEgPyBhcmd1bWVudHNbMV0gOiB1bmRlZmluZWQNCiAgICAgICwgbWFwcGluZyA9IG1hcGZuICE9PSB1bmRlZmluZWQNCiAgICAgICwgaW5kZXggICA9IDANCiAgICAgICwgaXRlckZuICA9IGdldEl0ZXJGbihPKQ0KICAgICAgLCBsZW5ndGgsIHJlc3VsdCwgc3RlcCwgaXRlcmF0b3I7DQogICAgaWYobWFwcGluZyltYXBmbiA9IGN0eChtYXBmbiwgYUxlbiA+IDIgPyBhcmd1bWVudHNbMl0gOiB1bmRlZmluZWQsIDIpOw0KICAgIC8vIGlmIG9iamVjdCBpc24ndCBpdGVyYWJsZSBvciBpdCdzIGFycmF5IHdpdGggZGVmYXVsdCBpdGVyYXRvciAtIHVzZSBzaW1wbGUgY2FzZQ0KICAgIGlmKGl0ZXJGbiAhPSB1bmRlZmluZWQgJiYgIShDID09IEFycmF5ICYmIGlzQXJyYXlJdGVyKGl0ZXJGbikpKXsNCiAgICAgIGZvcihpdGVyYXRvciA9IGl0ZXJGbi5jYWxsKE8pLCByZXN1bHQgPSBuZXcgQzsgIShzdGVwID0gaXRlcmF0b3IubmV4dCgpKS5kb25lOyBpbmRleCsrKXsNCiAgICAgICAgY3JlYXRlUHJvcGVydHkocmVzdWx0LCBpbmRleCwgbWFwcGluZyA/IGNhbGwoaXRlcmF0b3IsIG1hcGZuLCBbc3RlcC52YWx1ZSwgaW5kZXhdLCB0cnVlKSA6IHN0ZXAudmFsdWUpOw0KICAgICAgfQ0KICAgIH0gZWxzZSB7DQogICAgICBsZW5ndGggPSB0b0xlbmd0aChPLmxlbmd0aCk7DQogICAgICBmb3IocmVzdWx0ID0gbmV3IEMobGVuZ3RoKTsgbGVuZ3RoID4gaW5kZXg7IGluZGV4Kyspew0KICAgICAgICBjcmVhdGVQcm9wZXJ0eShyZXN1bHQsIGluZGV4LCBtYXBwaW5nID8gbWFwZm4oT1tpbmRleF0sIGluZGV4KSA6IE9baW5kZXhdKTsNCiAgICAgIH0NCiAgICB9DQogICAgcmVzdWx0Lmxlbmd0aCA9IGluZGV4Ow0KICAgIHJldHVybiByZXN1bHQ7DQogIH0NCn0pOw0KDQp9LHsiLi9fY3JlYXRlLXByb3BlcnR5IjoyNCwiLi9fY3R4IjoyNSwiLi9fZXhwb3J0IjozMiwiLi9faXMtYXJyYXktaXRlciI6NDYsIi4vX2l0ZXItY2FsbCI6NTEsIi4vX2l0ZXItZGV0ZWN0Ijo1NCwiLi9fdG8tbGVuZ3RoIjoxMDgsIi4vX3RvLW9iamVjdCI6MTA5LCIuL2NvcmUuZ2V0LWl0ZXJhdG9yLW1ldGhvZCI6MTE4fV0sMTI5OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCid1c2Ugc3RyaWN0JzsNCnZhciAkZXhwb3J0ICAgICAgID0gcmVxdWlyZSgnLi9fZXhwb3J0JykNCiAgLCAkaW5kZXhPZiAgICAgID0gcmVxdWlyZSgnLi9fYXJyYXktaW5jbHVkZXMnKShmYWxzZSkNCiAgLCAkbmF0aXZlICAgICAgID0gW10uaW5kZXhPZg0KICAsIE5FR0FUSVZFX1pFUk8gPSAhISRuYXRpdmUgJiYgMSAvIFsxXS5pbmRleE9mKDEsIC0wKSA8IDA7DQoNCiRleHBvcnQoJGV4cG9ydC5QICsgJGV4cG9ydC5GICogKE5FR0FUSVZFX1pFUk8gfHwgIXJlcXVpcmUoJy4vX3N0cmljdC1tZXRob2QnKSgkbmF0aXZlKSksICdBcnJheScsIHsNCiAgLy8gMjIuMS4zLjExIC8gMTUuNC40LjE0IEFycmF5LnByb3RvdHlwZS5pbmRleE9mKHNlYXJjaEVsZW1lbnQgWywgZnJvbUluZGV4XSkNCiAgaW5kZXhPZjogZnVuY3Rpb24gaW5kZXhPZihzZWFyY2hFbGVtZW50IC8qLCBmcm9tSW5kZXggPSAwICovKXsNCiAgICByZXR1cm4gTkVHQVRJVkVfWkVSTw0KICAgICAgLy8gY29udmVydCAtMCB0byArMA0KICAgICAgPyAkbmF0aXZlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgMA0KICAgICAgOiAkaW5kZXhPZih0aGlzLCBzZWFyY2hFbGVtZW50LCBhcmd1bWVudHNbMV0pOw0KICB9DQp9KTsNCn0seyIuL19hcnJheS1pbmNsdWRlcyI6MTEsIi4vX2V4cG9ydCI6MzIsIi4vX3N0cmljdC1tZXRob2QiOjk2fV0sMTMwOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCi8vIDIyLjEuMi4yIC8gMTUuNC4zLjIgQXJyYXkuaXNBcnJheShhcmcpDQp2YXIgJGV4cG9ydCA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpOw0KDQokZXhwb3J0KCRleHBvcnQuUywgJ0FycmF5Jywge2lzQXJyYXk6IHJlcXVpcmUoJy4vX2lzLWFycmF5Jyl9KTsNCn0seyIuL19leHBvcnQiOjMyLCIuL19pcy1hcnJheSI6NDd9XSwxMzE6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KJ3VzZSBzdHJpY3QnOw0KdmFyIGFkZFRvVW5zY29wYWJsZXMgPSByZXF1aXJlKCcuL19hZGQtdG8tdW5zY29wYWJsZXMnKQ0KICAsIHN0ZXAgICAgICAgICAgICAgPSByZXF1aXJlKCcuL19pdGVyLXN0ZXAnKQ0KICAsIEl0ZXJhdG9ycyAgICAgICAgPSByZXF1aXJlKCcuL19pdGVyYXRvcnMnKQ0KICAsIHRvSU9iamVjdCAgICAgICAgPSByZXF1aXJlKCcuL190by1pb2JqZWN0Jyk7DQoNCi8vIDIyLjEuMy40IEFycmF5LnByb3RvdHlwZS5lbnRyaWVzKCkNCi8vIDIyLjEuMy4xMyBBcnJheS5wcm90b3R5cGUua2V5cygpDQovLyAyMi4xLjMuMjkgQXJyYXkucHJvdG90eXBlLnZhbHVlcygpDQovLyAyMi4xLjMuMzAgQXJyYXkucHJvdG90eXBlW0BAaXRlcmF0b3JdKCkNCm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZSgnLi9faXRlci1kZWZpbmUnKShBcnJheSwgJ0FycmF5JywgZnVuY3Rpb24oaXRlcmF0ZWQsIGtpbmQpew0KICB0aGlzLl90ID0gdG9JT2JqZWN0KGl0ZXJhdGVkKTsgLy8gdGFyZ2V0DQogIHRoaXMuX2kgPSAwOyAgICAgICAgICAgICAgICAgICAvLyBuZXh0IGluZGV4DQogIHRoaXMuX2sgPSBraW5kOyAgICAgICAgICAgICAgICAvLyBraW5kDQovLyAyMi4xLjUuMi4xICVBcnJheUl0ZXJhdG9yUHJvdG90eXBlJS5uZXh0KCkNCn0sIGZ1bmN0aW9uKCl7DQogIHZhciBPICAgICA9IHRoaXMuX3QNCiAgICAsIGtpbmQgID0gdGhpcy5faw0KICAgICwgaW5kZXggPSB0aGlzLl9pKys7DQogIGlmKCFPIHx8IGluZGV4ID49IE8ubGVuZ3RoKXsNCiAgICB0aGlzLl90ID0gdW5kZWZpbmVkOw0KICAgIHJldHVybiBzdGVwKDEpOw0KICB9DQogIGlmKGtpbmQgPT0gJ2tleXMnICApcmV0dXJuIHN0ZXAoMCwgaW5kZXgpOw0KICBpZihraW5kID09ICd2YWx1ZXMnKXJldHVybiBzdGVwKDAsIE9baW5kZXhdKTsNCiAgcmV0dXJuIHN0ZXAoMCwgW2luZGV4LCBPW2luZGV4XV0pOw0KfSwgJ3ZhbHVlcycpOw0KDQovLyBhcmd1bWVudHNMaXN0W0BAaXRlcmF0b3JdIGlzICVBcnJheVByb3RvX3ZhbHVlcyUgKDkuNC40LjYsIDkuNC40LjcpDQpJdGVyYXRvcnMuQXJndW1lbnRzID0gSXRlcmF0b3JzLkFycmF5Ow0KDQphZGRUb1Vuc2NvcGFibGVzKCdrZXlzJyk7DQphZGRUb1Vuc2NvcGFibGVzKCd2YWx1ZXMnKTsNCmFkZFRvVW5zY29wYWJsZXMoJ2VudHJpZXMnKTsNCn0seyIuL19hZGQtdG8tdW5zY29wYWJsZXMiOjUsIi4vX2l0ZXItZGVmaW5lIjo1MywiLi9faXRlci1zdGVwIjo1NSwiLi9faXRlcmF0b3JzIjo1NiwiLi9fdG8taW9iamVjdCI6MTA3fV0sMTMyOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCid1c2Ugc3RyaWN0JzsNCi8vIDIyLjEuMy4xMyBBcnJheS5wcm90b3R5cGUuam9pbihzZXBhcmF0b3IpDQp2YXIgJGV4cG9ydCAgID0gcmVxdWlyZSgnLi9fZXhwb3J0JykNCiAgLCB0b0lPYmplY3QgPSByZXF1aXJlKCcuL190by1pb2JqZWN0JykNCiAgLCBhcnJheUpvaW4gPSBbXS5qb2luOw0KDQovLyBmYWxsYmFjayBmb3Igbm90IGFycmF5LWxpa2Ugc3RyaW5ncw0KJGV4cG9ydCgkZXhwb3J0LlAgKyAkZXhwb3J0LkYgKiAocmVxdWlyZSgnLi9faW9iamVjdCcpICE9IE9iamVjdCB8fCAhcmVxdWlyZSgnLi9fc3RyaWN0LW1ldGhvZCcpKGFycmF5Sm9pbikpLCAnQXJyYXknLCB7DQogIGpvaW46IGZ1bmN0aW9uIGpvaW4oc2VwYXJhdG9yKXsNCiAgICByZXR1cm4gYXJyYXlKb2luLmNhbGwodG9JT2JqZWN0KHRoaXMpLCBzZXBhcmF0b3IgPT09IHVuZGVmaW5lZCA/ICcsJyA6IHNlcGFyYXRvcik7DQogIH0NCn0pOw0KfSx7Ii4vX2V4cG9ydCI6MzIsIi4vX2lvYmplY3QiOjQ1LCIuL19zdHJpY3QtbWV0aG9kIjo5NiwiLi9fdG8taW9iamVjdCI6MTA3fV0sMTMzOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCid1c2Ugc3RyaWN0JzsNCnZhciAkZXhwb3J0ICAgICAgID0gcmVxdWlyZSgnLi9fZXhwb3J0JykNCiAgLCB0b0lPYmplY3QgICAgID0gcmVxdWlyZSgnLi9fdG8taW9iamVjdCcpDQogICwgdG9JbnRlZ2VyICAgICA9IHJlcXVpcmUoJy4vX3RvLWludGVnZXInKQ0KICAsIHRvTGVuZ3RoICAgICAgPSByZXF1aXJlKCcuL190by1sZW5ndGgnKQ0KICAsICRuYXRpdmUgICAgICAgPSBbXS5sYXN0SW5kZXhPZg0KICAsIE5FR0FUSVZFX1pFUk8gPSAhISRuYXRpdmUgJiYgMSAvIFsxXS5sYXN0SW5kZXhPZigxLCAtMCkgPCAwOw0KDQokZXhwb3J0KCRleHBvcnQuUCArICRleHBvcnQuRiAqIChORUdBVElWRV9aRVJPIHx8ICFyZXF1aXJlKCcuL19zdHJpY3QtbWV0aG9kJykoJG5hdGl2ZSkpLCAnQXJyYXknLCB7DQogIC8vIDIyLjEuMy4xNCAvIDE1LjQuNC4xNSBBcnJheS5wcm90b3R5cGUubGFzdEluZGV4T2Yoc2VhcmNoRWxlbWVudCBbLCBmcm9tSW5kZXhdKQ0KICBsYXN0SW5kZXhPZjogZnVuY3Rpb24gbGFzdEluZGV4T2Yoc2VhcmNoRWxlbWVudCAvKiwgZnJvbUluZGV4ID0gQFsqLTFdICovKXsNCiAgICAvLyBjb252ZXJ0IC0wIHRvICswDQogICAgaWYoTkVHQVRJVkVfWkVSTylyZXR1cm4gJG5hdGl2ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IDA7DQogICAgdmFyIE8gICAgICA9IHRvSU9iamVjdCh0aGlzKQ0KICAgICAgLCBsZW5ndGggPSB0b0xlbmd0aChPLmxlbmd0aCkNCiAgICAgICwgaW5kZXggID0gbGVuZ3RoIC0gMTsNCiAgICBpZihhcmd1bWVudHMubGVuZ3RoID4gMSlpbmRleCA9IE1hdGgubWluKGluZGV4LCB0b0ludGVnZXIoYXJndW1lbnRzWzFdKSk7DQogICAgaWYoaW5kZXggPCAwKWluZGV4ID0gbGVuZ3RoICsgaW5kZXg7DQogICAgZm9yKDtpbmRleCA+PSAwOyBpbmRleC0tKWlmKGluZGV4IGluIE8paWYoT1tpbmRleF0gPT09IHNlYXJjaEVsZW1lbnQpcmV0dXJuIGluZGV4IHx8IDA7DQogICAgcmV0dXJuIC0xOw0KICB9DQp9KTsNCn0seyIuL19leHBvcnQiOjMyLCIuL19zdHJpY3QtbWV0aG9kIjo5NiwiLi9fdG8taW50ZWdlciI6MTA2LCIuL190by1pb2JqZWN0IjoxMDcsIi4vX3RvLWxlbmd0aCI6MTA4fV0sMTM0OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCid1c2Ugc3RyaWN0JzsNCnZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0JykNCiAgLCAkbWFwICAgID0gcmVxdWlyZSgnLi9fYXJyYXktbWV0aG9kcycpKDEpOw0KDQokZXhwb3J0KCRleHBvcnQuUCArICRleHBvcnQuRiAqICFyZXF1aXJlKCcuL19zdHJpY3QtbWV0aG9kJykoW10ubWFwLCB0cnVlKSwgJ0FycmF5Jywgew0KICAvLyAyMi4xLjMuMTUgLyAxNS40LjQuMTkgQXJyYXkucHJvdG90eXBlLm1hcChjYWxsYmFja2ZuIFssIHRoaXNBcmddKQ0KICBtYXA6IGZ1bmN0aW9uIG1hcChjYWxsYmFja2ZuIC8qICwgdGhpc0FyZyAqLyl7DQogICAgcmV0dXJuICRtYXAodGhpcywgY2FsbGJhY2tmbiwgYXJndW1lbnRzWzFdKTsNCiAgfQ0KfSk7DQp9LHsiLi9fYXJyYXktbWV0aG9kcyI6MTIsIi4vX2V4cG9ydCI6MzIsIi4vX3N0cmljdC1tZXRob2QiOjk2fV0sMTM1OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCid1c2Ugc3RyaWN0JzsNCnZhciAkZXhwb3J0ICAgICAgICA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpDQogICwgY3JlYXRlUHJvcGVydHkgPSByZXF1aXJlKCcuL19jcmVhdGUtcHJvcGVydHknKTsNCg0KLy8gV2ViS2l0IEFycmF5Lm9mIGlzbid0IGdlbmVyaWMNCiRleHBvcnQoJGV4cG9ydC5TICsgJGV4cG9ydC5GICogcmVxdWlyZSgnLi9fZmFpbHMnKShmdW5jdGlvbigpew0KICBmdW5jdGlvbiBGKCl7fQ0KICByZXR1cm4gIShBcnJheS5vZi5jYWxsKEYpIGluc3RhbmNlb2YgRik7DQp9KSwgJ0FycmF5Jywgew0KICAvLyAyMi4xLjIuMyBBcnJheS5vZiggLi4uaXRlbXMpDQogIG9mOiBmdW5jdGlvbiBvZigvKiAuLi5hcmdzICovKXsNCiAgICB2YXIgaW5kZXggID0gMA0KICAgICAgLCBhTGVuICAgPSBhcmd1bWVudHMubGVuZ3RoDQogICAgICAsIHJlc3VsdCA9IG5ldyAodHlwZW9mIHRoaXMgPT0gJ2Z1bmN0aW9uJyA/IHRoaXMgOiBBcnJheSkoYUxlbik7DQogICAgd2hpbGUoYUxlbiA+IGluZGV4KWNyZWF0ZVByb3BlcnR5KHJlc3VsdCwgaW5kZXgsIGFyZ3VtZW50c1tpbmRleCsrXSk7DQogICAgcmVzdWx0Lmxlbmd0aCA9IGFMZW47DQogICAgcmV0dXJuIHJlc3VsdDsNCiAgfQ0KfSk7DQp9LHsiLi9fY3JlYXRlLXByb3BlcnR5IjoyNCwiLi9fZXhwb3J0IjozMiwiLi9fZmFpbHMiOjM0fV0sMTM2OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCid1c2Ugc3RyaWN0JzsNCnZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0JykNCiAgLCAkcmVkdWNlID0gcmVxdWlyZSgnLi9fYXJyYXktcmVkdWNlJyk7DQoNCiRleHBvcnQoJGV4cG9ydC5QICsgJGV4cG9ydC5GICogIXJlcXVpcmUoJy4vX3N0cmljdC1tZXRob2QnKShbXS5yZWR1Y2VSaWdodCwgdHJ1ZSksICdBcnJheScsIHsNCiAgLy8gMjIuMS4zLjE5IC8gMTUuNC40LjIyIEFycmF5LnByb3RvdHlwZS5yZWR1Y2VSaWdodChjYWxsYmFja2ZuIFssIGluaXRpYWxWYWx1ZV0pDQogIHJlZHVjZVJpZ2h0OiBmdW5jdGlvbiByZWR1Y2VSaWdodChjYWxsYmFja2ZuIC8qICwgaW5pdGlhbFZhbHVlICovKXsNCiAgICByZXR1cm4gJHJlZHVjZSh0aGlzLCBjYWxsYmFja2ZuLCBhcmd1bWVudHMubGVuZ3RoLCBhcmd1bWVudHNbMV0sIHRydWUpOw0KICB9DQp9KTsNCn0seyIuL19hcnJheS1yZWR1Y2UiOjEzLCIuL19leHBvcnQiOjMyLCIuL19zdHJpY3QtbWV0aG9kIjo5Nn1dLDEzNzpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQondXNlIHN0cmljdCc7DQp2YXIgJGV4cG9ydCA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpDQogICwgJHJlZHVjZSA9IHJlcXVpcmUoJy4vX2FycmF5LXJlZHVjZScpOw0KDQokZXhwb3J0KCRleHBvcnQuUCArICRleHBvcnQuRiAqICFyZXF1aXJlKCcuL19zdHJpY3QtbWV0aG9kJykoW10ucmVkdWNlLCB0cnVlKSwgJ0FycmF5Jywgew0KICAvLyAyMi4xLjMuMTggLyAxNS40LjQuMjEgQXJyYXkucHJvdG90eXBlLnJlZHVjZShjYWxsYmFja2ZuIFssIGluaXRpYWxWYWx1ZV0pDQogIHJlZHVjZTogZnVuY3Rpb24gcmVkdWNlKGNhbGxiYWNrZm4gLyogLCBpbml0aWFsVmFsdWUgKi8pew0KICAgIHJldHVybiAkcmVkdWNlKHRoaXMsIGNhbGxiYWNrZm4sIGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3VtZW50c1sxXSwgZmFsc2UpOw0KICB9DQp9KTsNCn0seyIuL19hcnJheS1yZWR1Y2UiOjEzLCIuL19leHBvcnQiOjMyLCIuL19zdHJpY3QtbWV0aG9kIjo5Nn1dLDEzODpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQondXNlIHN0cmljdCc7DQp2YXIgJGV4cG9ydCAgICA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpDQogICwgaHRtbCAgICAgICA9IHJlcXVpcmUoJy4vX2h0bWwnKQ0KICAsIGNvZiAgICAgICAgPSByZXF1aXJlKCcuL19jb2YnKQ0KICAsIHRvSW5kZXggICAgPSByZXF1aXJlKCcuL190by1pbmRleCcpDQogICwgdG9MZW5ndGggICA9IHJlcXVpcmUoJy4vX3RvLWxlbmd0aCcpDQogICwgYXJyYXlTbGljZSA9IFtdLnNsaWNlOw0KDQovLyBmYWxsYmFjayBmb3Igbm90IGFycmF5LWxpa2UgRVMzIHN0cmluZ3MgYW5kIERPTSBvYmplY3RzDQokZXhwb3J0KCRleHBvcnQuUCArICRleHBvcnQuRiAqIHJlcXVpcmUoJy4vX2ZhaWxzJykoZnVuY3Rpb24oKXsNCiAgaWYoaHRtbClhcnJheVNsaWNlLmNhbGwoaHRtbCk7DQp9KSwgJ0FycmF5Jywgew0KICBzbGljZTogZnVuY3Rpb24gc2xpY2UoYmVnaW4sIGVuZCl7DQogICAgdmFyIGxlbiAgID0gdG9MZW5ndGgodGhpcy5sZW5ndGgpDQogICAgICAsIGtsYXNzID0gY29mKHRoaXMpOw0KICAgIGVuZCA9IGVuZCA9PT0gdW5kZWZpbmVkID8gbGVuIDogZW5kOw0KICAgIGlmKGtsYXNzID09ICdBcnJheScpcmV0dXJuIGFycmF5U2xpY2UuY2FsbCh0aGlzLCBiZWdpbiwgZW5kKTsNCiAgICB2YXIgc3RhcnQgID0gdG9JbmRleChiZWdpbiwgbGVuKQ0KICAgICAgLCB1cFRvICAgPSB0b0luZGV4KGVuZCwgbGVuKQ0KICAgICAgLCBzaXplICAgPSB0b0xlbmd0aCh1cFRvIC0gc3RhcnQpDQogICAgICAsIGNsb25lZCA9IEFycmF5KHNpemUpDQogICAgICAsIGkgICAgICA9IDA7DQogICAgZm9yKDsgaSA8IHNpemU7IGkrKyljbG9uZWRbaV0gPSBrbGFzcyA9PSAnU3RyaW5nJw0KICAgICAgPyB0aGlzLmNoYXJBdChzdGFydCArIGkpDQogICAgICA6IHRoaXNbc3RhcnQgKyBpXTsNCiAgICByZXR1cm4gY2xvbmVkOw0KICB9DQp9KTsNCn0seyIuL19jb2YiOjE4LCIuL19leHBvcnQiOjMyLCIuL19mYWlscyI6MzQsIi4vX2h0bWwiOjQxLCIuL190by1pbmRleCI6MTA1LCIuL190by1sZW5ndGgiOjEwOH1dLDEzOTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQondXNlIHN0cmljdCc7DQp2YXIgJGV4cG9ydCA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpDQogICwgJHNvbWUgICA9IHJlcXVpcmUoJy4vX2FycmF5LW1ldGhvZHMnKSgzKTsNCg0KJGV4cG9ydCgkZXhwb3J0LlAgKyAkZXhwb3J0LkYgKiAhcmVxdWlyZSgnLi9fc3RyaWN0LW1ldGhvZCcpKFtdLnNvbWUsIHRydWUpLCAnQXJyYXknLCB7DQogIC8vIDIyLjEuMy4yMyAvIDE1LjQuNC4xNyBBcnJheS5wcm90b3R5cGUuc29tZShjYWxsYmFja2ZuIFssIHRoaXNBcmddKQ0KICBzb21lOiBmdW5jdGlvbiBzb21lKGNhbGxiYWNrZm4gLyogLCB0aGlzQXJnICovKXsNCiAgICByZXR1cm4gJHNvbWUodGhpcywgY2FsbGJhY2tmbiwgYXJndW1lbnRzWzFdKTsNCiAgfQ0KfSk7DQp9LHsiLi9fYXJyYXktbWV0aG9kcyI6MTIsIi4vX2V4cG9ydCI6MzIsIi4vX3N0cmljdC1tZXRob2QiOjk2fV0sMTQwOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCid1c2Ugc3RyaWN0JzsNCnZhciAkZXhwb3J0ICAgPSByZXF1aXJlKCcuL19leHBvcnQnKQ0KICAsIGFGdW5jdGlvbiA9IHJlcXVpcmUoJy4vX2EtZnVuY3Rpb24nKQ0KICAsIHRvT2JqZWN0ICA9IHJlcXVpcmUoJy4vX3RvLW9iamVjdCcpDQogICwgZmFpbHMgICAgID0gcmVxdWlyZSgnLi9fZmFpbHMnKQ0KICAsICRzb3J0ICAgICA9IFtdLnNvcnQNCiAgLCB0ZXN0ICAgICAgPSBbMSwgMiwgM107DQoNCiRleHBvcnQoJGV4cG9ydC5QICsgJGV4cG9ydC5GICogKGZhaWxzKGZ1bmN0aW9uKCl7DQogIC8vIElFOC0NCiAgdGVzdC5zb3J0KHVuZGVmaW5lZCk7DQp9KSB8fCAhZmFpbHMoZnVuY3Rpb24oKXsNCiAgLy8gVjggYnVnDQogIHRlc3Quc29ydChudWxsKTsNCiAgLy8gT2xkIFdlYktpdA0KfSkgfHwgIXJlcXVpcmUoJy4vX3N0cmljdC1tZXRob2QnKSgkc29ydCkpLCAnQXJyYXknLCB7DQogIC8vIDIyLjEuMy4yNSBBcnJheS5wcm90b3R5cGUuc29ydChjb21wYXJlZm4pDQogIHNvcnQ6IGZ1bmN0aW9uIHNvcnQoY29tcGFyZWZuKXsNCiAgICByZXR1cm4gY29tcGFyZWZuID09PSB1bmRlZmluZWQNCiAgICAgID8gJHNvcnQuY2FsbCh0b09iamVjdCh0aGlzKSkNCiAgICAgIDogJHNvcnQuY2FsbCh0b09iamVjdCh0aGlzKSwgYUZ1bmN0aW9uKGNvbXBhcmVmbikpOw0KICB9DQp9KTsNCn0seyIuL19hLWZ1bmN0aW9uIjozLCIuL19leHBvcnQiOjMyLCIuL19mYWlscyI6MzQsIi4vX3N0cmljdC1tZXRob2QiOjk2LCIuL190by1vYmplY3QiOjEwOX1dLDE0MTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQpyZXF1aXJlKCcuL19zZXQtc3BlY2llcycpKCdBcnJheScpOw0KfSx7Ii4vX3NldC1zcGVjaWVzIjo5MX1dLDE0MjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQovLyAyMC4zLjMuMSAvIDE1LjkuNC40IERhdGUubm93KCkNCnZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0Jyk7DQoNCiRleHBvcnQoJGV4cG9ydC5TLCAnRGF0ZScsIHtub3c6IGZ1bmN0aW9uKCl7IHJldHVybiBuZXcgRGF0ZSgpLmdldFRpbWUoKTsgfX0pOw0KfSx7Ii4vX2V4cG9ydCI6MzJ9XSwxNDM6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KJ3VzZSBzdHJpY3QnOw0KLy8gMjAuMy40LjM2IC8gMTUuOS41LjQzIERhdGUucHJvdG90eXBlLnRvSVNPU3RyaW5nKCkNCnZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0JykNCiAgLCBmYWlscyAgID0gcmVxdWlyZSgnLi9fZmFpbHMnKQ0KICAsIGdldFRpbWUgPSBEYXRlLnByb3RvdHlwZS5nZXRUaW1lOw0KDQp2YXIgbHogPSBmdW5jdGlvbihudW0pew0KICByZXR1cm4gbnVtID4gOSA/IG51bSA6ICcwJyArIG51bTsNCn07DQoNCi8vIFBoYW50b21KUyAvIG9sZCBXZWJLaXQgaGFzIGEgYnJva2VuIGltcGxlbWVudGF0aW9ucw0KJGV4cG9ydCgkZXhwb3J0LlAgKyAkZXhwb3J0LkYgKiAoZmFpbHMoZnVuY3Rpb24oKXsNCiAgcmV0dXJuIG5ldyBEYXRlKC01ZTEzIC0gMSkudG9JU09TdHJpbmcoKSAhPSAnMDM4NS0wNy0yNVQwNzowNjozOS45OTlaJzsNCn0pIHx8ICFmYWlscyhmdW5jdGlvbigpew0KICBuZXcgRGF0ZShOYU4pLnRvSVNPU3RyaW5nKCk7DQp9KSksICdEYXRlJywgew0KICB0b0lTT1N0cmluZzogZnVuY3Rpb24gdG9JU09TdHJpbmcoKXsNCiAgICBpZighaXNGaW5pdGUoZ2V0VGltZS5jYWxsKHRoaXMpKSl0aHJvdyBSYW5nZUVycm9yKCdJbnZhbGlkIHRpbWUgdmFsdWUnKTsNCiAgICB2YXIgZCA9IHRoaXMNCiAgICAgICwgeSA9IGQuZ2V0VVRDRnVsbFllYXIoKQ0KICAgICAgLCBtID0gZC5nZXRVVENNaWxsaXNlY29uZHMoKQ0KICAgICAgLCBzID0geSA8IDAgPyAnLScgOiB5ID4gOTk5OSA/ICcrJyA6ICcnOw0KICAgIHJldHVybiBzICsgKCcwMDAwMCcgKyBNYXRoLmFicyh5KSkuc2xpY2UocyA/IC02IDogLTQpICsNCiAgICAgICctJyArIGx6KGQuZ2V0VVRDTW9udGgoKSArIDEpICsgJy0nICsgbHooZC5nZXRVVENEYXRlKCkpICsNCiAgICAgICdUJyArIGx6KGQuZ2V0VVRDSG91cnMoKSkgKyAnOicgKyBseihkLmdldFVUQ01pbnV0ZXMoKSkgKw0KICAgICAgJzonICsgbHooZC5nZXRVVENTZWNvbmRzKCkpICsgJy4nICsgKG0gPiA5OSA/IG0gOiAnMCcgKyBseihtKSkgKyAnWic7DQogIH0NCn0pOw0KfSx7Ii4vX2V4cG9ydCI6MzIsIi4vX2ZhaWxzIjozNH1dLDE0NDpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQondXNlIHN0cmljdCc7DQp2YXIgJGV4cG9ydCAgICAgPSByZXF1aXJlKCcuL19leHBvcnQnKQ0KICAsIHRvT2JqZWN0ICAgID0gcmVxdWlyZSgnLi9fdG8tb2JqZWN0JykNCiAgLCB0b1ByaW1pdGl2ZSA9IHJlcXVpcmUoJy4vX3RvLXByaW1pdGl2ZScpOw0KDQokZXhwb3J0KCRleHBvcnQuUCArICRleHBvcnQuRiAqIHJlcXVpcmUoJy4vX2ZhaWxzJykoZnVuY3Rpb24oKXsNCiAgcmV0dXJuIG5ldyBEYXRlKE5hTikudG9KU09OKCkgIT09IG51bGwgfHwgRGF0ZS5wcm90b3R5cGUudG9KU09OLmNhbGwoe3RvSVNPU3RyaW5nOiBmdW5jdGlvbigpeyByZXR1cm4gMTsgfX0pICE9PSAxOw0KfSksICdEYXRlJywgew0KICB0b0pTT046IGZ1bmN0aW9uIHRvSlNPTihrZXkpew0KICAgIHZhciBPICA9IHRvT2JqZWN0KHRoaXMpDQogICAgICAsIHB2ID0gdG9QcmltaXRpdmUoTyk7DQogICAgcmV0dXJuIHR5cGVvZiBwdiA9PSAnbnVtYmVyJyAmJiAhaXNGaW5pdGUocHYpID8gbnVsbCA6IE8udG9JU09TdHJpbmcoKTsNCiAgfQ0KfSk7DQp9LHsiLi9fZXhwb3J0IjozMiwiLi9fZmFpbHMiOjM0LCIuL190by1vYmplY3QiOjEwOSwiLi9fdG8tcHJpbWl0aXZlIjoxMTB9XSwxNDU6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KdmFyIFRPX1BSSU1JVElWRSA9IHJlcXVpcmUoJy4vX3drcycpKCd0b1ByaW1pdGl2ZScpDQogICwgcHJvdG8gICAgICAgID0gRGF0ZS5wcm90b3R5cGU7DQoNCmlmKCEoVE9fUFJJTUlUSVZFIGluIHByb3RvKSlyZXF1aXJlKCcuL19oaWRlJykocHJvdG8sIFRPX1BSSU1JVElWRSwgcmVxdWlyZSgnLi9fZGF0ZS10by1wcmltaXRpdmUnKSk7DQp9LHsiLi9fZGF0ZS10by1wcmltaXRpdmUiOjI2LCIuL19oaWRlIjo0MCwiLi9fd2tzIjoxMTd9XSwxNDY6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KdmFyIERhdGVQcm90byAgICA9IERhdGUucHJvdG90eXBlDQogICwgSU5WQUxJRF9EQVRFID0gJ0ludmFsaWQgRGF0ZScNCiAgLCBUT19TVFJJTkcgICAgPSAndG9TdHJpbmcnDQogICwgJHRvU3RyaW5nICAgID0gRGF0ZVByb3RvW1RPX1NUUklOR10NCiAgLCBnZXRUaW1lICAgICAgPSBEYXRlUHJvdG8uZ2V0VGltZTsNCmlmKG5ldyBEYXRlKE5hTikgKyAnJyAhPSBJTlZBTElEX0RBVEUpew0KICByZXF1aXJlKCcuL19yZWRlZmluZScpKERhdGVQcm90bywgVE9fU1RSSU5HLCBmdW5jdGlvbiB0b1N0cmluZygpew0KICAgIHZhciB2YWx1ZSA9IGdldFRpbWUuY2FsbCh0aGlzKTsNCiAgICByZXR1cm4gdmFsdWUgPT09IHZhbHVlID8gJHRvU3RyaW5nLmNhbGwodGhpcykgOiBJTlZBTElEX0RBVEU7DQogIH0pOw0KfQ0KfSx7Ii4vX3JlZGVmaW5lIjo4N31dLDE0NzpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQovLyAxOS4yLjMuMiAvIDE1LjMuNC41IEZ1bmN0aW9uLnByb3RvdHlwZS5iaW5kKHRoaXNBcmcsIGFyZ3MuLi4pDQp2YXIgJGV4cG9ydCA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpOw0KDQokZXhwb3J0KCRleHBvcnQuUCwgJ0Z1bmN0aW9uJywge2JpbmQ6IHJlcXVpcmUoJy4vX2JpbmQnKX0pOw0KfSx7Ii4vX2JpbmQiOjE2LCIuL19leHBvcnQiOjMyfV0sMTQ4OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCid1c2Ugc3RyaWN0JzsNCnZhciBpc09iamVjdCAgICAgICA9IHJlcXVpcmUoJy4vX2lzLW9iamVjdCcpDQogICwgZ2V0UHJvdG90eXBlT2YgPSByZXF1aXJlKCcuL19vYmplY3QtZ3BvJykNCiAgLCBIQVNfSU5TVEFOQ0UgICA9IHJlcXVpcmUoJy4vX3drcycpKCdoYXNJbnN0YW5jZScpDQogICwgRnVuY3Rpb25Qcm90byAgPSBGdW5jdGlvbi5wcm90b3R5cGU7DQovLyAxOS4yLjMuNiBGdW5jdGlvbi5wcm90b3R5cGVbQEBoYXNJbnN0YW5jZV0oVikNCmlmKCEoSEFTX0lOU1RBTkNFIGluIEZ1bmN0aW9uUHJvdG8pKXJlcXVpcmUoJy4vX29iamVjdC1kcCcpLmYoRnVuY3Rpb25Qcm90bywgSEFTX0lOU1RBTkNFLCB7dmFsdWU6IGZ1bmN0aW9uKE8pew0KICBpZih0eXBlb2YgdGhpcyAhPSAnZnVuY3Rpb24nIHx8ICFpc09iamVjdChPKSlyZXR1cm4gZmFsc2U7DQogIGlmKCFpc09iamVjdCh0aGlzLnByb3RvdHlwZSkpcmV0dXJuIE8gaW5zdGFuY2VvZiB0aGlzOw0KICAvLyBmb3IgZW52aXJvbm1lbnQgdy9vIG5hdGl2ZSBgQEBoYXNJbnN0YW5jZWAgbG9naWMgZW5vdWdoIGBpbnN0YW5jZW9mYCwgYnV0IGFkZCB0aGlzOg0KICB3aGlsZShPID0gZ2V0UHJvdG90eXBlT2YoTykpaWYodGhpcy5wcm90b3R5cGUgPT09IE8pcmV0dXJuIHRydWU7DQogIHJldHVybiBmYWxzZTsNCn19KTsNCn0seyIuL19pcy1vYmplY3QiOjQ5LCIuL19vYmplY3QtZHAiOjY3LCIuL19vYmplY3QtZ3BvIjo3NCwiLi9fd2tzIjoxMTd9XSwxNDk6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KdmFyIGRQICAgICAgICAgPSByZXF1aXJlKCcuL19vYmplY3QtZHAnKS5mDQogICwgY3JlYXRlRGVzYyA9IHJlcXVpcmUoJy4vX3Byb3BlcnR5LWRlc2MnKQ0KICAsIGhhcyAgICAgICAgPSByZXF1aXJlKCcuL19oYXMnKQ0KICAsIEZQcm90byAgICAgPSBGdW5jdGlvbi5wcm90b3R5cGUNCiAgLCBuYW1lUkUgICAgID0gL15ccypmdW5jdGlvbiAoW14gKF0qKS8NCiAgLCBOQU1FICAgICAgID0gJ25hbWUnOw0KDQp2YXIgaXNFeHRlbnNpYmxlID0gT2JqZWN0LmlzRXh0ZW5zaWJsZSB8fCBmdW5jdGlvbigpew0KICByZXR1cm4gdHJ1ZTsNCn07DQoNCi8vIDE5LjIuNC4yIG5hbWUNCk5BTUUgaW4gRlByb3RvIHx8IHJlcXVpcmUoJy4vX2Rlc2NyaXB0b3JzJykgJiYgZFAoRlByb3RvLCBOQU1FLCB7DQogIGNvbmZpZ3VyYWJsZTogdHJ1ZSwNCiAgZ2V0OiBmdW5jdGlvbigpew0KICAgIHRyeSB7DQogICAgICB2YXIgdGhhdCA9IHRoaXMNCiAgICAgICAgLCBuYW1lID0gKCcnICsgdGhhdCkubWF0Y2gobmFtZVJFKVsxXTsNCiAgICAgIGhhcyh0aGF0LCBOQU1FKSB8fCAhaXNFeHRlbnNpYmxlKHRoYXQpIHx8IGRQKHRoYXQsIE5BTUUsIGNyZWF0ZURlc2MoNSwgbmFtZSkpOw0KICAgICAgcmV0dXJuIG5hbWU7DQogICAgfSBjYXRjaChlKXsNCiAgICAgIHJldHVybiAnJzsNCiAgICB9DQogIH0NCn0pOw0KfSx7Ii4vX2Rlc2NyaXB0b3JzIjoyOCwiLi9faGFzIjozOSwiLi9fb2JqZWN0LWRwIjo2NywiLi9fcHJvcGVydHktZGVzYyI6ODV9XSwxNTA6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KJ3VzZSBzdHJpY3QnOw0KdmFyIHN0cm9uZyA9IHJlcXVpcmUoJy4vX2NvbGxlY3Rpb24tc3Ryb25nJyk7DQoNCi8vIDIzLjEgTWFwIE9iamVjdHMNCm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZSgnLi9fY29sbGVjdGlvbicpKCdNYXAnLCBmdW5jdGlvbihnZXQpew0KICByZXR1cm4gZnVuY3Rpb24gTWFwKCl7IHJldHVybiBnZXQodGhpcywgYXJndW1lbnRzLmxlbmd0aCA+IDAgPyBhcmd1bWVudHNbMF0gOiB1bmRlZmluZWQpOyB9Ow0KfSwgew0KICAvLyAyMy4xLjMuNiBNYXAucHJvdG90eXBlLmdldChrZXkpDQogIGdldDogZnVuY3Rpb24gZ2V0KGtleSl7DQogICAgdmFyIGVudHJ5ID0gc3Ryb25nLmdldEVudHJ5KHRoaXMsIGtleSk7DQogICAgcmV0dXJuIGVudHJ5ICYmIGVudHJ5LnY7DQogIH0sDQogIC8vIDIzLjEuMy45IE1hcC5wcm90b3R5cGUuc2V0KGtleSwgdmFsdWUpDQogIHNldDogZnVuY3Rpb24gc2V0KGtleSwgdmFsdWUpew0KICAgIHJldHVybiBzdHJvbmcuZGVmKHRoaXMsIGtleSA9PT0gMCA/IDAgOiBrZXksIHZhbHVlKTsNCiAgfQ0KfSwgc3Ryb25nLCB0cnVlKTsNCn0seyIuL19jb2xsZWN0aW9uIjoyMiwiLi9fY29sbGVjdGlvbi1zdHJvbmciOjE5fV0sMTUxOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCi8vIDIwLjIuMi4zIE1hdGguYWNvc2goeCkNCnZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0JykNCiAgLCBsb2cxcCAgID0gcmVxdWlyZSgnLi9fbWF0aC1sb2cxcCcpDQogICwgc3FydCAgICA9IE1hdGguc3FydA0KICAsICRhY29zaCAgPSBNYXRoLmFjb3NoOw0KDQokZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqICEoJGFjb3NoDQogIC8vIFY4IGJ1ZzogaHR0cHM6Ly9jb2RlLmdvb2dsZS5jb20vcC92OC9pc3N1ZXMvZGV0YWlsP2lkPTM1MDkNCiAgJiYgTWF0aC5mbG9vcigkYWNvc2goTnVtYmVyLk1BWF9WQUxVRSkpID09IDcxMA0KICAvLyBUb3IgQnJvd3NlciBidWc6IE1hdGguYWNvc2goSW5maW5pdHkpIC0+IE5hTiANCiAgJiYgJGFjb3NoKEluZmluaXR5KSA9PSBJbmZpbml0eQ0KKSwgJ01hdGgnLCB7DQogIGFjb3NoOiBmdW5jdGlvbiBhY29zaCh4KXsNCiAgICByZXR1cm4gKHggPSAreCkgPCAxID8gTmFOIDogeCA+IDk0OTA2MjY1LjYyNDI1MTU2DQogICAgICA/IE1hdGgubG9nKHgpICsgTWF0aC5MTjINCiAgICAgIDogbG9nMXAoeCAtIDEgKyBzcXJ0KHggLSAxKSAqIHNxcnQoeCArIDEpKTsNCiAgfQ0KfSk7DQp9LHsiLi9fZXhwb3J0IjozMiwiLi9fbWF0aC1sb2cxcCI6NjB9XSwxNTI6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KLy8gMjAuMi4yLjUgTWF0aC5hc2luaCh4KQ0KdmFyICRleHBvcnQgPSByZXF1aXJlKCcuL19leHBvcnQnKQ0KICAsICRhc2luaCAgPSBNYXRoLmFzaW5oOw0KDQpmdW5jdGlvbiBhc2luaCh4KXsNCiAgcmV0dXJuICFpc0Zpbml0ZSh4ID0gK3gpIHx8IHggPT0gMCA/IHggOiB4IDwgMCA/IC1hc2luaCgteCkgOiBNYXRoLmxvZyh4ICsgTWF0aC5zcXJ0KHggKiB4ICsgMSkpOw0KfQ0KDQovLyBUb3IgQnJvd3NlciBidWc6IE1hdGguYXNpbmgoMCkgLT4gLTAgDQokZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqICEoJGFzaW5oICYmIDEgLyAkYXNpbmgoMCkgPiAwKSwgJ01hdGgnLCB7YXNpbmg6IGFzaW5ofSk7DQp9LHsiLi9fZXhwb3J0IjozMn1dLDE1MzpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQovLyAyMC4yLjIuNyBNYXRoLmF0YW5oKHgpDQp2YXIgJGV4cG9ydCA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpDQogICwgJGF0YW5oICA9IE1hdGguYXRhbmg7DQoNCi8vIFRvciBCcm93c2VyIGJ1ZzogTWF0aC5hdGFuaCgtMCkgLT4gMCANCiRleHBvcnQoJGV4cG9ydC5TICsgJGV4cG9ydC5GICogISgkYXRhbmggJiYgMSAvICRhdGFuaCgtMCkgPCAwKSwgJ01hdGgnLCB7DQogIGF0YW5oOiBmdW5jdGlvbiBhdGFuaCh4KXsNCiAgICByZXR1cm4gKHggPSAreCkgPT0gMCA/IHggOiBNYXRoLmxvZygoMSArIHgpIC8gKDEgLSB4KSkgLyAyOw0KICB9DQp9KTsNCn0seyIuL19leHBvcnQiOjMyfV0sMTU0OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCi8vIDIwLjIuMi45IE1hdGguY2JydCh4KQ0KdmFyICRleHBvcnQgPSByZXF1aXJlKCcuL19leHBvcnQnKQ0KICAsIHNpZ24gICAgPSByZXF1aXJlKCcuL19tYXRoLXNpZ24nKTsNCg0KJGV4cG9ydCgkZXhwb3J0LlMsICdNYXRoJywgew0KICBjYnJ0OiBmdW5jdGlvbiBjYnJ0KHgpew0KICAgIHJldHVybiBzaWduKHggPSAreCkgKiBNYXRoLnBvdyhNYXRoLmFicyh4KSwgMSAvIDMpOw0KICB9DQp9KTsNCn0seyIuL19leHBvcnQiOjMyLCIuL19tYXRoLXNpZ24iOjYxfV0sMTU1OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCi8vIDIwLjIuMi4xMSBNYXRoLmNsejMyKHgpDQp2YXIgJGV4cG9ydCA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpOw0KDQokZXhwb3J0KCRleHBvcnQuUywgJ01hdGgnLCB7DQogIGNsejMyOiBmdW5jdGlvbiBjbHozMih4KXsNCiAgICByZXR1cm4gKHggPj4+PSAwKSA/IDMxIC0gTWF0aC5mbG9vcihNYXRoLmxvZyh4ICsgMC41KSAqIE1hdGguTE9HMkUpIDogMzI7DQogIH0NCn0pOw0KfSx7Ii4vX2V4cG9ydCI6MzJ9XSwxNTY6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KLy8gMjAuMi4yLjEyIE1hdGguY29zaCh4KQ0KdmFyICRleHBvcnQgPSByZXF1aXJlKCcuL19leHBvcnQnKQ0KICAsIGV4cCAgICAgPSBNYXRoLmV4cDsNCg0KJGV4cG9ydCgkZXhwb3J0LlMsICdNYXRoJywgew0KICBjb3NoOiBmdW5jdGlvbiBjb3NoKHgpew0KICAgIHJldHVybiAoZXhwKHggPSAreCkgKyBleHAoLXgpKSAvIDI7DQogIH0NCn0pOw0KfSx7Ii4vX2V4cG9ydCI6MzJ9XSwxNTc6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KLy8gMjAuMi4yLjE0IE1hdGguZXhwbTEoeCkNCnZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0JykNCiAgLCAkZXhwbTEgID0gcmVxdWlyZSgnLi9fbWF0aC1leHBtMScpOw0KDQokZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqICgkZXhwbTEgIT0gTWF0aC5leHBtMSksICdNYXRoJywge2V4cG0xOiAkZXhwbTF9KTsNCn0seyIuL19leHBvcnQiOjMyLCIuL19tYXRoLWV4cG0xIjo1OX1dLDE1ODpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQovLyAyMC4yLjIuMTYgTWF0aC5mcm91bmQoeCkNCnZhciAkZXhwb3J0ICAgPSByZXF1aXJlKCcuL19leHBvcnQnKQ0KICAsIHNpZ24gICAgICA9IHJlcXVpcmUoJy4vX21hdGgtc2lnbicpDQogICwgcG93ICAgICAgID0gTWF0aC5wb3cNCiAgLCBFUFNJTE9OICAgPSBwb3coMiwgLTUyKQ0KICAsIEVQU0lMT04zMiA9IHBvdygyLCAtMjMpDQogICwgTUFYMzIgICAgID0gcG93KDIsIDEyNykgKiAoMiAtIEVQU0lMT04zMikNCiAgLCBNSU4zMiAgICAgPSBwb3coMiwgLTEyNik7DQoNCnZhciByb3VuZFRpZXNUb0V2ZW4gPSBmdW5jdGlvbihuKXsNCiAgcmV0dXJuIG4gKyAxIC8gRVBTSUxPTiAtIDEgLyBFUFNJTE9OOw0KfTsNCg0KDQokZXhwb3J0KCRleHBvcnQuUywgJ01hdGgnLCB7DQogIGZyb3VuZDogZnVuY3Rpb24gZnJvdW5kKHgpew0KICAgIHZhciAkYWJzICA9IE1hdGguYWJzKHgpDQogICAgICAsICRzaWduID0gc2lnbih4KQ0KICAgICAgLCBhLCByZXN1bHQ7DQogICAgaWYoJGFicyA8IE1JTjMyKXJldHVybiAkc2lnbiAqIHJvdW5kVGllc1RvRXZlbigkYWJzIC8gTUlOMzIgLyBFUFNJTE9OMzIpICogTUlOMzIgKiBFUFNJTE9OMzI7DQogICAgYSA9ICgxICsgRVBTSUxPTjMyIC8gRVBTSUxPTikgKiAkYWJzOw0KICAgIHJlc3VsdCA9IGEgLSAoYSAtICRhYnMpOw0KICAgIGlmKHJlc3VsdCA+IE1BWDMyIHx8IHJlc3VsdCAhPSByZXN1bHQpcmV0dXJuICRzaWduICogSW5maW5pdHk7DQogICAgcmV0dXJuICRzaWduICogcmVzdWx0Ow0KICB9DQp9KTsNCn0seyIuL19leHBvcnQiOjMyLCIuL19tYXRoLXNpZ24iOjYxfV0sMTU5OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCi8vIDIwLjIuMi4xNyBNYXRoLmh5cG90KFt2YWx1ZTFbLCB2YWx1ZTJbLCCFIF1dXSkNCnZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0JykNCiAgLCBhYnMgICAgID0gTWF0aC5hYnM7DQoNCiRleHBvcnQoJGV4cG9ydC5TLCAnTWF0aCcsIHsNCiAgaHlwb3Q6IGZ1bmN0aW9uIGh5cG90KHZhbHVlMSwgdmFsdWUyKXsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby11bnVzZWQtdmFycw0KICAgIHZhciBzdW0gID0gMA0KICAgICAgLCBpICAgID0gMA0KICAgICAgLCBhTGVuID0gYXJndW1lbnRzLmxlbmd0aA0KICAgICAgLCBsYXJnID0gMA0KICAgICAgLCBhcmcsIGRpdjsNCiAgICB3aGlsZShpIDwgYUxlbil7DQogICAgICBhcmcgPSBhYnMoYXJndW1lbnRzW2krK10pOw0KICAgICAgaWYobGFyZyA8IGFyZyl7DQogICAgICAgIGRpdiAgPSBsYXJnIC8gYXJnOw0KICAgICAgICBzdW0gID0gc3VtICogZGl2ICogZGl2ICsgMTsNCiAgICAgICAgbGFyZyA9IGFyZzsNCiAgICAgIH0gZWxzZSBpZihhcmcgPiAwKXsNCiAgICAgICAgZGl2ICA9IGFyZyAvIGxhcmc7DQogICAgICAgIHN1bSArPSBkaXYgKiBkaXY7DQogICAgICB9IGVsc2Ugc3VtICs9IGFyZzsNCiAgICB9DQogICAgcmV0dXJuIGxhcmcgPT09IEluZmluaXR5ID8gSW5maW5pdHkgOiBsYXJnICogTWF0aC5zcXJ0KHN1bSk7DQogIH0NCn0pOw0KfSx7Ii4vX2V4cG9ydCI6MzJ9XSwxNjA6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KLy8gMjAuMi4yLjE4IE1hdGguaW11bCh4LCB5KQ0KdmFyICRleHBvcnQgPSByZXF1aXJlKCcuL19leHBvcnQnKQ0KICAsICRpbXVsICAgPSBNYXRoLmltdWw7DQoNCi8vIHNvbWUgV2ViS2l0IHZlcnNpb25zIGZhaWxzIHdpdGggYmlnIG51bWJlcnMsIHNvbWUgaGFzIHdyb25nIGFyaXR5DQokZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqIHJlcXVpcmUoJy4vX2ZhaWxzJykoZnVuY3Rpb24oKXsNCiAgcmV0dXJuICRpbXVsKDB4ZmZmZmZmZmYsIDUpICE9IC01IHx8ICRpbXVsLmxlbmd0aCAhPSAyOw0KfSksICdNYXRoJywgew0KICBpbXVsOiBmdW5jdGlvbiBpbXVsKHgsIHkpew0KICAgIHZhciBVSU5UMTYgPSAweGZmZmYNCiAgICAgICwgeG4gPSAreA0KICAgICAgLCB5biA9ICt5DQogICAgICAsIHhsID0gVUlOVDE2ICYgeG4NCiAgICAgICwgeWwgPSBVSU5UMTYgJiB5bjsNCiAgICByZXR1cm4gMCB8IHhsICogeWwgKyAoKFVJTlQxNiAmIHhuID4+PiAxNikgKiB5bCArIHhsICogKFVJTlQxNiAmIHluID4+PiAxNikgPDwgMTYgPj4+IDApOw0KICB9DQp9KTsNCn0seyIuL19leHBvcnQiOjMyLCIuL19mYWlscyI6MzR9XSwxNjE6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KLy8gMjAuMi4yLjIxIE1hdGgubG9nMTAoeCkNCnZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0Jyk7DQoNCiRleHBvcnQoJGV4cG9ydC5TLCAnTWF0aCcsIHsNCiAgbG9nMTA6IGZ1bmN0aW9uIGxvZzEwKHgpew0KICAgIHJldHVybiBNYXRoLmxvZyh4KSAvIE1hdGguTE4xMDsNCiAgfQ0KfSk7DQp9LHsiLi9fZXhwb3J0IjozMn1dLDE2MjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQovLyAyMC4yLjIuMjAgTWF0aC5sb2cxcCh4KQ0KdmFyICRleHBvcnQgPSByZXF1aXJlKCcuL19leHBvcnQnKTsNCg0KJGV4cG9ydCgkZXhwb3J0LlMsICdNYXRoJywge2xvZzFwOiByZXF1aXJlKCcuL19tYXRoLWxvZzFwJyl9KTsNCn0seyIuL19leHBvcnQiOjMyLCIuL19tYXRoLWxvZzFwIjo2MH1dLDE2MzpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQovLyAyMC4yLjIuMjIgTWF0aC5sb2cyKHgpDQp2YXIgJGV4cG9ydCA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpOw0KDQokZXhwb3J0KCRleHBvcnQuUywgJ01hdGgnLCB7DQogIGxvZzI6IGZ1bmN0aW9uIGxvZzIoeCl7DQogICAgcmV0dXJuIE1hdGgubG9nKHgpIC8gTWF0aC5MTjI7DQogIH0NCn0pOw0KfSx7Ii4vX2V4cG9ydCI6MzJ9XSwxNjQ6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KLy8gMjAuMi4yLjI4IE1hdGguc2lnbih4KQ0KdmFyICRleHBvcnQgPSByZXF1aXJlKCcuL19leHBvcnQnKTsNCg0KJGV4cG9ydCgkZXhwb3J0LlMsICdNYXRoJywge3NpZ246IHJlcXVpcmUoJy4vX21hdGgtc2lnbicpfSk7DQp9LHsiLi9fZXhwb3J0IjozMiwiLi9fbWF0aC1zaWduIjo2MX1dLDE2NTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQovLyAyMC4yLjIuMzAgTWF0aC5zaW5oKHgpDQp2YXIgJGV4cG9ydCA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpDQogICwgZXhwbTEgICA9IHJlcXVpcmUoJy4vX21hdGgtZXhwbTEnKQ0KICAsIGV4cCAgICAgPSBNYXRoLmV4cDsNCg0KLy8gVjggbmVhciBDaHJvbWl1bSAzOCBoYXMgYSBwcm9ibGVtIHdpdGggdmVyeSBzbWFsbCBudW1iZXJzDQokZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqIHJlcXVpcmUoJy4vX2ZhaWxzJykoZnVuY3Rpb24oKXsNCiAgcmV0dXJuICFNYXRoLnNpbmgoLTJlLTE3KSAhPSAtMmUtMTc7DQp9KSwgJ01hdGgnLCB7DQogIHNpbmg6IGZ1bmN0aW9uIHNpbmgoeCl7DQogICAgcmV0dXJuIE1hdGguYWJzKHggPSAreCkgPCAxDQogICAgICA/IChleHBtMSh4KSAtIGV4cG0xKC14KSkgLyAyDQogICAgICA6IChleHAoeCAtIDEpIC0gZXhwKC14IC0gMSkpICogKE1hdGguRSAvIDIpOw0KICB9DQp9KTsNCn0seyIuL19leHBvcnQiOjMyLCIuL19mYWlscyI6MzQsIi4vX21hdGgtZXhwbTEiOjU5fV0sMTY2OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCi8vIDIwLjIuMi4zMyBNYXRoLnRhbmgoeCkNCnZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0JykNCiAgLCBleHBtMSAgID0gcmVxdWlyZSgnLi9fbWF0aC1leHBtMScpDQogICwgZXhwICAgICA9IE1hdGguZXhwOw0KDQokZXhwb3J0KCRleHBvcnQuUywgJ01hdGgnLCB7DQogIHRhbmg6IGZ1bmN0aW9uIHRhbmgoeCl7DQogICAgdmFyIGEgPSBleHBtMSh4ID0gK3gpDQogICAgICAsIGIgPSBleHBtMSgteCk7DQogICAgcmV0dXJuIGEgPT0gSW5maW5pdHkgPyAxIDogYiA9PSBJbmZpbml0eSA/IC0xIDogKGEgLSBiKSAvIChleHAoeCkgKyBleHAoLXgpKTsNCiAgfQ0KfSk7DQp9LHsiLi9fZXhwb3J0IjozMiwiLi9fbWF0aC1leHBtMSI6NTl9XSwxNjc6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KLy8gMjAuMi4yLjM0IE1hdGgudHJ1bmMoeCkNCnZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0Jyk7DQoNCiRleHBvcnQoJGV4cG9ydC5TLCAnTWF0aCcsIHsNCiAgdHJ1bmM6IGZ1bmN0aW9uIHRydW5jKGl0KXsNCiAgICByZXR1cm4gKGl0ID4gMCA/IE1hdGguZmxvb3IgOiBNYXRoLmNlaWwpKGl0KTsNCiAgfQ0KfSk7DQp9LHsiLi9fZXhwb3J0IjozMn1dLDE2ODpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQondXNlIHN0cmljdCc7DQp2YXIgZ2xvYmFsICAgICAgICAgICAgPSByZXF1aXJlKCcuL19nbG9iYWwnKQ0KICAsIGhhcyAgICAgICAgICAgICAgID0gcmVxdWlyZSgnLi9faGFzJykNCiAgLCBjb2YgICAgICAgICAgICAgICA9IHJlcXVpcmUoJy4vX2NvZicpDQogICwgaW5oZXJpdElmUmVxdWlyZWQgPSByZXF1aXJlKCcuL19pbmhlcml0LWlmLXJlcXVpcmVkJykNCiAgLCB0b1ByaW1pdGl2ZSAgICAgICA9IHJlcXVpcmUoJy4vX3RvLXByaW1pdGl2ZScpDQogICwgZmFpbHMgICAgICAgICAgICAgPSByZXF1aXJlKCcuL19mYWlscycpDQogICwgZ09QTiAgICAgICAgICAgICAgPSByZXF1aXJlKCcuL19vYmplY3QtZ29wbicpLmYNCiAgLCBnT1BEICAgICAgICAgICAgICA9IHJlcXVpcmUoJy4vX29iamVjdC1nb3BkJykuZg0KICAsIGRQICAgICAgICAgICAgICAgID0gcmVxdWlyZSgnLi9fb2JqZWN0LWRwJykuZg0KICAsICR0cmltICAgICAgICAgICAgID0gcmVxdWlyZSgnLi9fc3RyaW5nLXRyaW0nKS50cmltDQogICwgTlVNQkVSICAgICAgICAgICAgPSAnTnVtYmVyJw0KICAsICROdW1iZXIgICAgICAgICAgID0gZ2xvYmFsW05VTUJFUl0NCiAgLCBCYXNlICAgICAgICAgICAgICA9ICROdW1iZXINCiAgLCBwcm90byAgICAgICAgICAgICA9ICROdW1iZXIucHJvdG90eXBlDQogIC8vIE9wZXJhIH4xMiBoYXMgYnJva2VuIE9iamVjdCN0b1N0cmluZw0KICAsIEJST0tFTl9DT0YgICAgICAgID0gY29mKHJlcXVpcmUoJy4vX29iamVjdC1jcmVhdGUnKShwcm90bykpID09IE5VTUJFUg0KICAsIFRSSU0gICAgICAgICAgICAgID0gJ3RyaW0nIGluIFN0cmluZy5wcm90b3R5cGU7DQoNCi8vIDcuMS4zIFRvTnVtYmVyKGFyZ3VtZW50KQ0KdmFyIHRvTnVtYmVyID0gZnVuY3Rpb24oYXJndW1lbnQpew0KICB2YXIgaXQgPSB0b1ByaW1pdGl2ZShhcmd1bWVudCwgZmFsc2UpOw0KICBpZih0eXBlb2YgaXQgPT0gJ3N0cmluZycgJiYgaXQubGVuZ3RoID4gMil7DQogICAgaXQgPSBUUklNID8gaXQudHJpbSgpIDogJHRyaW0oaXQsIDMpOw0KICAgIHZhciBmaXJzdCA9IGl0LmNoYXJDb2RlQXQoMCkNCiAgICAgICwgdGhpcmQsIHJhZGl4LCBtYXhDb2RlOw0KICAgIGlmKGZpcnN0ID09PSA0MyB8fCBmaXJzdCA9PT0gNDUpew0KICAgICAgdGhpcmQgPSBpdC5jaGFyQ29kZUF0KDIpOw0KICAgICAgaWYodGhpcmQgPT09IDg4IHx8IHRoaXJkID09PSAxMjApcmV0dXJuIE5hTjsgLy8gTnVtYmVyKCcrMHgxJykgc2hvdWxkIGJlIE5hTiwgb2xkIFY4IGZpeA0KICAgIH0gZWxzZSBpZihmaXJzdCA9PT0gNDgpew0KICAgICAgc3dpdGNoKGl0LmNoYXJDb2RlQXQoMSkpew0KICAgICAgICBjYXNlIDY2IDogY2FzZSA5OCAgOiByYWRpeCA9IDI7IG1heENvZGUgPSA0OTsgYnJlYWs7IC8vIGZhc3QgZXF1YWwgL14wYlswMV0rJC9pDQogICAgICAgIGNhc2UgNzkgOiBjYXNlIDExMSA6IHJhZGl4ID0gODsgbWF4Q29kZSA9IDU1OyBicmVhazsgLy8gZmFzdCBlcXVhbCAvXjBvWzAtN10rJC9pDQogICAgICAgIGRlZmF1bHQgOiByZXR1cm4gK2l0Ow0KICAgICAgfQ0KICAgICAgZm9yKHZhciBkaWdpdHMgPSBpdC5zbGljZSgyKSwgaSA9IDAsIGwgPSBkaWdpdHMubGVuZ3RoLCBjb2RlOyBpIDwgbDsgaSsrKXsNCiAgICAgICAgY29kZSA9IGRpZ2l0cy5jaGFyQ29kZUF0KGkpOw0KICAgICAgICAvLyBwYXJzZUludCBwYXJzZXMgYSBzdHJpbmcgdG8gYSBmaXJzdCB1bmF2YWlsYWJsZSBzeW1ib2wNCiAgICAgICAgLy8gYnV0IFRvTnVtYmVyIHNob3VsZCByZXR1cm4gTmFOIGlmIGEgc3RyaW5nIGNvbnRhaW5zIHVuYXZhaWxhYmxlIHN5bWJvbHMNCiAgICAgICAgaWYoY29kZSA8IDQ4IHx8IGNvZGUgPiBtYXhDb2RlKXJldHVybiBOYU47DQogICAgICB9IHJldHVybiBwYXJzZUludChkaWdpdHMsIHJhZGl4KTsNCiAgICB9DQogIH0gcmV0dXJuICtpdDsNCn07DQoNCmlmKCEkTnVtYmVyKCcgMG8xJykgfHwgISROdW1iZXIoJzBiMScpIHx8ICROdW1iZXIoJysweDEnKSl7DQogICROdW1iZXIgPSBmdW5jdGlvbiBOdW1iZXIodmFsdWUpew0KICAgIHZhciBpdCA9IGFyZ3VtZW50cy5sZW5ndGggPCAxID8gMCA6IHZhbHVlDQogICAgICAsIHRoYXQgPSB0aGlzOw0KICAgIHJldHVybiB0aGF0IGluc3RhbmNlb2YgJE51bWJlcg0KICAgICAgLy8gY2hlY2sgb24gMS4uY29uc3RydWN0b3IoZm9vKSBjYXNlDQogICAgICAmJiAoQlJPS0VOX0NPRiA/IGZhaWxzKGZ1bmN0aW9uKCl7IHByb3RvLnZhbHVlT2YuY2FsbCh0aGF0KTsgfSkgOiBjb2YodGhhdCkgIT0gTlVNQkVSKQ0KICAgICAgICA/IGluaGVyaXRJZlJlcXVpcmVkKG5ldyBCYXNlKHRvTnVtYmVyKGl0KSksIHRoYXQsICROdW1iZXIpIDogdG9OdW1iZXIoaXQpOw0KICB9Ow0KICBmb3IodmFyIGtleXMgPSByZXF1aXJlKCcuL19kZXNjcmlwdG9ycycpID8gZ09QTihCYXNlKSA6ICgNCiAgICAvLyBFUzM6DQogICAgJ01BWF9WQUxVRSxNSU5fVkFMVUUsTmFOLE5FR0FUSVZFX0lORklOSVRZLFBPU0lUSVZFX0lORklOSVRZLCcgKw0KICAgIC8vIEVTNiAoaW4gY2FzZSwgaWYgbW9kdWxlcyB3aXRoIEVTNiBOdW1iZXIgc3RhdGljcyByZXF1aXJlZCBiZWZvcmUpOg0KICAgICdFUFNJTE9OLGlzRmluaXRlLGlzSW50ZWdlcixpc05hTixpc1NhZmVJbnRlZ2VyLE1BWF9TQUZFX0lOVEVHRVIsJyArDQogICAgJ01JTl9TQUZFX0lOVEVHRVIscGFyc2VGbG9hdCxwYXJzZUludCxpc0ludGVnZXInDQogICkuc3BsaXQoJywnKSwgaiA9IDAsIGtleTsga2V5cy5sZW5ndGggPiBqOyBqKyspew0KICAgIGlmKGhhcyhCYXNlLCBrZXkgPSBrZXlzW2pdKSAmJiAhaGFzKCROdW1iZXIsIGtleSkpew0KICAgICAgZFAoJE51bWJlciwga2V5LCBnT1BEKEJhc2UsIGtleSkpOw0KICAgIH0NCiAgfQ0KICAkTnVtYmVyLnByb3RvdHlwZSA9IHByb3RvOw0KICBwcm90by5jb25zdHJ1Y3RvciA9ICROdW1iZXI7DQogIHJlcXVpcmUoJy4vX3JlZGVmaW5lJykoZ2xvYmFsLCBOVU1CRVIsICROdW1iZXIpOw0KfQ0KfSx7Ii4vX2NvZiI6MTgsIi4vX2Rlc2NyaXB0b3JzIjoyOCwiLi9fZmFpbHMiOjM0LCIuL19nbG9iYWwiOjM4LCIuL19oYXMiOjM5LCIuL19pbmhlcml0LWlmLXJlcXVpcmVkIjo0MywiLi9fb2JqZWN0LWNyZWF0ZSI6NjYsIi4vX29iamVjdC1kcCI6NjcsIi4vX29iamVjdC1nb3BkIjo3MCwiLi9fb2JqZWN0LWdvcG4iOjcyLCIuL19yZWRlZmluZSI6ODcsIi4vX3N0cmluZy10cmltIjoxMDIsIi4vX3RvLXByaW1pdGl2ZSI6MTEwfV0sMTY5OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCi8vIDIwLjEuMi4xIE51bWJlci5FUFNJTE9ODQp2YXIgJGV4cG9ydCA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpOw0KDQokZXhwb3J0KCRleHBvcnQuUywgJ051bWJlcicsIHtFUFNJTE9OOiBNYXRoLnBvdygyLCAtNTIpfSk7DQp9LHsiLi9fZXhwb3J0IjozMn1dLDE3MDpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQovLyAyMC4xLjIuMiBOdW1iZXIuaXNGaW5pdGUobnVtYmVyKQ0KdmFyICRleHBvcnQgICA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpDQogICwgX2lzRmluaXRlID0gcmVxdWlyZSgnLi9fZ2xvYmFsJykuaXNGaW5pdGU7DQoNCiRleHBvcnQoJGV4cG9ydC5TLCAnTnVtYmVyJywgew0KICBpc0Zpbml0ZTogZnVuY3Rpb24gaXNGaW5pdGUoaXQpew0KICAgIHJldHVybiB0eXBlb2YgaXQgPT0gJ251bWJlcicgJiYgX2lzRmluaXRlKGl0KTsNCiAgfQ0KfSk7DQp9LHsiLi9fZXhwb3J0IjozMiwiLi9fZ2xvYmFsIjozOH1dLDE3MTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQovLyAyMC4xLjIuMyBOdW1iZXIuaXNJbnRlZ2VyKG51bWJlcikNCnZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0Jyk7DQoNCiRleHBvcnQoJGV4cG9ydC5TLCAnTnVtYmVyJywge2lzSW50ZWdlcjogcmVxdWlyZSgnLi9faXMtaW50ZWdlcicpfSk7DQp9LHsiLi9fZXhwb3J0IjozMiwiLi9faXMtaW50ZWdlciI6NDh9XSwxNzI6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KLy8gMjAuMS4yLjQgTnVtYmVyLmlzTmFOKG51bWJlcikNCnZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0Jyk7DQoNCiRleHBvcnQoJGV4cG9ydC5TLCAnTnVtYmVyJywgew0KICBpc05hTjogZnVuY3Rpb24gaXNOYU4obnVtYmVyKXsNCiAgICByZXR1cm4gbnVtYmVyICE9IG51bWJlcjsNCiAgfQ0KfSk7DQp9LHsiLi9fZXhwb3J0IjozMn1dLDE3MzpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQovLyAyMC4xLjIuNSBOdW1iZXIuaXNTYWZlSW50ZWdlcihudW1iZXIpDQp2YXIgJGV4cG9ydCAgID0gcmVxdWlyZSgnLi9fZXhwb3J0JykNCiAgLCBpc0ludGVnZXIgPSByZXF1aXJlKCcuL19pcy1pbnRlZ2VyJykNCiAgLCBhYnMgICAgICAgPSBNYXRoLmFiczsNCg0KJGV4cG9ydCgkZXhwb3J0LlMsICdOdW1iZXInLCB7DQogIGlzU2FmZUludGVnZXI6IGZ1bmN0aW9uIGlzU2FmZUludGVnZXIobnVtYmVyKXsNCiAgICByZXR1cm4gaXNJbnRlZ2VyKG51bWJlcikgJiYgYWJzKG51bWJlcikgPD0gMHgxZmZmZmZmZmZmZmZmZjsNCiAgfQ0KfSk7DQp9LHsiLi9fZXhwb3J0IjozMiwiLi9faXMtaW50ZWdlciI6NDh9XSwxNzQ6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KLy8gMjAuMS4yLjYgTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVINCnZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0Jyk7DQoNCiRleHBvcnQoJGV4cG9ydC5TLCAnTnVtYmVyJywge01BWF9TQUZFX0lOVEVHRVI6IDB4MWZmZmZmZmZmZmZmZmZ9KTsNCn0seyIuL19leHBvcnQiOjMyfV0sMTc1OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCi8vIDIwLjEuMi4xMCBOdW1iZXIuTUlOX1NBRkVfSU5URUdFUg0KdmFyICRleHBvcnQgPSByZXF1aXJlKCcuL19leHBvcnQnKTsNCg0KJGV4cG9ydCgkZXhwb3J0LlMsICdOdW1iZXInLCB7TUlOX1NBRkVfSU5URUdFUjogLTB4MWZmZmZmZmZmZmZmZmZ9KTsNCn0seyIuL19leHBvcnQiOjMyfV0sMTc2OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCnZhciAkZXhwb3J0ICAgICA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpDQogICwgJHBhcnNlRmxvYXQgPSByZXF1aXJlKCcuL19wYXJzZS1mbG9hdCcpOw0KLy8gMjAuMS4yLjEyIE51bWJlci5wYXJzZUZsb2F0KHN0cmluZykNCiRleHBvcnQoJGV4cG9ydC5TICsgJGV4cG9ydC5GICogKE51bWJlci5wYXJzZUZsb2F0ICE9ICRwYXJzZUZsb2F0KSwgJ051bWJlcicsIHtwYXJzZUZsb2F0OiAkcGFyc2VGbG9hdH0pOw0KfSx7Ii4vX2V4cG9ydCI6MzIsIi4vX3BhcnNlLWZsb2F0Ijo4MX1dLDE3NzpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQp2YXIgJGV4cG9ydCAgID0gcmVxdWlyZSgnLi9fZXhwb3J0JykNCiAgLCAkcGFyc2VJbnQgPSByZXF1aXJlKCcuL19wYXJzZS1pbnQnKTsNCi8vIDIwLjEuMi4xMyBOdW1iZXIucGFyc2VJbnQoc3RyaW5nLCByYWRpeCkNCiRleHBvcnQoJGV4cG9ydC5TICsgJGV4cG9ydC5GICogKE51bWJlci5wYXJzZUludCAhPSAkcGFyc2VJbnQpLCAnTnVtYmVyJywge3BhcnNlSW50OiAkcGFyc2VJbnR9KTsNCn0seyIuL19leHBvcnQiOjMyLCIuL19wYXJzZS1pbnQiOjgyfV0sMTc4OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCid1c2Ugc3RyaWN0JzsNCnZhciAkZXhwb3J0ICAgICAgPSByZXF1aXJlKCcuL19leHBvcnQnKQ0KICAsIGFuSW5zdGFuY2UgICA9IHJlcXVpcmUoJy4vX2FuLWluc3RhbmNlJykNCiAgLCB0b0ludGVnZXIgICAgPSByZXF1aXJlKCcuL190by1pbnRlZ2VyJykNCiAgLCBhTnVtYmVyVmFsdWUgPSByZXF1aXJlKCcuL19hLW51bWJlci12YWx1ZScpDQogICwgcmVwZWF0ICAgICAgID0gcmVxdWlyZSgnLi9fc3RyaW5nLXJlcGVhdCcpDQogICwgJHRvRml4ZWQgICAgID0gMS4udG9GaXhlZA0KICAsIGZsb29yICAgICAgICA9IE1hdGguZmxvb3INCiAgLCBkYXRhICAgICAgICAgPSBbMCwgMCwgMCwgMCwgMCwgMF0NCiAgLCBFUlJPUiAgICAgICAgPSAnTnVtYmVyLnRvRml4ZWQ6IGluY29ycmVjdCBpbnZvY2F0aW9uIScNCiAgLCBaRVJPICAgICAgICAgPSAnMCc7DQoNCnZhciBtdWx0aXBseSA9IGZ1bmN0aW9uKG4sIGMpew0KICB2YXIgaSAgPSAtMQ0KICAgICwgYzIgPSBjOw0KICB3aGlsZSgrK2kgPCA2KXsNCiAgICBjMiArPSBuICogZGF0YVtpXTsNCiAgICBkYXRhW2ldID0gYzIgJSAxZTc7DQogICAgYzIgPSBmbG9vcihjMiAvIDFlNyk7DQogIH0NCn07DQp2YXIgZGl2aWRlID0gZnVuY3Rpb24obil7DQogIHZhciBpID0gNg0KICAgICwgYyA9IDA7DQogIHdoaWxlKC0taSA+PSAwKXsNCiAgICBjICs9IGRhdGFbaV07DQogICAgZGF0YVtpXSA9IGZsb29yKGMgLyBuKTsNCiAgICBjID0gKGMgJSBuKSAqIDFlNzsNCiAgfQ0KfTsNCnZhciBudW1Ub1N0cmluZyA9IGZ1bmN0aW9uKCl7DQogIHZhciBpID0gNg0KICAgICwgcyA9ICcnOw0KICB3aGlsZSgtLWkgPj0gMCl7DQogICAgaWYocyAhPT0gJycgfHwgaSA9PT0gMCB8fCBkYXRhW2ldICE9PSAwKXsNCiAgICAgIHZhciB0ID0gU3RyaW5nKGRhdGFbaV0pOw0KICAgICAgcyA9IHMgPT09ICcnID8gdCA6IHMgKyByZXBlYXQuY2FsbChaRVJPLCA3IC0gdC5sZW5ndGgpICsgdDsNCiAgICB9DQogIH0gcmV0dXJuIHM7DQp9Ow0KdmFyIHBvdyA9IGZ1bmN0aW9uKHgsIG4sIGFjYyl7DQogIHJldHVybiBuID09PSAwID8gYWNjIDogbiAlIDIgPT09IDEgPyBwb3coeCwgbiAtIDEsIGFjYyAqIHgpIDogcG93KHggKiB4LCBuIC8gMiwgYWNjKTsNCn07DQp2YXIgbG9nID0gZnVuY3Rpb24oeCl7DQogIHZhciBuICA9IDANCiAgICAsIHgyID0geDsNCiAgd2hpbGUoeDIgPj0gNDA5Nil7DQogICAgbiArPSAxMjsNCiAgICB4MiAvPSA0MDk2Ow0KICB9DQogIHdoaWxlKHgyID49IDIpew0KICAgIG4gICs9IDE7DQogICAgeDIgLz0gMjsNCiAgfSByZXR1cm4gbjsNCn07DQoNCiRleHBvcnQoJGV4cG9ydC5QICsgJGV4cG9ydC5GICogKCEhJHRvRml4ZWQgJiYgKA0KICAwLjAwMDA4LnRvRml4ZWQoMykgIT09ICcwLjAwMCcgfHwNCiAgMC45LnRvRml4ZWQoMCkgIT09ICcxJyB8fA0KICAxLjI1NS50b0ZpeGVkKDIpICE9PSAnMS4yNScgfHwNCiAgMTAwMDAwMDAwMDAwMDAwMDEyOC4udG9GaXhlZCgwKSAhPT0gJzEwMDAwMDAwMDAwMDAwMDAxMjgnDQopIHx8ICFyZXF1aXJlKCcuL19mYWlscycpKGZ1bmN0aW9uKCl7DQogIC8vIFY4IH4gQW5kcm9pZCA0LjMtDQogICR0b0ZpeGVkLmNhbGwoe30pOw0KfSkpLCAnTnVtYmVyJywgew0KICB0b0ZpeGVkOiBmdW5jdGlvbiB0b0ZpeGVkKGZyYWN0aW9uRGlnaXRzKXsNCiAgICB2YXIgeCA9IGFOdW1iZXJWYWx1ZSh0aGlzLCBFUlJPUikNCiAgICAgICwgZiA9IHRvSW50ZWdlcihmcmFjdGlvbkRpZ2l0cykNCiAgICAgICwgcyA9ICcnDQogICAgICAsIG0gPSBaRVJPDQogICAgICAsIGUsIHosIGosIGs7DQogICAgaWYoZiA8IDAgfHwgZiA+IDIwKXRocm93IFJhbmdlRXJyb3IoRVJST1IpOw0KICAgIGlmKHggIT0geClyZXR1cm4gJ05hTic7DQogICAgaWYoeCA8PSAtMWUyMSB8fCB4ID49IDFlMjEpcmV0dXJuIFN0cmluZyh4KTsNCiAgICBpZih4IDwgMCl7DQogICAgICBzID0gJy0nOw0KICAgICAgeCA9IC14Ow0KICAgIH0NCiAgICBpZih4ID4gMWUtMjEpew0KICAgICAgZSA9IGxvZyh4ICogcG93KDIsIDY5LCAxKSkgLSA2OTsNCiAgICAgIHogPSBlIDwgMCA/IHggKiBwb3coMiwgLWUsIDEpIDogeCAvIHBvdygyLCBlLCAxKTsNCiAgICAgIHogKj0gMHgxMDAwMDAwMDAwMDAwMDsNCiAgICAgIGUgPSA1MiAtIGU7DQogICAgICBpZihlID4gMCl7DQogICAgICAgIG11bHRpcGx5KDAsIHopOw0KICAgICAgICBqID0gZjsNCiAgICAgICAgd2hpbGUoaiA+PSA3KXsNCiAgICAgICAgICBtdWx0aXBseSgxZTcsIDApOw0KICAgICAgICAgIGogLT0gNzsNCiAgICAgICAgfQ0KICAgICAgICBtdWx0aXBseShwb3coMTAsIGosIDEpLCAwKTsNCiAgICAgICAgaiA9IGUgLSAxOw0KICAgICAgICB3aGlsZShqID49IDIzKXsNCiAgICAgICAgICBkaXZpZGUoMSA8PCAyMyk7DQogICAgICAgICAgaiAtPSAyMzsNCiAgICAgICAgfQ0KICAgICAgICBkaXZpZGUoMSA8PCBqKTsNCiAgICAgICAgbXVsdGlwbHkoMSwgMSk7DQogICAgICAgIGRpdmlkZSgyKTsNCiAgICAgICAgbSA9IG51bVRvU3RyaW5nKCk7DQogICAgICB9IGVsc2Ugew0KICAgICAgICBtdWx0aXBseSgwLCB6KTsNCiAgICAgICAgbXVsdGlwbHkoMSA8PCAtZSwgMCk7DQogICAgICAgIG0gPSBudW1Ub1N0cmluZygpICsgcmVwZWF0LmNhbGwoWkVSTywgZik7DQogICAgICB9DQogICAgfQ0KICAgIGlmKGYgPiAwKXsNCiAgICAgIGsgPSBtLmxlbmd0aDsNCiAgICAgIG0gPSBzICsgKGsgPD0gZiA/ICcwLicgKyByZXBlYXQuY2FsbChaRVJPLCBmIC0gaykgKyBtIDogbS5zbGljZSgwLCBrIC0gZikgKyAnLicgKyBtLnNsaWNlKGsgLSBmKSk7DQogICAgfSBlbHNlIHsNCiAgICAgIG0gPSBzICsgbTsNCiAgICB9IHJldHVybiBtOw0KICB9DQp9KTsNCn0seyIuL19hLW51bWJlci12YWx1ZSI6NCwiLi9fYW4taW5zdGFuY2UiOjYsIi4vX2V4cG9ydCI6MzIsIi4vX2ZhaWxzIjozNCwiLi9fc3RyaW5nLXJlcGVhdCI6MTAxLCIuL190by1pbnRlZ2VyIjoxMDZ9XSwxNzk6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KJ3VzZSBzdHJpY3QnOw0KdmFyICRleHBvcnQgICAgICA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpDQogICwgJGZhaWxzICAgICAgID0gcmVxdWlyZSgnLi9fZmFpbHMnKQ0KICAsIGFOdW1iZXJWYWx1ZSA9IHJlcXVpcmUoJy4vX2EtbnVtYmVyLXZhbHVlJykNCiAgLCAkdG9QcmVjaXNpb24gPSAxLi50b1ByZWNpc2lvbjsNCg0KJGV4cG9ydCgkZXhwb3J0LlAgKyAkZXhwb3J0LkYgKiAoJGZhaWxzKGZ1bmN0aW9uKCl7DQogIC8vIElFNy0NCiAgcmV0dXJuICR0b1ByZWNpc2lvbi5jYWxsKDEsIHVuZGVmaW5lZCkgIT09ICcxJzsNCn0pIHx8ICEkZmFpbHMoZnVuY3Rpb24oKXsNCiAgLy8gVjggfiBBbmRyb2lkIDQuMy0NCiAgJHRvUHJlY2lzaW9uLmNhbGwoe30pOw0KfSkpLCAnTnVtYmVyJywgew0KICB0b1ByZWNpc2lvbjogZnVuY3Rpb24gdG9QcmVjaXNpb24ocHJlY2lzaW9uKXsNCiAgICB2YXIgdGhhdCA9IGFOdW1iZXJWYWx1ZSh0aGlzLCAnTnVtYmVyI3RvUHJlY2lzaW9uOiBpbmNvcnJlY3QgaW52b2NhdGlvbiEnKTsNCiAgICByZXR1cm4gcHJlY2lzaW9uID09PSB1bmRlZmluZWQgPyAkdG9QcmVjaXNpb24uY2FsbCh0aGF0KSA6ICR0b1ByZWNpc2lvbi5jYWxsKHRoYXQsIHByZWNpc2lvbik7IA0KICB9DQp9KTsNCn0seyIuL19hLW51bWJlci12YWx1ZSI6NCwiLi9fZXhwb3J0IjozMiwiLi9fZmFpbHMiOjM0fV0sMTgwOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCi8vIDE5LjEuMy4xIE9iamVjdC5hc3NpZ24odGFyZ2V0LCBzb3VyY2UpDQp2YXIgJGV4cG9ydCA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpOw0KDQokZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiwgJ09iamVjdCcsIHthc3NpZ246IHJlcXVpcmUoJy4vX29iamVjdC1hc3NpZ24nKX0pOw0KfSx7Ii4vX2V4cG9ydCI6MzIsIi4vX29iamVjdC1hc3NpZ24iOjY1fV0sMTgxOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCnZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0JykNCi8vIDE5LjEuMi4yIC8gMTUuMi4zLjUgT2JqZWN0LmNyZWF0ZShPIFssIFByb3BlcnRpZXNdKQ0KJGV4cG9ydCgkZXhwb3J0LlMsICdPYmplY3QnLCB7Y3JlYXRlOiByZXF1aXJlKCcuL19vYmplY3QtY3JlYXRlJyl9KTsNCn0seyIuL19leHBvcnQiOjMyLCIuL19vYmplY3QtY3JlYXRlIjo2Nn1dLDE4MjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQp2YXIgJGV4cG9ydCA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpOw0KLy8gMTkuMS4yLjMgLyAxNS4yLjMuNyBPYmplY3QuZGVmaW5lUHJvcGVydGllcyhPLCBQcm9wZXJ0aWVzKQ0KJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYgKiAhcmVxdWlyZSgnLi9fZGVzY3JpcHRvcnMnKSwgJ09iamVjdCcsIHtkZWZpbmVQcm9wZXJ0aWVzOiByZXF1aXJlKCcuL19vYmplY3QtZHBzJyl9KTsNCn0seyIuL19kZXNjcmlwdG9ycyI6MjgsIi4vX2V4cG9ydCI6MzIsIi4vX29iamVjdC1kcHMiOjY4fV0sMTgzOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCnZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0Jyk7DQovLyAxOS4xLjIuNCAvIDE1LjIuMy42IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShPLCBQLCBBdHRyaWJ1dGVzKQ0KJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYgKiAhcmVxdWlyZSgnLi9fZGVzY3JpcHRvcnMnKSwgJ09iamVjdCcsIHtkZWZpbmVQcm9wZXJ0eTogcmVxdWlyZSgnLi9fb2JqZWN0LWRwJykuZn0pOw0KfSx7Ii4vX2Rlc2NyaXB0b3JzIjoyOCwiLi9fZXhwb3J0IjozMiwiLi9fb2JqZWN0LWRwIjo2N31dLDE4NDpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQovLyAxOS4xLjIuNSBPYmplY3QuZnJlZXplKE8pDQp2YXIgaXNPYmplY3QgPSByZXF1aXJlKCcuL19pcy1vYmplY3QnKQ0KICAsIG1ldGEgICAgID0gcmVxdWlyZSgnLi9fbWV0YScpLm9uRnJlZXplOw0KDQpyZXF1aXJlKCcuL19vYmplY3Qtc2FwJykoJ2ZyZWV6ZScsIGZ1bmN0aW9uKCRmcmVlemUpew0KICByZXR1cm4gZnVuY3Rpb24gZnJlZXplKGl0KXsNCiAgICByZXR1cm4gJGZyZWV6ZSAmJiBpc09iamVjdChpdCkgPyAkZnJlZXplKG1ldGEoaXQpKSA6IGl0Ow0KICB9Ow0KfSk7DQp9LHsiLi9faXMtb2JqZWN0Ijo0OSwiLi9fbWV0YSI6NjIsIi4vX29iamVjdC1zYXAiOjc4fV0sMTg1OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCi8vIDE5LjEuMi42IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoTywgUCkNCnZhciB0b0lPYmplY3QgICAgICAgICAgICAgICAgID0gcmVxdWlyZSgnLi9fdG8taW9iamVjdCcpDQogICwgJGdldE93blByb3BlcnR5RGVzY3JpcHRvciA9IHJlcXVpcmUoJy4vX29iamVjdC1nb3BkJykuZjsNCg0KcmVxdWlyZSgnLi9fb2JqZWN0LXNhcCcpKCdnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3InLCBmdW5jdGlvbigpew0KICByZXR1cm4gZnVuY3Rpb24gZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGl0LCBrZXkpew0KICAgIHJldHVybiAkZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHRvSU9iamVjdChpdCksIGtleSk7DQogIH07DQp9KTsNCn0seyIuL19vYmplY3QtZ29wZCI6NzAsIi4vX29iamVjdC1zYXAiOjc4LCIuL190by1pb2JqZWN0IjoxMDd9XSwxODY6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KLy8gMTkuMS4yLjcgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMoTykNCnJlcXVpcmUoJy4vX29iamVjdC1zYXAnKSgnZ2V0T3duUHJvcGVydHlOYW1lcycsIGZ1bmN0aW9uKCl7DQogIHJldHVybiByZXF1aXJlKCcuL19vYmplY3QtZ29wbi1leHQnKS5mOw0KfSk7DQp9LHsiLi9fb2JqZWN0LWdvcG4tZXh0Ijo3MSwiLi9fb2JqZWN0LXNhcCI6Nzh9XSwxODc6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KLy8gMTkuMS4yLjkgT2JqZWN0LmdldFByb3RvdHlwZU9mKE8pDQp2YXIgdG9PYmplY3QgICAgICAgID0gcmVxdWlyZSgnLi9fdG8tb2JqZWN0JykNCiAgLCAkZ2V0UHJvdG90eXBlT2YgPSByZXF1aXJlKCcuL19vYmplY3QtZ3BvJyk7DQoNCnJlcXVpcmUoJy4vX29iamVjdC1zYXAnKSgnZ2V0UHJvdG90eXBlT2YnLCBmdW5jdGlvbigpew0KICByZXR1cm4gZnVuY3Rpb24gZ2V0UHJvdG90eXBlT2YoaXQpew0KICAgIHJldHVybiAkZ2V0UHJvdG90eXBlT2YodG9PYmplY3QoaXQpKTsNCiAgfTsNCn0pOw0KfSx7Ii4vX29iamVjdC1ncG8iOjc0LCIuL19vYmplY3Qtc2FwIjo3OCwiLi9fdG8tb2JqZWN0IjoxMDl9XSwxODg6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KLy8gMTkuMS4yLjExIE9iamVjdC5pc0V4dGVuc2libGUoTykNCnZhciBpc09iamVjdCA9IHJlcXVpcmUoJy4vX2lzLW9iamVjdCcpOw0KDQpyZXF1aXJlKCcuL19vYmplY3Qtc2FwJykoJ2lzRXh0ZW5zaWJsZScsIGZ1bmN0aW9uKCRpc0V4dGVuc2libGUpew0KICByZXR1cm4gZnVuY3Rpb24gaXNFeHRlbnNpYmxlKGl0KXsNCiAgICByZXR1cm4gaXNPYmplY3QoaXQpID8gJGlzRXh0ZW5zaWJsZSA/ICRpc0V4dGVuc2libGUoaXQpIDogdHJ1ZSA6IGZhbHNlOw0KICB9Ow0KfSk7DQp9LHsiLi9faXMtb2JqZWN0Ijo0OSwiLi9fb2JqZWN0LXNhcCI6Nzh9XSwxODk6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KLy8gMTkuMS4yLjEyIE9iamVjdC5pc0Zyb3plbihPKQ0KdmFyIGlzT2JqZWN0ID0gcmVxdWlyZSgnLi9faXMtb2JqZWN0Jyk7DQoNCnJlcXVpcmUoJy4vX29iamVjdC1zYXAnKSgnaXNGcm96ZW4nLCBmdW5jdGlvbigkaXNGcm96ZW4pew0KICByZXR1cm4gZnVuY3Rpb24gaXNGcm96ZW4oaXQpew0KICAgIHJldHVybiBpc09iamVjdChpdCkgPyAkaXNGcm96ZW4gPyAkaXNGcm96ZW4oaXQpIDogZmFsc2UgOiB0cnVlOw0KICB9Ow0KfSk7DQp9LHsiLi9faXMtb2JqZWN0Ijo0OSwiLi9fb2JqZWN0LXNhcCI6Nzh9XSwxOTA6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KLy8gMTkuMS4yLjEzIE9iamVjdC5pc1NlYWxlZChPKQ0KdmFyIGlzT2JqZWN0ID0gcmVxdWlyZSgnLi9faXMtb2JqZWN0Jyk7DQoNCnJlcXVpcmUoJy4vX29iamVjdC1zYXAnKSgnaXNTZWFsZWQnLCBmdW5jdGlvbigkaXNTZWFsZWQpew0KICByZXR1cm4gZnVuY3Rpb24gaXNTZWFsZWQoaXQpew0KICAgIHJldHVybiBpc09iamVjdChpdCkgPyAkaXNTZWFsZWQgPyAkaXNTZWFsZWQoaXQpIDogZmFsc2UgOiB0cnVlOw0KICB9Ow0KfSk7DQp9LHsiLi9faXMtb2JqZWN0Ijo0OSwiLi9fb2JqZWN0LXNhcCI6Nzh9XSwxOTE6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KLy8gMTkuMS4zLjEwIE9iamVjdC5pcyh2YWx1ZTEsIHZhbHVlMikNCnZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0Jyk7DQokZXhwb3J0KCRleHBvcnQuUywgJ09iamVjdCcsIHtpczogcmVxdWlyZSgnLi9fc2FtZS12YWx1ZScpfSk7DQp9LHsiLi9fZXhwb3J0IjozMiwiLi9fc2FtZS12YWx1ZSI6ODl9XSwxOTI6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KLy8gMTkuMS4yLjE0IE9iamVjdC5rZXlzKE8pDQp2YXIgdG9PYmplY3QgPSByZXF1aXJlKCcuL190by1vYmplY3QnKQ0KICAsICRrZXlzICAgID0gcmVxdWlyZSgnLi9fb2JqZWN0LWtleXMnKTsNCg0KcmVxdWlyZSgnLi9fb2JqZWN0LXNhcCcpKCdrZXlzJywgZnVuY3Rpb24oKXsNCiAgcmV0dXJuIGZ1bmN0aW9uIGtleXMoaXQpew0KICAgIHJldHVybiAka2V5cyh0b09iamVjdChpdCkpOw0KICB9Ow0KfSk7DQp9LHsiLi9fb2JqZWN0LWtleXMiOjc2LCIuL19vYmplY3Qtc2FwIjo3OCwiLi9fdG8tb2JqZWN0IjoxMDl9XSwxOTM6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KLy8gMTkuMS4yLjE1IE9iamVjdC5wcmV2ZW50RXh0ZW5zaW9ucyhPKQ0KdmFyIGlzT2JqZWN0ID0gcmVxdWlyZSgnLi9faXMtb2JqZWN0JykNCiAgLCBtZXRhICAgICA9IHJlcXVpcmUoJy4vX21ldGEnKS5vbkZyZWV6ZTsNCg0KcmVxdWlyZSgnLi9fb2JqZWN0LXNhcCcpKCdwcmV2ZW50RXh0ZW5zaW9ucycsIGZ1bmN0aW9uKCRwcmV2ZW50RXh0ZW5zaW9ucyl7DQogIHJldHVybiBmdW5jdGlvbiBwcmV2ZW50RXh0ZW5zaW9ucyhpdCl7DQogICAgcmV0dXJuICRwcmV2ZW50RXh0ZW5zaW9ucyAmJiBpc09iamVjdChpdCkgPyAkcHJldmVudEV4dGVuc2lvbnMobWV0YShpdCkpIDogaXQ7DQogIH07DQp9KTsNCn0seyIuL19pcy1vYmplY3QiOjQ5LCIuL19tZXRhIjo2MiwiLi9fb2JqZWN0LXNhcCI6Nzh9XSwxOTQ6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KLy8gMTkuMS4yLjE3IE9iamVjdC5zZWFsKE8pDQp2YXIgaXNPYmplY3QgPSByZXF1aXJlKCcuL19pcy1vYmplY3QnKQ0KICAsIG1ldGEgICAgID0gcmVxdWlyZSgnLi9fbWV0YScpLm9uRnJlZXplOw0KDQpyZXF1aXJlKCcuL19vYmplY3Qtc2FwJykoJ3NlYWwnLCBmdW5jdGlvbigkc2VhbCl7DQogIHJldHVybiBmdW5jdGlvbiBzZWFsKGl0KXsNCiAgICByZXR1cm4gJHNlYWwgJiYgaXNPYmplY3QoaXQpID8gJHNlYWwobWV0YShpdCkpIDogaXQ7DQogIH07DQp9KTsNCn0seyIuL19pcy1vYmplY3QiOjQ5LCIuL19tZXRhIjo2MiwiLi9fb2JqZWN0LXNhcCI6Nzh9XSwxOTU6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KLy8gMTkuMS4zLjE5IE9iamVjdC5zZXRQcm90b3R5cGVPZihPLCBwcm90bykNCnZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0Jyk7DQokZXhwb3J0KCRleHBvcnQuUywgJ09iamVjdCcsIHtzZXRQcm90b3R5cGVPZjogcmVxdWlyZSgnLi9fc2V0LXByb3RvJykuc2V0fSk7DQp9LHsiLi9fZXhwb3J0IjozMiwiLi9fc2V0LXByb3RvIjo5MH1dLDE5NjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQondXNlIHN0cmljdCc7DQovLyAxOS4xLjMuNiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nKCkNCnZhciBjbGFzc29mID0gcmVxdWlyZSgnLi9fY2xhc3NvZicpDQogICwgdGVzdCAgICA9IHt9Ow0KdGVzdFtyZXF1aXJlKCcuL193a3MnKSgndG9TdHJpbmdUYWcnKV0gPSAneic7DQppZih0ZXN0ICsgJycgIT0gJ1tvYmplY3Qgel0nKXsNCiAgcmVxdWlyZSgnLi9fcmVkZWZpbmUnKShPYmplY3QucHJvdG90eXBlLCAndG9TdHJpbmcnLCBmdW5jdGlvbiB0b1N0cmluZygpew0KICAgIHJldHVybiAnW29iamVjdCAnICsgY2xhc3NvZih0aGlzKSArICddJzsNCiAgfSwgdHJ1ZSk7DQp9DQp9LHsiLi9fY2xhc3NvZiI6MTcsIi4vX3JlZGVmaW5lIjo4NywiLi9fd2tzIjoxMTd9XSwxOTc6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KdmFyICRleHBvcnQgICAgID0gcmVxdWlyZSgnLi9fZXhwb3J0JykNCiAgLCAkcGFyc2VGbG9hdCA9IHJlcXVpcmUoJy4vX3BhcnNlLWZsb2F0Jyk7DQovLyAxOC4yLjQgcGFyc2VGbG9hdChzdHJpbmcpDQokZXhwb3J0KCRleHBvcnQuRyArICRleHBvcnQuRiAqIChwYXJzZUZsb2F0ICE9ICRwYXJzZUZsb2F0KSwge3BhcnNlRmxvYXQ6ICRwYXJzZUZsb2F0fSk7DQp9LHsiLi9fZXhwb3J0IjozMiwiLi9fcGFyc2UtZmxvYXQiOjgxfV0sMTk4OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCnZhciAkZXhwb3J0ICAgPSByZXF1aXJlKCcuL19leHBvcnQnKQ0KICAsICRwYXJzZUludCA9IHJlcXVpcmUoJy4vX3BhcnNlLWludCcpOw0KLy8gMTguMi41IHBhcnNlSW50KHN0cmluZywgcmFkaXgpDQokZXhwb3J0KCRleHBvcnQuRyArICRleHBvcnQuRiAqIChwYXJzZUludCAhPSAkcGFyc2VJbnQpLCB7cGFyc2VJbnQ6ICRwYXJzZUludH0pOw0KfSx7Ii4vX2V4cG9ydCI6MzIsIi4vX3BhcnNlLWludCI6ODJ9XSwxOTk6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KJ3VzZSBzdHJpY3QnOw0KdmFyIExJQlJBUlkgICAgICAgICAgICA9IHJlcXVpcmUoJy4vX2xpYnJhcnknKQ0KICAsIGdsb2JhbCAgICAgICAgICAgICA9IHJlcXVpcmUoJy4vX2dsb2JhbCcpDQogICwgY3R4ICAgICAgICAgICAgICAgID0gcmVxdWlyZSgnLi9fY3R4JykNCiAgLCBjbGFzc29mICAgICAgICAgICAgPSByZXF1aXJlKCcuL19jbGFzc29mJykNCiAgLCAkZXhwb3J0ICAgICAgICAgICAgPSByZXF1aXJlKCcuL19leHBvcnQnKQ0KICAsIGlzT2JqZWN0ICAgICAgICAgICA9IHJlcXVpcmUoJy4vX2lzLW9iamVjdCcpDQogICwgYW5PYmplY3QgICAgICAgICAgID0gcmVxdWlyZSgnLi9fYW4tb2JqZWN0JykNCiAgLCBhRnVuY3Rpb24gICAgICAgICAgPSByZXF1aXJlKCcuL19hLWZ1bmN0aW9uJykNCiAgLCBhbkluc3RhbmNlICAgICAgICAgPSByZXF1aXJlKCcuL19hbi1pbnN0YW5jZScpDQogICwgZm9yT2YgICAgICAgICAgICAgID0gcmVxdWlyZSgnLi9fZm9yLW9mJykNCiAgLCBzZXRQcm90byAgICAgICAgICAgPSByZXF1aXJlKCcuL19zZXQtcHJvdG8nKS5zZXQNCiAgLCBzcGVjaWVzQ29uc3RydWN0b3IgPSByZXF1aXJlKCcuL19zcGVjaWVzLWNvbnN0cnVjdG9yJykNCiAgLCB0YXNrICAgICAgICAgICAgICAgPSByZXF1aXJlKCcuL190YXNrJykuc2V0DQogICwgbWljcm90YXNrICAgICAgICAgID0gcmVxdWlyZSgnLi9fbWljcm90YXNrJykoKQ0KICAsIFBST01JU0UgICAgICAgICAgICA9ICdQcm9taXNlJw0KICAsIFR5cGVFcnJvciAgICAgICAgICA9IGdsb2JhbC5UeXBlRXJyb3INCiAgLCBwcm9jZXNzICAgICAgICAgICAgPSBnbG9iYWwucHJvY2Vzcw0KICAsICRQcm9taXNlICAgICAgICAgICA9IGdsb2JhbFtQUk9NSVNFXQ0KICAsIHByb2Nlc3MgICAgICAgICAgICA9IGdsb2JhbC5wcm9jZXNzDQogICwgaXNOb2RlICAgICAgICAgICAgID0gY2xhc3NvZihwcm9jZXNzKSA9PSAncHJvY2VzcycNCiAgLCBlbXB0eSAgICAgICAgICAgICAgPSBmdW5jdGlvbigpeyAvKiBlbXB0eSAqLyB9DQogICwgSW50ZXJuYWwsIEdlbmVyaWNQcm9taXNlQ2FwYWJpbGl0eSwgV3JhcHBlcjsNCg0KdmFyIFVTRV9OQVRJVkUgPSAhIWZ1bmN0aW9uKCl7DQogIHRyeSB7DQogICAgLy8gY29ycmVjdCBzdWJjbGFzc2luZyB3aXRoIEBAc3BlY2llcyBzdXBwb3J0DQogICAgdmFyIHByb21pc2UgICAgID0gJFByb21pc2UucmVzb2x2ZSgxKQ0KICAgICAgLCBGYWtlUHJvbWlzZSA9IChwcm9taXNlLmNvbnN0cnVjdG9yID0ge30pW3JlcXVpcmUoJy4vX3drcycpKCdzcGVjaWVzJyldID0gZnVuY3Rpb24oZXhlYyl7IGV4ZWMoZW1wdHksIGVtcHR5KTsgfTsNCiAgICAvLyB1bmhhbmRsZWQgcmVqZWN0aW9ucyB0cmFja2luZyBzdXBwb3J0LCBOb2RlSlMgUHJvbWlzZSB3aXRob3V0IGl0IGZhaWxzIEBAc3BlY2llcyB0ZXN0DQogICAgcmV0dXJuIChpc05vZGUgfHwgdHlwZW9mIFByb21pc2VSZWplY3Rpb25FdmVudCA9PSAnZnVuY3Rpb24nKSAmJiBwcm9taXNlLnRoZW4oZW1wdHkpIGluc3RhbmNlb2YgRmFrZVByb21pc2U7DQogIH0gY2F0Y2goZSl7IC8qIGVtcHR5ICovIH0NCn0oKTsNCg0KLy8gaGVscGVycw0KdmFyIHNhbWVDb25zdHJ1Y3RvciA9IGZ1bmN0aW9uKGEsIGIpew0KICAvLyB3aXRoIGxpYnJhcnkgd3JhcHBlciBzcGVjaWFsIGNhc2UNCiAgcmV0dXJuIGEgPT09IGIgfHwgYSA9PT0gJFByb21pc2UgJiYgYiA9PT0gV3JhcHBlcjsNCn07DQp2YXIgaXNUaGVuYWJsZSA9IGZ1bmN0aW9uKGl0KXsNCiAgdmFyIHRoZW47DQogIHJldHVybiBpc09iamVjdChpdCkgJiYgdHlwZW9mICh0aGVuID0gaXQudGhlbikgPT0gJ2Z1bmN0aW9uJyA/IHRoZW4gOiBmYWxzZTsNCn07DQp2YXIgbmV3UHJvbWlzZUNhcGFiaWxpdHkgPSBmdW5jdGlvbihDKXsNCiAgcmV0dXJuIHNhbWVDb25zdHJ1Y3RvcigkUHJvbWlzZSwgQykNCiAgICA/IG5ldyBQcm9taXNlQ2FwYWJpbGl0eShDKQ0KICAgIDogbmV3IEdlbmVyaWNQcm9taXNlQ2FwYWJpbGl0eShDKTsNCn07DQp2YXIgUHJvbWlzZUNhcGFiaWxpdHkgPSBHZW5lcmljUHJvbWlzZUNhcGFiaWxpdHkgPSBmdW5jdGlvbihDKXsNCiAgdmFyIHJlc29sdmUsIHJlamVjdDsNCiAgdGhpcy5wcm9taXNlID0gbmV3IEMoZnVuY3Rpb24oJCRyZXNvbHZlLCAkJHJlamVjdCl7DQogICAgaWYocmVzb2x2ZSAhPT0gdW5kZWZpbmVkIHx8IHJlamVjdCAhPT0gdW5kZWZpbmVkKXRocm93IFR5cGVFcnJvcignQmFkIFByb21pc2UgY29uc3RydWN0b3InKTsNCiAgICByZXNvbHZlID0gJCRyZXNvbHZlOw0KICAgIHJlamVjdCAgPSAkJHJlamVjdDsNCiAgfSk7DQogIHRoaXMucmVzb2x2ZSA9IGFGdW5jdGlvbihyZXNvbHZlKTsNCiAgdGhpcy5yZWplY3QgID0gYUZ1bmN0aW9uKHJlamVjdCk7DQp9Ow0KdmFyIHBlcmZvcm0gPSBmdW5jdGlvbihleGVjKXsNCiAgdHJ5IHsNCiAgICBleGVjKCk7DQogIH0gY2F0Y2goZSl7DQogICAgcmV0dXJuIHtlcnJvcjogZX07DQogIH0NCn07DQp2YXIgbm90aWZ5ID0gZnVuY3Rpb24ocHJvbWlzZSwgaXNSZWplY3Qpew0KICBpZihwcm9taXNlLl9uKXJldHVybjsNCiAgcHJvbWlzZS5fbiA9IHRydWU7DQogIHZhciBjaGFpbiA9IHByb21pc2UuX2M7DQogIG1pY3JvdGFzayhmdW5jdGlvbigpew0KICAgIHZhciB2YWx1ZSA9IHByb21pc2UuX3YNCiAgICAgICwgb2sgICAgPSBwcm9taXNlLl9zID09IDENCiAgICAgICwgaSAgICAgPSAwOw0KICAgIHZhciBydW4gPSBmdW5jdGlvbihyZWFjdGlvbil7DQogICAgICB2YXIgaGFuZGxlciA9IG9rID8gcmVhY3Rpb24ub2sgOiByZWFjdGlvbi5mYWlsDQogICAgICAgICwgcmVzb2x2ZSA9IHJlYWN0aW9uLnJlc29sdmUNCiAgICAgICAgLCByZWplY3QgID0gcmVhY3Rpb24ucmVqZWN0DQogICAgICAgICwgZG9tYWluICA9IHJlYWN0aW9uLmRvbWFpbg0KICAgICAgICAsIHJlc3VsdCwgdGhlbjsNCiAgICAgIHRyeSB7DQogICAgICAgIGlmKGhhbmRsZXIpew0KICAgICAgICAgIGlmKCFvayl7DQogICAgICAgICAgICBpZihwcm9taXNlLl9oID09IDIpb25IYW5kbGVVbmhhbmRsZWQocHJvbWlzZSk7DQogICAgICAgICAgICBwcm9taXNlLl9oID0gMTsNCiAgICAgICAgICB9DQogICAgICAgICAgaWYoaGFuZGxlciA9PT0gdHJ1ZSlyZXN1bHQgPSB2YWx1ZTsNCiAgICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgIGlmKGRvbWFpbilkb21haW4uZW50ZXIoKTsNCiAgICAgICAgICAgIHJlc3VsdCA9IGhhbmRsZXIodmFsdWUpOw0KICAgICAgICAgICAgaWYoZG9tYWluKWRvbWFpbi5leGl0KCk7DQogICAgICAgICAgfQ0KICAgICAgICAgIGlmKHJlc3VsdCA9PT0gcmVhY3Rpb24ucHJvbWlzZSl7DQogICAgICAgICAgICByZWplY3QoVHlwZUVycm9yKCdQcm9taXNlLWNoYWluIGN5Y2xlJykpOw0KICAgICAgICAgIH0gZWxzZSBpZih0aGVuID0gaXNUaGVuYWJsZShyZXN1bHQpKXsNCiAgICAgICAgICAgIHRoZW4uY2FsbChyZXN1bHQsIHJlc29sdmUsIHJlamVjdCk7DQogICAgICAgICAgfSBlbHNlIHJlc29sdmUocmVzdWx0KTsNCiAgICAgICAgfSBlbHNlIHJlamVjdCh2YWx1ZSk7DQogICAgICB9IGNhdGNoKGUpew0KICAgICAgICByZWplY3QoZSk7DQogICAgICB9DQogICAgfTsNCiAgICB3aGlsZShjaGFpbi5sZW5ndGggPiBpKXJ1bihjaGFpbltpKytdKTsgLy8gdmFyaWFibGUgbGVuZ3RoIC0gY2FuJ3QgdXNlIGZvckVhY2gNCiAgICBwcm9taXNlLl9jID0gW107DQogICAgcHJvbWlzZS5fbiA9IGZhbHNlOw0KICAgIGlmKGlzUmVqZWN0ICYmICFwcm9taXNlLl9oKW9uVW5oYW5kbGVkKHByb21pc2UpOw0KICB9KTsNCn07DQp2YXIgb25VbmhhbmRsZWQgPSBmdW5jdGlvbihwcm9taXNlKXsNCiAgdGFzay5jYWxsKGdsb2JhbCwgZnVuY3Rpb24oKXsNCiAgICB2YXIgdmFsdWUgPSBwcm9taXNlLl92DQogICAgICAsIGFicnVwdCwgaGFuZGxlciwgY29uc29sZTsNCiAgICBpZihpc1VuaGFuZGxlZChwcm9taXNlKSl7DQogICAgICBhYnJ1cHQgPSBwZXJmb3JtKGZ1bmN0aW9uKCl7DQogICAgICAgIGlmKGlzTm9kZSl7DQogICAgICAgICAgcHJvY2Vzcy5lbWl0KCd1bmhhbmRsZWRSZWplY3Rpb24nLCB2YWx1ZSwgcHJvbWlzZSk7DQogICAgICAgIH0gZWxzZSBpZihoYW5kbGVyID0gZ2xvYmFsLm9udW5oYW5kbGVkcmVqZWN0aW9uKXsNCiAgICAgICAgICBoYW5kbGVyKHtwcm9taXNlOiBwcm9taXNlLCByZWFzb246IHZhbHVlfSk7DQogICAgICAgIH0gZWxzZSBpZigoY29uc29sZSA9IGdsb2JhbC5jb25zb2xlKSAmJiBjb25zb2xlLmVycm9yKXsNCiAgICAgICAgICBjb25zb2xlLmVycm9yKCdVbmhhbmRsZWQgcHJvbWlzZSByZWplY3Rpb24nLCB2YWx1ZSk7DQogICAgICAgIH0NCiAgICAgIH0pOw0KICAgICAgLy8gQnJvd3NlcnMgc2hvdWxkIG5vdCB0cmlnZ2VyIGByZWplY3Rpb25IYW5kbGVkYCBldmVudCBpZiBpdCB3YXMgaGFuZGxlZCBoZXJlLCBOb2RlSlMgLSBzaG91bGQNCiAgICAgIHByb21pc2UuX2ggPSBpc05vZGUgfHwgaXNVbmhhbmRsZWQocHJvbWlzZSkgPyAyIDogMTsNCiAgICB9IHByb21pc2UuX2EgPSB1bmRlZmluZWQ7DQogICAgaWYoYWJydXB0KXRocm93IGFicnVwdC5lcnJvcjsNCiAgfSk7DQp9Ow0KdmFyIGlzVW5oYW5kbGVkID0gZnVuY3Rpb24ocHJvbWlzZSl7DQogIGlmKHByb21pc2UuX2ggPT0gMSlyZXR1cm4gZmFsc2U7DQogIHZhciBjaGFpbiA9IHByb21pc2UuX2EgfHwgcHJvbWlzZS5fYw0KICAgICwgaSAgICAgPSAwDQogICAgLCByZWFjdGlvbjsNCiAgd2hpbGUoY2hhaW4ubGVuZ3RoID4gaSl7DQogICAgcmVhY3Rpb24gPSBjaGFpbltpKytdOw0KICAgIGlmKHJlYWN0aW9uLmZhaWwgfHwgIWlzVW5oYW5kbGVkKHJlYWN0aW9uLnByb21pc2UpKXJldHVybiBmYWxzZTsNCiAgfSByZXR1cm4gdHJ1ZTsNCn07DQp2YXIgb25IYW5kbGVVbmhhbmRsZWQgPSBmdW5jdGlvbihwcm9taXNlKXsNCiAgdGFzay5jYWxsKGdsb2JhbCwgZnVuY3Rpb24oKXsNCiAgICB2YXIgaGFuZGxlcjsNCiAgICBpZihpc05vZGUpew0KICAgICAgcHJvY2Vzcy5lbWl0KCdyZWplY3Rpb25IYW5kbGVkJywgcHJvbWlzZSk7DQogICAgfSBlbHNlIGlmKGhhbmRsZXIgPSBnbG9iYWwub25yZWplY3Rpb25oYW5kbGVkKXsNCiAgICAgIGhhbmRsZXIoe3Byb21pc2U6IHByb21pc2UsIHJlYXNvbjogcHJvbWlzZS5fdn0pOw0KICAgIH0NCiAgfSk7DQp9Ow0KdmFyICRyZWplY3QgPSBmdW5jdGlvbih2YWx1ZSl7DQogIHZhciBwcm9taXNlID0gdGhpczsNCiAgaWYocHJvbWlzZS5fZClyZXR1cm47DQogIHByb21pc2UuX2QgPSB0cnVlOw0KICBwcm9taXNlID0gcHJvbWlzZS5fdyB8fCBwcm9taXNlOyAvLyB1bndyYXANCiAgcHJvbWlzZS5fdiA9IHZhbHVlOw0KICBwcm9taXNlLl9zID0gMjsNCiAgaWYoIXByb21pc2UuX2EpcHJvbWlzZS5fYSA9IHByb21pc2UuX2Muc2xpY2UoKTsNCiAgbm90aWZ5KHByb21pc2UsIHRydWUpOw0KfTsNCnZhciAkcmVzb2x2ZSA9IGZ1bmN0aW9uKHZhbHVlKXsNCiAgdmFyIHByb21pc2UgPSB0aGlzDQogICAgLCB0aGVuOw0KICBpZihwcm9taXNlLl9kKXJldHVybjsNCiAgcHJvbWlzZS5fZCA9IHRydWU7DQogIHByb21pc2UgPSBwcm9taXNlLl93IHx8IHByb21pc2U7IC8vIHVud3JhcA0KICB0cnkgew0KICAgIGlmKHByb21pc2UgPT09IHZhbHVlKXRocm93IFR5cGVFcnJvcigiUHJvbWlzZSBjYW4ndCBiZSByZXNvbHZlZCBpdHNlbGYiKTsNCiAgICBpZih0aGVuID0gaXNUaGVuYWJsZSh2YWx1ZSkpew0KICAgICAgbWljcm90YXNrKGZ1bmN0aW9uKCl7DQogICAgICAgIHZhciB3cmFwcGVyID0ge193OiBwcm9taXNlLCBfZDogZmFsc2V9OyAvLyB3cmFwDQogICAgICAgIHRyeSB7DQogICAgICAgICAgdGhlbi5jYWxsKHZhbHVlLCBjdHgoJHJlc29sdmUsIHdyYXBwZXIsIDEpLCBjdHgoJHJlamVjdCwgd3JhcHBlciwgMSkpOw0KICAgICAgICB9IGNhdGNoKGUpew0KICAgICAgICAgICRyZWplY3QuY2FsbCh3cmFwcGVyLCBlKTsNCiAgICAgICAgfQ0KICAgICAgfSk7DQogICAgfSBlbHNlIHsNCiAgICAgIHByb21pc2UuX3YgPSB2YWx1ZTsNCiAgICAgIHByb21pc2UuX3MgPSAxOw0KICAgICAgbm90aWZ5KHByb21pc2UsIGZhbHNlKTsNCiAgICB9DQogIH0gY2F0Y2goZSl7DQogICAgJHJlamVjdC5jYWxsKHtfdzogcHJvbWlzZSwgX2Q6IGZhbHNlfSwgZSk7IC8vIHdyYXANCiAgfQ0KfTsNCg0KLy8gY29uc3RydWN0b3IgcG9seWZpbGwNCmlmKCFVU0VfTkFUSVZFKXsNCiAgLy8gMjUuNC4zLjEgUHJvbWlzZShleGVjdXRvcikNCiAgJFByb21pc2UgPSBmdW5jdGlvbiBQcm9taXNlKGV4ZWN1dG9yKXsNCiAgICBhbkluc3RhbmNlKHRoaXMsICRQcm9taXNlLCBQUk9NSVNFLCAnX2gnKTsNCiAgICBhRnVuY3Rpb24oZXhlY3V0b3IpOw0KICAgIEludGVybmFsLmNhbGwodGhpcyk7DQogICAgdHJ5IHsNCiAgICAgIGV4ZWN1dG9yKGN0eCgkcmVzb2x2ZSwgdGhpcywgMSksIGN0eCgkcmVqZWN0LCB0aGlzLCAxKSk7DQogICAgfSBjYXRjaChlcnIpew0KICAgICAgJHJlamVjdC5jYWxsKHRoaXMsIGVycik7DQogICAgfQ0KICB9Ow0KICBJbnRlcm5hbCA9IGZ1bmN0aW9uIFByb21pc2UoZXhlY3V0b3Ipew0KICAgIHRoaXMuX2MgPSBbXTsgICAgICAgICAgICAgLy8gPC0gYXdhaXRpbmcgcmVhY3Rpb25zDQogICAgdGhpcy5fYSA9IHVuZGVmaW5lZDsgICAgICAvLyA8LSBjaGVja2VkIGluIGlzVW5oYW5kbGVkIHJlYWN0aW9ucw0KICAgIHRoaXMuX3MgPSAwOyAgICAgICAgICAgICAgLy8gPC0gc3RhdGUNCiAgICB0aGlzLl9kID0gZmFsc2U7ICAgICAgICAgIC8vIDwtIGRvbmUNCiAgICB0aGlzLl92ID0gdW5kZWZpbmVkOyAgICAgIC8vIDwtIHZhbHVlDQogICAgdGhpcy5faCA9IDA7ICAgICAgICAgICAgICAvLyA8LSByZWplY3Rpb24gc3RhdGUsIDAgLSBkZWZhdWx0LCAxIC0gaGFuZGxlZCwgMiAtIHVuaGFuZGxlZA0KICAgIHRoaXMuX24gPSBmYWxzZTsgICAgICAgICAgLy8gPC0gbm90aWZ5DQogIH07DQogIEludGVybmFsLnByb3RvdHlwZSA9IHJlcXVpcmUoJy4vX3JlZGVmaW5lLWFsbCcpKCRQcm9taXNlLnByb3RvdHlwZSwgew0KICAgIC8vIDI1LjQuNS4zIFByb21pc2UucHJvdG90eXBlLnRoZW4ob25GdWxmaWxsZWQsIG9uUmVqZWN0ZWQpDQogICAgdGhlbjogZnVuY3Rpb24gdGhlbihvbkZ1bGZpbGxlZCwgb25SZWplY3RlZCl7DQogICAgICB2YXIgcmVhY3Rpb24gICAgPSBuZXdQcm9taXNlQ2FwYWJpbGl0eShzcGVjaWVzQ29uc3RydWN0b3IodGhpcywgJFByb21pc2UpKTsNCiAgICAgIHJlYWN0aW9uLm9rICAgICA9IHR5cGVvZiBvbkZ1bGZpbGxlZCA9PSAnZnVuY3Rpb24nID8gb25GdWxmaWxsZWQgOiB0cnVlOw0KICAgICAgcmVhY3Rpb24uZmFpbCAgID0gdHlwZW9mIG9uUmVqZWN0ZWQgPT0gJ2Z1bmN0aW9uJyAmJiBvblJlamVjdGVkOw0KICAgICAgcmVhY3Rpb24uZG9tYWluID0gaXNOb2RlID8gcHJvY2Vzcy5kb21haW4gOiB1bmRlZmluZWQ7DQogICAgICB0aGlzLl9jLnB1c2gocmVhY3Rpb24pOw0KICAgICAgaWYodGhpcy5fYSl0aGlzLl9hLnB1c2gocmVhY3Rpb24pOw0KICAgICAgaWYodGhpcy5fcylub3RpZnkodGhpcywgZmFsc2UpOw0KICAgICAgcmV0dXJuIHJlYWN0aW9uLnByb21pc2U7DQogICAgfSwNCiAgICAvLyAyNS40LjUuMSBQcm9taXNlLnByb3RvdHlwZS5jYXRjaChvblJlamVjdGVkKQ0KICAgICdjYXRjaCc6IGZ1bmN0aW9uKG9uUmVqZWN0ZWQpew0KICAgICAgcmV0dXJuIHRoaXMudGhlbih1bmRlZmluZWQsIG9uUmVqZWN0ZWQpOw0KICAgIH0NCiAgfSk7DQogIFByb21pc2VDYXBhYmlsaXR5ID0gZnVuY3Rpb24oKXsNCiAgICB2YXIgcHJvbWlzZSAgPSBuZXcgSW50ZXJuYWw7DQogICAgdGhpcy5wcm9taXNlID0gcHJvbWlzZTsNCiAgICB0aGlzLnJlc29sdmUgPSBjdHgoJHJlc29sdmUsIHByb21pc2UsIDEpOw0KICAgIHRoaXMucmVqZWN0ICA9IGN0eCgkcmVqZWN0LCBwcm9taXNlLCAxKTsNCiAgfTsNCn0NCg0KJGV4cG9ydCgkZXhwb3J0LkcgKyAkZXhwb3J0LlcgKyAkZXhwb3J0LkYgKiAhVVNFX05BVElWRSwge1Byb21pc2U6ICRQcm9taXNlfSk7DQpyZXF1aXJlKCcuL19zZXQtdG8tc3RyaW5nLXRhZycpKCRQcm9taXNlLCBQUk9NSVNFKTsNCnJlcXVpcmUoJy4vX3NldC1zcGVjaWVzJykoUFJPTUlTRSk7DQpXcmFwcGVyID0gcmVxdWlyZSgnLi9fY29yZScpW1BST01JU0VdOw0KDQovLyBzdGF0aWNzDQokZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqICFVU0VfTkFUSVZFLCBQUk9NSVNFLCB7DQogIC8vIDI1LjQuNC41IFByb21pc2UucmVqZWN0KHIpDQogIHJlamVjdDogZnVuY3Rpb24gcmVqZWN0KHIpew0KICAgIHZhciBjYXBhYmlsaXR5ID0gbmV3UHJvbWlzZUNhcGFiaWxpdHkodGhpcykNCiAgICAgICwgJCRyZWplY3QgICA9IGNhcGFiaWxpdHkucmVqZWN0Ow0KICAgICQkcmVqZWN0KHIpOw0KICAgIHJldHVybiBjYXBhYmlsaXR5LnByb21pc2U7DQogIH0NCn0pOw0KJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYgKiAoTElCUkFSWSB8fCAhVVNFX05BVElWRSksIFBST01JU0UsIHsNCiAgLy8gMjUuNC40LjYgUHJvbWlzZS5yZXNvbHZlKHgpDQogIHJlc29sdmU6IGZ1bmN0aW9uIHJlc29sdmUoeCl7DQogICAgLy8gaW5zdGFuY2VvZiBpbnN0ZWFkIG9mIGludGVybmFsIHNsb3QgY2hlY2sgYmVjYXVzZSB3ZSBzaG91bGQgZml4IGl0IHdpdGhvdXQgcmVwbGFjZW1lbnQgbmF0aXZlIFByb21pc2UgY29yZQ0KICAgIGlmKHggaW5zdGFuY2VvZiAkUHJvbWlzZSAmJiBzYW1lQ29uc3RydWN0b3IoeC5jb25zdHJ1Y3RvciwgdGhpcykpcmV0dXJuIHg7DQogICAgdmFyIGNhcGFiaWxpdHkgPSBuZXdQcm9taXNlQ2FwYWJpbGl0eSh0aGlzKQ0KICAgICAgLCAkJHJlc29sdmUgID0gY2FwYWJpbGl0eS5yZXNvbHZlOw0KICAgICQkcmVzb2x2ZSh4KTsNCiAgICByZXR1cm4gY2FwYWJpbGl0eS5wcm9taXNlOw0KICB9DQp9KTsNCiRleHBvcnQoJGV4cG9ydC5TICsgJGV4cG9ydC5GICogIShVU0VfTkFUSVZFICYmIHJlcXVpcmUoJy4vX2l0ZXItZGV0ZWN0JykoZnVuY3Rpb24oaXRlcil7DQogICRQcm9taXNlLmFsbChpdGVyKVsnY2F0Y2gnXShlbXB0eSk7DQp9KSksIFBST01JU0UsIHsNCiAgLy8gMjUuNC40LjEgUHJvbWlzZS5hbGwoaXRlcmFibGUpDQogIGFsbDogZnVuY3Rpb24gYWxsKGl0ZXJhYmxlKXsNCiAgICB2YXIgQyAgICAgICAgICA9IHRoaXMNCiAgICAgICwgY2FwYWJpbGl0eSA9IG5ld1Byb21pc2VDYXBhYmlsaXR5KEMpDQogICAgICAsIHJlc29sdmUgICAgPSBjYXBhYmlsaXR5LnJlc29sdmUNCiAgICAgICwgcmVqZWN0ICAgICA9IGNhcGFiaWxpdHkucmVqZWN0Ow0KICAgIHZhciBhYnJ1cHQgPSBwZXJmb3JtKGZ1bmN0aW9uKCl7DQogICAgICB2YXIgdmFsdWVzICAgID0gW10NCiAgICAgICAgLCBpbmRleCAgICAgPSAwDQogICAgICAgICwgcmVtYWluaW5nID0gMTsNCiAgICAgIGZvck9mKGl0ZXJhYmxlLCBmYWxzZSwgZnVuY3Rpb24ocHJvbWlzZSl7DQogICAgICAgIHZhciAkaW5kZXggICAgICAgID0gaW5kZXgrKw0KICAgICAgICAgICwgYWxyZWFkeUNhbGxlZCA9IGZhbHNlOw0KICAgICAgICB2YWx1ZXMucHVzaCh1bmRlZmluZWQpOw0KICAgICAgICByZW1haW5pbmcrKzsNCiAgICAgICAgQy5yZXNvbHZlKHByb21pc2UpLnRoZW4oZnVuY3Rpb24odmFsdWUpew0KICAgICAgICAgIGlmKGFscmVhZHlDYWxsZWQpcmV0dXJuOw0KICAgICAgICAgIGFscmVhZHlDYWxsZWQgID0gdHJ1ZTsNCiAgICAgICAgICB2YWx1ZXNbJGluZGV4XSA9IHZhbHVlOw0KICAgICAgICAgIC0tcmVtYWluaW5nIHx8IHJlc29sdmUodmFsdWVzKTsNCiAgICAgICAgfSwgcmVqZWN0KTsNCiAgICAgIH0pOw0KICAgICAgLS1yZW1haW5pbmcgfHwgcmVzb2x2ZSh2YWx1ZXMpOw0KICAgIH0pOw0KICAgIGlmKGFicnVwdClyZWplY3QoYWJydXB0LmVycm9yKTsNCiAgICByZXR1cm4gY2FwYWJpbGl0eS5wcm9taXNlOw0KICB9LA0KICAvLyAyNS40LjQuNCBQcm9taXNlLnJhY2UoaXRlcmFibGUpDQogIHJhY2U6IGZ1bmN0aW9uIHJhY2UoaXRlcmFibGUpew0KICAgIHZhciBDICAgICAgICAgID0gdGhpcw0KICAgICAgLCBjYXBhYmlsaXR5ID0gbmV3UHJvbWlzZUNhcGFiaWxpdHkoQykNCiAgICAgICwgcmVqZWN0ICAgICA9IGNhcGFiaWxpdHkucmVqZWN0Ow0KICAgIHZhciBhYnJ1cHQgPSBwZXJmb3JtKGZ1bmN0aW9uKCl7DQogICAgICBmb3JPZihpdGVyYWJsZSwgZmFsc2UsIGZ1bmN0aW9uKHByb21pc2Upew0KICAgICAgICBDLnJlc29sdmUocHJvbWlzZSkudGhlbihjYXBhYmlsaXR5LnJlc29sdmUsIHJlamVjdCk7DQogICAgICB9KTsNCiAgICB9KTsNCiAgICBpZihhYnJ1cHQpcmVqZWN0KGFicnVwdC5lcnJvcik7DQogICAgcmV0dXJuIGNhcGFiaWxpdHkucHJvbWlzZTsNCiAgfQ0KfSk7DQp9LHsiLi9fYS1mdW5jdGlvbiI6MywiLi9fYW4taW5zdGFuY2UiOjYsIi4vX2FuLW9iamVjdCI6NywiLi9fY2xhc3NvZiI6MTcsIi4vX2NvcmUiOjIzLCIuL19jdHgiOjI1LCIuL19leHBvcnQiOjMyLCIuL19mb3Itb2YiOjM3LCIuL19nbG9iYWwiOjM4LCIuL19pcy1vYmplY3QiOjQ5LCIuL19pdGVyLWRldGVjdCI6NTQsIi4vX2xpYnJhcnkiOjU4LCIuL19taWNyb3Rhc2siOjY0LCIuL19yZWRlZmluZS1hbGwiOjg2LCIuL19zZXQtcHJvdG8iOjkwLCIuL19zZXQtc3BlY2llcyI6OTEsIi4vX3NldC10by1zdHJpbmctdGFnIjo5MiwiLi9fc3BlY2llcy1jb25zdHJ1Y3RvciI6OTUsIi4vX3Rhc2siOjEwNCwiLi9fd2tzIjoxMTd9XSwyMDA6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KLy8gMjYuMS4xIFJlZmxlY3QuYXBwbHkodGFyZ2V0LCB0aGlzQXJndW1lbnQsIGFyZ3VtZW50c0xpc3QpDQp2YXIgJGV4cG9ydCAgID0gcmVxdWlyZSgnLi9fZXhwb3J0JykNCiAgLCBhRnVuY3Rpb24gPSByZXF1aXJlKCcuL19hLWZ1bmN0aW9uJykNCiAgLCBhbk9iamVjdCAgPSByZXF1aXJlKCcuL19hbi1vYmplY3QnKQ0KICAsIF9hcHBseSAgICA9IEZ1bmN0aW9uLmFwcGx5Ow0KDQokZXhwb3J0KCRleHBvcnQuUywgJ1JlZmxlY3QnLCB7DQogIGFwcGx5OiBmdW5jdGlvbiBhcHBseSh0YXJnZXQsIHRoaXNBcmd1bWVudCwgYXJndW1lbnRzTGlzdCl7DQogICAgcmV0dXJuIF9hcHBseS5jYWxsKGFGdW5jdGlvbih0YXJnZXQpLCB0aGlzQXJndW1lbnQsIGFuT2JqZWN0KGFyZ3VtZW50c0xpc3QpKTsNCiAgfQ0KfSk7DQp9LHsiLi9fYS1mdW5jdGlvbiI6MywiLi9fYW4tb2JqZWN0Ijo3LCIuL19leHBvcnQiOjMyfV0sMjAxOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCi8vIDI2LjEuMiBSZWZsZWN0LmNvbnN0cnVjdCh0YXJnZXQsIGFyZ3VtZW50c0xpc3QgWywgbmV3VGFyZ2V0XSkNCnZhciAkZXhwb3J0ICAgPSByZXF1aXJlKCcuL19leHBvcnQnKQ0KICAsIGNyZWF0ZSAgICA9IHJlcXVpcmUoJy4vX29iamVjdC1jcmVhdGUnKQ0KICAsIGFGdW5jdGlvbiA9IHJlcXVpcmUoJy4vX2EtZnVuY3Rpb24nKQ0KICAsIGFuT2JqZWN0ICA9IHJlcXVpcmUoJy4vX2FuLW9iamVjdCcpDQogICwgaXNPYmplY3QgID0gcmVxdWlyZSgnLi9faXMtb2JqZWN0JykNCiAgLCBiaW5kICAgICAgPSByZXF1aXJlKCcuL19iaW5kJyk7DQoNCi8vIE1TIEVkZ2Ugc3VwcG9ydHMgb25seSAyIGFyZ3VtZW50cw0KLy8gRkYgTmlnaHRseSBzZXRzIHRoaXJkIGFyZ3VtZW50IGFzIGBuZXcudGFyZ2V0YCwgYnV0IGRvZXMgbm90IGNyZWF0ZSBgdGhpc2AgZnJvbSBpdA0KJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYgKiByZXF1aXJlKCcuL19mYWlscycpKGZ1bmN0aW9uKCl7DQogIGZ1bmN0aW9uIEYoKXt9DQogIHJldHVybiAhKFJlZmxlY3QuY29uc3RydWN0KGZ1bmN0aW9uKCl7fSwgW10sIEYpIGluc3RhbmNlb2YgRik7DQp9KSwgJ1JlZmxlY3QnLCB7DQogIGNvbnN0cnVjdDogZnVuY3Rpb24gY29uc3RydWN0KFRhcmdldCwgYXJncyAvKiwgbmV3VGFyZ2V0Ki8pew0KICAgIGFGdW5jdGlvbihUYXJnZXQpOw0KICAgIGFuT2JqZWN0KGFyZ3MpOw0KICAgIHZhciBuZXdUYXJnZXQgPSBhcmd1bWVudHMubGVuZ3RoIDwgMyA/IFRhcmdldCA6IGFGdW5jdGlvbihhcmd1bWVudHNbMl0pOw0KICAgIGlmKFRhcmdldCA9PSBuZXdUYXJnZXQpew0KICAgICAgLy8gdy9vIGFsdGVyZWQgbmV3VGFyZ2V0LCBvcHRpbWl6YXRpb24gZm9yIDAtNCBhcmd1bWVudHMNCiAgICAgIHN3aXRjaChhcmdzLmxlbmd0aCl7DQogICAgICAgIGNhc2UgMDogcmV0dXJuIG5ldyBUYXJnZXQ7DQogICAgICAgIGNhc2UgMTogcmV0dXJuIG5ldyBUYXJnZXQoYXJnc1swXSk7DQogICAgICAgIGNhc2UgMjogcmV0dXJuIG5ldyBUYXJnZXQoYXJnc1swXSwgYXJnc1sxXSk7DQogICAgICAgIGNhc2UgMzogcmV0dXJuIG5ldyBUYXJnZXQoYXJnc1swXSwgYXJnc1sxXSwgYXJnc1syXSk7DQogICAgICAgIGNhc2UgNDogcmV0dXJuIG5ldyBUYXJnZXQoYXJnc1swXSwgYXJnc1sxXSwgYXJnc1syXSwgYXJnc1szXSk7DQogICAgICB9DQogICAgICAvLyB3L28gYWx0ZXJlZCBuZXdUYXJnZXQsIGxvdCBvZiBhcmd1bWVudHMgY2FzZQ0KICAgICAgdmFyICRhcmdzID0gW251bGxdOw0KICAgICAgJGFyZ3MucHVzaC5hcHBseSgkYXJncywgYXJncyk7DQogICAgICByZXR1cm4gbmV3IChiaW5kLmFwcGx5KFRhcmdldCwgJGFyZ3MpKTsNCiAgICB9DQogICAgLy8gd2l0aCBhbHRlcmVkIG5ld1RhcmdldCwgbm90IHN1cHBvcnQgYnVpbHQtaW4gY29uc3RydWN0b3JzDQogICAgdmFyIHByb3RvICAgID0gbmV3VGFyZ2V0LnByb3RvdHlwZQ0KICAgICAgLCBpbnN0YW5jZSA9IGNyZWF0ZShpc09iamVjdChwcm90bykgPyBwcm90byA6IE9iamVjdC5wcm90b3R5cGUpDQogICAgICAsIHJlc3VsdCAgID0gRnVuY3Rpb24uYXBwbHkuY2FsbChUYXJnZXQsIGluc3RhbmNlLCBhcmdzKTsNCiAgICByZXR1cm4gaXNPYmplY3QocmVzdWx0KSA/IHJlc3VsdCA6IGluc3RhbmNlOw0KICB9DQp9KTsNCn0seyIuL19hLWZ1bmN0aW9uIjozLCIuL19hbi1vYmplY3QiOjcsIi4vX2JpbmQiOjE2LCIuL19leHBvcnQiOjMyLCIuL19mYWlscyI6MzQsIi4vX2lzLW9iamVjdCI6NDksIi4vX29iamVjdC1jcmVhdGUiOjY2fV0sMjAyOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCi8vIDI2LjEuMyBSZWZsZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgcHJvcGVydHlLZXksIGF0dHJpYnV0ZXMpDQp2YXIgZFAgICAgICAgICAgPSByZXF1aXJlKCcuL19vYmplY3QtZHAnKQ0KICAsICRleHBvcnQgICAgID0gcmVxdWlyZSgnLi9fZXhwb3J0JykNCiAgLCBhbk9iamVjdCAgICA9IHJlcXVpcmUoJy4vX2FuLW9iamVjdCcpDQogICwgdG9QcmltaXRpdmUgPSByZXF1aXJlKCcuL190by1wcmltaXRpdmUnKTsNCg0KLy8gTVMgRWRnZSBoYXMgYnJva2VuIFJlZmxlY3QuZGVmaW5lUHJvcGVydHkgLSB0aHJvd2luZyBpbnN0ZWFkIG9mIHJldHVybmluZyBmYWxzZQ0KJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYgKiByZXF1aXJlKCcuL19mYWlscycpKGZ1bmN0aW9uKCl7DQogIFJlZmxlY3QuZGVmaW5lUHJvcGVydHkoZFAuZih7fSwgMSwge3ZhbHVlOiAxfSksIDEsIHt2YWx1ZTogMn0pOw0KfSksICdSZWZsZWN0Jywgew0KICBkZWZpbmVQcm9wZXJ0eTogZnVuY3Rpb24gZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBwcm9wZXJ0eUtleSwgYXR0cmlidXRlcyl7DQogICAgYW5PYmplY3QodGFyZ2V0KTsNCiAgICBwcm9wZXJ0eUtleSA9IHRvUHJpbWl0aXZlKHByb3BlcnR5S2V5LCB0cnVlKTsNCiAgICBhbk9iamVjdChhdHRyaWJ1dGVzKTsNCiAgICB0cnkgew0KICAgICAgZFAuZih0YXJnZXQsIHByb3BlcnR5S2V5LCBhdHRyaWJ1dGVzKTsNCiAgICAgIHJldHVybiB0cnVlOw0KICAgIH0gY2F0Y2goZSl7DQogICAgICByZXR1cm4gZmFsc2U7DQogICAgfQ0KICB9DQp9KTsNCn0seyIuL19hbi1vYmplY3QiOjcsIi4vX2V4cG9ydCI6MzIsIi4vX2ZhaWxzIjozNCwiLi9fb2JqZWN0LWRwIjo2NywiLi9fdG8tcHJpbWl0aXZlIjoxMTB9XSwyMDM6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KLy8gMjYuMS40IFJlZmxlY3QuZGVsZXRlUHJvcGVydHkodGFyZ2V0LCBwcm9wZXJ0eUtleSkNCnZhciAkZXhwb3J0ICA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpDQogICwgZ09QRCAgICAgPSByZXF1aXJlKCcuL19vYmplY3QtZ29wZCcpLmYNCiAgLCBhbk9iamVjdCA9IHJlcXVpcmUoJy4vX2FuLW9iamVjdCcpOw0KDQokZXhwb3J0KCRleHBvcnQuUywgJ1JlZmxlY3QnLCB7DQogIGRlbGV0ZVByb3BlcnR5OiBmdW5jdGlvbiBkZWxldGVQcm9wZXJ0eSh0YXJnZXQsIHByb3BlcnR5S2V5KXsNCiAgICB2YXIgZGVzYyA9IGdPUEQoYW5PYmplY3QodGFyZ2V0KSwgcHJvcGVydHlLZXkpOw0KICAgIHJldHVybiBkZXNjICYmICFkZXNjLmNvbmZpZ3VyYWJsZSA/IGZhbHNlIDogZGVsZXRlIHRhcmdldFtwcm9wZXJ0eUtleV07DQogIH0NCn0pOw0KfSx7Ii4vX2FuLW9iamVjdCI6NywiLi9fZXhwb3J0IjozMiwiLi9fb2JqZWN0LWdvcGQiOjcwfV0sMjA0OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCid1c2Ugc3RyaWN0JzsNCi8vIDI2LjEuNSBSZWZsZWN0LmVudW1lcmF0ZSh0YXJnZXQpDQp2YXIgJGV4cG9ydCAgPSByZXF1aXJlKCcuL19leHBvcnQnKQ0KICAsIGFuT2JqZWN0ID0gcmVxdWlyZSgnLi9fYW4tb2JqZWN0Jyk7DQp2YXIgRW51bWVyYXRlID0gZnVuY3Rpb24oaXRlcmF0ZWQpew0KICB0aGlzLl90ID0gYW5PYmplY3QoaXRlcmF0ZWQpOyAvLyB0YXJnZXQNCiAgdGhpcy5faSA9IDA7ICAgICAgICAgICAgICAgICAgLy8gbmV4dCBpbmRleA0KICB2YXIga2V5cyA9IHRoaXMuX2sgPSBbXSAgICAgICAvLyBrZXlzDQogICAgLCBrZXk7DQogIGZvcihrZXkgaW4gaXRlcmF0ZWQpa2V5cy5wdXNoKGtleSk7DQp9Ow0KcmVxdWlyZSgnLi9faXRlci1jcmVhdGUnKShFbnVtZXJhdGUsICdPYmplY3QnLCBmdW5jdGlvbigpew0KICB2YXIgdGhhdCA9IHRoaXMNCiAgICAsIGtleXMgPSB0aGF0Ll9rDQogICAgLCBrZXk7DQogIGRvIHsNCiAgICBpZih0aGF0Ll9pID49IGtleXMubGVuZ3RoKXJldHVybiB7dmFsdWU6IHVuZGVmaW5lZCwgZG9uZTogdHJ1ZX07DQogIH0gd2hpbGUoISgoa2V5ID0ga2V5c1t0aGF0Ll9pKytdKSBpbiB0aGF0Ll90KSk7DQogIHJldHVybiB7dmFsdWU6IGtleSwgZG9uZTogZmFsc2V9Ow0KfSk7DQoNCiRleHBvcnQoJGV4cG9ydC5TLCAnUmVmbGVjdCcsIHsNCiAgZW51bWVyYXRlOiBmdW5jdGlvbiBlbnVtZXJhdGUodGFyZ2V0KXsNCiAgICByZXR1cm4gbmV3IEVudW1lcmF0ZSh0YXJnZXQpOw0KICB9DQp9KTsNCn0seyIuL19hbi1vYmplY3QiOjcsIi4vX2V4cG9ydCI6MzIsIi4vX2l0ZXItY3JlYXRlIjo1Mn1dLDIwNTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQovLyAyNi4xLjcgUmVmbGVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBwcm9wZXJ0eUtleSkNCnZhciBnT1BEICAgICA9IHJlcXVpcmUoJy4vX29iamVjdC1nb3BkJykNCiAgLCAkZXhwb3J0ICA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpDQogICwgYW5PYmplY3QgPSByZXF1aXJlKCcuL19hbi1vYmplY3QnKTsNCg0KJGV4cG9ydCgkZXhwb3J0LlMsICdSZWZsZWN0Jywgew0KICBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3I6IGZ1bmN0aW9uIGdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIHByb3BlcnR5S2V5KXsNCiAgICByZXR1cm4gZ09QRC5mKGFuT2JqZWN0KHRhcmdldCksIHByb3BlcnR5S2V5KTsNCiAgfQ0KfSk7DQp9LHsiLi9fYW4tb2JqZWN0Ijo3LCIuL19leHBvcnQiOjMyLCIuL19vYmplY3QtZ29wZCI6NzB9XSwyMDY6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KLy8gMjYuMS44IFJlZmxlY3QuZ2V0UHJvdG90eXBlT2YodGFyZ2V0KQ0KdmFyICRleHBvcnQgID0gcmVxdWlyZSgnLi9fZXhwb3J0JykNCiAgLCBnZXRQcm90byA9IHJlcXVpcmUoJy4vX29iamVjdC1ncG8nKQ0KICAsIGFuT2JqZWN0ID0gcmVxdWlyZSgnLi9fYW4tb2JqZWN0Jyk7DQoNCiRleHBvcnQoJGV4cG9ydC5TLCAnUmVmbGVjdCcsIHsNCiAgZ2V0UHJvdG90eXBlT2Y6IGZ1bmN0aW9uIGdldFByb3RvdHlwZU9mKHRhcmdldCl7DQogICAgcmV0dXJuIGdldFByb3RvKGFuT2JqZWN0KHRhcmdldCkpOw0KICB9DQp9KTsNCn0seyIuL19hbi1vYmplY3QiOjcsIi4vX2V4cG9ydCI6MzIsIi4vX29iamVjdC1ncG8iOjc0fV0sMjA3OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCi8vIDI2LjEuNiBSZWZsZWN0LmdldCh0YXJnZXQsIHByb3BlcnR5S2V5IFssIHJlY2VpdmVyXSkNCnZhciBnT1BEICAgICAgICAgICA9IHJlcXVpcmUoJy4vX29iamVjdC1nb3BkJykNCiAgLCBnZXRQcm90b3R5cGVPZiA9IHJlcXVpcmUoJy4vX29iamVjdC1ncG8nKQ0KICAsIGhhcyAgICAgICAgICAgID0gcmVxdWlyZSgnLi9faGFzJykNCiAgLCAkZXhwb3J0ICAgICAgICA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpDQogICwgaXNPYmplY3QgICAgICAgPSByZXF1aXJlKCcuL19pcy1vYmplY3QnKQ0KICAsIGFuT2JqZWN0ICAgICAgID0gcmVxdWlyZSgnLi9fYW4tb2JqZWN0Jyk7DQoNCmZ1bmN0aW9uIGdldCh0YXJnZXQsIHByb3BlcnR5S2V5LyosIHJlY2VpdmVyKi8pew0KICB2YXIgcmVjZWl2ZXIgPSBhcmd1bWVudHMubGVuZ3RoIDwgMyA/IHRhcmdldCA6IGFyZ3VtZW50c1syXQ0KICAgICwgZGVzYywgcHJvdG87DQogIGlmKGFuT2JqZWN0KHRhcmdldCkgPT09IHJlY2VpdmVyKXJldHVybiB0YXJnZXRbcHJvcGVydHlLZXldOw0KICBpZihkZXNjID0gZ09QRC5mKHRhcmdldCwgcHJvcGVydHlLZXkpKXJldHVybiBoYXMoZGVzYywgJ3ZhbHVlJykNCiAgICA/IGRlc2MudmFsdWUNCiAgICA6IGRlc2MuZ2V0ICE9PSB1bmRlZmluZWQNCiAgICAgID8gZGVzYy5nZXQuY2FsbChyZWNlaXZlcikNCiAgICAgIDogdW5kZWZpbmVkOw0KICBpZihpc09iamVjdChwcm90byA9IGdldFByb3RvdHlwZU9mKHRhcmdldCkpKXJldHVybiBnZXQocHJvdG8sIHByb3BlcnR5S2V5LCByZWNlaXZlcik7DQp9DQoNCiRleHBvcnQoJGV4cG9ydC5TLCAnUmVmbGVjdCcsIHtnZXQ6IGdldH0pOw0KfSx7Ii4vX2FuLW9iamVjdCI6NywiLi9fZXhwb3J0IjozMiwiLi9faGFzIjozOSwiLi9faXMtb2JqZWN0Ijo0OSwiLi9fb2JqZWN0LWdvcGQiOjcwLCIuL19vYmplY3QtZ3BvIjo3NH1dLDIwODpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQovLyAyNi4xLjkgUmVmbGVjdC5oYXModGFyZ2V0LCBwcm9wZXJ0eUtleSkNCnZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0Jyk7DQoNCiRleHBvcnQoJGV4cG9ydC5TLCAnUmVmbGVjdCcsIHsNCiAgaGFzOiBmdW5jdGlvbiBoYXModGFyZ2V0LCBwcm9wZXJ0eUtleSl7DQogICAgcmV0dXJuIHByb3BlcnR5S2V5IGluIHRhcmdldDsNCiAgfQ0KfSk7DQp9LHsiLi9fZXhwb3J0IjozMn1dLDIwOTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQovLyAyNi4xLjEwIFJlZmxlY3QuaXNFeHRlbnNpYmxlKHRhcmdldCkNCnZhciAkZXhwb3J0ICAgICAgID0gcmVxdWlyZSgnLi9fZXhwb3J0JykNCiAgLCBhbk9iamVjdCAgICAgID0gcmVxdWlyZSgnLi9fYW4tb2JqZWN0JykNCiAgLCAkaXNFeHRlbnNpYmxlID0gT2JqZWN0LmlzRXh0ZW5zaWJsZTsNCg0KJGV4cG9ydCgkZXhwb3J0LlMsICdSZWZsZWN0Jywgew0KICBpc0V4dGVuc2libGU6IGZ1bmN0aW9uIGlzRXh0ZW5zaWJsZSh0YXJnZXQpew0KICAgIGFuT2JqZWN0KHRhcmdldCk7DQogICAgcmV0dXJuICRpc0V4dGVuc2libGUgPyAkaXNFeHRlbnNpYmxlKHRhcmdldCkgOiB0cnVlOw0KICB9DQp9KTsNCn0seyIuL19hbi1vYmplY3QiOjcsIi4vX2V4cG9ydCI6MzJ9XSwyMTA6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KLy8gMjYuMS4xMSBSZWZsZWN0Lm93bktleXModGFyZ2V0KQ0KdmFyICRleHBvcnQgPSByZXF1aXJlKCcuL19leHBvcnQnKTsNCg0KJGV4cG9ydCgkZXhwb3J0LlMsICdSZWZsZWN0Jywge293bktleXM6IHJlcXVpcmUoJy4vX293bi1rZXlzJyl9KTsNCn0seyIuL19leHBvcnQiOjMyLCIuL19vd24ta2V5cyI6ODB9XSwyMTE6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KLy8gMjYuMS4xMiBSZWZsZWN0LnByZXZlbnRFeHRlbnNpb25zKHRhcmdldCkNCnZhciAkZXhwb3J0ICAgICAgICAgICAgPSByZXF1aXJlKCcuL19leHBvcnQnKQ0KICAsIGFuT2JqZWN0ICAgICAgICAgICA9IHJlcXVpcmUoJy4vX2FuLW9iamVjdCcpDQogICwgJHByZXZlbnRFeHRlbnNpb25zID0gT2JqZWN0LnByZXZlbnRFeHRlbnNpb25zOw0KDQokZXhwb3J0KCRleHBvcnQuUywgJ1JlZmxlY3QnLCB7DQogIHByZXZlbnRFeHRlbnNpb25zOiBmdW5jdGlvbiBwcmV2ZW50RXh0ZW5zaW9ucyh0YXJnZXQpew0KICAgIGFuT2JqZWN0KHRhcmdldCk7DQogICAgdHJ5IHsNCiAgICAgIGlmKCRwcmV2ZW50RXh0ZW5zaW9ucykkcHJldmVudEV4dGVuc2lvbnModGFyZ2V0KTsNCiAgICAgIHJldHVybiB0cnVlOw0KICAgIH0gY2F0Y2goZSl7DQogICAgICByZXR1cm4gZmFsc2U7DQogICAgfQ0KICB9DQp9KTsNCn0seyIuL19hbi1vYmplY3QiOjcsIi4vX2V4cG9ydCI6MzJ9XSwyMTI6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KLy8gMjYuMS4xNCBSZWZsZWN0LnNldFByb3RvdHlwZU9mKHRhcmdldCwgcHJvdG8pDQp2YXIgJGV4cG9ydCAgPSByZXF1aXJlKCcuL19leHBvcnQnKQ0KICAsIHNldFByb3RvID0gcmVxdWlyZSgnLi9fc2V0LXByb3RvJyk7DQoNCmlmKHNldFByb3RvKSRleHBvcnQoJGV4cG9ydC5TLCAnUmVmbGVjdCcsIHsNCiAgc2V0UHJvdG90eXBlT2Y6IGZ1bmN0aW9uIHNldFByb3RvdHlwZU9mKHRhcmdldCwgcHJvdG8pew0KICAgIHNldFByb3RvLmNoZWNrKHRhcmdldCwgcHJvdG8pOw0KICAgIHRyeSB7DQogICAgICBzZXRQcm90by5zZXQodGFyZ2V0LCBwcm90byk7DQogICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9IGNhdGNoKGUpew0KICAgICAgcmV0dXJuIGZhbHNlOw0KICAgIH0NCiAgfQ0KfSk7DQp9LHsiLi9fZXhwb3J0IjozMiwiLi9fc2V0LXByb3RvIjo5MH1dLDIxMzpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQovLyAyNi4xLjEzIFJlZmxlY3Quc2V0KHRhcmdldCwgcHJvcGVydHlLZXksIFYgWywgcmVjZWl2ZXJdKQ0KdmFyIGRQICAgICAgICAgICAgID0gcmVxdWlyZSgnLi9fb2JqZWN0LWRwJykNCiAgLCBnT1BEICAgICAgICAgICA9IHJlcXVpcmUoJy4vX29iamVjdC1nb3BkJykNCiAgLCBnZXRQcm90b3R5cGVPZiA9IHJlcXVpcmUoJy4vX29iamVjdC1ncG8nKQ0KICAsIGhhcyAgICAgICAgICAgID0gcmVxdWlyZSgnLi9faGFzJykNCiAgLCAkZXhwb3J0ICAgICAgICA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpDQogICwgY3JlYXRlRGVzYyAgICAgPSByZXF1aXJlKCcuL19wcm9wZXJ0eS1kZXNjJykNCiAgLCBhbk9iamVjdCAgICAgICA9IHJlcXVpcmUoJy4vX2FuLW9iamVjdCcpDQogICwgaXNPYmplY3QgICAgICAgPSByZXF1aXJlKCcuL19pcy1vYmplY3QnKTsNCg0KZnVuY3Rpb24gc2V0KHRhcmdldCwgcHJvcGVydHlLZXksIFYvKiwgcmVjZWl2ZXIqLyl7DQogIHZhciByZWNlaXZlciA9IGFyZ3VtZW50cy5sZW5ndGggPCA0ID8gdGFyZ2V0IDogYXJndW1lbnRzWzNdDQogICAgLCBvd25EZXNjICA9IGdPUEQuZihhbk9iamVjdCh0YXJnZXQpLCBwcm9wZXJ0eUtleSkNCiAgICAsIGV4aXN0aW5nRGVzY3JpcHRvciwgcHJvdG87DQogIGlmKCFvd25EZXNjKXsNCiAgICBpZihpc09iamVjdChwcm90byA9IGdldFByb3RvdHlwZU9mKHRhcmdldCkpKXsNCiAgICAgIHJldHVybiBzZXQocHJvdG8sIHByb3BlcnR5S2V5LCBWLCByZWNlaXZlcik7DQogICAgfQ0KICAgIG93bkRlc2MgPSBjcmVhdGVEZXNjKDApOw0KICB9DQogIGlmKGhhcyhvd25EZXNjLCAndmFsdWUnKSl7DQogICAgaWYob3duRGVzYy53cml0YWJsZSA9PT0gZmFsc2UgfHwgIWlzT2JqZWN0KHJlY2VpdmVyKSlyZXR1cm4gZmFsc2U7DQogICAgZXhpc3RpbmdEZXNjcmlwdG9yID0gZ09QRC5mKHJlY2VpdmVyLCBwcm9wZXJ0eUtleSkgfHwgY3JlYXRlRGVzYygwKTsNCiAgICBleGlzdGluZ0Rlc2NyaXB0b3IudmFsdWUgPSBWOw0KICAgIGRQLmYocmVjZWl2ZXIsIHByb3BlcnR5S2V5LCBleGlzdGluZ0Rlc2NyaXB0b3IpOw0KICAgIHJldHVybiB0cnVlOw0KICB9DQogIHJldHVybiBvd25EZXNjLnNldCA9PT0gdW5kZWZpbmVkID8gZmFsc2UgOiAob3duRGVzYy5zZXQuY2FsbChyZWNlaXZlciwgViksIHRydWUpOw0KfQ0KDQokZXhwb3J0KCRleHBvcnQuUywgJ1JlZmxlY3QnLCB7c2V0OiBzZXR9KTsNCn0seyIuL19hbi1vYmplY3QiOjcsIi4vX2V4cG9ydCI6MzIsIi4vX2hhcyI6MzksIi4vX2lzLW9iamVjdCI6NDksIi4vX29iamVjdC1kcCI6NjcsIi4vX29iamVjdC1nb3BkIjo3MCwiLi9fb2JqZWN0LWdwbyI6NzQsIi4vX3Byb3BlcnR5LWRlc2MiOjg1fV0sMjE0OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCnZhciBnbG9iYWwgICAgICAgICAgICA9IHJlcXVpcmUoJy4vX2dsb2JhbCcpDQogICwgaW5oZXJpdElmUmVxdWlyZWQgPSByZXF1aXJlKCcuL19pbmhlcml0LWlmLXJlcXVpcmVkJykNCiAgLCBkUCAgICAgICAgICAgICAgICA9IHJlcXVpcmUoJy4vX29iamVjdC1kcCcpLmYNCiAgLCBnT1BOICAgICAgICAgICAgICA9IHJlcXVpcmUoJy4vX29iamVjdC1nb3BuJykuZg0KICAsIGlzUmVnRXhwICAgICAgICAgID0gcmVxdWlyZSgnLi9faXMtcmVnZXhwJykNCiAgLCAkZmxhZ3MgICAgICAgICAgICA9IHJlcXVpcmUoJy4vX2ZsYWdzJykNCiAgLCAkUmVnRXhwICAgICAgICAgICA9IGdsb2JhbC5SZWdFeHANCiAgLCBCYXNlICAgICAgICAgICAgICA9ICRSZWdFeHANCiAgLCBwcm90byAgICAgICAgICAgICA9ICRSZWdFeHAucHJvdG90eXBlDQogICwgcmUxICAgICAgICAgICAgICAgPSAvYS9nDQogICwgcmUyICAgICAgICAgICAgICAgPSAvYS9nDQogIC8vICJuZXciIGNyZWF0ZXMgYSBuZXcgb2JqZWN0LCBvbGQgd2Via2l0IGJ1Z2d5IGhlcmUNCiAgLCBDT1JSRUNUX05FVyAgICAgICA9IG5ldyAkUmVnRXhwKHJlMSkgIT09IHJlMTsNCg0KaWYocmVxdWlyZSgnLi9fZGVzY3JpcHRvcnMnKSAmJiAoIUNPUlJFQ1RfTkVXIHx8IHJlcXVpcmUoJy4vX2ZhaWxzJykoZnVuY3Rpb24oKXsNCiAgcmUyW3JlcXVpcmUoJy4vX3drcycpKCdtYXRjaCcpXSA9IGZhbHNlOw0KICAvLyBSZWdFeHAgY29uc3RydWN0b3IgY2FuIGFsdGVyIGZsYWdzIGFuZCBJc1JlZ0V4cCB3b3JrcyBjb3JyZWN0IHdpdGggQEBtYXRjaA0KICByZXR1cm4gJFJlZ0V4cChyZTEpICE9IHJlMSB8fCAkUmVnRXhwKHJlMikgPT0gcmUyIHx8ICRSZWdFeHAocmUxLCAnaScpICE9ICcvYS9pJzsNCn0pKSl7DQogICRSZWdFeHAgPSBmdW5jdGlvbiBSZWdFeHAocCwgZil7DQogICAgdmFyIHRpUkUgPSB0aGlzIGluc3RhbmNlb2YgJFJlZ0V4cA0KICAgICAgLCBwaVJFID0gaXNSZWdFeHAocCkNCiAgICAgICwgZmlVICA9IGYgPT09IHVuZGVmaW5lZDsNCiAgICByZXR1cm4gIXRpUkUgJiYgcGlSRSAmJiBwLmNvbnN0cnVjdG9yID09PSAkUmVnRXhwICYmIGZpVSA/IHANCiAgICAgIDogaW5oZXJpdElmUmVxdWlyZWQoQ09SUkVDVF9ORVcNCiAgICAgICAgPyBuZXcgQmFzZShwaVJFICYmICFmaVUgPyBwLnNvdXJjZSA6IHAsIGYpDQogICAgICAgIDogQmFzZSgocGlSRSA9IHAgaW5zdGFuY2VvZiAkUmVnRXhwKSA/IHAuc291cmNlIDogcCwgcGlSRSAmJiBmaVUgPyAkZmxhZ3MuY2FsbChwKSA6IGYpDQogICAgICAsIHRpUkUgPyB0aGlzIDogcHJvdG8sICRSZWdFeHApOw0KICB9Ow0KICB2YXIgcHJveHkgPSBmdW5jdGlvbihrZXkpew0KICAgIGtleSBpbiAkUmVnRXhwIHx8IGRQKCRSZWdFeHAsIGtleSwgew0KICAgICAgY29uZmlndXJhYmxlOiB0cnVlLA0KICAgICAgZ2V0OiBmdW5jdGlvbigpeyByZXR1cm4gQmFzZVtrZXldOyB9LA0KICAgICAgc2V0OiBmdW5jdGlvbihpdCl7IEJhc2Vba2V5XSA9IGl0OyB9DQogICAgfSk7DQogIH07DQogIGZvcih2YXIga2V5cyA9IGdPUE4oQmFzZSksIGkgPSAwOyBrZXlzLmxlbmd0aCA+IGk7IClwcm94eShrZXlzW2krK10pOw0KICBwcm90by5jb25zdHJ1Y3RvciA9ICRSZWdFeHA7DQogICRSZWdFeHAucHJvdG90eXBlID0gcHJvdG87DQogIHJlcXVpcmUoJy4vX3JlZGVmaW5lJykoZ2xvYmFsLCAnUmVnRXhwJywgJFJlZ0V4cCk7DQp9DQoNCnJlcXVpcmUoJy4vX3NldC1zcGVjaWVzJykoJ1JlZ0V4cCcpOw0KfSx7Ii4vX2Rlc2NyaXB0b3JzIjoyOCwiLi9fZmFpbHMiOjM0LCIuL19mbGFncyI6MzYsIi4vX2dsb2JhbCI6MzgsIi4vX2luaGVyaXQtaWYtcmVxdWlyZWQiOjQzLCIuL19pcy1yZWdleHAiOjUwLCIuL19vYmplY3QtZHAiOjY3LCIuL19vYmplY3QtZ29wbiI6NzIsIi4vX3JlZGVmaW5lIjo4NywiLi9fc2V0LXNwZWNpZXMiOjkxLCIuL193a3MiOjExN31dLDIxNTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQovLyAyMS4yLjUuMyBnZXQgUmVnRXhwLnByb3RvdHlwZS5mbGFncygpDQppZihyZXF1aXJlKCcuL19kZXNjcmlwdG9ycycpICYmIC8uL2cuZmxhZ3MgIT0gJ2cnKXJlcXVpcmUoJy4vX29iamVjdC1kcCcpLmYoUmVnRXhwLnByb3RvdHlwZSwgJ2ZsYWdzJywgew0KICBjb25maWd1cmFibGU6IHRydWUsDQogIGdldDogcmVxdWlyZSgnLi9fZmxhZ3MnKQ0KfSk7DQp9LHsiLi9fZGVzY3JpcHRvcnMiOjI4LCIuL19mbGFncyI6MzYsIi4vX29iamVjdC1kcCI6Njd9XSwyMTY6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KLy8gQEBtYXRjaCBsb2dpYw0KcmVxdWlyZSgnLi9fZml4LXJlLXdrcycpKCdtYXRjaCcsIDEsIGZ1bmN0aW9uKGRlZmluZWQsIE1BVENILCAkbWF0Y2gpew0KICAvLyAyMS4xLjMuMTEgU3RyaW5nLnByb3RvdHlwZS5tYXRjaChyZWdleHApDQogIHJldHVybiBbZnVuY3Rpb24gbWF0Y2gocmVnZXhwKXsNCiAgICAndXNlIHN0cmljdCc7DQogICAgdmFyIE8gID0gZGVmaW5lZCh0aGlzKQ0KICAgICAgLCBmbiA9IHJlZ2V4cCA9PSB1bmRlZmluZWQgPyB1bmRlZmluZWQgOiByZWdleHBbTUFUQ0hdOw0KICAgIHJldHVybiBmbiAhPT0gdW5kZWZpbmVkID8gZm4uY2FsbChyZWdleHAsIE8pIDogbmV3IFJlZ0V4cChyZWdleHApW01BVENIXShTdHJpbmcoTykpOw0KICB9LCAkbWF0Y2hdOw0KfSk7DQp9LHsiLi9fZml4LXJlLXdrcyI6MzV9XSwyMTc6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KLy8gQEByZXBsYWNlIGxvZ2ljDQpyZXF1aXJlKCcuL19maXgtcmUtd2tzJykoJ3JlcGxhY2UnLCAyLCBmdW5jdGlvbihkZWZpbmVkLCBSRVBMQUNFLCAkcmVwbGFjZSl7DQogIC8vIDIxLjEuMy4xNCBTdHJpbmcucHJvdG90eXBlLnJlcGxhY2Uoc2VhcmNoVmFsdWUsIHJlcGxhY2VWYWx1ZSkNCiAgcmV0dXJuIFtmdW5jdGlvbiByZXBsYWNlKHNlYXJjaFZhbHVlLCByZXBsYWNlVmFsdWUpew0KICAgICd1c2Ugc3RyaWN0JzsNCiAgICB2YXIgTyAgPSBkZWZpbmVkKHRoaXMpDQogICAgICAsIGZuID0gc2VhcmNoVmFsdWUgPT0gdW5kZWZpbmVkID8gdW5kZWZpbmVkIDogc2VhcmNoVmFsdWVbUkVQTEFDRV07DQogICAgcmV0dXJuIGZuICE9PSB1bmRlZmluZWQNCiAgICAgID8gZm4uY2FsbChzZWFyY2hWYWx1ZSwgTywgcmVwbGFjZVZhbHVlKQ0KICAgICAgOiAkcmVwbGFjZS5jYWxsKFN0cmluZyhPKSwgc2VhcmNoVmFsdWUsIHJlcGxhY2VWYWx1ZSk7DQogIH0sICRyZXBsYWNlXTsNCn0pOw0KfSx7Ii4vX2ZpeC1yZS13a3MiOjM1fV0sMjE4OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCi8vIEBAc2VhcmNoIGxvZ2ljDQpyZXF1aXJlKCcuL19maXgtcmUtd2tzJykoJ3NlYXJjaCcsIDEsIGZ1bmN0aW9uKGRlZmluZWQsIFNFQVJDSCwgJHNlYXJjaCl7DQogIC8vIDIxLjEuMy4xNSBTdHJpbmcucHJvdG90eXBlLnNlYXJjaChyZWdleHApDQogIHJldHVybiBbZnVuY3Rpb24gc2VhcmNoKHJlZ2V4cCl7DQogICAgJ3VzZSBzdHJpY3QnOw0KICAgIHZhciBPICA9IGRlZmluZWQodGhpcykNCiAgICAgICwgZm4gPSByZWdleHAgPT0gdW5kZWZpbmVkID8gdW5kZWZpbmVkIDogcmVnZXhwW1NFQVJDSF07DQogICAgcmV0dXJuIGZuICE9PSB1bmRlZmluZWQgPyBmbi5jYWxsKHJlZ2V4cCwgTykgOiBuZXcgUmVnRXhwKHJlZ2V4cClbU0VBUkNIXShTdHJpbmcoTykpOw0KICB9LCAkc2VhcmNoXTsNCn0pOw0KfSx7Ii4vX2ZpeC1yZS13a3MiOjM1fV0sMjE5OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCi8vIEBAc3BsaXQgbG9naWMNCnJlcXVpcmUoJy4vX2ZpeC1yZS13a3MnKSgnc3BsaXQnLCAyLCBmdW5jdGlvbihkZWZpbmVkLCBTUExJVCwgJHNwbGl0KXsNCiAgJ3VzZSBzdHJpY3QnOw0KICB2YXIgaXNSZWdFeHAgICA9IHJlcXVpcmUoJy4vX2lzLXJlZ2V4cCcpDQogICAgLCBfc3BsaXQgICAgID0gJHNwbGl0DQogICAgLCAkcHVzaCAgICAgID0gW10ucHVzaA0KICAgICwgJFNQTElUICAgICA9ICdzcGxpdCcNCiAgICAsIExFTkdUSCAgICAgPSAnbGVuZ3RoJw0KICAgICwgTEFTVF9JTkRFWCA9ICdsYXN0SW5kZXgnOw0KICBpZigNCiAgICAnYWJiYydbJFNQTElUXSgvKGIpKi8pWzFdID09ICdjJyB8fA0KICAgICd0ZXN0J1skU1BMSVRdKC8oPzopLywgLTEpW0xFTkdUSF0gIT0gNCB8fA0KICAgICdhYidbJFNQTElUXSgvKD86YWIpKi8pW0xFTkdUSF0gIT0gMiB8fA0KICAgICcuJ1skU1BMSVRdKC8oLj8pKC4/KS8pW0xFTkdUSF0gIT0gNCB8fA0KICAgICcuJ1skU1BMSVRdKC8oKSgpLylbTEVOR1RIXSA+IDEgfHwNCiAgICAnJ1skU1BMSVRdKC8uPy8pW0xFTkdUSF0NCiAgKXsNCiAgICB2YXIgTlBDRyA9IC8oKT8/Ly5leGVjKCcnKVsxXSA9PT0gdW5kZWZpbmVkOyAvLyBub25wYXJ0aWNpcGF0aW5nIGNhcHR1cmluZyBncm91cA0KICAgIC8vIGJhc2VkIG9uIGVzNS1zaGltIGltcGxlbWVudGF0aW9uLCBuZWVkIHRvIHJld29yayBpdA0KICAgICRzcGxpdCA9IGZ1bmN0aW9uKHNlcGFyYXRvciwgbGltaXQpew0KICAgICAgdmFyIHN0cmluZyA9IFN0cmluZyh0aGlzKTsNCiAgICAgIGlmKHNlcGFyYXRvciA9PT0gdW5kZWZpbmVkICYmIGxpbWl0ID09PSAwKXJldHVybiBbXTsNCiAgICAgIC8vIElmIGBzZXBhcmF0b3JgIGlzIG5vdCBhIHJlZ2V4LCB1c2UgbmF0aXZlIHNwbGl0DQogICAgICBpZighaXNSZWdFeHAoc2VwYXJhdG9yKSlyZXR1cm4gX3NwbGl0LmNhbGwoc3RyaW5nLCBzZXBhcmF0b3IsIGxpbWl0KTsNCiAgICAgIHZhciBvdXRwdXQgPSBbXTsNCiAgICAgIHZhciBmbGFncyA9IChzZXBhcmF0b3IuaWdub3JlQ2FzZSA/ICdpJyA6ICcnKSArDQogICAgICAgICAgICAgICAgICAoc2VwYXJhdG9yLm11bHRpbGluZSA/ICdtJyA6ICcnKSArDQogICAgICAgICAgICAgICAgICAoc2VwYXJhdG9yLnVuaWNvZGUgPyAndScgOiAnJykgKw0KICAgICAgICAgICAgICAgICAgKHNlcGFyYXRvci5zdGlja3kgPyAneScgOiAnJyk7DQogICAgICB2YXIgbGFzdExhc3RJbmRleCA9IDA7DQogICAgICB2YXIgc3BsaXRMaW1pdCA9IGxpbWl0ID09PSB1bmRlZmluZWQgPyA0Mjk0OTY3Mjk1IDogbGltaXQgPj4+IDA7DQogICAgICAvLyBNYWtlIGBnbG9iYWxgIGFuZCBhdm9pZCBgbGFzdEluZGV4YCBpc3N1ZXMgYnkgd29ya2luZyB3aXRoIGEgY29weQ0KICAgICAgdmFyIHNlcGFyYXRvckNvcHkgPSBuZXcgUmVnRXhwKHNlcGFyYXRvci5zb3VyY2UsIGZsYWdzICsgJ2cnKTsNCiAgICAgIHZhciBzZXBhcmF0b3IyLCBtYXRjaCwgbGFzdEluZGV4LCBsYXN0TGVuZ3RoLCBpOw0KICAgICAgLy8gRG9lc24ndCBuZWVkIGZsYWdzIGd5LCBidXQgdGhleSBkb24ndCBodXJ0DQogICAgICBpZighTlBDRylzZXBhcmF0b3IyID0gbmV3IFJlZ0V4cCgnXicgKyBzZXBhcmF0b3JDb3B5LnNvdXJjZSArICckKD8hXFxzKScsIGZsYWdzKTsNCiAgICAgIHdoaWxlKG1hdGNoID0gc2VwYXJhdG9yQ29weS5leGVjKHN0cmluZykpew0KICAgICAgICAvLyBgc2VwYXJhdG9yQ29weS5sYXN0SW5kZXhgIGlzIG5vdCByZWxpYWJsZSBjcm9zcy1icm93c2VyDQogICAgICAgIGxhc3RJbmRleCA9IG1hdGNoLmluZGV4ICsgbWF0Y2hbMF1bTEVOR1RIXTsNCiAgICAgICAgaWYobGFzdEluZGV4ID4gbGFzdExhc3RJbmRleCl7DQogICAgICAgICAgb3V0cHV0LnB1c2goc3RyaW5nLnNsaWNlKGxhc3RMYXN0SW5kZXgsIG1hdGNoLmluZGV4KSk7DQogICAgICAgICAgLy8gRml4IGJyb3dzZXJzIHdob3NlIGBleGVjYCBtZXRob2RzIGRvbid0IGNvbnNpc3RlbnRseSByZXR1cm4gYHVuZGVmaW5lZGAgZm9yIE5QQ0cNCiAgICAgICAgICBpZighTlBDRyAmJiBtYXRjaFtMRU5HVEhdID4gMSltYXRjaFswXS5yZXBsYWNlKHNlcGFyYXRvcjIsIGZ1bmN0aW9uKCl7DQogICAgICAgICAgICBmb3IoaSA9IDE7IGkgPCBhcmd1bWVudHNbTEVOR1RIXSAtIDI7IGkrKylpZihhcmd1bWVudHNbaV0gPT09IHVuZGVmaW5lZCltYXRjaFtpXSA9IHVuZGVmaW5lZDsNCiAgICAgICAgICB9KTsNCiAgICAgICAgICBpZihtYXRjaFtMRU5HVEhdID4gMSAmJiBtYXRjaC5pbmRleCA8IHN0cmluZ1tMRU5HVEhdKSRwdXNoLmFwcGx5KG91dHB1dCwgbWF0Y2guc2xpY2UoMSkpOw0KICAgICAgICAgIGxhc3RMZW5ndGggPSBtYXRjaFswXVtMRU5HVEhdOw0KICAgICAgICAgIGxhc3RMYXN0SW5kZXggPSBsYXN0SW5kZXg7DQogICAgICAgICAgaWYob3V0cHV0W0xFTkdUSF0gPj0gc3BsaXRMaW1pdClicmVhazsNCiAgICAgICAgfQ0KICAgICAgICBpZihzZXBhcmF0b3JDb3B5W0xBU1RfSU5ERVhdID09PSBtYXRjaC5pbmRleClzZXBhcmF0b3JDb3B5W0xBU1RfSU5ERVhdKys7IC8vIEF2b2lkIGFuIGluZmluaXRlIGxvb3ANCiAgICAgIH0NCiAgICAgIGlmKGxhc3RMYXN0SW5kZXggPT09IHN0cmluZ1tMRU5HVEhdKXsNCiAgICAgICAgaWYobGFzdExlbmd0aCB8fCAhc2VwYXJhdG9yQ29weS50ZXN0KCcnKSlvdXRwdXQucHVzaCgnJyk7DQogICAgICB9IGVsc2Ugb3V0cHV0LnB1c2goc3RyaW5nLnNsaWNlKGxhc3RMYXN0SW5kZXgpKTsNCiAgICAgIHJldHVybiBvdXRwdXRbTEVOR1RIXSA+IHNwbGl0TGltaXQgPyBvdXRwdXQuc2xpY2UoMCwgc3BsaXRMaW1pdCkgOiBvdXRwdXQ7DQogICAgfTsNCiAgLy8gQ2hha3JhLCBWOA0KICB9IGVsc2UgaWYoJzAnWyRTUExJVF0odW5kZWZpbmVkLCAwKVtMRU5HVEhdKXsNCiAgICAkc3BsaXQgPSBmdW5jdGlvbihzZXBhcmF0b3IsIGxpbWl0KXsNCiAgICAgIHJldHVybiBzZXBhcmF0b3IgPT09IHVuZGVmaW5lZCAmJiBsaW1pdCA9PT0gMCA/IFtdIDogX3NwbGl0LmNhbGwodGhpcywgc2VwYXJhdG9yLCBsaW1pdCk7DQogICAgfTsNCiAgfQ0KICAvLyAyMS4xLjMuMTcgU3RyaW5nLnByb3RvdHlwZS5zcGxpdChzZXBhcmF0b3IsIGxpbWl0KQ0KICByZXR1cm4gW2Z1bmN0aW9uIHNwbGl0KHNlcGFyYXRvciwgbGltaXQpew0KICAgIHZhciBPICA9IGRlZmluZWQodGhpcykNCiAgICAgICwgZm4gPSBzZXBhcmF0b3IgPT0gdW5kZWZpbmVkID8gdW5kZWZpbmVkIDogc2VwYXJhdG9yW1NQTElUXTsNCiAgICByZXR1cm4gZm4gIT09IHVuZGVmaW5lZCA/IGZuLmNhbGwoc2VwYXJhdG9yLCBPLCBsaW1pdCkgOiAkc3BsaXQuY2FsbChTdHJpbmcoTyksIHNlcGFyYXRvciwgbGltaXQpOw0KICB9LCAkc3BsaXRdOw0KfSk7DQp9LHsiLi9fZml4LXJlLXdrcyI6MzUsIi4vX2lzLXJlZ2V4cCI6NTB9XSwyMjA6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KJ3VzZSBzdHJpY3QnOw0KcmVxdWlyZSgnLi9lczYucmVnZXhwLmZsYWdzJyk7DQp2YXIgYW5PYmplY3QgICAgPSByZXF1aXJlKCcuL19hbi1vYmplY3QnKQ0KICAsICRmbGFncyAgICAgID0gcmVxdWlyZSgnLi9fZmxhZ3MnKQ0KICAsIERFU0NSSVBUT1JTID0gcmVxdWlyZSgnLi9fZGVzY3JpcHRvcnMnKQ0KICAsIFRPX1NUUklORyAgID0gJ3RvU3RyaW5nJw0KICAsICR0b1N0cmluZyAgID0gLy4vW1RPX1NUUklOR107DQoNCnZhciBkZWZpbmUgPSBmdW5jdGlvbihmbil7DQogIHJlcXVpcmUoJy4vX3JlZGVmaW5lJykoUmVnRXhwLnByb3RvdHlwZSwgVE9fU1RSSU5HLCBmbiwgdHJ1ZSk7DQp9Ow0KDQovLyAyMS4yLjUuMTQgUmVnRXhwLnByb3RvdHlwZS50b1N0cmluZygpDQppZihyZXF1aXJlKCcuL19mYWlscycpKGZ1bmN0aW9uKCl7IHJldHVybiAkdG9TdHJpbmcuY2FsbCh7c291cmNlOiAnYScsIGZsYWdzOiAnYid9KSAhPSAnL2EvYic7IH0pKXsNCiAgZGVmaW5lKGZ1bmN0aW9uIHRvU3RyaW5nKCl7DQogICAgdmFyIFIgPSBhbk9iamVjdCh0aGlzKTsNCiAgICByZXR1cm4gJy8nLmNvbmNhdChSLnNvdXJjZSwgJy8nLA0KICAgICAgJ2ZsYWdzJyBpbiBSID8gUi5mbGFncyA6ICFERVNDUklQVE9SUyAmJiBSIGluc3RhbmNlb2YgUmVnRXhwID8gJGZsYWdzLmNhbGwoUikgOiB1bmRlZmluZWQpOw0KICB9KTsNCi8vIEZGNDQtIFJlZ0V4cCN0b1N0cmluZyBoYXMgYSB3cm9uZyBuYW1lDQp9IGVsc2UgaWYoJHRvU3RyaW5nLm5hbWUgIT0gVE9fU1RSSU5HKXsNCiAgZGVmaW5lKGZ1bmN0aW9uIHRvU3RyaW5nKCl7DQogICAgcmV0dXJuICR0b1N0cmluZy5jYWxsKHRoaXMpOw0KICB9KTsNCn0NCn0seyIuL19hbi1vYmplY3QiOjcsIi4vX2Rlc2NyaXB0b3JzIjoyOCwiLi9fZmFpbHMiOjM0LCIuL19mbGFncyI6MzYsIi4vX3JlZGVmaW5lIjo4NywiLi9lczYucmVnZXhwLmZsYWdzIjoyMTV9XSwyMjE6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KJ3VzZSBzdHJpY3QnOw0KdmFyIHN0cm9uZyA9IHJlcXVpcmUoJy4vX2NvbGxlY3Rpb24tc3Ryb25nJyk7DQoNCi8vIDIzLjIgU2V0IE9iamVjdHMNCm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZSgnLi9fY29sbGVjdGlvbicpKCdTZXQnLCBmdW5jdGlvbihnZXQpew0KICByZXR1cm4gZnVuY3Rpb24gU2V0KCl7IHJldHVybiBnZXQodGhpcywgYXJndW1lbnRzLmxlbmd0aCA+IDAgPyBhcmd1bWVudHNbMF0gOiB1bmRlZmluZWQpOyB9Ow0KfSwgew0KICAvLyAyMy4yLjMuMSBTZXQucHJvdG90eXBlLmFkZCh2YWx1ZSkNCiAgYWRkOiBmdW5jdGlvbiBhZGQodmFsdWUpew0KICAgIHJldHVybiBzdHJvbmcuZGVmKHRoaXMsIHZhbHVlID0gdmFsdWUgPT09IDAgPyAwIDogdmFsdWUsIHZhbHVlKTsNCiAgfQ0KfSwgc3Ryb25nKTsNCn0seyIuL19jb2xsZWN0aW9uIjoyMiwiLi9fY29sbGVjdGlvbi1zdHJvbmciOjE5fV0sMjIyOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCid1c2Ugc3RyaWN0JzsNCi8vIEIuMi4zLjIgU3RyaW5nLnByb3RvdHlwZS5hbmNob3IobmFtZSkNCnJlcXVpcmUoJy4vX3N0cmluZy1odG1sJykoJ2FuY2hvcicsIGZ1bmN0aW9uKGNyZWF0ZUhUTUwpew0KICByZXR1cm4gZnVuY3Rpb24gYW5jaG9yKG5hbWUpew0KICAgIHJldHVybiBjcmVhdGVIVE1MKHRoaXMsICdhJywgJ25hbWUnLCBuYW1lKTsNCiAgfQ0KfSk7DQp9LHsiLi9fc3RyaW5nLWh0bWwiOjk5fV0sMjIzOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCid1c2Ugc3RyaWN0JzsNCi8vIEIuMi4zLjMgU3RyaW5nLnByb3RvdHlwZS5iaWcoKQ0KcmVxdWlyZSgnLi9fc3RyaW5nLWh0bWwnKSgnYmlnJywgZnVuY3Rpb24oY3JlYXRlSFRNTCl7DQogIHJldHVybiBmdW5jdGlvbiBiaWcoKXsNCiAgICByZXR1cm4gY3JlYXRlSFRNTCh0aGlzLCAnYmlnJywgJycsICcnKTsNCiAgfQ0KfSk7DQp9LHsiLi9fc3RyaW5nLWh0bWwiOjk5fV0sMjI0OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCid1c2Ugc3RyaWN0JzsNCi8vIEIuMi4zLjQgU3RyaW5nLnByb3RvdHlwZS5ibGluaygpDQpyZXF1aXJlKCcuL19zdHJpbmctaHRtbCcpKCdibGluaycsIGZ1bmN0aW9uKGNyZWF0ZUhUTUwpew0KICByZXR1cm4gZnVuY3Rpb24gYmxpbmsoKXsNCiAgICByZXR1cm4gY3JlYXRlSFRNTCh0aGlzLCAnYmxpbmsnLCAnJywgJycpOw0KICB9DQp9KTsNCn0seyIuL19zdHJpbmctaHRtbCI6OTl9XSwyMjU6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KJ3VzZSBzdHJpY3QnOw0KLy8gQi4yLjMuNSBTdHJpbmcucHJvdG90eXBlLmJvbGQoKQ0KcmVxdWlyZSgnLi9fc3RyaW5nLWh0bWwnKSgnYm9sZCcsIGZ1bmN0aW9uKGNyZWF0ZUhUTUwpew0KICByZXR1cm4gZnVuY3Rpb24gYm9sZCgpew0KICAgIHJldHVybiBjcmVhdGVIVE1MKHRoaXMsICdiJywgJycsICcnKTsNCiAgfQ0KfSk7DQp9LHsiLi9fc3RyaW5nLWh0bWwiOjk5fV0sMjI2OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCid1c2Ugc3RyaWN0JzsNCnZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0JykNCiAgLCAkYXQgICAgID0gcmVxdWlyZSgnLi9fc3RyaW5nLWF0JykoZmFsc2UpOw0KJGV4cG9ydCgkZXhwb3J0LlAsICdTdHJpbmcnLCB7DQogIC8vIDIxLjEuMy4zIFN0cmluZy5wcm90b3R5cGUuY29kZVBvaW50QXQocG9zKQ0KICBjb2RlUG9pbnRBdDogZnVuY3Rpb24gY29kZVBvaW50QXQocG9zKXsNCiAgICByZXR1cm4gJGF0KHRoaXMsIHBvcyk7DQogIH0NCn0pOw0KfSx7Ii4vX2V4cG9ydCI6MzIsIi4vX3N0cmluZy1hdCI6OTd9XSwyMjc6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KLy8gMjEuMS4zLjYgU3RyaW5nLnByb3RvdHlwZS5lbmRzV2l0aChzZWFyY2hTdHJpbmcgWywgZW5kUG9zaXRpb25dKQ0KJ3VzZSBzdHJpY3QnOw0KdmFyICRleHBvcnQgICA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpDQogICwgdG9MZW5ndGggID0gcmVxdWlyZSgnLi9fdG8tbGVuZ3RoJykNCiAgLCBjb250ZXh0ICAgPSByZXF1aXJlKCcuL19zdHJpbmctY29udGV4dCcpDQogICwgRU5EU19XSVRIID0gJ2VuZHNXaXRoJw0KICAsICRlbmRzV2l0aCA9ICcnW0VORFNfV0lUSF07DQoNCiRleHBvcnQoJGV4cG9ydC5QICsgJGV4cG9ydC5GICogcmVxdWlyZSgnLi9fZmFpbHMtaXMtcmVnZXhwJykoRU5EU19XSVRIKSwgJ1N0cmluZycsIHsNCiAgZW5kc1dpdGg6IGZ1bmN0aW9uIGVuZHNXaXRoKHNlYXJjaFN0cmluZyAvKiwgZW5kUG9zaXRpb24gPSBAbGVuZ3RoICovKXsNCiAgICB2YXIgdGhhdCA9IGNvbnRleHQodGhpcywgc2VhcmNoU3RyaW5nLCBFTkRTX1dJVEgpDQogICAgICAsIGVuZFBvc2l0aW9uID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgPyBhcmd1bWVudHNbMV0gOiB1bmRlZmluZWQNCiAgICAgICwgbGVuICAgID0gdG9MZW5ndGgodGhhdC5sZW5ndGgpDQogICAgICAsIGVuZCAgICA9IGVuZFBvc2l0aW9uID09PSB1bmRlZmluZWQgPyBsZW4gOiBNYXRoLm1pbih0b0xlbmd0aChlbmRQb3NpdGlvbiksIGxlbikNCiAgICAgICwgc2VhcmNoID0gU3RyaW5nKHNlYXJjaFN0cmluZyk7DQogICAgcmV0dXJuICRlbmRzV2l0aA0KICAgICAgPyAkZW5kc1dpdGguY2FsbCh0aGF0LCBzZWFyY2gsIGVuZCkNCiAgICAgIDogdGhhdC5zbGljZShlbmQgLSBzZWFyY2gubGVuZ3RoLCBlbmQpID09PSBzZWFyY2g7DQogIH0NCn0pOw0KfSx7Ii4vX2V4cG9ydCI6MzIsIi4vX2ZhaWxzLWlzLXJlZ2V4cCI6MzMsIi4vX3N0cmluZy1jb250ZXh0Ijo5OCwiLi9fdG8tbGVuZ3RoIjoxMDh9XSwyMjg6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KJ3VzZSBzdHJpY3QnOw0KLy8gQi4yLjMuNiBTdHJpbmcucHJvdG90eXBlLmZpeGVkKCkNCnJlcXVpcmUoJy4vX3N0cmluZy1odG1sJykoJ2ZpeGVkJywgZnVuY3Rpb24oY3JlYXRlSFRNTCl7DQogIHJldHVybiBmdW5jdGlvbiBmaXhlZCgpew0KICAgIHJldHVybiBjcmVhdGVIVE1MKHRoaXMsICd0dCcsICcnLCAnJyk7DQogIH0NCn0pOw0KfSx7Ii4vX3N0cmluZy1odG1sIjo5OX1dLDIyOTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQondXNlIHN0cmljdCc7DQovLyBCLjIuMy43IFN0cmluZy5wcm90b3R5cGUuZm9udGNvbG9yKGNvbG9yKQ0KcmVxdWlyZSgnLi9fc3RyaW5nLWh0bWwnKSgnZm9udGNvbG9yJywgZnVuY3Rpb24oY3JlYXRlSFRNTCl7DQogIHJldHVybiBmdW5jdGlvbiBmb250Y29sb3IoY29sb3Ipew0KICAgIHJldHVybiBjcmVhdGVIVE1MKHRoaXMsICdmb250JywgJ2NvbG9yJywgY29sb3IpOw0KICB9DQp9KTsNCn0seyIuL19zdHJpbmctaHRtbCI6OTl9XSwyMzA6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KJ3VzZSBzdHJpY3QnOw0KLy8gQi4yLjMuOCBTdHJpbmcucHJvdG90eXBlLmZvbnRzaXplKHNpemUpDQpyZXF1aXJlKCcuL19zdHJpbmctaHRtbCcpKCdmb250c2l6ZScsIGZ1bmN0aW9uKGNyZWF0ZUhUTUwpew0KICByZXR1cm4gZnVuY3Rpb24gZm9udHNpemUoc2l6ZSl7DQogICAgcmV0dXJuIGNyZWF0ZUhUTUwodGhpcywgJ2ZvbnQnLCAnc2l6ZScsIHNpemUpOw0KICB9DQp9KTsNCn0seyIuL19zdHJpbmctaHRtbCI6OTl9XSwyMzE6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KdmFyICRleHBvcnQgICAgICAgID0gcmVxdWlyZSgnLi9fZXhwb3J0JykNCiAgLCB0b0luZGV4ICAgICAgICA9IHJlcXVpcmUoJy4vX3RvLWluZGV4JykNCiAgLCBmcm9tQ2hhckNvZGUgICA9IFN0cmluZy5mcm9tQ2hhckNvZGUNCiAgLCAkZnJvbUNvZGVQb2ludCA9IFN0cmluZy5mcm9tQ29kZVBvaW50Ow0KDQovLyBsZW5ndGggc2hvdWxkIGJlIDEsIG9sZCBGRiBwcm9ibGVtDQokZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqICghISRmcm9tQ29kZVBvaW50ICYmICRmcm9tQ29kZVBvaW50Lmxlbmd0aCAhPSAxKSwgJ1N0cmluZycsIHsNCiAgLy8gMjEuMS4yLjIgU3RyaW5nLmZyb21Db2RlUG9pbnQoLi4uY29kZVBvaW50cykNCiAgZnJvbUNvZGVQb2ludDogZnVuY3Rpb24gZnJvbUNvZGVQb2ludCh4KXsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby11bnVzZWQtdmFycw0KICAgIHZhciByZXMgID0gW10NCiAgICAgICwgYUxlbiA9IGFyZ3VtZW50cy5sZW5ndGgNCiAgICAgICwgaSAgICA9IDANCiAgICAgICwgY29kZTsNCiAgICB3aGlsZShhTGVuID4gaSl7DQogICAgICBjb2RlID0gK2FyZ3VtZW50c1tpKytdOw0KICAgICAgaWYodG9JbmRleChjb2RlLCAweDEwZmZmZikgIT09IGNvZGUpdGhyb3cgUmFuZ2VFcnJvcihjb2RlICsgJyBpcyBub3QgYSB2YWxpZCBjb2RlIHBvaW50Jyk7DQogICAgICByZXMucHVzaChjb2RlIDwgMHgxMDAwMA0KICAgICAgICA/IGZyb21DaGFyQ29kZShjb2RlKQ0KICAgICAgICA6IGZyb21DaGFyQ29kZSgoKGNvZGUgLT0gMHgxMDAwMCkgPj4gMTApICsgMHhkODAwLCBjb2RlICUgMHg0MDAgKyAweGRjMDApDQogICAgICApOw0KICAgIH0gcmV0dXJuIHJlcy5qb2luKCcnKTsNCiAgfQ0KfSk7DQp9LHsiLi9fZXhwb3J0IjozMiwiLi9fdG8taW5kZXgiOjEwNX1dLDIzMjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQovLyAyMS4xLjMuNyBTdHJpbmcucHJvdG90eXBlLmluY2x1ZGVzKHNlYXJjaFN0cmluZywgcG9zaXRpb24gPSAwKQ0KJ3VzZSBzdHJpY3QnOw0KdmFyICRleHBvcnQgID0gcmVxdWlyZSgnLi9fZXhwb3J0JykNCiAgLCBjb250ZXh0ICA9IHJlcXVpcmUoJy4vX3N0cmluZy1jb250ZXh0JykNCiAgLCBJTkNMVURFUyA9ICdpbmNsdWRlcyc7DQoNCiRleHBvcnQoJGV4cG9ydC5QICsgJGV4cG9ydC5GICogcmVxdWlyZSgnLi9fZmFpbHMtaXMtcmVnZXhwJykoSU5DTFVERVMpLCAnU3RyaW5nJywgew0KICBpbmNsdWRlczogZnVuY3Rpb24gaW5jbHVkZXMoc2VhcmNoU3RyaW5nIC8qLCBwb3NpdGlvbiA9IDAgKi8pew0KICAgIHJldHVybiAhIX5jb250ZXh0KHRoaXMsIHNlYXJjaFN0cmluZywgSU5DTFVERVMpDQogICAgICAuaW5kZXhPZihzZWFyY2hTdHJpbmcsIGFyZ3VtZW50cy5sZW5ndGggPiAxID8gYXJndW1lbnRzWzFdIDogdW5kZWZpbmVkKTsNCiAgfQ0KfSk7DQp9LHsiLi9fZXhwb3J0IjozMiwiLi9fZmFpbHMtaXMtcmVnZXhwIjozMywiLi9fc3RyaW5nLWNvbnRleHQiOjk4fV0sMjMzOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCid1c2Ugc3RyaWN0JzsNCi8vIEIuMi4zLjkgU3RyaW5nLnByb3RvdHlwZS5pdGFsaWNzKCkNCnJlcXVpcmUoJy4vX3N0cmluZy1odG1sJykoJ2l0YWxpY3MnLCBmdW5jdGlvbihjcmVhdGVIVE1MKXsNCiAgcmV0dXJuIGZ1bmN0aW9uIGl0YWxpY3MoKXsNCiAgICByZXR1cm4gY3JlYXRlSFRNTCh0aGlzLCAnaScsICcnLCAnJyk7DQogIH0NCn0pOw0KfSx7Ii4vX3N0cmluZy1odG1sIjo5OX1dLDIzNDpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQondXNlIHN0cmljdCc7DQp2YXIgJGF0ICA9IHJlcXVpcmUoJy4vX3N0cmluZy1hdCcpKHRydWUpOw0KDQovLyAyMS4xLjMuMjcgU3RyaW5nLnByb3RvdHlwZVtAQGl0ZXJhdG9yXSgpDQpyZXF1aXJlKCcuL19pdGVyLWRlZmluZScpKFN0cmluZywgJ1N0cmluZycsIGZ1bmN0aW9uKGl0ZXJhdGVkKXsNCiAgdGhpcy5fdCA9IFN0cmluZyhpdGVyYXRlZCk7IC8vIHRhcmdldA0KICB0aGlzLl9pID0gMDsgICAgICAgICAgICAgICAgLy8gbmV4dCBpbmRleA0KLy8gMjEuMS41LjIuMSAlU3RyaW5nSXRlcmF0b3JQcm90b3R5cGUlLm5leHQoKQ0KfSwgZnVuY3Rpb24oKXsNCiAgdmFyIE8gICAgID0gdGhpcy5fdA0KICAgICwgaW5kZXggPSB0aGlzLl9pDQogICAgLCBwb2ludDsNCiAgaWYoaW5kZXggPj0gTy5sZW5ndGgpcmV0dXJuIHt2YWx1ZTogdW5kZWZpbmVkLCBkb25lOiB0cnVlfTsNCiAgcG9pbnQgPSAkYXQoTywgaW5kZXgpOw0KICB0aGlzLl9pICs9IHBvaW50Lmxlbmd0aDsNCiAgcmV0dXJuIHt2YWx1ZTogcG9pbnQsIGRvbmU6IGZhbHNlfTsNCn0pOw0KfSx7Ii4vX2l0ZXItZGVmaW5lIjo1MywiLi9fc3RyaW5nLWF0Ijo5N31dLDIzNTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQondXNlIHN0cmljdCc7DQovLyBCLjIuMy4xMCBTdHJpbmcucHJvdG90eXBlLmxpbmsodXJsKQ0KcmVxdWlyZSgnLi9fc3RyaW5nLWh0bWwnKSgnbGluaycsIGZ1bmN0aW9uKGNyZWF0ZUhUTUwpew0KICByZXR1cm4gZnVuY3Rpb24gbGluayh1cmwpew0KICAgIHJldHVybiBjcmVhdGVIVE1MKHRoaXMsICdhJywgJ2hyZWYnLCB1cmwpOw0KICB9DQp9KTsNCn0seyIuL19zdHJpbmctaHRtbCI6OTl9XSwyMzY6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KdmFyICRleHBvcnQgICA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpDQogICwgdG9JT2JqZWN0ID0gcmVxdWlyZSgnLi9fdG8taW9iamVjdCcpDQogICwgdG9MZW5ndGggID0gcmVxdWlyZSgnLi9fdG8tbGVuZ3RoJyk7DQoNCiRleHBvcnQoJGV4cG9ydC5TLCAnU3RyaW5nJywgew0KICAvLyAyMS4xLjIuNCBTdHJpbmcucmF3KGNhbGxTaXRlLCAuLi5zdWJzdGl0dXRpb25zKQ0KICByYXc6IGZ1bmN0aW9uIHJhdyhjYWxsU2l0ZSl7DQogICAgdmFyIHRwbCAgPSB0b0lPYmplY3QoY2FsbFNpdGUucmF3KQ0KICAgICAgLCBsZW4gID0gdG9MZW5ndGgodHBsLmxlbmd0aCkNCiAgICAgICwgYUxlbiA9IGFyZ3VtZW50cy5sZW5ndGgNCiAgICAgICwgcmVzICA9IFtdDQogICAgICAsIGkgICAgPSAwOw0KICAgIHdoaWxlKGxlbiA+IGkpew0KICAgICAgcmVzLnB1c2goU3RyaW5nKHRwbFtpKytdKSk7DQogICAgICBpZihpIDwgYUxlbilyZXMucHVzaChTdHJpbmcoYXJndW1lbnRzW2ldKSk7DQogICAgfSByZXR1cm4gcmVzLmpvaW4oJycpOw0KICB9DQp9KTsNCn0seyIuL19leHBvcnQiOjMyLCIuL190by1pb2JqZWN0IjoxMDcsIi4vX3RvLWxlbmd0aCI6MTA4fV0sMjM3OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCnZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0Jyk7DQoNCiRleHBvcnQoJGV4cG9ydC5QLCAnU3RyaW5nJywgew0KICAvLyAyMS4xLjMuMTMgU3RyaW5nLnByb3RvdHlwZS5yZXBlYXQoY291bnQpDQogIHJlcGVhdDogcmVxdWlyZSgnLi9fc3RyaW5nLXJlcGVhdCcpDQp9KTsNCn0seyIuL19leHBvcnQiOjMyLCIuL19zdHJpbmctcmVwZWF0IjoxMDF9XSwyMzg6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KJ3VzZSBzdHJpY3QnOw0KLy8gQi4yLjMuMTEgU3RyaW5nLnByb3RvdHlwZS5zbWFsbCgpDQpyZXF1aXJlKCcuL19zdHJpbmctaHRtbCcpKCdzbWFsbCcsIGZ1bmN0aW9uKGNyZWF0ZUhUTUwpew0KICByZXR1cm4gZnVuY3Rpb24gc21hbGwoKXsNCiAgICByZXR1cm4gY3JlYXRlSFRNTCh0aGlzLCAnc21hbGwnLCAnJywgJycpOw0KICB9DQp9KTsNCn0seyIuL19zdHJpbmctaHRtbCI6OTl9XSwyMzk6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KLy8gMjEuMS4zLjE4IFN0cmluZy5wcm90b3R5cGUuc3RhcnRzV2l0aChzZWFyY2hTdHJpbmcgWywgcG9zaXRpb24gXSkNCid1c2Ugc3RyaWN0JzsNCnZhciAkZXhwb3J0ICAgICA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpDQogICwgdG9MZW5ndGggICAgPSByZXF1aXJlKCcuL190by1sZW5ndGgnKQ0KICAsIGNvbnRleHQgICAgID0gcmVxdWlyZSgnLi9fc3RyaW5nLWNvbnRleHQnKQ0KICAsIFNUQVJUU19XSVRIID0gJ3N0YXJ0c1dpdGgnDQogICwgJHN0YXJ0c1dpdGggPSAnJ1tTVEFSVFNfV0lUSF07DQoNCiRleHBvcnQoJGV4cG9ydC5QICsgJGV4cG9ydC5GICogcmVxdWlyZSgnLi9fZmFpbHMtaXMtcmVnZXhwJykoU1RBUlRTX1dJVEgpLCAnU3RyaW5nJywgew0KICBzdGFydHNXaXRoOiBmdW5jdGlvbiBzdGFydHNXaXRoKHNlYXJjaFN0cmluZyAvKiwgcG9zaXRpb24gPSAwICovKXsNCiAgICB2YXIgdGhhdCAgID0gY29udGV4dCh0aGlzLCBzZWFyY2hTdHJpbmcsIFNUQVJUU19XSVRIKQ0KICAgICAgLCBpbmRleCAgPSB0b0xlbmd0aChNYXRoLm1pbihhcmd1bWVudHMubGVuZ3RoID4gMSA/IGFyZ3VtZW50c1sxXSA6IHVuZGVmaW5lZCwgdGhhdC5sZW5ndGgpKQ0KICAgICAgLCBzZWFyY2ggPSBTdHJpbmcoc2VhcmNoU3RyaW5nKTsNCiAgICByZXR1cm4gJHN0YXJ0c1dpdGgNCiAgICAgID8gJHN0YXJ0c1dpdGguY2FsbCh0aGF0LCBzZWFyY2gsIGluZGV4KQ0KICAgICAgOiB0aGF0LnNsaWNlKGluZGV4LCBpbmRleCArIHNlYXJjaC5sZW5ndGgpID09PSBzZWFyY2g7DQogIH0NCn0pOw0KfSx7Ii4vX2V4cG9ydCI6MzIsIi4vX2ZhaWxzLWlzLXJlZ2V4cCI6MzMsIi4vX3N0cmluZy1jb250ZXh0Ijo5OCwiLi9fdG8tbGVuZ3RoIjoxMDh9XSwyNDA6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KJ3VzZSBzdHJpY3QnOw0KLy8gQi4yLjMuMTIgU3RyaW5nLnByb3RvdHlwZS5zdHJpa2UoKQ0KcmVxdWlyZSgnLi9fc3RyaW5nLWh0bWwnKSgnc3RyaWtlJywgZnVuY3Rpb24oY3JlYXRlSFRNTCl7DQogIHJldHVybiBmdW5jdGlvbiBzdHJpa2UoKXsNCiAgICByZXR1cm4gY3JlYXRlSFRNTCh0aGlzLCAnc3RyaWtlJywgJycsICcnKTsNCiAgfQ0KfSk7DQp9LHsiLi9fc3RyaW5nLWh0bWwiOjk5fV0sMjQxOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCid1c2Ugc3RyaWN0JzsNCi8vIEIuMi4zLjEzIFN0cmluZy5wcm90b3R5cGUuc3ViKCkNCnJlcXVpcmUoJy4vX3N0cmluZy1odG1sJykoJ3N1YicsIGZ1bmN0aW9uKGNyZWF0ZUhUTUwpew0KICByZXR1cm4gZnVuY3Rpb24gc3ViKCl7DQogICAgcmV0dXJuIGNyZWF0ZUhUTUwodGhpcywgJ3N1YicsICcnLCAnJyk7DQogIH0NCn0pOw0KfSx7Ii4vX3N0cmluZy1odG1sIjo5OX1dLDI0MjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQondXNlIHN0cmljdCc7DQovLyBCLjIuMy4xNCBTdHJpbmcucHJvdG90eXBlLnN1cCgpDQpyZXF1aXJlKCcuL19zdHJpbmctaHRtbCcpKCdzdXAnLCBmdW5jdGlvbihjcmVhdGVIVE1MKXsNCiAgcmV0dXJuIGZ1bmN0aW9uIHN1cCgpew0KICAgIHJldHVybiBjcmVhdGVIVE1MKHRoaXMsICdzdXAnLCAnJywgJycpOw0KICB9DQp9KTsNCn0seyIuL19zdHJpbmctaHRtbCI6OTl9XSwyNDM6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KJ3VzZSBzdHJpY3QnOw0KLy8gMjEuMS4zLjI1IFN0cmluZy5wcm90b3R5cGUudHJpbSgpDQpyZXF1aXJlKCcuL19zdHJpbmctdHJpbScpKCd0cmltJywgZnVuY3Rpb24oJHRyaW0pew0KICByZXR1cm4gZnVuY3Rpb24gdHJpbSgpew0KICAgIHJldHVybiAkdHJpbSh0aGlzLCAzKTsNCiAgfTsNCn0pOw0KfSx7Ii4vX3N0cmluZy10cmltIjoxMDJ9XSwyNDQ6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KJ3VzZSBzdHJpY3QnOw0KLy8gRUNNQVNjcmlwdCA2IHN5bWJvbHMgc2hpbQ0KdmFyIGdsb2JhbCAgICAgICAgID0gcmVxdWlyZSgnLi9fZ2xvYmFsJykNCiAgLCBoYXMgICAgICAgICAgICA9IHJlcXVpcmUoJy4vX2hhcycpDQogICwgREVTQ1JJUFRPUlMgICAgPSByZXF1aXJlKCcuL19kZXNjcmlwdG9ycycpDQogICwgJGV4cG9ydCAgICAgICAgPSByZXF1aXJlKCcuL19leHBvcnQnKQ0KICAsIHJlZGVmaW5lICAgICAgID0gcmVxdWlyZSgnLi9fcmVkZWZpbmUnKQ0KICAsIE1FVEEgICAgICAgICAgID0gcmVxdWlyZSgnLi9fbWV0YScpLktFWQ0KICAsICRmYWlscyAgICAgICAgID0gcmVxdWlyZSgnLi9fZmFpbHMnKQ0KICAsIHNoYXJlZCAgICAgICAgID0gcmVxdWlyZSgnLi9fc2hhcmVkJykNCiAgLCBzZXRUb1N0cmluZ1RhZyA9IHJlcXVpcmUoJy4vX3NldC10by1zdHJpbmctdGFnJykNCiAgLCB1aWQgICAgICAgICAgICA9IHJlcXVpcmUoJy4vX3VpZCcpDQogICwgd2tzICAgICAgICAgICAgPSByZXF1aXJlKCcuL193a3MnKQ0KICAsIHdrc0V4dCAgICAgICAgID0gcmVxdWlyZSgnLi9fd2tzLWV4dCcpDQogICwgd2tzRGVmaW5lICAgICAgPSByZXF1aXJlKCcuL193a3MtZGVmaW5lJykNCiAgLCBrZXlPZiAgICAgICAgICA9IHJlcXVpcmUoJy4vX2tleW9mJykNCiAgLCBlbnVtS2V5cyAgICAgICA9IHJlcXVpcmUoJy4vX2VudW0ta2V5cycpDQogICwgaXNBcnJheSAgICAgICAgPSByZXF1aXJlKCcuL19pcy1hcnJheScpDQogICwgYW5PYmplY3QgICAgICAgPSByZXF1aXJlKCcuL19hbi1vYmplY3QnKQ0KICAsIHRvSU9iamVjdCAgICAgID0gcmVxdWlyZSgnLi9fdG8taW9iamVjdCcpDQogICwgdG9QcmltaXRpdmUgICAgPSByZXF1aXJlKCcuL190by1wcmltaXRpdmUnKQ0KICAsIGNyZWF0ZURlc2MgICAgID0gcmVxdWlyZSgnLi9fcHJvcGVydHktZGVzYycpDQogICwgX2NyZWF0ZSAgICAgICAgPSByZXF1aXJlKCcuL19vYmplY3QtY3JlYXRlJykNCiAgLCBnT1BORXh0ICAgICAgICA9IHJlcXVpcmUoJy4vX29iamVjdC1nb3BuLWV4dCcpDQogICwgJEdPUEQgICAgICAgICAgPSByZXF1aXJlKCcuL19vYmplY3QtZ29wZCcpDQogICwgJERQICAgICAgICAgICAgPSByZXF1aXJlKCcuL19vYmplY3QtZHAnKQ0KICAsICRrZXlzICAgICAgICAgID0gcmVxdWlyZSgnLi9fb2JqZWN0LWtleXMnKQ0KICAsIGdPUEQgICAgICAgICAgID0gJEdPUEQuZg0KICAsIGRQICAgICAgICAgICAgID0gJERQLmYNCiAgLCBnT1BOICAgICAgICAgICA9IGdPUE5FeHQuZg0KICAsICRTeW1ib2wgICAgICAgID0gZ2xvYmFsLlN5bWJvbA0KICAsICRKU09OICAgICAgICAgID0gZ2xvYmFsLkpTT04NCiAgLCBfc3RyaW5naWZ5ICAgICA9ICRKU09OICYmICRKU09OLnN0cmluZ2lmeQ0KICAsIFBST1RPVFlQRSAgICAgID0gJ3Byb3RvdHlwZScNCiAgLCBISURERU4gICAgICAgICA9IHdrcygnX2hpZGRlbicpDQogICwgVE9fUFJJTUlUSVZFICAgPSB3a3MoJ3RvUHJpbWl0aXZlJykNCiAgLCBpc0VudW0gICAgICAgICA9IHt9LnByb3BlcnR5SXNFbnVtZXJhYmxlDQogICwgU3ltYm9sUmVnaXN0cnkgPSBzaGFyZWQoJ3N5bWJvbC1yZWdpc3RyeScpDQogICwgQWxsU3ltYm9scyAgICAgPSBzaGFyZWQoJ3N5bWJvbHMnKQ0KICAsIE9QU3ltYm9scyAgICAgID0gc2hhcmVkKCdvcC1zeW1ib2xzJykNCiAgLCBPYmplY3RQcm90byAgICA9IE9iamVjdFtQUk9UT1RZUEVdDQogICwgVVNFX05BVElWRSAgICAgPSB0eXBlb2YgJFN5bWJvbCA9PSAnZnVuY3Rpb24nDQogICwgUU9iamVjdCAgICAgICAgPSBnbG9iYWwuUU9iamVjdDsNCi8vIERvbid0IHVzZSBzZXR0ZXJzIGluIFF0IFNjcmlwdCwgaHR0cHM6Ly9naXRodWIuY29tL3psb2lyb2NrL2NvcmUtanMvaXNzdWVzLzE3Mw0KdmFyIHNldHRlciA9ICFRT2JqZWN0IHx8ICFRT2JqZWN0W1BST1RPVFlQRV0gfHwgIVFPYmplY3RbUFJPVE9UWVBFXS5maW5kQ2hpbGQ7DQoNCi8vIGZhbGxiYWNrIGZvciBvbGQgQW5kcm9pZCwgaHR0cHM6Ly9jb2RlLmdvb2dsZS5jb20vcC92OC9pc3N1ZXMvZGV0YWlsP2lkPTY4Nw0KdmFyIHNldFN5bWJvbERlc2MgPSBERVNDUklQVE9SUyAmJiAkZmFpbHMoZnVuY3Rpb24oKXsNCiAgcmV0dXJuIF9jcmVhdGUoZFAoe30sICdhJywgew0KICAgIGdldDogZnVuY3Rpb24oKXsgcmV0dXJuIGRQKHRoaXMsICdhJywge3ZhbHVlOiA3fSkuYTsgfQ0KICB9KSkuYSAhPSA3Ow0KfSkgPyBmdW5jdGlvbihpdCwga2V5LCBEKXsNCiAgdmFyIHByb3RvRGVzYyA9IGdPUEQoT2JqZWN0UHJvdG8sIGtleSk7DQogIGlmKHByb3RvRGVzYylkZWxldGUgT2JqZWN0UHJvdG9ba2V5XTsNCiAgZFAoaXQsIGtleSwgRCk7DQogIGlmKHByb3RvRGVzYyAmJiBpdCAhPT0gT2JqZWN0UHJvdG8pZFAoT2JqZWN0UHJvdG8sIGtleSwgcHJvdG9EZXNjKTsNCn0gOiBkUDsNCg0KdmFyIHdyYXAgPSBmdW5jdGlvbih0YWcpew0KICB2YXIgc3ltID0gQWxsU3ltYm9sc1t0YWddID0gX2NyZWF0ZSgkU3ltYm9sW1BST1RPVFlQRV0pOw0KICBzeW0uX2sgPSB0YWc7DQogIHJldHVybiBzeW07DQp9Ow0KDQp2YXIgaXNTeW1ib2wgPSBVU0VfTkFUSVZFICYmIHR5cGVvZiAkU3ltYm9sLml0ZXJhdG9yID09ICdzeW1ib2wnID8gZnVuY3Rpb24oaXQpew0KICByZXR1cm4gdHlwZW9mIGl0ID09ICdzeW1ib2wnOw0KfSA6IGZ1bmN0aW9uKGl0KXsNCiAgcmV0dXJuIGl0IGluc3RhbmNlb2YgJFN5bWJvbDsNCn07DQoNCnZhciAkZGVmaW5lUHJvcGVydHkgPSBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0eShpdCwga2V5LCBEKXsNCiAgaWYoaXQgPT09IE9iamVjdFByb3RvKSRkZWZpbmVQcm9wZXJ0eShPUFN5bWJvbHMsIGtleSwgRCk7DQogIGFuT2JqZWN0KGl0KTsNCiAga2V5ID0gdG9QcmltaXRpdmUoa2V5LCB0cnVlKTsNCiAgYW5PYmplY3QoRCk7DQogIGlmKGhhcyhBbGxTeW1ib2xzLCBrZXkpKXsNCiAgICBpZighRC5lbnVtZXJhYmxlKXsNCiAgICAgIGlmKCFoYXMoaXQsIEhJRERFTikpZFAoaXQsIEhJRERFTiwgY3JlYXRlRGVzYygxLCB7fSkpOw0KICAgICAgaXRbSElEREVOXVtrZXldID0gdHJ1ZTsNCiAgICB9IGVsc2Ugew0KICAgICAgaWYoaGFzKGl0LCBISURERU4pICYmIGl0W0hJRERFTl1ba2V5XSlpdFtISURERU5dW2tleV0gPSBmYWxzZTsNCiAgICAgIEQgPSBfY3JlYXRlKEQsIHtlbnVtZXJhYmxlOiBjcmVhdGVEZXNjKDAsIGZhbHNlKX0pOw0KICAgIH0gcmV0dXJuIHNldFN5bWJvbERlc2MoaXQsIGtleSwgRCk7DQogIH0gcmV0dXJuIGRQKGl0LCBrZXksIEQpOw0KfTsNCnZhciAkZGVmaW5lUHJvcGVydGllcyA9IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXMoaXQsIFApew0KICBhbk9iamVjdChpdCk7DQogIHZhciBrZXlzID0gZW51bUtleXMoUCA9IHRvSU9iamVjdChQKSkNCiAgICAsIGkgICAgPSAwDQogICAgLCBsID0ga2V5cy5sZW5ndGgNCiAgICAsIGtleTsNCiAgd2hpbGUobCA+IGkpJGRlZmluZVByb3BlcnR5KGl0LCBrZXkgPSBrZXlzW2krK10sIFBba2V5XSk7DQogIHJldHVybiBpdDsNCn07DQp2YXIgJGNyZWF0ZSA9IGZ1bmN0aW9uIGNyZWF0ZShpdCwgUCl7DQogIHJldHVybiBQID09PSB1bmRlZmluZWQgPyBfY3JlYXRlKGl0KSA6ICRkZWZpbmVQcm9wZXJ0aWVzKF9jcmVhdGUoaXQpLCBQKTsNCn07DQp2YXIgJHByb3BlcnR5SXNFbnVtZXJhYmxlID0gZnVuY3Rpb24gcHJvcGVydHlJc0VudW1lcmFibGUoa2V5KXsNCiAgdmFyIEUgPSBpc0VudW0uY2FsbCh0aGlzLCBrZXkgPSB0b1ByaW1pdGl2ZShrZXksIHRydWUpKTsNCiAgaWYodGhpcyA9PT0gT2JqZWN0UHJvdG8gJiYgaGFzKEFsbFN5bWJvbHMsIGtleSkgJiYgIWhhcyhPUFN5bWJvbHMsIGtleSkpcmV0dXJuIGZhbHNlOw0KICByZXR1cm4gRSB8fCAhaGFzKHRoaXMsIGtleSkgfHwgIWhhcyhBbGxTeW1ib2xzLCBrZXkpIHx8IGhhcyh0aGlzLCBISURERU4pICYmIHRoaXNbSElEREVOXVtrZXldID8gRSA6IHRydWU7DQp9Ow0KdmFyICRnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPSBmdW5jdGlvbiBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoaXQsIGtleSl7DQogIGl0ICA9IHRvSU9iamVjdChpdCk7DQogIGtleSA9IHRvUHJpbWl0aXZlKGtleSwgdHJ1ZSk7DQogIGlmKGl0ID09PSBPYmplY3RQcm90byAmJiBoYXMoQWxsU3ltYm9scywga2V5KSAmJiAhaGFzKE9QU3ltYm9scywga2V5KSlyZXR1cm47DQogIHZhciBEID0gZ09QRChpdCwga2V5KTsNCiAgaWYoRCAmJiBoYXMoQWxsU3ltYm9scywga2V5KSAmJiAhKGhhcyhpdCwgSElEREVOKSAmJiBpdFtISURERU5dW2tleV0pKUQuZW51bWVyYWJsZSA9IHRydWU7DQogIHJldHVybiBEOw0KfTsNCnZhciAkZ2V0T3duUHJvcGVydHlOYW1lcyA9IGZ1bmN0aW9uIGdldE93blByb3BlcnR5TmFtZXMoaXQpew0KICB2YXIgbmFtZXMgID0gZ09QTih0b0lPYmplY3QoaXQpKQ0KICAgICwgcmVzdWx0ID0gW10NCiAgICAsIGkgICAgICA9IDANCiAgICAsIGtleTsNCiAgd2hpbGUobmFtZXMubGVuZ3RoID4gaSl7DQogICAgaWYoIWhhcyhBbGxTeW1ib2xzLCBrZXkgPSBuYW1lc1tpKytdKSAmJiBrZXkgIT0gSElEREVOICYmIGtleSAhPSBNRVRBKXJlc3VsdC5wdXNoKGtleSk7DQogIH0gcmV0dXJuIHJlc3VsdDsNCn07DQp2YXIgJGdldE93blByb3BlcnR5U3ltYm9scyA9IGZ1bmN0aW9uIGdldE93blByb3BlcnR5U3ltYm9scyhpdCl7DQogIHZhciBJU19PUCAgPSBpdCA9PT0gT2JqZWN0UHJvdG8NCiAgICAsIG5hbWVzICA9IGdPUE4oSVNfT1AgPyBPUFN5bWJvbHMgOiB0b0lPYmplY3QoaXQpKQ0KICAgICwgcmVzdWx0ID0gW10NCiAgICAsIGkgICAgICA9IDANCiAgICAsIGtleTsNCiAgd2hpbGUobmFtZXMubGVuZ3RoID4gaSl7DQogICAgaWYoaGFzKEFsbFN5bWJvbHMsIGtleSA9IG5hbWVzW2krK10pICYmIChJU19PUCA/IGhhcyhPYmplY3RQcm90bywga2V5KSA6IHRydWUpKXJlc3VsdC5wdXNoKEFsbFN5bWJvbHNba2V5XSk7DQogIH0gcmV0dXJuIHJlc3VsdDsNCn07DQoNCi8vIDE5LjQuMS4xIFN5bWJvbChbZGVzY3JpcHRpb25dKQ0KaWYoIVVTRV9OQVRJVkUpew0KICAkU3ltYm9sID0gZnVuY3Rpb24gU3ltYm9sKCl7DQogICAgaWYodGhpcyBpbnN0YW5jZW9mICRTeW1ib2wpdGhyb3cgVHlwZUVycm9yKCdTeW1ib2wgaXMgbm90IGEgY29uc3RydWN0b3IhJyk7DQogICAgdmFyIHRhZyA9IHVpZChhcmd1bWVudHMubGVuZ3RoID4gMCA/IGFyZ3VtZW50c1swXSA6IHVuZGVmaW5lZCk7DQogICAgdmFyICRzZXQgPSBmdW5jdGlvbih2YWx1ZSl7DQogICAgICBpZih0aGlzID09PSBPYmplY3RQcm90bykkc2V0LmNhbGwoT1BTeW1ib2xzLCB2YWx1ZSk7DQogICAgICBpZihoYXModGhpcywgSElEREVOKSAmJiBoYXModGhpc1tISURERU5dLCB0YWcpKXRoaXNbSElEREVOXVt0YWddID0gZmFsc2U7DQogICAgICBzZXRTeW1ib2xEZXNjKHRoaXMsIHRhZywgY3JlYXRlRGVzYygxLCB2YWx1ZSkpOw0KICAgIH07DQogICAgaWYoREVTQ1JJUFRPUlMgJiYgc2V0dGVyKXNldFN5bWJvbERlc2MoT2JqZWN0UHJvdG8sIHRhZywge2NvbmZpZ3VyYWJsZTogdHJ1ZSwgc2V0OiAkc2V0fSk7DQogICAgcmV0dXJuIHdyYXAodGFnKTsNCiAgfTsNCiAgcmVkZWZpbmUoJFN5bWJvbFtQUk9UT1RZUEVdLCAndG9TdHJpbmcnLCBmdW5jdGlvbiB0b1N0cmluZygpew0KICAgIHJldHVybiB0aGlzLl9rOw0KICB9KTsNCg0KICAkR09QRC5mID0gJGdldE93blByb3BlcnR5RGVzY3JpcHRvcjsNCiAgJERQLmYgICA9ICRkZWZpbmVQcm9wZXJ0eTsNCiAgcmVxdWlyZSgnLi9fb2JqZWN0LWdvcG4nKS5mID0gZ09QTkV4dC5mID0gJGdldE93blByb3BlcnR5TmFtZXM7DQogIHJlcXVpcmUoJy4vX29iamVjdC1waWUnKS5mICA9ICRwcm9wZXJ0eUlzRW51bWVyYWJsZTsNCiAgcmVxdWlyZSgnLi9fb2JqZWN0LWdvcHMnKS5mID0gJGdldE93blByb3BlcnR5U3ltYm9sczsNCg0KICBpZihERVNDUklQVE9SUyAmJiAhcmVxdWlyZSgnLi9fbGlicmFyeScpKXsNCiAgICByZWRlZmluZShPYmplY3RQcm90bywgJ3Byb3BlcnR5SXNFbnVtZXJhYmxlJywgJHByb3BlcnR5SXNFbnVtZXJhYmxlLCB0cnVlKTsNCiAgfQ0KDQogIHdrc0V4dC5mID0gZnVuY3Rpb24obmFtZSl7DQogICAgcmV0dXJuIHdyYXAod2tzKG5hbWUpKTsNCiAgfQ0KfQ0KDQokZXhwb3J0KCRleHBvcnQuRyArICRleHBvcnQuVyArICRleHBvcnQuRiAqICFVU0VfTkFUSVZFLCB7U3ltYm9sOiAkU3ltYm9sfSk7DQoNCmZvcih2YXIgc3ltYm9scyA9ICgNCiAgLy8gMTkuNC4yLjIsIDE5LjQuMi4zLCAxOS40LjIuNCwgMTkuNC4yLjYsIDE5LjQuMi44LCAxOS40LjIuOSwgMTkuNC4yLjEwLCAxOS40LjIuMTEsIDE5LjQuMi4xMiwgMTkuNC4yLjEzLCAxOS40LjIuMTQNCiAgJ2hhc0luc3RhbmNlLGlzQ29uY2F0U3ByZWFkYWJsZSxpdGVyYXRvcixtYXRjaCxyZXBsYWNlLHNlYXJjaCxzcGVjaWVzLHNwbGl0LHRvUHJpbWl0aXZlLHRvU3RyaW5nVGFnLHVuc2NvcGFibGVzJw0KKS5zcGxpdCgnLCcpLCBpID0gMDsgc3ltYm9scy5sZW5ndGggPiBpOyApd2tzKHN5bWJvbHNbaSsrXSk7DQoNCmZvcih2YXIgc3ltYm9scyA9ICRrZXlzKHdrcy5zdG9yZSksIGkgPSAwOyBzeW1ib2xzLmxlbmd0aCA+IGk7ICl3a3NEZWZpbmUoc3ltYm9sc1tpKytdKTsNCg0KJGV4cG9ydCgkZXhwb3J0LlMgKyAkZXhwb3J0LkYgKiAhVVNFX05BVElWRSwgJ1N5bWJvbCcsIHsNCiAgLy8gMTkuNC4yLjEgU3ltYm9sLmZvcihrZXkpDQogICdmb3InOiBmdW5jdGlvbihrZXkpew0KICAgIHJldHVybiBoYXMoU3ltYm9sUmVnaXN0cnksIGtleSArPSAnJykNCiAgICAgID8gU3ltYm9sUmVnaXN0cnlba2V5XQ0KICAgICAgOiBTeW1ib2xSZWdpc3RyeVtrZXldID0gJFN5bWJvbChrZXkpOw0KICB9LA0KICAvLyAxOS40LjIuNSBTeW1ib2wua2V5Rm9yKHN5bSkNCiAga2V5Rm9yOiBmdW5jdGlvbiBrZXlGb3Ioa2V5KXsNCiAgICBpZihpc1N5bWJvbChrZXkpKXJldHVybiBrZXlPZihTeW1ib2xSZWdpc3RyeSwga2V5KTsNCiAgICB0aHJvdyBUeXBlRXJyb3Ioa2V5ICsgJyBpcyBub3QgYSBzeW1ib2whJyk7DQogIH0sDQogIHVzZVNldHRlcjogZnVuY3Rpb24oKXsgc2V0dGVyID0gdHJ1ZTsgfSwNCiAgdXNlU2ltcGxlOiBmdW5jdGlvbigpeyBzZXR0ZXIgPSBmYWxzZTsgfQ0KfSk7DQoNCiRleHBvcnQoJGV4cG9ydC5TICsgJGV4cG9ydC5GICogIVVTRV9OQVRJVkUsICdPYmplY3QnLCB7DQogIC8vIDE5LjEuMi4yIE9iamVjdC5jcmVhdGUoTyBbLCBQcm9wZXJ0aWVzXSkNCiAgY3JlYXRlOiAkY3JlYXRlLA0KICAvLyAxOS4xLjIuNCBPYmplY3QuZGVmaW5lUHJvcGVydHkoTywgUCwgQXR0cmlidXRlcykNCiAgZGVmaW5lUHJvcGVydHk6ICRkZWZpbmVQcm9wZXJ0eSwNCiAgLy8gMTkuMS4yLjMgT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoTywgUHJvcGVydGllcykNCiAgZGVmaW5lUHJvcGVydGllczogJGRlZmluZVByb3BlcnRpZXMsDQogIC8vIDE5LjEuMi42IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoTywgUCkNCiAgZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yOiAkZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yLA0KICAvLyAxOS4xLjIuNyBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhPKQ0KICBnZXRPd25Qcm9wZXJ0eU5hbWVzOiAkZ2V0T3duUHJvcGVydHlOYW1lcywNCiAgLy8gMTkuMS4yLjggT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhPKQ0KICBnZXRPd25Qcm9wZXJ0eVN5bWJvbHM6ICRnZXRPd25Qcm9wZXJ0eVN5bWJvbHMNCn0pOw0KDQovLyAyNC4zLjIgSlNPTi5zdHJpbmdpZnkodmFsdWUgWywgcmVwbGFjZXIgWywgc3BhY2VdXSkNCiRKU09OICYmICRleHBvcnQoJGV4cG9ydC5TICsgJGV4cG9ydC5GICogKCFVU0VfTkFUSVZFIHx8ICRmYWlscyhmdW5jdGlvbigpew0KICB2YXIgUyA9ICRTeW1ib2woKTsNCiAgLy8gTVMgRWRnZSBjb252ZXJ0cyBzeW1ib2wgdmFsdWVzIHRvIEpTT04gYXMge30NCiAgLy8gV2ViS2l0IGNvbnZlcnRzIHN5bWJvbCB2YWx1ZXMgdG8gSlNPTiBhcyBudWxsDQogIC8vIFY4IHRocm93cyBvbiBib3hlZCBzeW1ib2xzDQogIHJldHVybiBfc3RyaW5naWZ5KFtTXSkgIT0gJ1tudWxsXScgfHwgX3N0cmluZ2lmeSh7YTogU30pICE9ICd7fScgfHwgX3N0cmluZ2lmeShPYmplY3QoUykpICE9ICd7fSc7DQp9KSksICdKU09OJywgew0KICBzdHJpbmdpZnk6IGZ1bmN0aW9uIHN0cmluZ2lmeShpdCl7DQogICAgaWYoaXQgPT09IHVuZGVmaW5lZCB8fCBpc1N5bWJvbChpdCkpcmV0dXJuOyAvLyBJRTggcmV0dXJucyBzdHJpbmcgb24gdW5kZWZpbmVkDQogICAgdmFyIGFyZ3MgPSBbaXRdDQogICAgICAsIGkgICAgPSAxDQogICAgICAsIHJlcGxhY2VyLCAkcmVwbGFjZXI7DQogICAgd2hpbGUoYXJndW1lbnRzLmxlbmd0aCA+IGkpYXJncy5wdXNoKGFyZ3VtZW50c1tpKytdKTsNCiAgICByZXBsYWNlciA9IGFyZ3NbMV07DQogICAgaWYodHlwZW9mIHJlcGxhY2VyID09ICdmdW5jdGlvbicpJHJlcGxhY2VyID0gcmVwbGFjZXI7DQogICAgaWYoJHJlcGxhY2VyIHx8ICFpc0FycmF5KHJlcGxhY2VyKSlyZXBsYWNlciA9IGZ1bmN0aW9uKGtleSwgdmFsdWUpew0KICAgICAgaWYoJHJlcGxhY2VyKXZhbHVlID0gJHJlcGxhY2VyLmNhbGwodGhpcywga2V5LCB2YWx1ZSk7DQogICAgICBpZighaXNTeW1ib2wodmFsdWUpKXJldHVybiB2YWx1ZTsNCiAgICB9Ow0KICAgIGFyZ3NbMV0gPSByZXBsYWNlcjsNCiAgICByZXR1cm4gX3N0cmluZ2lmeS5hcHBseSgkSlNPTiwgYXJncyk7DQogIH0NCn0pOw0KDQovLyAxOS40LjMuNCBTeW1ib2wucHJvdG90eXBlW0BAdG9QcmltaXRpdmVdKGhpbnQpDQokU3ltYm9sW1BST1RPVFlQRV1bVE9fUFJJTUlUSVZFXSB8fCByZXF1aXJlKCcuL19oaWRlJykoJFN5bWJvbFtQUk9UT1RZUEVdLCBUT19QUklNSVRJVkUsICRTeW1ib2xbUFJPVE9UWVBFXS52YWx1ZU9mKTsNCi8vIDE5LjQuMy41IFN5bWJvbC5wcm90b3R5cGVbQEB0b1N0cmluZ1RhZ10NCnNldFRvU3RyaW5nVGFnKCRTeW1ib2wsICdTeW1ib2wnKTsNCi8vIDIwLjIuMS45IE1hdGhbQEB0b1N0cmluZ1RhZ10NCnNldFRvU3RyaW5nVGFnKE1hdGgsICdNYXRoJywgdHJ1ZSk7DQovLyAyNC4zLjMgSlNPTltAQHRvU3RyaW5nVGFnXQ0Kc2V0VG9TdHJpbmdUYWcoZ2xvYmFsLkpTT04sICdKU09OJywgdHJ1ZSk7DQp9LHsiLi9fYW4tb2JqZWN0Ijo3LCIuL19kZXNjcmlwdG9ycyI6MjgsIi4vX2VudW0ta2V5cyI6MzEsIi4vX2V4cG9ydCI6MzIsIi4vX2ZhaWxzIjozNCwiLi9fZ2xvYmFsIjozOCwiLi9faGFzIjozOSwiLi9faGlkZSI6NDAsIi4vX2lzLWFycmF5Ijo0NywiLi9fa2V5b2YiOjU3LCIuL19saWJyYXJ5Ijo1OCwiLi9fbWV0YSI6NjIsIi4vX29iamVjdC1jcmVhdGUiOjY2LCIuL19vYmplY3QtZHAiOjY3LCIuL19vYmplY3QtZ29wZCI6NzAsIi4vX29iamVjdC1nb3BuIjo3MiwiLi9fb2JqZWN0LWdvcG4tZXh0Ijo3MSwiLi9fb2JqZWN0LWdvcHMiOjczLCIuL19vYmplY3Qta2V5cyI6NzYsIi4vX29iamVjdC1waWUiOjc3LCIuL19wcm9wZXJ0eS1kZXNjIjo4NSwiLi9fcmVkZWZpbmUiOjg3LCIuL19zZXQtdG8tc3RyaW5nLXRhZyI6OTIsIi4vX3NoYXJlZCI6OTQsIi4vX3RvLWlvYmplY3QiOjEwNywiLi9fdG8tcHJpbWl0aXZlIjoxMTAsIi4vX3VpZCI6MTE0LCIuL193a3MiOjExNywiLi9fd2tzLWRlZmluZSI6MTE1LCIuL193a3MtZXh0IjoxMTZ9XSwyNDU6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KJ3VzZSBzdHJpY3QnOw0KdmFyICRleHBvcnQgICAgICA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpDQogICwgJHR5cGVkICAgICAgID0gcmVxdWlyZSgnLi9fdHlwZWQnKQ0KICAsIGJ1ZmZlciAgICAgICA9IHJlcXVpcmUoJy4vX3R5cGVkLWJ1ZmZlcicpDQogICwgYW5PYmplY3QgICAgID0gcmVxdWlyZSgnLi9fYW4tb2JqZWN0JykNCiAgLCB0b0luZGV4ICAgICAgPSByZXF1aXJlKCcuL190by1pbmRleCcpDQogICwgdG9MZW5ndGggICAgID0gcmVxdWlyZSgnLi9fdG8tbGVuZ3RoJykNCiAgLCBpc09iamVjdCAgICAgPSByZXF1aXJlKCcuL19pcy1vYmplY3QnKQ0KICAsIFRZUEVEX0FSUkFZICA9IHJlcXVpcmUoJy4vX3drcycpKCd0eXBlZF9hcnJheScpDQogICwgQXJyYXlCdWZmZXIgID0gcmVxdWlyZSgnLi9fZ2xvYmFsJykuQXJyYXlCdWZmZXINCiAgLCBzcGVjaWVzQ29uc3RydWN0b3IgPSByZXF1aXJlKCcuL19zcGVjaWVzLWNvbnN0cnVjdG9yJykNCiAgLCAkQXJyYXlCdWZmZXIgPSBidWZmZXIuQXJyYXlCdWZmZXINCiAgLCAkRGF0YVZpZXcgICAgPSBidWZmZXIuRGF0YVZpZXcNCiAgLCAkaXNWaWV3ICAgICAgPSAkdHlwZWQuQUJWICYmIEFycmF5QnVmZmVyLmlzVmlldw0KICAsICRzbGljZSAgICAgICA9ICRBcnJheUJ1ZmZlci5wcm90b3R5cGUuc2xpY2UNCiAgLCBWSUVXICAgICAgICAgPSAkdHlwZWQuVklFVw0KICAsIEFSUkFZX0JVRkZFUiA9ICdBcnJheUJ1ZmZlcic7DQoNCiRleHBvcnQoJGV4cG9ydC5HICsgJGV4cG9ydC5XICsgJGV4cG9ydC5GICogKEFycmF5QnVmZmVyICE9PSAkQXJyYXlCdWZmZXIpLCB7QXJyYXlCdWZmZXI6ICRBcnJheUJ1ZmZlcn0pOw0KDQokZXhwb3J0KCRleHBvcnQuUyArICRleHBvcnQuRiAqICEkdHlwZWQuQ09OU1RSLCBBUlJBWV9CVUZGRVIsIHsNCiAgLy8gMjQuMS4zLjEgQXJyYXlCdWZmZXIuaXNWaWV3KGFyZykNCiAgaXNWaWV3OiBmdW5jdGlvbiBpc1ZpZXcoaXQpew0KICAgIHJldHVybiAkaXNWaWV3ICYmICRpc1ZpZXcoaXQpIHx8IGlzT2JqZWN0KGl0KSAmJiBWSUVXIGluIGl0Ow0KICB9DQp9KTsNCg0KJGV4cG9ydCgkZXhwb3J0LlAgKyAkZXhwb3J0LlUgKyAkZXhwb3J0LkYgKiByZXF1aXJlKCcuL19mYWlscycpKGZ1bmN0aW9uKCl7DQogIHJldHVybiAhbmV3ICRBcnJheUJ1ZmZlcigyKS5zbGljZSgxLCB1bmRlZmluZWQpLmJ5dGVMZW5ndGg7DQp9KSwgQVJSQVlfQlVGRkVSLCB7DQogIC8vIDI0LjEuNC4zIEFycmF5QnVmZmVyLnByb3RvdHlwZS5zbGljZShzdGFydCwgZW5kKQ0KICBzbGljZTogZnVuY3Rpb24gc2xpY2Uoc3RhcnQsIGVuZCl7DQogICAgaWYoJHNsaWNlICE9PSB1bmRlZmluZWQgJiYgZW5kID09PSB1bmRlZmluZWQpcmV0dXJuICRzbGljZS5jYWxsKGFuT2JqZWN0KHRoaXMpLCBzdGFydCk7IC8vIEZGIGZpeA0KICAgIHZhciBsZW4gICAgPSBhbk9iamVjdCh0aGlzKS5ieXRlTGVuZ3RoDQogICAgICAsIGZpcnN0ICA9IHRvSW5kZXgoc3RhcnQsIGxlbikNCiAgICAgICwgZmluYWwgID0gdG9JbmRleChlbmQgPT09IHVuZGVmaW5lZCA/IGxlbiA6IGVuZCwgbGVuKQ0KICAgICAgLCByZXN1bHQgPSBuZXcgKHNwZWNpZXNDb25zdHJ1Y3Rvcih0aGlzLCAkQXJyYXlCdWZmZXIpKSh0b0xlbmd0aChmaW5hbCAtIGZpcnN0KSkNCiAgICAgICwgdmlld1MgID0gbmV3ICREYXRhVmlldyh0aGlzKQ0KICAgICAgLCB2aWV3VCAgPSBuZXcgJERhdGFWaWV3KHJlc3VsdCkNCiAgICAgICwgaW5kZXggID0gMDsNCiAgICB3aGlsZShmaXJzdCA8IGZpbmFsKXsNCiAgICAgIHZpZXdULnNldFVpbnQ4KGluZGV4KyssIHZpZXdTLmdldFVpbnQ4KGZpcnN0KyspKTsNCiAgICB9IHJldHVybiByZXN1bHQ7DQogIH0NCn0pOw0KDQpyZXF1aXJlKCcuL19zZXQtc3BlY2llcycpKEFSUkFZX0JVRkZFUik7DQp9LHsiLi9fYW4tb2JqZWN0Ijo3LCIuL19leHBvcnQiOjMyLCIuL19mYWlscyI6MzQsIi4vX2dsb2JhbCI6MzgsIi4vX2lzLW9iamVjdCI6NDksIi4vX3NldC1zcGVjaWVzIjo5MSwiLi9fc3BlY2llcy1jb25zdHJ1Y3RvciI6OTUsIi4vX3RvLWluZGV4IjoxMDUsIi4vX3RvLWxlbmd0aCI6MTA4LCIuL190eXBlZCI6MTEzLCIuL190eXBlZC1idWZmZXIiOjExMiwiLi9fd2tzIjoxMTd9XSwyNDY6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KdmFyICRleHBvcnQgPSByZXF1aXJlKCcuL19leHBvcnQnKTsNCiRleHBvcnQoJGV4cG9ydC5HICsgJGV4cG9ydC5XICsgJGV4cG9ydC5GICogIXJlcXVpcmUoJy4vX3R5cGVkJykuQUJWLCB7DQogIERhdGFWaWV3OiByZXF1aXJlKCcuL190eXBlZC1idWZmZXInKS5EYXRhVmlldw0KfSk7DQp9LHsiLi9fZXhwb3J0IjozMiwiLi9fdHlwZWQiOjExMywiLi9fdHlwZWQtYnVmZmVyIjoxMTJ9XSwyNDc6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KcmVxdWlyZSgnLi9fdHlwZWQtYXJyYXknKSgnRmxvYXQzMicsIDQsIGZ1bmN0aW9uKGluaXQpew0KICByZXR1cm4gZnVuY3Rpb24gRmxvYXQzMkFycmF5KGRhdGEsIGJ5dGVPZmZzZXQsIGxlbmd0aCl7DQogICAgcmV0dXJuIGluaXQodGhpcywgZGF0YSwgYnl0ZU9mZnNldCwgbGVuZ3RoKTsNCiAgfTsNCn0pOw0KfSx7Ii4vX3R5cGVkLWFycmF5IjoxMTF9XSwyNDg6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KcmVxdWlyZSgnLi9fdHlwZWQtYXJyYXknKSgnRmxvYXQ2NCcsIDgsIGZ1bmN0aW9uKGluaXQpew0KICByZXR1cm4gZnVuY3Rpb24gRmxvYXQ2NEFycmF5KGRhdGEsIGJ5dGVPZmZzZXQsIGxlbmd0aCl7DQogICAgcmV0dXJuIGluaXQodGhpcywgZGF0YSwgYnl0ZU9mZnNldCwgbGVuZ3RoKTsNCiAgfTsNCn0pOw0KfSx7Ii4vX3R5cGVkLWFycmF5IjoxMTF9XSwyNDk6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KcmVxdWlyZSgnLi9fdHlwZWQtYXJyYXknKSgnSW50MTYnLCAyLCBmdW5jdGlvbihpbml0KXsNCiAgcmV0dXJuIGZ1bmN0aW9uIEludDE2QXJyYXkoZGF0YSwgYnl0ZU9mZnNldCwgbGVuZ3RoKXsNCiAgICByZXR1cm4gaW5pdCh0aGlzLCBkYXRhLCBieXRlT2Zmc2V0LCBsZW5ndGgpOw0KICB9Ow0KfSk7DQp9LHsiLi9fdHlwZWQtYXJyYXkiOjExMX1dLDI1MDpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQpyZXF1aXJlKCcuL190eXBlZC1hcnJheScpKCdJbnQzMicsIDQsIGZ1bmN0aW9uKGluaXQpew0KICByZXR1cm4gZnVuY3Rpb24gSW50MzJBcnJheShkYXRhLCBieXRlT2Zmc2V0LCBsZW5ndGgpew0KICAgIHJldHVybiBpbml0KHRoaXMsIGRhdGEsIGJ5dGVPZmZzZXQsIGxlbmd0aCk7DQogIH07DQp9KTsNCn0seyIuL190eXBlZC1hcnJheSI6MTExfV0sMjUxOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCnJlcXVpcmUoJy4vX3R5cGVkLWFycmF5JykoJ0ludDgnLCAxLCBmdW5jdGlvbihpbml0KXsNCiAgcmV0dXJuIGZ1bmN0aW9uIEludDhBcnJheShkYXRhLCBieXRlT2Zmc2V0LCBsZW5ndGgpew0KICAgIHJldHVybiBpbml0KHRoaXMsIGRhdGEsIGJ5dGVPZmZzZXQsIGxlbmd0aCk7DQogIH07DQp9KTsNCn0seyIuL190eXBlZC1hcnJheSI6MTExfV0sMjUyOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCnJlcXVpcmUoJy4vX3R5cGVkLWFycmF5JykoJ1VpbnQxNicsIDIsIGZ1bmN0aW9uKGluaXQpew0KICByZXR1cm4gZnVuY3Rpb24gVWludDE2QXJyYXkoZGF0YSwgYnl0ZU9mZnNldCwgbGVuZ3RoKXsNCiAgICByZXR1cm4gaW5pdCh0aGlzLCBkYXRhLCBieXRlT2Zmc2V0LCBsZW5ndGgpOw0KICB9Ow0KfSk7DQp9LHsiLi9fdHlwZWQtYXJyYXkiOjExMX1dLDI1MzpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQpyZXF1aXJlKCcuL190eXBlZC1hcnJheScpKCdVaW50MzInLCA0LCBmdW5jdGlvbihpbml0KXsNCiAgcmV0dXJuIGZ1bmN0aW9uIFVpbnQzMkFycmF5KGRhdGEsIGJ5dGVPZmZzZXQsIGxlbmd0aCl7DQogICAgcmV0dXJuIGluaXQodGhpcywgZGF0YSwgYnl0ZU9mZnNldCwgbGVuZ3RoKTsNCiAgfTsNCn0pOw0KfSx7Ii4vX3R5cGVkLWFycmF5IjoxMTF9XSwyNTQ6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KcmVxdWlyZSgnLi9fdHlwZWQtYXJyYXknKSgnVWludDgnLCAxLCBmdW5jdGlvbihpbml0KXsNCiAgcmV0dXJuIGZ1bmN0aW9uIFVpbnQ4QXJyYXkoZGF0YSwgYnl0ZU9mZnNldCwgbGVuZ3RoKXsNCiAgICByZXR1cm4gaW5pdCh0aGlzLCBkYXRhLCBieXRlT2Zmc2V0LCBsZW5ndGgpOw0KICB9Ow0KfSk7DQp9LHsiLi9fdHlwZWQtYXJyYXkiOjExMX1dLDI1NTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQpyZXF1aXJlKCcuL190eXBlZC1hcnJheScpKCdVaW50OCcsIDEsIGZ1bmN0aW9uKGluaXQpew0KICByZXR1cm4gZnVuY3Rpb24gVWludDhDbGFtcGVkQXJyYXkoZGF0YSwgYnl0ZU9mZnNldCwgbGVuZ3RoKXsNCiAgICByZXR1cm4gaW5pdCh0aGlzLCBkYXRhLCBieXRlT2Zmc2V0LCBsZW5ndGgpOw0KICB9Ow0KfSwgdHJ1ZSk7DQp9LHsiLi9fdHlwZWQtYXJyYXkiOjExMX1dLDI1NjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQondXNlIHN0cmljdCc7DQp2YXIgZWFjaCAgICAgICAgID0gcmVxdWlyZSgnLi9fYXJyYXktbWV0aG9kcycpKDApDQogICwgcmVkZWZpbmUgICAgID0gcmVxdWlyZSgnLi9fcmVkZWZpbmUnKQ0KICAsIG1ldGEgICAgICAgICA9IHJlcXVpcmUoJy4vX21ldGEnKQ0KICAsIGFzc2lnbiAgICAgICA9IHJlcXVpcmUoJy4vX29iamVjdC1hc3NpZ24nKQ0KICAsIHdlYWsgICAgICAgICA9IHJlcXVpcmUoJy4vX2NvbGxlY3Rpb24td2VhaycpDQogICwgaXNPYmplY3QgICAgID0gcmVxdWlyZSgnLi9faXMtb2JqZWN0JykNCiAgLCBoYXMgICAgICAgICAgPSByZXF1aXJlKCcuL19oYXMnKQ0KICAsIGdldFdlYWsgICAgICA9IG1ldGEuZ2V0V2Vhaw0KICAsIGlzRXh0ZW5zaWJsZSA9IE9iamVjdC5pc0V4dGVuc2libGUNCiAgLCB1bmNhdWdodEZyb3plblN0b3JlID0gd2Vhay51ZnN0b3JlDQogICwgdG1wICAgICAgICAgID0ge30NCiAgLCBJbnRlcm5hbE1hcDsNCg0KdmFyIHdyYXBwZXIgPSBmdW5jdGlvbihnZXQpew0KICByZXR1cm4gZnVuY3Rpb24gV2Vha01hcCgpew0KICAgIHJldHVybiBnZXQodGhpcywgYXJndW1lbnRzLmxlbmd0aCA+IDAgPyBhcmd1bWVudHNbMF0gOiB1bmRlZmluZWQpOw0KICB9Ow0KfTsNCg0KdmFyIG1ldGhvZHMgPSB7DQogIC8vIDIzLjMuMy4zIFdlYWtNYXAucHJvdG90eXBlLmdldChrZXkpDQogIGdldDogZnVuY3Rpb24gZ2V0KGtleSl7DQogICAgaWYoaXNPYmplY3Qoa2V5KSl7DQogICAgICB2YXIgZGF0YSA9IGdldFdlYWsoa2V5KTsNCiAgICAgIGlmKGRhdGEgPT09IHRydWUpcmV0dXJuIHVuY2F1Z2h0RnJvemVuU3RvcmUodGhpcykuZ2V0KGtleSk7DQogICAgICByZXR1cm4gZGF0YSA/IGRhdGFbdGhpcy5faV0gOiB1bmRlZmluZWQ7DQogICAgfQ0KICB9LA0KICAvLyAyMy4zLjMuNSBXZWFrTWFwLnByb3RvdHlwZS5zZXQoa2V5LCB2YWx1ZSkNCiAgc2V0OiBmdW5jdGlvbiBzZXQoa2V5LCB2YWx1ZSl7DQogICAgcmV0dXJuIHdlYWsuZGVmKHRoaXMsIGtleSwgdmFsdWUpOw0KICB9DQp9Ow0KDQovLyAyMy4zIFdlYWtNYXAgT2JqZWN0cw0KdmFyICRXZWFrTWFwID0gbW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKCcuL19jb2xsZWN0aW9uJykoJ1dlYWtNYXAnLCB3cmFwcGVyLCBtZXRob2RzLCB3ZWFrLCB0cnVlLCB0cnVlKTsNCg0KLy8gSUUxMSBXZWFrTWFwIGZyb3plbiBrZXlzIGZpeA0KaWYobmV3ICRXZWFrTWFwKCkuc2V0KChPYmplY3QuZnJlZXplIHx8IE9iamVjdCkodG1wKSwgNykuZ2V0KHRtcCkgIT0gNyl7DQogIEludGVybmFsTWFwID0gd2Vhay5nZXRDb25zdHJ1Y3Rvcih3cmFwcGVyKTsNCiAgYXNzaWduKEludGVybmFsTWFwLnByb3RvdHlwZSwgbWV0aG9kcyk7DQogIG1ldGEuTkVFRCA9IHRydWU7DQogIGVhY2goWydkZWxldGUnLCAnaGFzJywgJ2dldCcsICdzZXQnXSwgZnVuY3Rpb24oa2V5KXsNCiAgICB2YXIgcHJvdG8gID0gJFdlYWtNYXAucHJvdG90eXBlDQogICAgICAsIG1ldGhvZCA9IHByb3RvW2tleV07DQogICAgcmVkZWZpbmUocHJvdG8sIGtleSwgZnVuY3Rpb24oYSwgYil7DQogICAgICAvLyBzdG9yZSBmcm96ZW4gb2JqZWN0cyBvbiBpbnRlcm5hbCB3ZWFrbWFwIHNoaW0NCiAgICAgIGlmKGlzT2JqZWN0KGEpICYmICFpc0V4dGVuc2libGUoYSkpew0KICAgICAgICBpZighdGhpcy5fZil0aGlzLl9mID0gbmV3IEludGVybmFsTWFwOw0KICAgICAgICB2YXIgcmVzdWx0ID0gdGhpcy5fZltrZXldKGEsIGIpOw0KICAgICAgICByZXR1cm4ga2V5ID09ICdzZXQnID8gdGhpcyA6IHJlc3VsdDsNCiAgICAgIC8vIHN0b3JlIGFsbCB0aGUgcmVzdCBvbiBuYXRpdmUgd2Vha21hcA0KICAgICAgfSByZXR1cm4gbWV0aG9kLmNhbGwodGhpcywgYSwgYik7DQogICAgfSk7DQogIH0pOw0KfQ0KfSx7Ii4vX2FycmF5LW1ldGhvZHMiOjEyLCIuL19jb2xsZWN0aW9uIjoyMiwiLi9fY29sbGVjdGlvbi13ZWFrIjoyMSwiLi9faGFzIjozOSwiLi9faXMtb2JqZWN0Ijo0OSwiLi9fbWV0YSI6NjIsIi4vX29iamVjdC1hc3NpZ24iOjY1LCIuL19yZWRlZmluZSI6ODd9XSwyNTc6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KJ3VzZSBzdHJpY3QnOw0KdmFyIHdlYWsgPSByZXF1aXJlKCcuL19jb2xsZWN0aW9uLXdlYWsnKTsNCg0KLy8gMjMuNCBXZWFrU2V0IE9iamVjdHMNCnJlcXVpcmUoJy4vX2NvbGxlY3Rpb24nKSgnV2Vha1NldCcsIGZ1bmN0aW9uKGdldCl7DQogIHJldHVybiBmdW5jdGlvbiBXZWFrU2V0KCl7IHJldHVybiBnZXQodGhpcywgYXJndW1lbnRzLmxlbmd0aCA+IDAgPyBhcmd1bWVudHNbMF0gOiB1bmRlZmluZWQpOyB9Ow0KfSwgew0KICAvLyAyMy40LjMuMSBXZWFrU2V0LnByb3RvdHlwZS5hZGQodmFsdWUpDQogIGFkZDogZnVuY3Rpb24gYWRkKHZhbHVlKXsNCiAgICByZXR1cm4gd2Vhay5kZWYodGhpcywgdmFsdWUsIHRydWUpOw0KICB9DQp9LCB3ZWFrLCBmYWxzZSwgdHJ1ZSk7DQp9LHsiLi9fY29sbGVjdGlvbiI6MjIsIi4vX2NvbGxlY3Rpb24td2VhayI6MjF9XSwyNTg6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KJ3VzZSBzdHJpY3QnOw0KLy8gaHR0cHM6Ly9naXRodWIuY29tL3RjMzkvQXJyYXkucHJvdG90eXBlLmluY2x1ZGVzDQp2YXIgJGV4cG9ydCAgID0gcmVxdWlyZSgnLi9fZXhwb3J0JykNCiAgLCAkaW5jbHVkZXMgPSByZXF1aXJlKCcuL19hcnJheS1pbmNsdWRlcycpKHRydWUpOw0KDQokZXhwb3J0KCRleHBvcnQuUCwgJ0FycmF5Jywgew0KICBpbmNsdWRlczogZnVuY3Rpb24gaW5jbHVkZXMoZWwgLyosIGZyb21JbmRleCA9IDAgKi8pew0KICAgIHJldHVybiAkaW5jbHVkZXModGhpcywgZWwsIGFyZ3VtZW50cy5sZW5ndGggPiAxID8gYXJndW1lbnRzWzFdIDogdW5kZWZpbmVkKTsNCiAgfQ0KfSk7DQoNCnJlcXVpcmUoJy4vX2FkZC10by11bnNjb3BhYmxlcycpKCdpbmNsdWRlcycpOw0KfSx7Ii4vX2FkZC10by11bnNjb3BhYmxlcyI6NSwiLi9fYXJyYXktaW5jbHVkZXMiOjExLCIuL19leHBvcnQiOjMyfV0sMjU5OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCi8vIGh0dHBzOi8vZ2l0aHViLmNvbS9yd2FsZHJvbi90YzM5LW5vdGVzL2Jsb2IvbWFzdGVyL2VzNi8yMDE0LTA5L3NlcHQtMjUubWQjNTEwLWdsb2JhbGFzYXAtZm9yLWVucXVldWluZy1hLW1pY3JvdGFzaw0KdmFyICRleHBvcnQgICA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpDQogICwgbWljcm90YXNrID0gcmVxdWlyZSgnLi9fbWljcm90YXNrJykoKQ0KICAsIHByb2Nlc3MgICA9IHJlcXVpcmUoJy4vX2dsb2JhbCcpLnByb2Nlc3MNCiAgLCBpc05vZGUgICAgPSByZXF1aXJlKCcuL19jb2YnKShwcm9jZXNzKSA9PSAncHJvY2Vzcyc7DQoNCiRleHBvcnQoJGV4cG9ydC5HLCB7DQogIGFzYXA6IGZ1bmN0aW9uIGFzYXAoZm4pew0KICAgIHZhciBkb21haW4gPSBpc05vZGUgJiYgcHJvY2Vzcy5kb21haW47DQogICAgbWljcm90YXNrKGRvbWFpbiA/IGRvbWFpbi5iaW5kKGZuKSA6IGZuKTsNCiAgfQ0KfSk7DQp9LHsiLi9fY29mIjoxOCwiLi9fZXhwb3J0IjozMiwiLi9fZ2xvYmFsIjozOCwiLi9fbWljcm90YXNrIjo2NH1dLDI2MDpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQovLyBodHRwczovL2dpdGh1Yi5jb20vbGpoYXJiL3Byb3Bvc2FsLWlzLWVycm9yDQp2YXIgJGV4cG9ydCA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpDQogICwgY29mICAgICA9IHJlcXVpcmUoJy4vX2NvZicpOw0KDQokZXhwb3J0KCRleHBvcnQuUywgJ0Vycm9yJywgew0KICBpc0Vycm9yOiBmdW5jdGlvbiBpc0Vycm9yKGl0KXsNCiAgICByZXR1cm4gY29mKGl0KSA9PT0gJ0Vycm9yJzsNCiAgfQ0KfSk7DQp9LHsiLi9fY29mIjoxOCwiLi9fZXhwb3J0IjozMn1dLDI2MTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQovLyBodHRwczovL2dpdGh1Yi5jb20vRGF2aWRCcnVhbnQvTWFwLVNldC5wcm90b3R5cGUudG9KU09ODQp2YXIgJGV4cG9ydCAgPSByZXF1aXJlKCcuL19leHBvcnQnKTsNCg0KJGV4cG9ydCgkZXhwb3J0LlAgKyAkZXhwb3J0LlIsICdNYXAnLCB7dG9KU09OOiByZXF1aXJlKCcuL19jb2xsZWN0aW9uLXRvLWpzb24nKSgnTWFwJyl9KTsNCn0seyIuL19jb2xsZWN0aW9uLXRvLWpzb24iOjIwLCIuL19leHBvcnQiOjMyfV0sMjYyOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCi8vIGh0dHBzOi8vZ2lzdC5naXRodWIuY29tL0JyZW5kYW5FaWNoLzQyOTRkNWMyMTJhNmQyMjU0NzAzDQp2YXIgJGV4cG9ydCA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpOw0KDQokZXhwb3J0KCRleHBvcnQuUywgJ01hdGgnLCB7DQogIGlhZGRoOiBmdW5jdGlvbiBpYWRkaCh4MCwgeDEsIHkwLCB5MSl7DQogICAgdmFyICR4MCA9IHgwID4+PiAwDQogICAgICAsICR4MSA9IHgxID4+PiAwDQogICAgICAsICR5MCA9IHkwID4+PiAwOw0KICAgIHJldHVybiAkeDEgKyAoeTEgPj4+IDApICsgKCgkeDAgJiAkeTAgfCAoJHgwIHwgJHkwKSAmIH4oJHgwICsgJHkwID4+PiAwKSkgPj4+IDMxKSB8IDA7DQogIH0NCn0pOw0KfSx7Ii4vX2V4cG9ydCI6MzJ9XSwyNjM6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KLy8gaHR0cHM6Ly9naXN0LmdpdGh1Yi5jb20vQnJlbmRhbkVpY2gvNDI5NGQ1YzIxMmE2ZDIyNTQ3MDMNCnZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0Jyk7DQoNCiRleHBvcnQoJGV4cG9ydC5TLCAnTWF0aCcsIHsNCiAgaW11bGg6IGZ1bmN0aW9uIGltdWxoKHUsIHYpew0KICAgIHZhciBVSU5UMTYgPSAweGZmZmYNCiAgICAgICwgJHUgPSArdQ0KICAgICAgLCAkdiA9ICt2DQogICAgICAsIHUwID0gJHUgJiBVSU5UMTYNCiAgICAgICwgdjAgPSAkdiAmIFVJTlQxNg0KICAgICAgLCB1MSA9ICR1ID4+IDE2DQogICAgICAsIHYxID0gJHYgPj4gMTYNCiAgICAgICwgdCAgPSAodTEgKiB2MCA+Pj4gMCkgKyAodTAgKiB2MCA+Pj4gMTYpOw0KICAgIHJldHVybiB1MSAqIHYxICsgKHQgPj4gMTYpICsgKCh1MCAqIHYxID4+PiAwKSArICh0ICYgVUlOVDE2KSA+PiAxNik7DQogIH0NCn0pOw0KfSx7Ii4vX2V4cG9ydCI6MzJ9XSwyNjQ6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KLy8gaHR0cHM6Ly9naXN0LmdpdGh1Yi5jb20vQnJlbmRhbkVpY2gvNDI5NGQ1YzIxMmE2ZDIyNTQ3MDMNCnZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0Jyk7DQoNCiRleHBvcnQoJGV4cG9ydC5TLCAnTWF0aCcsIHsNCiAgaXN1Ymg6IGZ1bmN0aW9uIGlzdWJoKHgwLCB4MSwgeTAsIHkxKXsNCiAgICB2YXIgJHgwID0geDAgPj4+IDANCiAgICAgICwgJHgxID0geDEgPj4+IDANCiAgICAgICwgJHkwID0geTAgPj4+IDA7DQogICAgcmV0dXJuICR4MSAtICh5MSA+Pj4gMCkgLSAoKH4keDAgJiAkeTAgfCB+KCR4MCBeICR5MCkgJiAkeDAgLSAkeTAgPj4+IDApID4+PiAzMSkgfCAwOw0KICB9DQp9KTsNCn0seyIuL19leHBvcnQiOjMyfV0sMjY1OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCi8vIGh0dHBzOi8vZ2lzdC5naXRodWIuY29tL0JyZW5kYW5FaWNoLzQyOTRkNWMyMTJhNmQyMjU0NzAzDQp2YXIgJGV4cG9ydCA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpOw0KDQokZXhwb3J0KCRleHBvcnQuUywgJ01hdGgnLCB7DQogIHVtdWxoOiBmdW5jdGlvbiB1bXVsaCh1LCB2KXsNCiAgICB2YXIgVUlOVDE2ID0gMHhmZmZmDQogICAgICAsICR1ID0gK3UNCiAgICAgICwgJHYgPSArdg0KICAgICAgLCB1MCA9ICR1ICYgVUlOVDE2DQogICAgICAsIHYwID0gJHYgJiBVSU5UMTYNCiAgICAgICwgdTEgPSAkdSA+Pj4gMTYNCiAgICAgICwgdjEgPSAkdiA+Pj4gMTYNCiAgICAgICwgdCAgPSAodTEgKiB2MCA+Pj4gMCkgKyAodTAgKiB2MCA+Pj4gMTYpOw0KICAgIHJldHVybiB1MSAqIHYxICsgKHQgPj4+IDE2KSArICgodTAgKiB2MSA+Pj4gMCkgKyAodCAmIFVJTlQxNikgPj4+IDE2KTsNCiAgfQ0KfSk7DQp9LHsiLi9fZXhwb3J0IjozMn1dLDI2NjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQondXNlIHN0cmljdCc7DQp2YXIgJGV4cG9ydCAgICAgICAgID0gcmVxdWlyZSgnLi9fZXhwb3J0JykNCiAgLCB0b09iamVjdCAgICAgICAgPSByZXF1aXJlKCcuL190by1vYmplY3QnKQ0KICAsIGFGdW5jdGlvbiAgICAgICA9IHJlcXVpcmUoJy4vX2EtZnVuY3Rpb24nKQ0KICAsICRkZWZpbmVQcm9wZXJ0eSA9IHJlcXVpcmUoJy4vX29iamVjdC1kcCcpOw0KDQovLyBCLjIuMi4yIE9iamVjdC5wcm90b3R5cGUuX19kZWZpbmVHZXR0ZXJfXyhQLCBnZXR0ZXIpDQpyZXF1aXJlKCcuL19kZXNjcmlwdG9ycycpICYmICRleHBvcnQoJGV4cG9ydC5QICsgcmVxdWlyZSgnLi9fb2JqZWN0LWZvcmNlZC1wYW0nKSwgJ09iamVjdCcsIHsNCiAgX19kZWZpbmVHZXR0ZXJfXzogZnVuY3Rpb24gX19kZWZpbmVHZXR0ZXJfXyhQLCBnZXR0ZXIpew0KICAgICRkZWZpbmVQcm9wZXJ0eS5mKHRvT2JqZWN0KHRoaXMpLCBQLCB7Z2V0OiBhRnVuY3Rpb24oZ2V0dGVyKSwgZW51bWVyYWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlfSk7DQogIH0NCn0pOw0KfSx7Ii4vX2EtZnVuY3Rpb24iOjMsIi4vX2Rlc2NyaXB0b3JzIjoyOCwiLi9fZXhwb3J0IjozMiwiLi9fb2JqZWN0LWRwIjo2NywiLi9fb2JqZWN0LWZvcmNlZC1wYW0iOjY5LCIuL190by1vYmplY3QiOjEwOX1dLDI2NzpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQondXNlIHN0cmljdCc7DQp2YXIgJGV4cG9ydCAgICAgICAgID0gcmVxdWlyZSgnLi9fZXhwb3J0JykNCiAgLCB0b09iamVjdCAgICAgICAgPSByZXF1aXJlKCcuL190by1vYmplY3QnKQ0KICAsIGFGdW5jdGlvbiAgICAgICA9IHJlcXVpcmUoJy4vX2EtZnVuY3Rpb24nKQ0KICAsICRkZWZpbmVQcm9wZXJ0eSA9IHJlcXVpcmUoJy4vX29iamVjdC1kcCcpOw0KDQovLyBCLjIuMi4zIE9iamVjdC5wcm90b3R5cGUuX19kZWZpbmVTZXR0ZXJfXyhQLCBzZXR0ZXIpDQpyZXF1aXJlKCcuL19kZXNjcmlwdG9ycycpICYmICRleHBvcnQoJGV4cG9ydC5QICsgcmVxdWlyZSgnLi9fb2JqZWN0LWZvcmNlZC1wYW0nKSwgJ09iamVjdCcsIHsNCiAgX19kZWZpbmVTZXR0ZXJfXzogZnVuY3Rpb24gX19kZWZpbmVTZXR0ZXJfXyhQLCBzZXR0ZXIpew0KICAgICRkZWZpbmVQcm9wZXJ0eS5mKHRvT2JqZWN0KHRoaXMpLCBQLCB7c2V0OiBhRnVuY3Rpb24oc2V0dGVyKSwgZW51bWVyYWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlfSk7DQogIH0NCn0pOw0KfSx7Ii4vX2EtZnVuY3Rpb24iOjMsIi4vX2Rlc2NyaXB0b3JzIjoyOCwiLi9fZXhwb3J0IjozMiwiLi9fb2JqZWN0LWRwIjo2NywiLi9fb2JqZWN0LWZvcmNlZC1wYW0iOjY5LCIuL190by1vYmplY3QiOjEwOX1dLDI2ODpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQovLyBodHRwczovL2dpdGh1Yi5jb20vdGMzOS9wcm9wb3NhbC1vYmplY3QtdmFsdWVzLWVudHJpZXMNCnZhciAkZXhwb3J0ICA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpDQogICwgJGVudHJpZXMgPSByZXF1aXJlKCcuL19vYmplY3QtdG8tYXJyYXknKSh0cnVlKTsNCg0KJGV4cG9ydCgkZXhwb3J0LlMsICdPYmplY3QnLCB7DQogIGVudHJpZXM6IGZ1bmN0aW9uIGVudHJpZXMoaXQpew0KICAgIHJldHVybiAkZW50cmllcyhpdCk7DQogIH0NCn0pOw0KfSx7Ii4vX2V4cG9ydCI6MzIsIi4vX29iamVjdC10by1hcnJheSI6Nzl9XSwyNjk6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KLy8gaHR0cHM6Ly9naXRodWIuY29tL3RjMzkvcHJvcG9zYWwtb2JqZWN0LWdldG93bnByb3BlcnR5ZGVzY3JpcHRvcnMNCnZhciAkZXhwb3J0ICAgICAgICA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpDQogICwgb3duS2V5cyAgICAgICAgPSByZXF1aXJlKCcuL19vd24ta2V5cycpDQogICwgdG9JT2JqZWN0ICAgICAgPSByZXF1aXJlKCcuL190by1pb2JqZWN0JykNCiAgLCBnT1BEICAgICAgICAgICA9IHJlcXVpcmUoJy4vX29iamVjdC1nb3BkJykNCiAgLCBjcmVhdGVQcm9wZXJ0eSA9IHJlcXVpcmUoJy4vX2NyZWF0ZS1wcm9wZXJ0eScpOw0KDQokZXhwb3J0KCRleHBvcnQuUywgJ09iamVjdCcsIHsNCiAgZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yczogZnVuY3Rpb24gZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhvYmplY3Qpew0KICAgIHZhciBPICAgICAgID0gdG9JT2JqZWN0KG9iamVjdCkNCiAgICAgICwgZ2V0RGVzYyA9IGdPUEQuZg0KICAgICAgLCBrZXlzICAgID0gb3duS2V5cyhPKQ0KICAgICAgLCByZXN1bHQgID0ge30NCiAgICAgICwgaSAgICAgICA9IDANCiAgICAgICwga2V5LCBEOw0KICAgIHdoaWxlKGtleXMubGVuZ3RoID4gaSljcmVhdGVQcm9wZXJ0eShyZXN1bHQsIGtleSA9IGtleXNbaSsrXSwgZ2V0RGVzYyhPLCBrZXkpKTsNCiAgICByZXR1cm4gcmVzdWx0Ow0KICB9DQp9KTsNCn0seyIuL19jcmVhdGUtcHJvcGVydHkiOjI0LCIuL19leHBvcnQiOjMyLCIuL19vYmplY3QtZ29wZCI6NzAsIi4vX293bi1rZXlzIjo4MCwiLi9fdG8taW9iamVjdCI6MTA3fV0sMjcwOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCid1c2Ugc3RyaWN0JzsNCnZhciAkZXhwb3J0ICAgICAgICAgICAgICAgICAgPSByZXF1aXJlKCcuL19leHBvcnQnKQ0KICAsIHRvT2JqZWN0ICAgICAgICAgICAgICAgICA9IHJlcXVpcmUoJy4vX3RvLW9iamVjdCcpDQogICwgdG9QcmltaXRpdmUgICAgICAgICAgICAgID0gcmVxdWlyZSgnLi9fdG8tcHJpbWl0aXZlJykNCiAgLCBnZXRQcm90b3R5cGVPZiAgICAgICAgICAgPSByZXF1aXJlKCcuL19vYmplY3QtZ3BvJykNCiAgLCBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IgPSByZXF1aXJlKCcuL19vYmplY3QtZ29wZCcpLmY7DQoNCi8vIEIuMi4yLjQgT2JqZWN0LnByb3RvdHlwZS5fX2xvb2t1cEdldHRlcl9fKFApDQpyZXF1aXJlKCcuL19kZXNjcmlwdG9ycycpICYmICRleHBvcnQoJGV4cG9ydC5QICsgcmVxdWlyZSgnLi9fb2JqZWN0LWZvcmNlZC1wYW0nKSwgJ09iamVjdCcsIHsNCiAgX19sb29rdXBHZXR0ZXJfXzogZnVuY3Rpb24gX19sb29rdXBHZXR0ZXJfXyhQKXsNCiAgICB2YXIgTyA9IHRvT2JqZWN0KHRoaXMpDQogICAgICAsIEsgPSB0b1ByaW1pdGl2ZShQLCB0cnVlKQ0KICAgICAgLCBEOw0KICAgIGRvIHsNCiAgICAgIGlmKEQgPSBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoTywgSykpcmV0dXJuIEQuZ2V0Ow0KICAgIH0gd2hpbGUoTyA9IGdldFByb3RvdHlwZU9mKE8pKTsNCiAgfQ0KfSk7DQp9LHsiLi9fZGVzY3JpcHRvcnMiOjI4LCIuL19leHBvcnQiOjMyLCIuL19vYmplY3QtZm9yY2VkLXBhbSI6NjksIi4vX29iamVjdC1nb3BkIjo3MCwiLi9fb2JqZWN0LWdwbyI6NzQsIi4vX3RvLW9iamVjdCI6MTA5LCIuL190by1wcmltaXRpdmUiOjExMH1dLDI3MTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQondXNlIHN0cmljdCc7DQp2YXIgJGV4cG9ydCAgICAgICAgICAgICAgICAgID0gcmVxdWlyZSgnLi9fZXhwb3J0JykNCiAgLCB0b09iamVjdCAgICAgICAgICAgICAgICAgPSByZXF1aXJlKCcuL190by1vYmplY3QnKQ0KICAsIHRvUHJpbWl0aXZlICAgICAgICAgICAgICA9IHJlcXVpcmUoJy4vX3RvLXByaW1pdGl2ZScpDQogICwgZ2V0UHJvdG90eXBlT2YgICAgICAgICAgID0gcmVxdWlyZSgnLi9fb2JqZWN0LWdwbycpDQogICwgZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yID0gcmVxdWlyZSgnLi9fb2JqZWN0LWdvcGQnKS5mOw0KDQovLyBCLjIuMi41IE9iamVjdC5wcm90b3R5cGUuX19sb29rdXBTZXR0ZXJfXyhQKQ0KcmVxdWlyZSgnLi9fZGVzY3JpcHRvcnMnKSAmJiAkZXhwb3J0KCRleHBvcnQuUCArIHJlcXVpcmUoJy4vX29iamVjdC1mb3JjZWQtcGFtJyksICdPYmplY3QnLCB7DQogIF9fbG9va3VwU2V0dGVyX186IGZ1bmN0aW9uIF9fbG9va3VwU2V0dGVyX18oUCl7DQogICAgdmFyIE8gPSB0b09iamVjdCh0aGlzKQ0KICAgICAgLCBLID0gdG9QcmltaXRpdmUoUCwgdHJ1ZSkNCiAgICAgICwgRDsNCiAgICBkbyB7DQogICAgICBpZihEID0gZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKE8sIEspKXJldHVybiBELnNldDsNCiAgICB9IHdoaWxlKE8gPSBnZXRQcm90b3R5cGVPZihPKSk7DQogIH0NCn0pOw0KfSx7Ii4vX2Rlc2NyaXB0b3JzIjoyOCwiLi9fZXhwb3J0IjozMiwiLi9fb2JqZWN0LWZvcmNlZC1wYW0iOjY5LCIuL19vYmplY3QtZ29wZCI6NzAsIi4vX29iamVjdC1ncG8iOjc0LCIuL190by1vYmplY3QiOjEwOSwiLi9fdG8tcHJpbWl0aXZlIjoxMTB9XSwyNzI6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KLy8gaHR0cHM6Ly9naXRodWIuY29tL3RjMzkvcHJvcG9zYWwtb2JqZWN0LXZhbHVlcy1lbnRyaWVzDQp2YXIgJGV4cG9ydCA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpDQogICwgJHZhbHVlcyA9IHJlcXVpcmUoJy4vX29iamVjdC10by1hcnJheScpKGZhbHNlKTsNCg0KJGV4cG9ydCgkZXhwb3J0LlMsICdPYmplY3QnLCB7DQogIHZhbHVlczogZnVuY3Rpb24gdmFsdWVzKGl0KXsNCiAgICByZXR1cm4gJHZhbHVlcyhpdCk7DQogIH0NCn0pOw0KfSx7Ii4vX2V4cG9ydCI6MzIsIi4vX29iamVjdC10by1hcnJheSI6Nzl9XSwyNzM6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KJ3VzZSBzdHJpY3QnOw0KLy8gaHR0cHM6Ly9naXRodWIuY29tL3plbnBhcnNpbmcvZXMtb2JzZXJ2YWJsZQ0KdmFyICRleHBvcnQgICAgID0gcmVxdWlyZSgnLi9fZXhwb3J0JykNCiAgLCBnbG9iYWwgICAgICA9IHJlcXVpcmUoJy4vX2dsb2JhbCcpDQogICwgY29yZSAgICAgICAgPSByZXF1aXJlKCcuL19jb3JlJykNCiAgLCBtaWNyb3Rhc2sgICA9IHJlcXVpcmUoJy4vX21pY3JvdGFzaycpKCkNCiAgLCBPQlNFUlZBQkxFICA9IHJlcXVpcmUoJy4vX3drcycpKCdvYnNlcnZhYmxlJykNCiAgLCBhRnVuY3Rpb24gICA9IHJlcXVpcmUoJy4vX2EtZnVuY3Rpb24nKQ0KICAsIGFuT2JqZWN0ICAgID0gcmVxdWlyZSgnLi9fYW4tb2JqZWN0JykNCiAgLCBhbkluc3RhbmNlICA9IHJlcXVpcmUoJy4vX2FuLWluc3RhbmNlJykNCiAgLCByZWRlZmluZUFsbCA9IHJlcXVpcmUoJy4vX3JlZGVmaW5lLWFsbCcpDQogICwgaGlkZSAgICAgICAgPSByZXF1aXJlKCcuL19oaWRlJykNCiAgLCBmb3JPZiAgICAgICA9IHJlcXVpcmUoJy4vX2Zvci1vZicpDQogICwgUkVUVVJOICAgICAgPSBmb3JPZi5SRVRVUk47DQoNCnZhciBnZXRNZXRob2QgPSBmdW5jdGlvbihmbil7DQogIHJldHVybiBmbiA9PSBudWxsID8gdW5kZWZpbmVkIDogYUZ1bmN0aW9uKGZuKTsNCn07DQoNCnZhciBjbGVhbnVwU3Vic2NyaXB0aW9uID0gZnVuY3Rpb24oc3Vic2NyaXB0aW9uKXsNCiAgdmFyIGNsZWFudXAgPSBzdWJzY3JpcHRpb24uX2M7DQogIGlmKGNsZWFudXApew0KICAgIHN1YnNjcmlwdGlvbi5fYyA9IHVuZGVmaW5lZDsNCiAgICBjbGVhbnVwKCk7DQogIH0NCn07DQoNCnZhciBzdWJzY3JpcHRpb25DbG9zZWQgPSBmdW5jdGlvbihzdWJzY3JpcHRpb24pew0KICByZXR1cm4gc3Vic2NyaXB0aW9uLl9vID09PSB1bmRlZmluZWQ7DQp9Ow0KDQp2YXIgY2xvc2VTdWJzY3JpcHRpb24gPSBmdW5jdGlvbihzdWJzY3JpcHRpb24pew0KICBpZighc3Vic2NyaXB0aW9uQ2xvc2VkKHN1YnNjcmlwdGlvbikpew0KICAgIHN1YnNjcmlwdGlvbi5fbyA9IHVuZGVmaW5lZDsNCiAgICBjbGVhbnVwU3Vic2NyaXB0aW9uKHN1YnNjcmlwdGlvbik7DQogIH0NCn07DQoNCnZhciBTdWJzY3JpcHRpb24gPSBmdW5jdGlvbihvYnNlcnZlciwgc3Vic2NyaWJlcil7DQogIGFuT2JqZWN0KG9ic2VydmVyKTsNCiAgdGhpcy5fYyA9IHVuZGVmaW5lZDsNCiAgdGhpcy5fbyA9IG9ic2VydmVyOw0KICBvYnNlcnZlciA9IG5ldyBTdWJzY3JpcHRpb25PYnNlcnZlcih0aGlzKTsNCiAgdHJ5IHsNCiAgICB2YXIgY2xlYW51cCAgICAgID0gc3Vic2NyaWJlcihvYnNlcnZlcikNCiAgICAgICwgc3Vic2NyaXB0aW9uID0gY2xlYW51cDsNCiAgICBpZihjbGVhbnVwICE9IG51bGwpew0KICAgICAgaWYodHlwZW9mIGNsZWFudXAudW5zdWJzY3JpYmUgPT09ICdmdW5jdGlvbicpY2xlYW51cCA9IGZ1bmN0aW9uKCl7IHN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpOyB9Ow0KICAgICAgZWxzZSBhRnVuY3Rpb24oY2xlYW51cCk7DQogICAgICB0aGlzLl9jID0gY2xlYW51cDsNCiAgICB9DQogIH0gY2F0Y2goZSl7DQogICAgb2JzZXJ2ZXIuZXJyb3IoZSk7DQogICAgcmV0dXJuOw0KICB9IGlmKHN1YnNjcmlwdGlvbkNsb3NlZCh0aGlzKSljbGVhbnVwU3Vic2NyaXB0aW9uKHRoaXMpOw0KfTsNCg0KU3Vic2NyaXB0aW9uLnByb3RvdHlwZSA9IHJlZGVmaW5lQWxsKHt9LCB7DQogIHVuc3Vic2NyaWJlOiBmdW5jdGlvbiB1bnN1YnNjcmliZSgpeyBjbG9zZVN1YnNjcmlwdGlvbih0aGlzKTsgfQ0KfSk7DQoNCnZhciBTdWJzY3JpcHRpb25PYnNlcnZlciA9IGZ1bmN0aW9uKHN1YnNjcmlwdGlvbil7DQogIHRoaXMuX3MgPSBzdWJzY3JpcHRpb247DQp9Ow0KDQpTdWJzY3JpcHRpb25PYnNlcnZlci5wcm90b3R5cGUgPSByZWRlZmluZUFsbCh7fSwgew0KICBuZXh0OiBmdW5jdGlvbiBuZXh0KHZhbHVlKXsNCiAgICB2YXIgc3Vic2NyaXB0aW9uID0gdGhpcy5fczsNCiAgICBpZighc3Vic2NyaXB0aW9uQ2xvc2VkKHN1YnNjcmlwdGlvbikpew0KICAgICAgdmFyIG9ic2VydmVyID0gc3Vic2NyaXB0aW9uLl9vOw0KICAgICAgdHJ5IHsNCiAgICAgICAgdmFyIG0gPSBnZXRNZXRob2Qob2JzZXJ2ZXIubmV4dCk7DQogICAgICAgIGlmKG0pcmV0dXJuIG0uY2FsbChvYnNlcnZlciwgdmFsdWUpOw0KICAgICAgfSBjYXRjaChlKXsNCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICBjbG9zZVN1YnNjcmlwdGlvbihzdWJzY3JpcHRpb24pOw0KICAgICAgICB9IGZpbmFsbHkgew0KICAgICAgICAgIHRocm93IGU7DQogICAgICAgIH0NCiAgICAgIH0NCiAgICB9DQogIH0sDQogIGVycm9yOiBmdW5jdGlvbiBlcnJvcih2YWx1ZSl7DQogICAgdmFyIHN1YnNjcmlwdGlvbiA9IHRoaXMuX3M7DQogICAgaWYoc3Vic2NyaXB0aW9uQ2xvc2VkKHN1YnNjcmlwdGlvbikpdGhyb3cgdmFsdWU7DQogICAgdmFyIG9ic2VydmVyID0gc3Vic2NyaXB0aW9uLl9vOw0KICAgIHN1YnNjcmlwdGlvbi5fbyA9IHVuZGVmaW5lZDsNCiAgICB0cnkgew0KICAgICAgdmFyIG0gPSBnZXRNZXRob2Qob2JzZXJ2ZXIuZXJyb3IpOw0KICAgICAgaWYoIW0pdGhyb3cgdmFsdWU7DQogICAgICB2YWx1ZSA9IG0uY2FsbChvYnNlcnZlciwgdmFsdWUpOw0KICAgIH0gY2F0Y2goZSl7DQogICAgICB0cnkgew0KICAgICAgICBjbGVhbnVwU3Vic2NyaXB0aW9uKHN1YnNjcmlwdGlvbik7DQogICAgICB9IGZpbmFsbHkgew0KICAgICAgICB0aHJvdyBlOw0KICAgICAgfQ0KICAgIH0gY2xlYW51cFN1YnNjcmlwdGlvbihzdWJzY3JpcHRpb24pOw0KICAgIHJldHVybiB2YWx1ZTsNCiAgfSwNCiAgY29tcGxldGU6IGZ1bmN0aW9uIGNvbXBsZXRlKHZhbHVlKXsNCiAgICB2YXIgc3Vic2NyaXB0aW9uID0gdGhpcy5fczsNCiAgICBpZighc3Vic2NyaXB0aW9uQ2xvc2VkKHN1YnNjcmlwdGlvbikpew0KICAgICAgdmFyIG9ic2VydmVyID0gc3Vic2NyaXB0aW9uLl9vOw0KICAgICAgc3Vic2NyaXB0aW9uLl9vID0gdW5kZWZpbmVkOw0KICAgICAgdHJ5IHsNCiAgICAgICAgdmFyIG0gPSBnZXRNZXRob2Qob2JzZXJ2ZXIuY29tcGxldGUpOw0KICAgICAgICB2YWx1ZSA9IG0gPyBtLmNhbGwob2JzZXJ2ZXIsIHZhbHVlKSA6IHVuZGVmaW5lZDsNCiAgICAgIH0gY2F0Y2goZSl7DQogICAgICAgIHRyeSB7DQogICAgICAgICAgY2xlYW51cFN1YnNjcmlwdGlvbihzdWJzY3JpcHRpb24pOw0KICAgICAgICB9IGZpbmFsbHkgew0KICAgICAgICAgIHRocm93IGU7DQogICAgICAgIH0NCiAgICAgIH0gY2xlYW51cFN1YnNjcmlwdGlvbihzdWJzY3JpcHRpb24pOw0KICAgICAgcmV0dXJuIHZhbHVlOw0KICAgIH0NCiAgfQ0KfSk7DQoNCnZhciAkT2JzZXJ2YWJsZSA9IGZ1bmN0aW9uIE9ic2VydmFibGUoc3Vic2NyaWJlcil7DQogIGFuSW5zdGFuY2UodGhpcywgJE9ic2VydmFibGUsICdPYnNlcnZhYmxlJywgJ19mJykuX2YgPSBhRnVuY3Rpb24oc3Vic2NyaWJlcik7DQp9Ow0KDQpyZWRlZmluZUFsbCgkT2JzZXJ2YWJsZS5wcm90b3R5cGUsIHsNCiAgc3Vic2NyaWJlOiBmdW5jdGlvbiBzdWJzY3JpYmUob2JzZXJ2ZXIpew0KICAgIHJldHVybiBuZXcgU3Vic2NyaXB0aW9uKG9ic2VydmVyLCB0aGlzLl9mKTsNCiAgfSwNCiAgZm9yRWFjaDogZnVuY3Rpb24gZm9yRWFjaChmbil7DQogICAgdmFyIHRoYXQgPSB0aGlzOw0KICAgIHJldHVybiBuZXcgKGNvcmUuUHJvbWlzZSB8fCBnbG9iYWwuUHJvbWlzZSkoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KXsNCiAgICAgIGFGdW5jdGlvbihmbik7DQogICAgICB2YXIgc3Vic2NyaXB0aW9uID0gdGhhdC5zdWJzY3JpYmUoew0KICAgICAgICBuZXh0IDogZnVuY3Rpb24odmFsdWUpew0KICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICByZXR1cm4gZm4odmFsdWUpOw0KICAgICAgICAgIH0gY2F0Y2goZSl7DQogICAgICAgICAgICByZWplY3QoZSk7DQogICAgICAgICAgICBzdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTsNCiAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIGVycm9yOiByZWplY3QsDQogICAgICAgIGNvbXBsZXRlOiByZXNvbHZlDQogICAgICB9KTsNCiAgICB9KTsNCiAgfQ0KfSk7DQoNCnJlZGVmaW5lQWxsKCRPYnNlcnZhYmxlLCB7DQogIGZyb206IGZ1bmN0aW9uIGZyb20oeCl7DQogICAgdmFyIEMgPSB0eXBlb2YgdGhpcyA9PT0gJ2Z1bmN0aW9uJyA/IHRoaXMgOiAkT2JzZXJ2YWJsZTsNCiAgICB2YXIgbWV0aG9kID0gZ2V0TWV0aG9kKGFuT2JqZWN0KHgpW09CU0VSVkFCTEVdKTsNCiAgICBpZihtZXRob2Qpew0KICAgICAgdmFyIG9ic2VydmFibGUgPSBhbk9iamVjdChtZXRob2QuY2FsbCh4KSk7DQogICAgICByZXR1cm4gb2JzZXJ2YWJsZS5jb25zdHJ1Y3RvciA9PT0gQyA/IG9ic2VydmFibGUgOiBuZXcgQyhmdW5jdGlvbihvYnNlcnZlcil7DQogICAgICAgIHJldHVybiBvYnNlcnZhYmxlLnN1YnNjcmliZShvYnNlcnZlcik7DQogICAgICB9KTsNCiAgICB9DQogICAgcmV0dXJuIG5ldyBDKGZ1bmN0aW9uKG9ic2VydmVyKXsNCiAgICAgIHZhciBkb25lID0gZmFsc2U7DQogICAgICBtaWNyb3Rhc2soZnVuY3Rpb24oKXsNCiAgICAgICAgaWYoIWRvbmUpew0KICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICBpZihmb3JPZih4LCBmYWxzZSwgZnVuY3Rpb24oaXQpew0KICAgICAgICAgICAgICBvYnNlcnZlci5uZXh0KGl0KTsNCiAgICAgICAgICAgICAgaWYoZG9uZSlyZXR1cm4gUkVUVVJOOw0KICAgICAgICAgICAgfSkgPT09IFJFVFVSTilyZXR1cm47DQogICAgICAgICAgfSBjYXRjaChlKXsNCiAgICAgICAgICAgIGlmKGRvbmUpdGhyb3cgZTsNCiAgICAgICAgICAgIG9ic2VydmVyLmVycm9yKGUpOw0KICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgIH0gb2JzZXJ2ZXIuY29tcGxldGUoKTsNCiAgICAgICAgfQ0KICAgICAgfSk7DQogICAgICByZXR1cm4gZnVuY3Rpb24oKXsgZG9uZSA9IHRydWU7IH07DQogICAgfSk7DQogIH0sDQogIG9mOiBmdW5jdGlvbiBvZigpew0KICAgIGZvcih2YXIgaSA9IDAsIGwgPSBhcmd1bWVudHMubGVuZ3RoLCBpdGVtcyA9IEFycmF5KGwpOyBpIDwgbDspaXRlbXNbaV0gPSBhcmd1bWVudHNbaSsrXTsNCiAgICByZXR1cm4gbmV3ICh0eXBlb2YgdGhpcyA9PT0gJ2Z1bmN0aW9uJyA/IHRoaXMgOiAkT2JzZXJ2YWJsZSkoZnVuY3Rpb24ob2JzZXJ2ZXIpew0KICAgICAgdmFyIGRvbmUgPSBmYWxzZTsNCiAgICAgIG1pY3JvdGFzayhmdW5jdGlvbigpew0KICAgICAgICBpZighZG9uZSl7DQogICAgICAgICAgZm9yKHZhciBpID0gMDsgaSA8IGl0ZW1zLmxlbmd0aDsgKytpKXsNCiAgICAgICAgICAgIG9ic2VydmVyLm5leHQoaXRlbXNbaV0pOw0KICAgICAgICAgICAgaWYoZG9uZSlyZXR1cm47DQogICAgICAgICAgfSBvYnNlcnZlci5jb21wbGV0ZSgpOw0KICAgICAgICB9DQogICAgICB9KTsNCiAgICAgIHJldHVybiBmdW5jdGlvbigpeyBkb25lID0gdHJ1ZTsgfTsNCiAgICB9KTsNCiAgfQ0KfSk7DQoNCmhpZGUoJE9ic2VydmFibGUucHJvdG90eXBlLCBPQlNFUlZBQkxFLCBmdW5jdGlvbigpeyByZXR1cm4gdGhpczsgfSk7DQoNCiRleHBvcnQoJGV4cG9ydC5HLCB7T2JzZXJ2YWJsZTogJE9ic2VydmFibGV9KTsNCg0KcmVxdWlyZSgnLi9fc2V0LXNwZWNpZXMnKSgnT2JzZXJ2YWJsZScpOw0KfSx7Ii4vX2EtZnVuY3Rpb24iOjMsIi4vX2FuLWluc3RhbmNlIjo2LCIuL19hbi1vYmplY3QiOjcsIi4vX2NvcmUiOjIzLCIuL19leHBvcnQiOjMyLCIuL19mb3Itb2YiOjM3LCIuL19nbG9iYWwiOjM4LCIuL19oaWRlIjo0MCwiLi9fbWljcm90YXNrIjo2NCwiLi9fcmVkZWZpbmUtYWxsIjo4NiwiLi9fc2V0LXNwZWNpZXMiOjkxLCIuL193a3MiOjExN31dLDI3NDpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQp2YXIgbWV0YWRhdGEgICAgICAgICAgICAgICAgICA9IHJlcXVpcmUoJy4vX21ldGFkYXRhJykNCiAgLCBhbk9iamVjdCAgICAgICAgICAgICAgICAgID0gcmVxdWlyZSgnLi9fYW4tb2JqZWN0JykNCiAgLCB0b01ldGFLZXkgICAgICAgICAgICAgICAgID0gbWV0YWRhdGEua2V5DQogICwgb3JkaW5hcnlEZWZpbmVPd25NZXRhZGF0YSA9IG1ldGFkYXRhLnNldDsNCg0KbWV0YWRhdGEuZXhwKHtkZWZpbmVNZXRhZGF0YTogZnVuY3Rpb24gZGVmaW5lTWV0YWRhdGEobWV0YWRhdGFLZXksIG1ldGFkYXRhVmFsdWUsIHRhcmdldCwgdGFyZ2V0S2V5KXsNCiAgb3JkaW5hcnlEZWZpbmVPd25NZXRhZGF0YShtZXRhZGF0YUtleSwgbWV0YWRhdGFWYWx1ZSwgYW5PYmplY3QodGFyZ2V0KSwgdG9NZXRhS2V5KHRhcmdldEtleSkpOw0KfX0pOw0KfSx7Ii4vX2FuLW9iamVjdCI6NywiLi9fbWV0YWRhdGEiOjYzfV0sMjc1OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCnZhciBtZXRhZGF0YSAgICAgICAgICAgICAgID0gcmVxdWlyZSgnLi9fbWV0YWRhdGEnKQ0KICAsIGFuT2JqZWN0ICAgICAgICAgICAgICAgPSByZXF1aXJlKCcuL19hbi1vYmplY3QnKQ0KICAsIHRvTWV0YUtleSAgICAgICAgICAgICAgPSBtZXRhZGF0YS5rZXkNCiAgLCBnZXRPckNyZWF0ZU1ldGFkYXRhTWFwID0gbWV0YWRhdGEubWFwDQogICwgc3RvcmUgICAgICAgICAgICAgICAgICA9IG1ldGFkYXRhLnN0b3JlOw0KDQptZXRhZGF0YS5leHAoe2RlbGV0ZU1ldGFkYXRhOiBmdW5jdGlvbiBkZWxldGVNZXRhZGF0YShtZXRhZGF0YUtleSwgdGFyZ2V0IC8qLCB0YXJnZXRLZXkgKi8pew0KICB2YXIgdGFyZ2V0S2V5ICAgPSBhcmd1bWVudHMubGVuZ3RoIDwgMyA/IHVuZGVmaW5lZCA6IHRvTWV0YUtleShhcmd1bWVudHNbMl0pDQogICAgLCBtZXRhZGF0YU1hcCA9IGdldE9yQ3JlYXRlTWV0YWRhdGFNYXAoYW5PYmplY3QodGFyZ2V0KSwgdGFyZ2V0S2V5LCBmYWxzZSk7DQogIGlmKG1ldGFkYXRhTWFwID09PSB1bmRlZmluZWQgfHwgIW1ldGFkYXRhTWFwWydkZWxldGUnXShtZXRhZGF0YUtleSkpcmV0dXJuIGZhbHNlOw0KICBpZihtZXRhZGF0YU1hcC5zaXplKXJldHVybiB0cnVlOw0KICB2YXIgdGFyZ2V0TWV0YWRhdGEgPSBzdG9yZS5nZXQodGFyZ2V0KTsNCiAgdGFyZ2V0TWV0YWRhdGFbJ2RlbGV0ZSddKHRhcmdldEtleSk7DQogIHJldHVybiAhIXRhcmdldE1ldGFkYXRhLnNpemUgfHwgc3RvcmVbJ2RlbGV0ZSddKHRhcmdldCk7DQp9fSk7DQp9LHsiLi9fYW4tb2JqZWN0Ijo3LCIuL19tZXRhZGF0YSI6NjN9XSwyNzY6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KdmFyIFNldCAgICAgICAgICAgICAgICAgICAgID0gcmVxdWlyZSgnLi9lczYuc2V0JykNCiAgLCBmcm9tICAgICAgICAgICAgICAgICAgICA9IHJlcXVpcmUoJy4vX2FycmF5LWZyb20taXRlcmFibGUnKQ0KICAsIG1ldGFkYXRhICAgICAgICAgICAgICAgID0gcmVxdWlyZSgnLi9fbWV0YWRhdGEnKQ0KICAsIGFuT2JqZWN0ICAgICAgICAgICAgICAgID0gcmVxdWlyZSgnLi9fYW4tb2JqZWN0JykNCiAgLCBnZXRQcm90b3R5cGVPZiAgICAgICAgICA9IHJlcXVpcmUoJy4vX29iamVjdC1ncG8nKQ0KICAsIG9yZGluYXJ5T3duTWV0YWRhdGFLZXlzID0gbWV0YWRhdGEua2V5cw0KICAsIHRvTWV0YUtleSAgICAgICAgICAgICAgID0gbWV0YWRhdGEua2V5Ow0KDQp2YXIgb3JkaW5hcnlNZXRhZGF0YUtleXMgPSBmdW5jdGlvbihPLCBQKXsNCiAgdmFyIG9LZXlzICA9IG9yZGluYXJ5T3duTWV0YWRhdGFLZXlzKE8sIFApDQogICAgLCBwYXJlbnQgPSBnZXRQcm90b3R5cGVPZihPKTsNCiAgaWYocGFyZW50ID09PSBudWxsKXJldHVybiBvS2V5czsNCiAgdmFyIHBLZXlzICA9IG9yZGluYXJ5TWV0YWRhdGFLZXlzKHBhcmVudCwgUCk7DQogIHJldHVybiBwS2V5cy5sZW5ndGggPyBvS2V5cy5sZW5ndGggPyBmcm9tKG5ldyBTZXQob0tleXMuY29uY2F0KHBLZXlzKSkpIDogcEtleXMgOiBvS2V5czsNCn07DQoNCm1ldGFkYXRhLmV4cCh7Z2V0TWV0YWRhdGFLZXlzOiBmdW5jdGlvbiBnZXRNZXRhZGF0YUtleXModGFyZ2V0IC8qLCB0YXJnZXRLZXkgKi8pew0KICByZXR1cm4gb3JkaW5hcnlNZXRhZGF0YUtleXMoYW5PYmplY3QodGFyZ2V0KSwgYXJndW1lbnRzLmxlbmd0aCA8IDIgPyB1bmRlZmluZWQgOiB0b01ldGFLZXkoYXJndW1lbnRzWzFdKSk7DQp9fSk7DQp9LHsiLi9fYW4tb2JqZWN0Ijo3LCIuL19hcnJheS1mcm9tLWl0ZXJhYmxlIjoxMCwiLi9fbWV0YWRhdGEiOjYzLCIuL19vYmplY3QtZ3BvIjo3NCwiLi9lczYuc2V0IjoyMjF9XSwyNzc6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KdmFyIG1ldGFkYXRhICAgICAgICAgICAgICAgPSByZXF1aXJlKCcuL19tZXRhZGF0YScpDQogICwgYW5PYmplY3QgICAgICAgICAgICAgICA9IHJlcXVpcmUoJy4vX2FuLW9iamVjdCcpDQogICwgZ2V0UHJvdG90eXBlT2YgICAgICAgICA9IHJlcXVpcmUoJy4vX29iamVjdC1ncG8nKQ0KICAsIG9yZGluYXJ5SGFzT3duTWV0YWRhdGEgPSBtZXRhZGF0YS5oYXMNCiAgLCBvcmRpbmFyeUdldE93bk1ldGFkYXRhID0gbWV0YWRhdGEuZ2V0DQogICwgdG9NZXRhS2V5ICAgICAgICAgICAgICA9IG1ldGFkYXRhLmtleTsNCg0KdmFyIG9yZGluYXJ5R2V0TWV0YWRhdGEgPSBmdW5jdGlvbihNZXRhZGF0YUtleSwgTywgUCl7DQogIHZhciBoYXNPd24gPSBvcmRpbmFyeUhhc093bk1ldGFkYXRhKE1ldGFkYXRhS2V5LCBPLCBQKTsNCiAgaWYoaGFzT3duKXJldHVybiBvcmRpbmFyeUdldE93bk1ldGFkYXRhKE1ldGFkYXRhS2V5LCBPLCBQKTsNCiAgdmFyIHBhcmVudCA9IGdldFByb3RvdHlwZU9mKE8pOw0KICByZXR1cm4gcGFyZW50ICE9PSBudWxsID8gb3JkaW5hcnlHZXRNZXRhZGF0YShNZXRhZGF0YUtleSwgcGFyZW50LCBQKSA6IHVuZGVmaW5lZDsNCn07DQoNCm1ldGFkYXRhLmV4cCh7Z2V0TWV0YWRhdGE6IGZ1bmN0aW9uIGdldE1ldGFkYXRhKG1ldGFkYXRhS2V5LCB0YXJnZXQgLyosIHRhcmdldEtleSAqLyl7DQogIHJldHVybiBvcmRpbmFyeUdldE1ldGFkYXRhKG1ldGFkYXRhS2V5LCBhbk9iamVjdCh0YXJnZXQpLCBhcmd1bWVudHMubGVuZ3RoIDwgMyA/IHVuZGVmaW5lZCA6IHRvTWV0YUtleShhcmd1bWVudHNbMl0pKTsNCn19KTsNCn0seyIuL19hbi1vYmplY3QiOjcsIi4vX21ldGFkYXRhIjo2MywiLi9fb2JqZWN0LWdwbyI6NzR9XSwyNzg6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KdmFyIG1ldGFkYXRhICAgICAgICAgICAgICAgID0gcmVxdWlyZSgnLi9fbWV0YWRhdGEnKQ0KICAsIGFuT2JqZWN0ICAgICAgICAgICAgICAgID0gcmVxdWlyZSgnLi9fYW4tb2JqZWN0JykNCiAgLCBvcmRpbmFyeU93bk1ldGFkYXRhS2V5cyA9IG1ldGFkYXRhLmtleXMNCiAgLCB0b01ldGFLZXkgICAgICAgICAgICAgICA9IG1ldGFkYXRhLmtleTsNCg0KbWV0YWRhdGEuZXhwKHtnZXRPd25NZXRhZGF0YUtleXM6IGZ1bmN0aW9uIGdldE93bk1ldGFkYXRhS2V5cyh0YXJnZXQgLyosIHRhcmdldEtleSAqLyl7DQogIHJldHVybiBvcmRpbmFyeU93bk1ldGFkYXRhS2V5cyhhbk9iamVjdCh0YXJnZXQpLCBhcmd1bWVudHMubGVuZ3RoIDwgMiA/IHVuZGVmaW5lZCA6IHRvTWV0YUtleShhcmd1bWVudHNbMV0pKTsNCn19KTsNCn0seyIuL19hbi1vYmplY3QiOjcsIi4vX21ldGFkYXRhIjo2M31dLDI3OTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQp2YXIgbWV0YWRhdGEgICAgICAgICAgICAgICA9IHJlcXVpcmUoJy4vX21ldGFkYXRhJykNCiAgLCBhbk9iamVjdCAgICAgICAgICAgICAgID0gcmVxdWlyZSgnLi9fYW4tb2JqZWN0JykNCiAgLCBvcmRpbmFyeUdldE93bk1ldGFkYXRhID0gbWV0YWRhdGEuZ2V0DQogICwgdG9NZXRhS2V5ICAgICAgICAgICAgICA9IG1ldGFkYXRhLmtleTsNCg0KbWV0YWRhdGEuZXhwKHtnZXRPd25NZXRhZGF0YTogZnVuY3Rpb24gZ2V0T3duTWV0YWRhdGEobWV0YWRhdGFLZXksIHRhcmdldCAvKiwgdGFyZ2V0S2V5ICovKXsNCiAgcmV0dXJuIG9yZGluYXJ5R2V0T3duTWV0YWRhdGEobWV0YWRhdGFLZXksIGFuT2JqZWN0KHRhcmdldCkNCiAgICAsIGFyZ3VtZW50cy5sZW5ndGggPCAzID8gdW5kZWZpbmVkIDogdG9NZXRhS2V5KGFyZ3VtZW50c1syXSkpOw0KfX0pOw0KfSx7Ii4vX2FuLW9iamVjdCI6NywiLi9fbWV0YWRhdGEiOjYzfV0sMjgwOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCnZhciBtZXRhZGF0YSAgICAgICAgICAgICAgID0gcmVxdWlyZSgnLi9fbWV0YWRhdGEnKQ0KICAsIGFuT2JqZWN0ICAgICAgICAgICAgICAgPSByZXF1aXJlKCcuL19hbi1vYmplY3QnKQ0KICAsIGdldFByb3RvdHlwZU9mICAgICAgICAgPSByZXF1aXJlKCcuL19vYmplY3QtZ3BvJykNCiAgLCBvcmRpbmFyeUhhc093bk1ldGFkYXRhID0gbWV0YWRhdGEuaGFzDQogICwgdG9NZXRhS2V5ICAgICAgICAgICAgICA9IG1ldGFkYXRhLmtleTsNCg0KdmFyIG9yZGluYXJ5SGFzTWV0YWRhdGEgPSBmdW5jdGlvbihNZXRhZGF0YUtleSwgTywgUCl7DQogIHZhciBoYXNPd24gPSBvcmRpbmFyeUhhc093bk1ldGFkYXRhKE1ldGFkYXRhS2V5LCBPLCBQKTsNCiAgaWYoaGFzT3duKXJldHVybiB0cnVlOw0KICB2YXIgcGFyZW50ID0gZ2V0UHJvdG90eXBlT2YoTyk7DQogIHJldHVybiBwYXJlbnQgIT09IG51bGwgPyBvcmRpbmFyeUhhc01ldGFkYXRhKE1ldGFkYXRhS2V5LCBwYXJlbnQsIFApIDogZmFsc2U7DQp9Ow0KDQptZXRhZGF0YS5leHAoe2hhc01ldGFkYXRhOiBmdW5jdGlvbiBoYXNNZXRhZGF0YShtZXRhZGF0YUtleSwgdGFyZ2V0IC8qLCB0YXJnZXRLZXkgKi8pew0KICByZXR1cm4gb3JkaW5hcnlIYXNNZXRhZGF0YShtZXRhZGF0YUtleSwgYW5PYmplY3QodGFyZ2V0KSwgYXJndW1lbnRzLmxlbmd0aCA8IDMgPyB1bmRlZmluZWQgOiB0b01ldGFLZXkoYXJndW1lbnRzWzJdKSk7DQp9fSk7DQp9LHsiLi9fYW4tb2JqZWN0Ijo3LCIuL19tZXRhZGF0YSI6NjMsIi4vX29iamVjdC1ncG8iOjc0fV0sMjgxOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCnZhciBtZXRhZGF0YSAgICAgICAgICAgICAgID0gcmVxdWlyZSgnLi9fbWV0YWRhdGEnKQ0KICAsIGFuT2JqZWN0ICAgICAgICAgICAgICAgPSByZXF1aXJlKCcuL19hbi1vYmplY3QnKQ0KICAsIG9yZGluYXJ5SGFzT3duTWV0YWRhdGEgPSBtZXRhZGF0YS5oYXMNCiAgLCB0b01ldGFLZXkgICAgICAgICAgICAgID0gbWV0YWRhdGEua2V5Ow0KDQptZXRhZGF0YS5leHAoe2hhc093bk1ldGFkYXRhOiBmdW5jdGlvbiBoYXNPd25NZXRhZGF0YShtZXRhZGF0YUtleSwgdGFyZ2V0IC8qLCB0YXJnZXRLZXkgKi8pew0KICByZXR1cm4gb3JkaW5hcnlIYXNPd25NZXRhZGF0YShtZXRhZGF0YUtleSwgYW5PYmplY3QodGFyZ2V0KQ0KICAgICwgYXJndW1lbnRzLmxlbmd0aCA8IDMgPyB1bmRlZmluZWQgOiB0b01ldGFLZXkoYXJndW1lbnRzWzJdKSk7DQp9fSk7DQp9LHsiLi9fYW4tb2JqZWN0Ijo3LCIuL19tZXRhZGF0YSI6NjN9XSwyODI6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KdmFyIG1ldGFkYXRhICAgICAgICAgICAgICAgICAgPSByZXF1aXJlKCcuL19tZXRhZGF0YScpDQogICwgYW5PYmplY3QgICAgICAgICAgICAgICAgICA9IHJlcXVpcmUoJy4vX2FuLW9iamVjdCcpDQogICwgYUZ1bmN0aW9uICAgICAgICAgICAgICAgICA9IHJlcXVpcmUoJy4vX2EtZnVuY3Rpb24nKQ0KICAsIHRvTWV0YUtleSAgICAgICAgICAgICAgICAgPSBtZXRhZGF0YS5rZXkNCiAgLCBvcmRpbmFyeURlZmluZU93bk1ldGFkYXRhID0gbWV0YWRhdGEuc2V0Ow0KDQptZXRhZGF0YS5leHAoe21ldGFkYXRhOiBmdW5jdGlvbiBtZXRhZGF0YShtZXRhZGF0YUtleSwgbWV0YWRhdGFWYWx1ZSl7DQogIHJldHVybiBmdW5jdGlvbiBkZWNvcmF0b3IodGFyZ2V0LCB0YXJnZXRLZXkpew0KICAgIG9yZGluYXJ5RGVmaW5lT3duTWV0YWRhdGEoDQogICAgICBtZXRhZGF0YUtleSwgbWV0YWRhdGFWYWx1ZSwNCiAgICAgICh0YXJnZXRLZXkgIT09IHVuZGVmaW5lZCA/IGFuT2JqZWN0IDogYUZ1bmN0aW9uKSh0YXJnZXQpLA0KICAgICAgdG9NZXRhS2V5KHRhcmdldEtleSkNCiAgICApOw0KICB9Ow0KfX0pOw0KfSx7Ii4vX2EtZnVuY3Rpb24iOjMsIi4vX2FuLW9iamVjdCI6NywiLi9fbWV0YWRhdGEiOjYzfV0sMjgzOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCi8vIGh0dHBzOi8vZ2l0aHViLmNvbS9EYXZpZEJydWFudC9NYXAtU2V0LnByb3RvdHlwZS50b0pTT04NCnZhciAkZXhwb3J0ICA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpOw0KDQokZXhwb3J0KCRleHBvcnQuUCArICRleHBvcnQuUiwgJ1NldCcsIHt0b0pTT046IHJlcXVpcmUoJy4vX2NvbGxlY3Rpb24tdG8tanNvbicpKCdTZXQnKX0pOw0KfSx7Ii4vX2NvbGxlY3Rpb24tdG8tanNvbiI6MjAsIi4vX2V4cG9ydCI6MzJ9XSwyODQ6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KJ3VzZSBzdHJpY3QnOw0KLy8gaHR0cHM6Ly9naXRodWIuY29tL21hdGhpYXNieW5lbnMvU3RyaW5nLnByb3RvdHlwZS5hdA0KdmFyICRleHBvcnQgPSByZXF1aXJlKCcuL19leHBvcnQnKQ0KICAsICRhdCAgICAgPSByZXF1aXJlKCcuL19zdHJpbmctYXQnKSh0cnVlKTsNCg0KJGV4cG9ydCgkZXhwb3J0LlAsICdTdHJpbmcnLCB7DQogIGF0OiBmdW5jdGlvbiBhdChwb3Mpew0KICAgIHJldHVybiAkYXQodGhpcywgcG9zKTsNCiAgfQ0KfSk7DQp9LHsiLi9fZXhwb3J0IjozMiwiLi9fc3RyaW5nLWF0Ijo5N31dLDI4NTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQondXNlIHN0cmljdCc7DQovLyBodHRwczovL3RjMzkuZ2l0aHViLmlvL1N0cmluZy5wcm90b3R5cGUubWF0Y2hBbGwvDQp2YXIgJGV4cG9ydCAgICAgPSByZXF1aXJlKCcuL19leHBvcnQnKQ0KICAsIGRlZmluZWQgICAgID0gcmVxdWlyZSgnLi9fZGVmaW5lZCcpDQogICwgdG9MZW5ndGggICAgPSByZXF1aXJlKCcuL190by1sZW5ndGgnKQ0KICAsIGlzUmVnRXhwICAgID0gcmVxdWlyZSgnLi9faXMtcmVnZXhwJykNCiAgLCBnZXRGbGFncyAgICA9IHJlcXVpcmUoJy4vX2ZsYWdzJykNCiAgLCBSZWdFeHBQcm90byA9IFJlZ0V4cC5wcm90b3R5cGU7DQoNCnZhciAkUmVnRXhwU3RyaW5nSXRlcmF0b3IgPSBmdW5jdGlvbihyZWdleHAsIHN0cmluZyl7DQogIHRoaXMuX3IgPSByZWdleHA7DQogIHRoaXMuX3MgPSBzdHJpbmc7DQp9Ow0KDQpyZXF1aXJlKCcuL19pdGVyLWNyZWF0ZScpKCRSZWdFeHBTdHJpbmdJdGVyYXRvciwgJ1JlZ0V4cCBTdHJpbmcnLCBmdW5jdGlvbiBuZXh0KCl7DQogIHZhciBtYXRjaCA9IHRoaXMuX3IuZXhlYyh0aGlzLl9zKTsNCiAgcmV0dXJuIHt2YWx1ZTogbWF0Y2gsIGRvbmU6IG1hdGNoID09PSBudWxsfTsNCn0pOw0KDQokZXhwb3J0KCRleHBvcnQuUCwgJ1N0cmluZycsIHsNCiAgbWF0Y2hBbGw6IGZ1bmN0aW9uIG1hdGNoQWxsKHJlZ2V4cCl7DQogICAgZGVmaW5lZCh0aGlzKTsNCiAgICBpZighaXNSZWdFeHAocmVnZXhwKSl0aHJvdyBUeXBlRXJyb3IocmVnZXhwICsgJyBpcyBub3QgYSByZWdleHAhJyk7DQogICAgdmFyIFMgICAgID0gU3RyaW5nKHRoaXMpDQogICAgICAsIGZsYWdzID0gJ2ZsYWdzJyBpbiBSZWdFeHBQcm90byA/IFN0cmluZyhyZWdleHAuZmxhZ3MpIDogZ2V0RmxhZ3MuY2FsbChyZWdleHApDQogICAgICAsIHJ4ICAgID0gbmV3IFJlZ0V4cChyZWdleHAuc291cmNlLCB+ZmxhZ3MuaW5kZXhPZignZycpID8gZmxhZ3MgOiAnZycgKyBmbGFncyk7DQogICAgcngubGFzdEluZGV4ID0gdG9MZW5ndGgocmVnZXhwLmxhc3RJbmRleCk7DQogICAgcmV0dXJuIG5ldyAkUmVnRXhwU3RyaW5nSXRlcmF0b3IocngsIFMpOw0KICB9DQp9KTsNCn0seyIuL19kZWZpbmVkIjoyNywiLi9fZXhwb3J0IjozMiwiLi9fZmxhZ3MiOjM2LCIuL19pcy1yZWdleHAiOjUwLCIuL19pdGVyLWNyZWF0ZSI6NTIsIi4vX3RvLWxlbmd0aCI6MTA4fV0sMjg2OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCid1c2Ugc3RyaWN0JzsNCi8vIGh0dHBzOi8vZ2l0aHViLmNvbS90YzM5L3Byb3Bvc2FsLXN0cmluZy1wYWQtc3RhcnQtZW5kDQp2YXIgJGV4cG9ydCA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpDQogICwgJHBhZCAgICA9IHJlcXVpcmUoJy4vX3N0cmluZy1wYWQnKTsNCg0KJGV4cG9ydCgkZXhwb3J0LlAsICdTdHJpbmcnLCB7DQogIHBhZEVuZDogZnVuY3Rpb24gcGFkRW5kKG1heExlbmd0aCAvKiwgZmlsbFN0cmluZyA9ICcgJyAqLyl7DQogICAgcmV0dXJuICRwYWQodGhpcywgbWF4TGVuZ3RoLCBhcmd1bWVudHMubGVuZ3RoID4gMSA/IGFyZ3VtZW50c1sxXSA6IHVuZGVmaW5lZCwgZmFsc2UpOw0KICB9DQp9KTsNCn0seyIuL19leHBvcnQiOjMyLCIuL19zdHJpbmctcGFkIjoxMDB9XSwyODc6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KJ3VzZSBzdHJpY3QnOw0KLy8gaHR0cHM6Ly9naXRodWIuY29tL3RjMzkvcHJvcG9zYWwtc3RyaW5nLXBhZC1zdGFydC1lbmQNCnZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0JykNCiAgLCAkcGFkICAgID0gcmVxdWlyZSgnLi9fc3RyaW5nLXBhZCcpOw0KDQokZXhwb3J0KCRleHBvcnQuUCwgJ1N0cmluZycsIHsNCiAgcGFkU3RhcnQ6IGZ1bmN0aW9uIHBhZFN0YXJ0KG1heExlbmd0aCAvKiwgZmlsbFN0cmluZyA9ICcgJyAqLyl7DQogICAgcmV0dXJuICRwYWQodGhpcywgbWF4TGVuZ3RoLCBhcmd1bWVudHMubGVuZ3RoID4gMSA/IGFyZ3VtZW50c1sxXSA6IHVuZGVmaW5lZCwgdHJ1ZSk7DQogIH0NCn0pOw0KfSx7Ii4vX2V4cG9ydCI6MzIsIi4vX3N0cmluZy1wYWQiOjEwMH1dLDI4ODpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQondXNlIHN0cmljdCc7DQovLyBodHRwczovL2dpdGh1Yi5jb20vc2VibWFya2JhZ2UvZWNtYXNjcmlwdC1zdHJpbmctbGVmdC1yaWdodC10cmltDQpyZXF1aXJlKCcuL19zdHJpbmctdHJpbScpKCd0cmltTGVmdCcsIGZ1bmN0aW9uKCR0cmltKXsNCiAgcmV0dXJuIGZ1bmN0aW9uIHRyaW1MZWZ0KCl7DQogICAgcmV0dXJuICR0cmltKHRoaXMsIDEpOw0KICB9Ow0KfSwgJ3RyaW1TdGFydCcpOw0KfSx7Ii4vX3N0cmluZy10cmltIjoxMDJ9XSwyODk6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KJ3VzZSBzdHJpY3QnOw0KLy8gaHR0cHM6Ly9naXRodWIuY29tL3NlYm1hcmtiYWdlL2VjbWFzY3JpcHQtc3RyaW5nLWxlZnQtcmlnaHQtdHJpbQ0KcmVxdWlyZSgnLi9fc3RyaW5nLXRyaW0nKSgndHJpbVJpZ2h0JywgZnVuY3Rpb24oJHRyaW0pew0KICByZXR1cm4gZnVuY3Rpb24gdHJpbVJpZ2h0KCl7DQogICAgcmV0dXJuICR0cmltKHRoaXMsIDIpOw0KICB9Ow0KfSwgJ3RyaW1FbmQnKTsNCn0seyIuL19zdHJpbmctdHJpbSI6MTAyfV0sMjkwOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCnJlcXVpcmUoJy4vX3drcy1kZWZpbmUnKSgnYXN5bmNJdGVyYXRvcicpOw0KfSx7Ii4vX3drcy1kZWZpbmUiOjExNX1dLDI5MTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQpyZXF1aXJlKCcuL193a3MtZGVmaW5lJykoJ29ic2VydmFibGUnKTsNCn0seyIuL193a3MtZGVmaW5lIjoxMTV9XSwyOTI6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KLy8gaHR0cHM6Ly9naXRodWIuY29tL2xqaGFyYi9wcm9wb3NhbC1nbG9iYWwNCnZhciAkZXhwb3J0ID0gcmVxdWlyZSgnLi9fZXhwb3J0Jyk7DQoNCiRleHBvcnQoJGV4cG9ydC5TLCAnU3lzdGVtJywge2dsb2JhbDogcmVxdWlyZSgnLi9fZ2xvYmFsJyl9KTsNCn0seyIuL19leHBvcnQiOjMyLCIuL19nbG9iYWwiOjM4fV0sMjkzOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCnZhciAkaXRlcmF0b3JzICAgID0gcmVxdWlyZSgnLi9lczYuYXJyYXkuaXRlcmF0b3InKQ0KICAsIHJlZGVmaW5lICAgICAgPSByZXF1aXJlKCcuL19yZWRlZmluZScpDQogICwgZ2xvYmFsICAgICAgICA9IHJlcXVpcmUoJy4vX2dsb2JhbCcpDQogICwgaGlkZSAgICAgICAgICA9IHJlcXVpcmUoJy4vX2hpZGUnKQ0KICAsIEl0ZXJhdG9ycyAgICAgPSByZXF1aXJlKCcuL19pdGVyYXRvcnMnKQ0KICAsIHdrcyAgICAgICAgICAgPSByZXF1aXJlKCcuL193a3MnKQ0KICAsIElURVJBVE9SICAgICAgPSB3a3MoJ2l0ZXJhdG9yJykNCiAgLCBUT19TVFJJTkdfVEFHID0gd2tzKCd0b1N0cmluZ1RhZycpDQogICwgQXJyYXlWYWx1ZXMgICA9IEl0ZXJhdG9ycy5BcnJheTsNCg0KZm9yKHZhciBjb2xsZWN0aW9ucyA9IFsnTm9kZUxpc3QnLCAnRE9NVG9rZW5MaXN0JywgJ01lZGlhTGlzdCcsICdTdHlsZVNoZWV0TGlzdCcsICdDU1NSdWxlTGlzdCddLCBpID0gMDsgaSA8IDU7IGkrKyl7DQogIHZhciBOQU1FICAgICAgID0gY29sbGVjdGlvbnNbaV0NCiAgICAsIENvbGxlY3Rpb24gPSBnbG9iYWxbTkFNRV0NCiAgICAsIHByb3RvICAgICAgPSBDb2xsZWN0aW9uICYmIENvbGxlY3Rpb24ucHJvdG90eXBlDQogICAgLCBrZXk7DQogIGlmKHByb3RvKXsNCiAgICBpZighcHJvdG9bSVRFUkFUT1JdKWhpZGUocHJvdG8sIElURVJBVE9SLCBBcnJheVZhbHVlcyk7DQogICAgaWYoIXByb3RvW1RPX1NUUklOR19UQUddKWhpZGUocHJvdG8sIFRPX1NUUklOR19UQUcsIE5BTUUpOw0KICAgIEl0ZXJhdG9yc1tOQU1FXSA9IEFycmF5VmFsdWVzOw0KICAgIGZvcihrZXkgaW4gJGl0ZXJhdG9ycylpZighcHJvdG9ba2V5XSlyZWRlZmluZShwcm90bywga2V5LCAkaXRlcmF0b3JzW2tleV0sIHRydWUpOw0KICB9DQp9DQp9LHsiLi9fZ2xvYmFsIjozOCwiLi9faGlkZSI6NDAsIi4vX2l0ZXJhdG9ycyI6NTYsIi4vX3JlZGVmaW5lIjo4NywiLi9fd2tzIjoxMTcsIi4vZXM2LmFycmF5Lml0ZXJhdG9yIjoxMzF9XSwyOTQ6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KdmFyICRleHBvcnQgPSByZXF1aXJlKCcuL19leHBvcnQnKQ0KICAsICR0YXNrICAgPSByZXF1aXJlKCcuL190YXNrJyk7DQokZXhwb3J0KCRleHBvcnQuRyArICRleHBvcnQuQiwgew0KICBzZXRJbW1lZGlhdGU6ICAgJHRhc2suc2V0LA0KICBjbGVhckltbWVkaWF0ZTogJHRhc2suY2xlYXINCn0pOw0KfSx7Ii4vX2V4cG9ydCI6MzIsIi4vX3Rhc2siOjEwNH1dLDI5NTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQovLyBpZTktIHNldFRpbWVvdXQgJiBzZXRJbnRlcnZhbCBhZGRpdGlvbmFsIHBhcmFtZXRlcnMgZml4DQp2YXIgZ2xvYmFsICAgICA9IHJlcXVpcmUoJy4vX2dsb2JhbCcpDQogICwgJGV4cG9ydCAgICA9IHJlcXVpcmUoJy4vX2V4cG9ydCcpDQogICwgaW52b2tlICAgICA9IHJlcXVpcmUoJy4vX2ludm9rZScpDQogICwgcGFydGlhbCAgICA9IHJlcXVpcmUoJy4vX3BhcnRpYWwnKQ0KICAsIG5hdmlnYXRvciAgPSBnbG9iYWwubmF2aWdhdG9yDQogICwgTVNJRSAgICAgICA9ICEhbmF2aWdhdG9yICYmIC9NU0lFIC5cLi8udGVzdChuYXZpZ2F0b3IudXNlckFnZW50KTsgLy8gPC0gZGlydHkgaWU5LSBjaGVjaw0KdmFyIHdyYXAgPSBmdW5jdGlvbihzZXQpew0KICByZXR1cm4gTVNJRSA/IGZ1bmN0aW9uKGZuLCB0aW1lIC8qLCAuLi5hcmdzICovKXsNCiAgICByZXR1cm4gc2V0KGludm9rZSgNCiAgICAgIHBhcnRpYWwsDQogICAgICBbXS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMiksDQogICAgICB0eXBlb2YgZm4gPT0gJ2Z1bmN0aW9uJyA/IGZuIDogRnVuY3Rpb24oZm4pDQogICAgKSwgdGltZSk7DQogIH0gOiBzZXQ7DQp9Ow0KJGV4cG9ydCgkZXhwb3J0LkcgKyAkZXhwb3J0LkIgKyAkZXhwb3J0LkYgKiBNU0lFLCB7DQogIHNldFRpbWVvdXQ6ICB3cmFwKGdsb2JhbC5zZXRUaW1lb3V0KSwNCiAgc2V0SW50ZXJ2YWw6IHdyYXAoZ2xvYmFsLnNldEludGVydmFsKQ0KfSk7DQp9LHsiLi9fZXhwb3J0IjozMiwiLi9fZ2xvYmFsIjozOCwiLi9faW52b2tlIjo0NCwiLi9fcGFydGlhbCI6ODN9XSwyOTY6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KcmVxdWlyZSgnLi9tb2R1bGVzL2VzNi5zeW1ib2wnKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczYub2JqZWN0LmNyZWF0ZScpOw0KcmVxdWlyZSgnLi9tb2R1bGVzL2VzNi5vYmplY3QuZGVmaW5lLXByb3BlcnR5Jyk7DQpyZXF1aXJlKCcuL21vZHVsZXMvZXM2Lm9iamVjdC5kZWZpbmUtcHJvcGVydGllcycpOw0KcmVxdWlyZSgnLi9tb2R1bGVzL2VzNi5vYmplY3QuZ2V0LW93bi1wcm9wZXJ0eS1kZXNjcmlwdG9yJyk7DQpyZXF1aXJlKCcuL21vZHVsZXMvZXM2Lm9iamVjdC5nZXQtcHJvdG90eXBlLW9mJyk7DQpyZXF1aXJlKCcuL21vZHVsZXMvZXM2Lm9iamVjdC5rZXlzJyk7DQpyZXF1aXJlKCcuL21vZHVsZXMvZXM2Lm9iamVjdC5nZXQtb3duLXByb3BlcnR5LW5hbWVzJyk7DQpyZXF1aXJlKCcuL21vZHVsZXMvZXM2Lm9iamVjdC5mcmVlemUnKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczYub2JqZWN0LnNlYWwnKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczYub2JqZWN0LnByZXZlbnQtZXh0ZW5zaW9ucycpOw0KcmVxdWlyZSgnLi9tb2R1bGVzL2VzNi5vYmplY3QuaXMtZnJvemVuJyk7DQpyZXF1aXJlKCcuL21vZHVsZXMvZXM2Lm9iamVjdC5pcy1zZWFsZWQnKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczYub2JqZWN0LmlzLWV4dGVuc2libGUnKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczYub2JqZWN0LmFzc2lnbicpOw0KcmVxdWlyZSgnLi9tb2R1bGVzL2VzNi5vYmplY3QuaXMnKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczYub2JqZWN0LnNldC1wcm90b3R5cGUtb2YnKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczYub2JqZWN0LnRvLXN0cmluZycpOw0KcmVxdWlyZSgnLi9tb2R1bGVzL2VzNi5mdW5jdGlvbi5iaW5kJyk7DQpyZXF1aXJlKCcuL21vZHVsZXMvZXM2LmZ1bmN0aW9uLm5hbWUnKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczYuZnVuY3Rpb24uaGFzLWluc3RhbmNlJyk7DQpyZXF1aXJlKCcuL21vZHVsZXMvZXM2LnBhcnNlLWludCcpOw0KcmVxdWlyZSgnLi9tb2R1bGVzL2VzNi5wYXJzZS1mbG9hdCcpOw0KcmVxdWlyZSgnLi9tb2R1bGVzL2VzNi5udW1iZXIuY29uc3RydWN0b3InKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczYubnVtYmVyLnRvLWZpeGVkJyk7DQpyZXF1aXJlKCcuL21vZHVsZXMvZXM2Lm51bWJlci50by1wcmVjaXNpb24nKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczYubnVtYmVyLmVwc2lsb24nKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczYubnVtYmVyLmlzLWZpbml0ZScpOw0KcmVxdWlyZSgnLi9tb2R1bGVzL2VzNi5udW1iZXIuaXMtaW50ZWdlcicpOw0KcmVxdWlyZSgnLi9tb2R1bGVzL2VzNi5udW1iZXIuaXMtbmFuJyk7DQpyZXF1aXJlKCcuL21vZHVsZXMvZXM2Lm51bWJlci5pcy1zYWZlLWludGVnZXInKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczYubnVtYmVyLm1heC1zYWZlLWludGVnZXInKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczYubnVtYmVyLm1pbi1zYWZlLWludGVnZXInKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczYubnVtYmVyLnBhcnNlLWZsb2F0Jyk7DQpyZXF1aXJlKCcuL21vZHVsZXMvZXM2Lm51bWJlci5wYXJzZS1pbnQnKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczYubWF0aC5hY29zaCcpOw0KcmVxdWlyZSgnLi9tb2R1bGVzL2VzNi5tYXRoLmFzaW5oJyk7DQpyZXF1aXJlKCcuL21vZHVsZXMvZXM2Lm1hdGguYXRhbmgnKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczYubWF0aC5jYnJ0Jyk7DQpyZXF1aXJlKCcuL21vZHVsZXMvZXM2Lm1hdGguY2x6MzInKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczYubWF0aC5jb3NoJyk7DQpyZXF1aXJlKCcuL21vZHVsZXMvZXM2Lm1hdGguZXhwbTEnKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczYubWF0aC5mcm91bmQnKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczYubWF0aC5oeXBvdCcpOw0KcmVxdWlyZSgnLi9tb2R1bGVzL2VzNi5tYXRoLmltdWwnKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczYubWF0aC5sb2cxMCcpOw0KcmVxdWlyZSgnLi9tb2R1bGVzL2VzNi5tYXRoLmxvZzFwJyk7DQpyZXF1aXJlKCcuL21vZHVsZXMvZXM2Lm1hdGgubG9nMicpOw0KcmVxdWlyZSgnLi9tb2R1bGVzL2VzNi5tYXRoLnNpZ24nKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczYubWF0aC5zaW5oJyk7DQpyZXF1aXJlKCcuL21vZHVsZXMvZXM2Lm1hdGgudGFuaCcpOw0KcmVxdWlyZSgnLi9tb2R1bGVzL2VzNi5tYXRoLnRydW5jJyk7DQpyZXF1aXJlKCcuL21vZHVsZXMvZXM2LnN0cmluZy5mcm9tLWNvZGUtcG9pbnQnKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczYuc3RyaW5nLnJhdycpOw0KcmVxdWlyZSgnLi9tb2R1bGVzL2VzNi5zdHJpbmcudHJpbScpOw0KcmVxdWlyZSgnLi9tb2R1bGVzL2VzNi5zdHJpbmcuaXRlcmF0b3InKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczYuc3RyaW5nLmNvZGUtcG9pbnQtYXQnKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczYuc3RyaW5nLmVuZHMtd2l0aCcpOw0KcmVxdWlyZSgnLi9tb2R1bGVzL2VzNi5zdHJpbmcuaW5jbHVkZXMnKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczYuc3RyaW5nLnJlcGVhdCcpOw0KcmVxdWlyZSgnLi9tb2R1bGVzL2VzNi5zdHJpbmcuc3RhcnRzLXdpdGgnKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczYuc3RyaW5nLmFuY2hvcicpOw0KcmVxdWlyZSgnLi9tb2R1bGVzL2VzNi5zdHJpbmcuYmlnJyk7DQpyZXF1aXJlKCcuL21vZHVsZXMvZXM2LnN0cmluZy5ibGluaycpOw0KcmVxdWlyZSgnLi9tb2R1bGVzL2VzNi5zdHJpbmcuYm9sZCcpOw0KcmVxdWlyZSgnLi9tb2R1bGVzL2VzNi5zdHJpbmcuZml4ZWQnKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczYuc3RyaW5nLmZvbnRjb2xvcicpOw0KcmVxdWlyZSgnLi9tb2R1bGVzL2VzNi5zdHJpbmcuZm9udHNpemUnKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczYuc3RyaW5nLml0YWxpY3MnKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczYuc3RyaW5nLmxpbmsnKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczYuc3RyaW5nLnNtYWxsJyk7DQpyZXF1aXJlKCcuL21vZHVsZXMvZXM2LnN0cmluZy5zdHJpa2UnKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczYuc3RyaW5nLnN1YicpOw0KcmVxdWlyZSgnLi9tb2R1bGVzL2VzNi5zdHJpbmcuc3VwJyk7DQpyZXF1aXJlKCcuL21vZHVsZXMvZXM2LmRhdGUubm93Jyk7DQpyZXF1aXJlKCcuL21vZHVsZXMvZXM2LmRhdGUudG8tanNvbicpOw0KcmVxdWlyZSgnLi9tb2R1bGVzL2VzNi5kYXRlLnRvLWlzby1zdHJpbmcnKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczYuZGF0ZS50by1zdHJpbmcnKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczYuZGF0ZS50by1wcmltaXRpdmUnKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczYuYXJyYXkuaXMtYXJyYXknKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczYuYXJyYXkuZnJvbScpOw0KcmVxdWlyZSgnLi9tb2R1bGVzL2VzNi5hcnJheS5vZicpOw0KcmVxdWlyZSgnLi9tb2R1bGVzL2VzNi5hcnJheS5qb2luJyk7DQpyZXF1aXJlKCcuL21vZHVsZXMvZXM2LmFycmF5LnNsaWNlJyk7DQpyZXF1aXJlKCcuL21vZHVsZXMvZXM2LmFycmF5LnNvcnQnKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczYuYXJyYXkuZm9yLWVhY2gnKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczYuYXJyYXkubWFwJyk7DQpyZXF1aXJlKCcuL21vZHVsZXMvZXM2LmFycmF5LmZpbHRlcicpOw0KcmVxdWlyZSgnLi9tb2R1bGVzL2VzNi5hcnJheS5zb21lJyk7DQpyZXF1aXJlKCcuL21vZHVsZXMvZXM2LmFycmF5LmV2ZXJ5Jyk7DQpyZXF1aXJlKCcuL21vZHVsZXMvZXM2LmFycmF5LnJlZHVjZScpOw0KcmVxdWlyZSgnLi9tb2R1bGVzL2VzNi5hcnJheS5yZWR1Y2UtcmlnaHQnKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczYuYXJyYXkuaW5kZXgtb2YnKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczYuYXJyYXkubGFzdC1pbmRleC1vZicpOw0KcmVxdWlyZSgnLi9tb2R1bGVzL2VzNi5hcnJheS5jb3B5LXdpdGhpbicpOw0KcmVxdWlyZSgnLi9tb2R1bGVzL2VzNi5hcnJheS5maWxsJyk7DQpyZXF1aXJlKCcuL21vZHVsZXMvZXM2LmFycmF5LmZpbmQnKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczYuYXJyYXkuZmluZC1pbmRleCcpOw0KcmVxdWlyZSgnLi9tb2R1bGVzL2VzNi5hcnJheS5zcGVjaWVzJyk7DQpyZXF1aXJlKCcuL21vZHVsZXMvZXM2LmFycmF5Lml0ZXJhdG9yJyk7DQpyZXF1aXJlKCcuL21vZHVsZXMvZXM2LnJlZ2V4cC5jb25zdHJ1Y3RvcicpOw0KcmVxdWlyZSgnLi9tb2R1bGVzL2VzNi5yZWdleHAudG8tc3RyaW5nJyk7DQpyZXF1aXJlKCcuL21vZHVsZXMvZXM2LnJlZ2V4cC5mbGFncycpOw0KcmVxdWlyZSgnLi9tb2R1bGVzL2VzNi5yZWdleHAubWF0Y2gnKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczYucmVnZXhwLnJlcGxhY2UnKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczYucmVnZXhwLnNlYXJjaCcpOw0KcmVxdWlyZSgnLi9tb2R1bGVzL2VzNi5yZWdleHAuc3BsaXQnKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczYucHJvbWlzZScpOw0KcmVxdWlyZSgnLi9tb2R1bGVzL2VzNi5tYXAnKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczYuc2V0Jyk7DQpyZXF1aXJlKCcuL21vZHVsZXMvZXM2LndlYWstbWFwJyk7DQpyZXF1aXJlKCcuL21vZHVsZXMvZXM2LndlYWstc2V0Jyk7DQpyZXF1aXJlKCcuL21vZHVsZXMvZXM2LnR5cGVkLmFycmF5LWJ1ZmZlcicpOw0KcmVxdWlyZSgnLi9tb2R1bGVzL2VzNi50eXBlZC5kYXRhLXZpZXcnKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczYudHlwZWQuaW50OC1hcnJheScpOw0KcmVxdWlyZSgnLi9tb2R1bGVzL2VzNi50eXBlZC51aW50OC1hcnJheScpOw0KcmVxdWlyZSgnLi9tb2R1bGVzL2VzNi50eXBlZC51aW50OC1jbGFtcGVkLWFycmF5Jyk7DQpyZXF1aXJlKCcuL21vZHVsZXMvZXM2LnR5cGVkLmludDE2LWFycmF5Jyk7DQpyZXF1aXJlKCcuL21vZHVsZXMvZXM2LnR5cGVkLnVpbnQxNi1hcnJheScpOw0KcmVxdWlyZSgnLi9tb2R1bGVzL2VzNi50eXBlZC5pbnQzMi1hcnJheScpOw0KcmVxdWlyZSgnLi9tb2R1bGVzL2VzNi50eXBlZC51aW50MzItYXJyYXknKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczYudHlwZWQuZmxvYXQzMi1hcnJheScpOw0KcmVxdWlyZSgnLi9tb2R1bGVzL2VzNi50eXBlZC5mbG9hdDY0LWFycmF5Jyk7DQpyZXF1aXJlKCcuL21vZHVsZXMvZXM2LnJlZmxlY3QuYXBwbHknKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczYucmVmbGVjdC5jb25zdHJ1Y3QnKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczYucmVmbGVjdC5kZWZpbmUtcHJvcGVydHknKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczYucmVmbGVjdC5kZWxldGUtcHJvcGVydHknKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczYucmVmbGVjdC5lbnVtZXJhdGUnKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczYucmVmbGVjdC5nZXQnKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczYucmVmbGVjdC5nZXQtb3duLXByb3BlcnR5LWRlc2NyaXB0b3InKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczYucmVmbGVjdC5nZXQtcHJvdG90eXBlLW9mJyk7DQpyZXF1aXJlKCcuL21vZHVsZXMvZXM2LnJlZmxlY3QuaGFzJyk7DQpyZXF1aXJlKCcuL21vZHVsZXMvZXM2LnJlZmxlY3QuaXMtZXh0ZW5zaWJsZScpOw0KcmVxdWlyZSgnLi9tb2R1bGVzL2VzNi5yZWZsZWN0Lm93bi1rZXlzJyk7DQpyZXF1aXJlKCcuL21vZHVsZXMvZXM2LnJlZmxlY3QucHJldmVudC1leHRlbnNpb25zJyk7DQpyZXF1aXJlKCcuL21vZHVsZXMvZXM2LnJlZmxlY3Quc2V0Jyk7DQpyZXF1aXJlKCcuL21vZHVsZXMvZXM2LnJlZmxlY3Quc2V0LXByb3RvdHlwZS1vZicpOw0KcmVxdWlyZSgnLi9tb2R1bGVzL2VzNy5hcnJheS5pbmNsdWRlcycpOw0KcmVxdWlyZSgnLi9tb2R1bGVzL2VzNy5zdHJpbmcuYXQnKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczcuc3RyaW5nLnBhZC1zdGFydCcpOw0KcmVxdWlyZSgnLi9tb2R1bGVzL2VzNy5zdHJpbmcucGFkLWVuZCcpOw0KcmVxdWlyZSgnLi9tb2R1bGVzL2VzNy5zdHJpbmcudHJpbS1sZWZ0Jyk7DQpyZXF1aXJlKCcuL21vZHVsZXMvZXM3LnN0cmluZy50cmltLXJpZ2h0Jyk7DQpyZXF1aXJlKCcuL21vZHVsZXMvZXM3LnN0cmluZy5tYXRjaC1hbGwnKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczcuc3ltYm9sLmFzeW5jLWl0ZXJhdG9yJyk7DQpyZXF1aXJlKCcuL21vZHVsZXMvZXM3LnN5bWJvbC5vYnNlcnZhYmxlJyk7DQpyZXF1aXJlKCcuL21vZHVsZXMvZXM3Lm9iamVjdC5nZXQtb3duLXByb3BlcnR5LWRlc2NyaXB0b3JzJyk7DQpyZXF1aXJlKCcuL21vZHVsZXMvZXM3Lm9iamVjdC52YWx1ZXMnKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczcub2JqZWN0LmVudHJpZXMnKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczcub2JqZWN0LmRlZmluZS1nZXR0ZXInKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczcub2JqZWN0LmRlZmluZS1zZXR0ZXInKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczcub2JqZWN0Lmxvb2t1cC1nZXR0ZXInKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczcub2JqZWN0Lmxvb2t1cC1zZXR0ZXInKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczcubWFwLnRvLWpzb24nKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczcuc2V0LnRvLWpzb24nKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczcuc3lzdGVtLmdsb2JhbCcpOw0KcmVxdWlyZSgnLi9tb2R1bGVzL2VzNy5lcnJvci5pcy1lcnJvcicpOw0KcmVxdWlyZSgnLi9tb2R1bGVzL2VzNy5tYXRoLmlhZGRoJyk7DQpyZXF1aXJlKCcuL21vZHVsZXMvZXM3Lm1hdGguaXN1YmgnKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczcubWF0aC5pbXVsaCcpOw0KcmVxdWlyZSgnLi9tb2R1bGVzL2VzNy5tYXRoLnVtdWxoJyk7DQpyZXF1aXJlKCcuL21vZHVsZXMvZXM3LnJlZmxlY3QuZGVmaW5lLW1ldGFkYXRhJyk7DQpyZXF1aXJlKCcuL21vZHVsZXMvZXM3LnJlZmxlY3QuZGVsZXRlLW1ldGFkYXRhJyk7DQpyZXF1aXJlKCcuL21vZHVsZXMvZXM3LnJlZmxlY3QuZ2V0LW1ldGFkYXRhJyk7DQpyZXF1aXJlKCcuL21vZHVsZXMvZXM3LnJlZmxlY3QuZ2V0LW1ldGFkYXRhLWtleXMnKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczcucmVmbGVjdC5nZXQtb3duLW1ldGFkYXRhJyk7DQpyZXF1aXJlKCcuL21vZHVsZXMvZXM3LnJlZmxlY3QuZ2V0LW93bi1tZXRhZGF0YS1rZXlzJyk7DQpyZXF1aXJlKCcuL21vZHVsZXMvZXM3LnJlZmxlY3QuaGFzLW1ldGFkYXRhJyk7DQpyZXF1aXJlKCcuL21vZHVsZXMvZXM3LnJlZmxlY3QuaGFzLW93bi1tZXRhZGF0YScpOw0KcmVxdWlyZSgnLi9tb2R1bGVzL2VzNy5yZWZsZWN0Lm1ldGFkYXRhJyk7DQpyZXF1aXJlKCcuL21vZHVsZXMvZXM3LmFzYXAnKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy9lczcub2JzZXJ2YWJsZScpOw0KcmVxdWlyZSgnLi9tb2R1bGVzL3dlYi50aW1lcnMnKTsNCnJlcXVpcmUoJy4vbW9kdWxlcy93ZWIuaW1tZWRpYXRlJyk7DQpyZXF1aXJlKCcuL21vZHVsZXMvd2ViLmRvbS5pdGVyYWJsZScpOw0KbW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKCcuL21vZHVsZXMvX2NvcmUnKTsNCn0seyIuL21vZHVsZXMvX2NvcmUiOjIzLCIuL21vZHVsZXMvZXM2LmFycmF5LmNvcHktd2l0aGluIjoxMjEsIi4vbW9kdWxlcy9lczYuYXJyYXkuZXZlcnkiOjEyMiwiLi9tb2R1bGVzL2VzNi5hcnJheS5maWxsIjoxMjMsIi4vbW9kdWxlcy9lczYuYXJyYXkuZmlsdGVyIjoxMjQsIi4vbW9kdWxlcy9lczYuYXJyYXkuZmluZCI6MTI2LCIuL21vZHVsZXMvZXM2LmFycmF5LmZpbmQtaW5kZXgiOjEyNSwiLi9tb2R1bGVzL2VzNi5hcnJheS5mb3ItZWFjaCI6MTI3LCIuL21vZHVsZXMvZXM2LmFycmF5LmZyb20iOjEyOCwiLi9tb2R1bGVzL2VzNi5hcnJheS5pbmRleC1vZiI6MTI5LCIuL21vZHVsZXMvZXM2LmFycmF5LmlzLWFycmF5IjoxMzAsIi4vbW9kdWxlcy9lczYuYXJyYXkuaXRlcmF0b3IiOjEzMSwiLi9tb2R1bGVzL2VzNi5hcnJheS5qb2luIjoxMzIsIi4vbW9kdWxlcy9lczYuYXJyYXkubGFzdC1pbmRleC1vZiI6MTMzLCIuL21vZHVsZXMvZXM2LmFycmF5Lm1hcCI6MTM0LCIuL21vZHVsZXMvZXM2LmFycmF5Lm9mIjoxMzUsIi4vbW9kdWxlcy9lczYuYXJyYXkucmVkdWNlIjoxMzcsIi4vbW9kdWxlcy9lczYuYXJyYXkucmVkdWNlLXJpZ2h0IjoxMzYsIi4vbW9kdWxlcy9lczYuYXJyYXkuc2xpY2UiOjEzOCwiLi9tb2R1bGVzL2VzNi5hcnJheS5zb21lIjoxMzksIi4vbW9kdWxlcy9lczYuYXJyYXkuc29ydCI6MTQwLCIuL21vZHVsZXMvZXM2LmFycmF5LnNwZWNpZXMiOjE0MSwiLi9tb2R1bGVzL2VzNi5kYXRlLm5vdyI6MTQyLCIuL21vZHVsZXMvZXM2LmRhdGUudG8taXNvLXN0cmluZyI6MTQzLCIuL21vZHVsZXMvZXM2LmRhdGUudG8tanNvbiI6MTQ0LCIuL21vZHVsZXMvZXM2LmRhdGUudG8tcHJpbWl0aXZlIjoxNDUsIi4vbW9kdWxlcy9lczYuZGF0ZS50by1zdHJpbmciOjE0NiwiLi9tb2R1bGVzL2VzNi5mdW5jdGlvbi5iaW5kIjoxNDcsIi4vbW9kdWxlcy9lczYuZnVuY3Rpb24uaGFzLWluc3RhbmNlIjoxNDgsIi4vbW9kdWxlcy9lczYuZnVuY3Rpb24ubmFtZSI6MTQ5LCIuL21vZHVsZXMvZXM2Lm1hcCI6MTUwLCIuL21vZHVsZXMvZXM2Lm1hdGguYWNvc2giOjE1MSwiLi9tb2R1bGVzL2VzNi5tYXRoLmFzaW5oIjoxNTIsIi4vbW9kdWxlcy9lczYubWF0aC5hdGFuaCI6MTUzLCIuL21vZHVsZXMvZXM2Lm1hdGguY2JydCI6MTU0LCIuL21vZHVsZXMvZXM2Lm1hdGguY2x6MzIiOjE1NSwiLi9tb2R1bGVzL2VzNi5tYXRoLmNvc2giOjE1NiwiLi9tb2R1bGVzL2VzNi5tYXRoLmV4cG0xIjoxNTcsIi4vbW9kdWxlcy9lczYubWF0aC5mcm91bmQiOjE1OCwiLi9tb2R1bGVzL2VzNi5tYXRoLmh5cG90IjoxNTksIi4vbW9kdWxlcy9lczYubWF0aC5pbXVsIjoxNjAsIi4vbW9kdWxlcy9lczYubWF0aC5sb2cxMCI6MTYxLCIuL21vZHVsZXMvZXM2Lm1hdGgubG9nMXAiOjE2MiwiLi9tb2R1bGVzL2VzNi5tYXRoLmxvZzIiOjE2MywiLi9tb2R1bGVzL2VzNi5tYXRoLnNpZ24iOjE2NCwiLi9tb2R1bGVzL2VzNi5tYXRoLnNpbmgiOjE2NSwiLi9tb2R1bGVzL2VzNi5tYXRoLnRhbmgiOjE2NiwiLi9tb2R1bGVzL2VzNi5tYXRoLnRydW5jIjoxNjcsIi4vbW9kdWxlcy9lczYubnVtYmVyLmNvbnN0cnVjdG9yIjoxNjgsIi4vbW9kdWxlcy9lczYubnVtYmVyLmVwc2lsb24iOjE2OSwiLi9tb2R1bGVzL2VzNi5udW1iZXIuaXMtZmluaXRlIjoxNzAsIi4vbW9kdWxlcy9lczYubnVtYmVyLmlzLWludGVnZXIiOjE3MSwiLi9tb2R1bGVzL2VzNi5udW1iZXIuaXMtbmFuIjoxNzIsIi4vbW9kdWxlcy9lczYubnVtYmVyLmlzLXNhZmUtaW50ZWdlciI6MTczLCIuL21vZHVsZXMvZXM2Lm51bWJlci5tYXgtc2FmZS1pbnRlZ2VyIjoxNzQsIi4vbW9kdWxlcy9lczYubnVtYmVyLm1pbi1zYWZlLWludGVnZXIiOjE3NSwiLi9tb2R1bGVzL2VzNi5udW1iZXIucGFyc2UtZmxvYXQiOjE3NiwiLi9tb2R1bGVzL2VzNi5udW1iZXIucGFyc2UtaW50IjoxNzcsIi4vbW9kdWxlcy9lczYubnVtYmVyLnRvLWZpeGVkIjoxNzgsIi4vbW9kdWxlcy9lczYubnVtYmVyLnRvLXByZWNpc2lvbiI6MTc5LCIuL21vZHVsZXMvZXM2Lm9iamVjdC5hc3NpZ24iOjE4MCwiLi9tb2R1bGVzL2VzNi5vYmplY3QuY3JlYXRlIjoxODEsIi4vbW9kdWxlcy9lczYub2JqZWN0LmRlZmluZS1wcm9wZXJ0aWVzIjoxODIsIi4vbW9kdWxlcy9lczYub2JqZWN0LmRlZmluZS1wcm9wZXJ0eSI6MTgzLCIuL21vZHVsZXMvZXM2Lm9iamVjdC5mcmVlemUiOjE4NCwiLi9tb2R1bGVzL2VzNi5vYmplY3QuZ2V0LW93bi1wcm9wZXJ0eS1kZXNjcmlwdG9yIjoxODUsIi4vbW9kdWxlcy9lczYub2JqZWN0LmdldC1vd24tcHJvcGVydHktbmFtZXMiOjE4NiwiLi9tb2R1bGVzL2VzNi5vYmplY3QuZ2V0LXByb3RvdHlwZS1vZiI6MTg3LCIuL21vZHVsZXMvZXM2Lm9iamVjdC5pcyI6MTkxLCIuL21vZHVsZXMvZXM2Lm9iamVjdC5pcy1leHRlbnNpYmxlIjoxODgsIi4vbW9kdWxlcy9lczYub2JqZWN0LmlzLWZyb3plbiI6MTg5LCIuL21vZHVsZXMvZXM2Lm9iamVjdC5pcy1zZWFsZWQiOjE5MCwiLi9tb2R1bGVzL2VzNi5vYmplY3Qua2V5cyI6MTkyLCIuL21vZHVsZXMvZXM2Lm9iamVjdC5wcmV2ZW50LWV4dGVuc2lvbnMiOjE5MywiLi9tb2R1bGVzL2VzNi5vYmplY3Quc2VhbCI6MTk0LCIuL21vZHVsZXMvZXM2Lm9iamVjdC5zZXQtcHJvdG90eXBlLW9mIjoxOTUsIi4vbW9kdWxlcy9lczYub2JqZWN0LnRvLXN0cmluZyI6MTk2LCIuL21vZHVsZXMvZXM2LnBhcnNlLWZsb2F0IjoxOTcsIi4vbW9kdWxlcy9lczYucGFyc2UtaW50IjoxOTgsIi4vbW9kdWxlcy9lczYucHJvbWlzZSI6MTk5LCIuL21vZHVsZXMvZXM2LnJlZmxlY3QuYXBwbHkiOjIwMCwiLi9tb2R1bGVzL2VzNi5yZWZsZWN0LmNvbnN0cnVjdCI6MjAxLCIuL21vZHVsZXMvZXM2LnJlZmxlY3QuZGVmaW5lLXByb3BlcnR5IjoyMDIsIi4vbW9kdWxlcy9lczYucmVmbGVjdC5kZWxldGUtcHJvcGVydHkiOjIwMywiLi9tb2R1bGVzL2VzNi5yZWZsZWN0LmVudW1lcmF0ZSI6MjA0LCIuL21vZHVsZXMvZXM2LnJlZmxlY3QuZ2V0IjoyMDcsIi4vbW9kdWxlcy9lczYucmVmbGVjdC5nZXQtb3duLXByb3BlcnR5LWRlc2NyaXB0b3IiOjIwNSwiLi9tb2R1bGVzL2VzNi5yZWZsZWN0LmdldC1wcm90b3R5cGUtb2YiOjIwNiwiLi9tb2R1bGVzL2VzNi5yZWZsZWN0LmhhcyI6MjA4LCIuL21vZHVsZXMvZXM2LnJlZmxlY3QuaXMtZXh0ZW5zaWJsZSI6MjA5LCIuL21vZHVsZXMvZXM2LnJlZmxlY3Qub3duLWtleXMiOjIxMCwiLi9tb2R1bGVzL2VzNi5yZWZsZWN0LnByZXZlbnQtZXh0ZW5zaW9ucyI6MjExLCIuL21vZHVsZXMvZXM2LnJlZmxlY3Quc2V0IjoyMTMsIi4vbW9kdWxlcy9lczYucmVmbGVjdC5zZXQtcHJvdG90eXBlLW9mIjoyMTIsIi4vbW9kdWxlcy9lczYucmVnZXhwLmNvbnN0cnVjdG9yIjoyMTQsIi4vbW9kdWxlcy9lczYucmVnZXhwLmZsYWdzIjoyMTUsIi4vbW9kdWxlcy9lczYucmVnZXhwLm1hdGNoIjoyMTYsIi4vbW9kdWxlcy9lczYucmVnZXhwLnJlcGxhY2UiOjIxNywiLi9tb2R1bGVzL2VzNi5yZWdleHAuc2VhcmNoIjoyMTgsIi4vbW9kdWxlcy9lczYucmVnZXhwLnNwbGl0IjoyMTksIi4vbW9kdWxlcy9lczYucmVnZXhwLnRvLXN0cmluZyI6MjIwLCIuL21vZHVsZXMvZXM2LnNldCI6MjIxLCIuL21vZHVsZXMvZXM2LnN0cmluZy5hbmNob3IiOjIyMiwiLi9tb2R1bGVzL2VzNi5zdHJpbmcuYmlnIjoyMjMsIi4vbW9kdWxlcy9lczYuc3RyaW5nLmJsaW5rIjoyMjQsIi4vbW9kdWxlcy9lczYuc3RyaW5nLmJvbGQiOjIyNSwiLi9tb2R1bGVzL2VzNi5zdHJpbmcuY29kZS1wb2ludC1hdCI6MjI2LCIuL21vZHVsZXMvZXM2LnN0cmluZy5lbmRzLXdpdGgiOjIyNywiLi9tb2R1bGVzL2VzNi5zdHJpbmcuZml4ZWQiOjIyOCwiLi9tb2R1bGVzL2VzNi5zdHJpbmcuZm9udGNvbG9yIjoyMjksIi4vbW9kdWxlcy9lczYuc3RyaW5nLmZvbnRzaXplIjoyMzAsIi4vbW9kdWxlcy9lczYuc3RyaW5nLmZyb20tY29kZS1wb2ludCI6MjMxLCIuL21vZHVsZXMvZXM2LnN0cmluZy5pbmNsdWRlcyI6MjMyLCIuL21vZHVsZXMvZXM2LnN0cmluZy5pdGFsaWNzIjoyMzMsIi4vbW9kdWxlcy9lczYuc3RyaW5nLml0ZXJhdG9yIjoyMzQsIi4vbW9kdWxlcy9lczYuc3RyaW5nLmxpbmsiOjIzNSwiLi9tb2R1bGVzL2VzNi5zdHJpbmcucmF3IjoyMzYsIi4vbW9kdWxlcy9lczYuc3RyaW5nLnJlcGVhdCI6MjM3LCIuL21vZHVsZXMvZXM2LnN0cmluZy5zbWFsbCI6MjM4LCIuL21vZHVsZXMvZXM2LnN0cmluZy5zdGFydHMtd2l0aCI6MjM5LCIuL21vZHVsZXMvZXM2LnN0cmluZy5zdHJpa2UiOjI0MCwiLi9tb2R1bGVzL2VzNi5zdHJpbmcuc3ViIjoyNDEsIi4vbW9kdWxlcy9lczYuc3RyaW5nLnN1cCI6MjQyLCIuL21vZHVsZXMvZXM2LnN0cmluZy50cmltIjoyNDMsIi4vbW9kdWxlcy9lczYuc3ltYm9sIjoyNDQsIi4vbW9kdWxlcy9lczYudHlwZWQuYXJyYXktYnVmZmVyIjoyNDUsIi4vbW9kdWxlcy9lczYudHlwZWQuZGF0YS12aWV3IjoyNDYsIi4vbW9kdWxlcy9lczYudHlwZWQuZmxvYXQzMi1hcnJheSI6MjQ3LCIuL21vZHVsZXMvZXM2LnR5cGVkLmZsb2F0NjQtYXJyYXkiOjI0OCwiLi9tb2R1bGVzL2VzNi50eXBlZC5pbnQxNi1hcnJheSI6MjQ5LCIuL21vZHVsZXMvZXM2LnR5cGVkLmludDMyLWFycmF5IjoyNTAsIi4vbW9kdWxlcy9lczYudHlwZWQuaW50OC1hcnJheSI6MjUxLCIuL21vZHVsZXMvZXM2LnR5cGVkLnVpbnQxNi1hcnJheSI6MjUyLCIuL21vZHVsZXMvZXM2LnR5cGVkLnVpbnQzMi1hcnJheSI6MjUzLCIuL21vZHVsZXMvZXM2LnR5cGVkLnVpbnQ4LWFycmF5IjoyNTQsIi4vbW9kdWxlcy9lczYudHlwZWQudWludDgtY2xhbXBlZC1hcnJheSI6MjU1LCIuL21vZHVsZXMvZXM2LndlYWstbWFwIjoyNTYsIi4vbW9kdWxlcy9lczYud2Vhay1zZXQiOjI1NywiLi9tb2R1bGVzL2VzNy5hcnJheS5pbmNsdWRlcyI6MjU4LCIuL21vZHVsZXMvZXM3LmFzYXAiOjI1OSwiLi9tb2R1bGVzL2VzNy5lcnJvci5pcy1lcnJvciI6MjYwLCIuL21vZHVsZXMvZXM3Lm1hcC50by1qc29uIjoyNjEsIi4vbW9kdWxlcy9lczcubWF0aC5pYWRkaCI6MjYyLCIuL21vZHVsZXMvZXM3Lm1hdGguaW11bGgiOjI2MywiLi9tb2R1bGVzL2VzNy5tYXRoLmlzdWJoIjoyNjQsIi4vbW9kdWxlcy9lczcubWF0aC51bXVsaCI6MjY1LCIuL21vZHVsZXMvZXM3Lm9iamVjdC5kZWZpbmUtZ2V0dGVyIjoyNjYsIi4vbW9kdWxlcy9lczcub2JqZWN0LmRlZmluZS1zZXR0ZXIiOjI2NywiLi9tb2R1bGVzL2VzNy5vYmplY3QuZW50cmllcyI6MjY4LCIuL21vZHVsZXMvZXM3Lm9iamVjdC5nZXQtb3duLXByb3BlcnR5LWRlc2NyaXB0b3JzIjoyNjksIi4vbW9kdWxlcy9lczcub2JqZWN0Lmxvb2t1cC1nZXR0ZXIiOjI3MCwiLi9tb2R1bGVzL2VzNy5vYmplY3QubG9va3VwLXNldHRlciI6MjcxLCIuL21vZHVsZXMvZXM3Lm9iamVjdC52YWx1ZXMiOjI3MiwiLi9tb2R1bGVzL2VzNy5vYnNlcnZhYmxlIjoyNzMsIi4vbW9kdWxlcy9lczcucmVmbGVjdC5kZWZpbmUtbWV0YWRhdGEiOjI3NCwiLi9tb2R1bGVzL2VzNy5yZWZsZWN0LmRlbGV0ZS1tZXRhZGF0YSI6Mjc1LCIuL21vZHVsZXMvZXM3LnJlZmxlY3QuZ2V0LW1ldGFkYXRhIjoyNzcsIi4vbW9kdWxlcy9lczcucmVmbGVjdC5nZXQtbWV0YWRhdGEta2V5cyI6Mjc2LCIuL21vZHVsZXMvZXM3LnJlZmxlY3QuZ2V0LW93bi1tZXRhZGF0YSI6Mjc5LCIuL21vZHVsZXMvZXM3LnJlZmxlY3QuZ2V0LW93bi1tZXRhZGF0YS1rZXlzIjoyNzgsIi4vbW9kdWxlcy9lczcucmVmbGVjdC5oYXMtbWV0YWRhdGEiOjI4MCwiLi9tb2R1bGVzL2VzNy5yZWZsZWN0Lmhhcy1vd24tbWV0YWRhdGEiOjI4MSwiLi9tb2R1bGVzL2VzNy5yZWZsZWN0Lm1ldGFkYXRhIjoyODIsIi4vbW9kdWxlcy9lczcuc2V0LnRvLWpzb24iOjI4MywiLi9tb2R1bGVzL2VzNy5zdHJpbmcuYXQiOjI4NCwiLi9tb2R1bGVzL2VzNy5zdHJpbmcubWF0Y2gtYWxsIjoyODUsIi4vbW9kdWxlcy9lczcuc3RyaW5nLnBhZC1lbmQiOjI4NiwiLi9tb2R1bGVzL2VzNy5zdHJpbmcucGFkLXN0YXJ0IjoyODcsIi4vbW9kdWxlcy9lczcuc3RyaW5nLnRyaW0tbGVmdCI6Mjg4LCIuL21vZHVsZXMvZXM3LnN0cmluZy50cmltLXJpZ2h0IjoyODksIi4vbW9kdWxlcy9lczcuc3ltYm9sLmFzeW5jLWl0ZXJhdG9yIjoyOTAsIi4vbW9kdWxlcy9lczcuc3ltYm9sLm9ic2VydmFibGUiOjI5MSwiLi9tb2R1bGVzL2VzNy5zeXN0ZW0uZ2xvYmFsIjoyOTIsIi4vbW9kdWxlcy93ZWIuZG9tLml0ZXJhYmxlIjoyOTMsIi4vbW9kdWxlcy93ZWIuaW1tZWRpYXRlIjoyOTQsIi4vbW9kdWxlcy93ZWIudGltZXJzIjoyOTV9XSwyOTc6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KLyoqDQogKiBDb3B5cmlnaHQgKGMpIDIwMTQsIEZhY2Vib29rLCBJbmMuDQogKiBBbGwgcmlnaHRzIHJlc2VydmVkLg0KICoNCiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIEJTRC1zdHlsZSBsaWNlbnNlIGZvdW5kIGluIHRoZQ0KICogaHR0cHM6Ly9yYXcuZ2l0aHViLmNvbS9mYWNlYm9vay9yZWdlbmVyYXRvci9tYXN0ZXIvTElDRU5TRSBmaWxlLiBBbg0KICogYWRkaXRpb25hbCBncmFudCBvZiBwYXRlbnQgcmlnaHRzIGNhbiBiZSBmb3VuZCBpbiB0aGUgUEFURU5UUyBmaWxlIGluDQogKiB0aGUgc2FtZSBkaXJlY3RvcnkuDQogKi8NCg0KIShmdW5jdGlvbihnbG9iYWwpIHsNCiAgInVzZSBzdHJpY3QiOw0KDQogIHZhciBoYXNPd24gPSBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5Ow0KICB2YXIgdW5kZWZpbmVkOyAvLyBNb3JlIGNvbXByZXNzaWJsZSB0aGFuIHZvaWQgMC4NCiAgdmFyICRTeW1ib2wgPSB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iID8gU3ltYm9sIDoge307DQogIHZhciBpdGVyYXRvclN5bWJvbCA9ICRTeW1ib2wuaXRlcmF0b3IgfHwgIkBAaXRlcmF0b3IiOw0KICB2YXIgdG9TdHJpbmdUYWdTeW1ib2wgPSAkU3ltYm9sLnRvU3RyaW5nVGFnIHx8ICJAQHRvU3RyaW5nVGFnIjsNCg0KICB2YXIgaW5Nb2R1bGUgPSB0eXBlb2YgbW9kdWxlID09PSAib2JqZWN0IjsNCiAgdmFyIHJ1bnRpbWUgPSBnbG9iYWwucmVnZW5lcmF0b3JSdW50aW1lOw0KICBpZiAocnVudGltZSkgew0KICAgIGlmIChpbk1vZHVsZSkgew0KICAgICAgLy8gSWYgcmVnZW5lcmF0b3JSdW50aW1lIGlzIGRlZmluZWQgZ2xvYmFsbHkgYW5kIHdlJ3JlIGluIGEgbW9kdWxlLA0KICAgICAgLy8gbWFrZSB0aGUgZXhwb3J0cyBvYmplY3QgaWRlbnRpY2FsIHRvIHJlZ2VuZXJhdG9yUnVudGltZS4NCiAgICAgIG1vZHVsZS5leHBvcnRzID0gcnVudGltZTsNCiAgICB9DQogICAgLy8gRG9uJ3QgYm90aGVyIGV2YWx1YXRpbmcgdGhlIHJlc3Qgb2YgdGhpcyBmaWxlIGlmIHRoZSBydW50aW1lIHdhcw0KICAgIC8vIGFscmVhZHkgZGVmaW5lZCBnbG9iYWxseS4NCiAgICByZXR1cm47DQogIH0NCg0KICAvLyBEZWZpbmUgdGhlIHJ1bnRpbWUgZ2xvYmFsbHkgKGFzIGV4cGVjdGVkIGJ5IGdlbmVyYXRlZCBjb2RlKSBhcyBlaXRoZXINCiAgLy8gbW9kdWxlLmV4cG9ydHMgKGlmIHdlJ3JlIGluIGEgbW9kdWxlKSBvciBhIG5ldywgZW1wdHkgb2JqZWN0Lg0KICBydW50aW1lID0gZ2xvYmFsLnJlZ2VuZXJhdG9yUnVudGltZSA9IGluTW9kdWxlID8gbW9kdWxlLmV4cG9ydHMgOiB7fTsNCg0KICBmdW5jdGlvbiB3cmFwKGlubmVyRm4sIG91dGVyRm4sIHNlbGYsIHRyeUxvY3NMaXN0KSB7DQogICAgLy8gSWYgb3V0ZXJGbiBwcm92aWRlZCwgdGhlbiBvdXRlckZuLnByb3RvdHlwZSBpbnN0YW5jZW9mIEdlbmVyYXRvci4NCiAgICB2YXIgZ2VuZXJhdG9yID0gT2JqZWN0LmNyZWF0ZSgob3V0ZXJGbiB8fCBHZW5lcmF0b3IpLnByb3RvdHlwZSk7DQogICAgdmFyIGNvbnRleHQgPSBuZXcgQ29udGV4dCh0cnlMb2NzTGlzdCB8fCBbXSk7DQoNCiAgICAvLyBUaGUgLl9pbnZva2UgbWV0aG9kIHVuaWZpZXMgdGhlIGltcGxlbWVudGF0aW9ucyBvZiB0aGUgLm5leHQsDQogICAgLy8gLnRocm93LCBhbmQgLnJldHVybiBtZXRob2RzLg0KICAgIGdlbmVyYXRvci5faW52b2tlID0gbWFrZUludm9rZU1ldGhvZChpbm5lckZuLCBzZWxmLCBjb250ZXh0KTsNCg0KICAgIHJldHVybiBnZW5lcmF0b3I7DQogIH0NCiAgcnVudGltZS53cmFwID0gd3JhcDsNCg0KICAvLyBUcnkvY2F0Y2ggaGVscGVyIHRvIG1pbmltaXplIGRlb3B0aW1pemF0aW9ucy4gUmV0dXJucyBhIGNvbXBsZXRpb24NCiAgLy8gcmVjb3JkIGxpa2UgY29udGV4dC50cnlFbnRyaWVzW2ldLmNvbXBsZXRpb24uIFRoaXMgaW50ZXJmYWNlIGNvdWxkDQogIC8vIGhhdmUgYmVlbiAoYW5kIHdhcyBwcmV2aW91c2x5KSBkZXNpZ25lZCB0byB0YWtlIGEgY2xvc3VyZSB0byBiZQ0KICAvLyBpbnZva2VkIHdpdGhvdXQgYXJndW1lbnRzLCBidXQgaW4gYWxsIHRoZSBjYXNlcyB3ZSBjYXJlIGFib3V0IHdlDQogIC8vIGFscmVhZHkgaGF2ZSBhbiBleGlzdGluZyBtZXRob2Qgd2Ugd2FudCB0byBjYWxsLCBzbyB0aGVyZSdzIG5vIG5lZWQNCiAgLy8gdG8gY3JlYXRlIGEgbmV3IGZ1bmN0aW9uIG9iamVjdC4gV2UgY2FuIGV2ZW4gZ2V0IGF3YXkgd2l0aCBhc3N1bWluZw0KICAvLyB0aGUgbWV0aG9kIHRha2VzIGV4YWN0bHkgb25lIGFyZ3VtZW50LCBzaW5jZSB0aGF0IGhhcHBlbnMgdG8gYmUgdHJ1ZQ0KICAvLyBpbiBldmVyeSBjYXNlLCBzbyB3ZSBkb24ndCBoYXZlIHRvIHRvdWNoIHRoZSBhcmd1bWVudHMgb2JqZWN0LiBUaGUNCiAgLy8gb25seSBhZGRpdGlvbmFsIGFsbG9jYXRpb24gcmVxdWlyZWQgaXMgdGhlIGNvbXBsZXRpb24gcmVjb3JkLCB3aGljaA0KICAvLyBoYXMgYSBzdGFibGUgc2hhcGUgYW5kIHNvIGhvcGVmdWxseSBzaG91bGQgYmUgY2hlYXAgdG8gYWxsb2NhdGUuDQogIGZ1bmN0aW9uIHRyeUNhdGNoKGZuLCBvYmosIGFyZykgew0KICAgIHRyeSB7DQogICAgICByZXR1cm4geyB0eXBlOiAibm9ybWFsIiwgYXJnOiBmbi5jYWxsKG9iaiwgYXJnKSB9Ow0KICAgIH0gY2F0Y2ggKGVycikgew0KICAgICAgcmV0dXJuIHsgdHlwZTogInRocm93IiwgYXJnOiBlcnIgfTsNCiAgICB9DQogIH0NCg0KICB2YXIgR2VuU3RhdGVTdXNwZW5kZWRTdGFydCA9ICJzdXNwZW5kZWRTdGFydCI7DQogIHZhciBHZW5TdGF0ZVN1c3BlbmRlZFlpZWxkID0gInN1c3BlbmRlZFlpZWxkIjsNCiAgdmFyIEdlblN0YXRlRXhlY3V0aW5nID0gImV4ZWN1dGluZyI7DQogIHZhciBHZW5TdGF0ZUNvbXBsZXRlZCA9ICJjb21wbGV0ZWQiOw0KDQogIC8vIFJldHVybmluZyB0aGlzIG9iamVjdCBmcm9tIHRoZSBpbm5lckZuIGhhcyB0aGUgc2FtZSBlZmZlY3QgYXMNCiAgLy8gYnJlYWtpbmcgb3V0IG9mIHRoZSBkaXNwYXRjaCBzd2l0Y2ggc3RhdGVtZW50Lg0KICB2YXIgQ29udGludWVTZW50aW5lbCA9IHt9Ow0KDQogIC8vIER1bW15IGNvbnN0cnVjdG9yIGZ1bmN0aW9ucyB0aGF0IHdlIHVzZSBhcyB0aGUgLmNvbnN0cnVjdG9yIGFuZA0KICAvLyAuY29uc3RydWN0b3IucHJvdG90eXBlIHByb3BlcnRpZXMgZm9yIGZ1bmN0aW9ucyB0aGF0IHJldHVybiBHZW5lcmF0b3INCiAgLy8gb2JqZWN0cy4gRm9yIGZ1bGwgc3BlYyBjb21wbGlhbmNlLCB5b3UgbWF5IHdpc2ggdG8gY29uZmlndXJlIHlvdXINCiAgLy8gbWluaWZpZXIgbm90IHRvIG1hbmdsZSB0aGUgbmFtZXMgb2YgdGhlc2UgdHdvIGZ1bmN0aW9ucy4NCiAgZnVuY3Rpb24gR2VuZXJhdG9yKCkge30NCiAgZnVuY3Rpb24gR2VuZXJhdG9yRnVuY3Rpb24oKSB7fQ0KICBmdW5jdGlvbiBHZW5lcmF0b3JGdW5jdGlvblByb3RvdHlwZSgpIHt9DQoNCiAgdmFyIEdwID0gR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGUucHJvdG90eXBlID0gR2VuZXJhdG9yLnByb3RvdHlwZTsNCiAgR2VuZXJhdG9yRnVuY3Rpb24ucHJvdG90eXBlID0gR3AuY29uc3RydWN0b3IgPSBHZW5lcmF0b3JGdW5jdGlvblByb3RvdHlwZTsNCiAgR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGUuY29uc3RydWN0b3IgPSBHZW5lcmF0b3JGdW5jdGlvbjsNCiAgR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGVbdG9TdHJpbmdUYWdTeW1ib2xdID0gR2VuZXJhdG9yRnVuY3Rpb24uZGlzcGxheU5hbWUgPSAiR2VuZXJhdG9yRnVuY3Rpb24iOw0KDQogIC8vIEhlbHBlciBmb3IgZGVmaW5pbmcgdGhlIC5uZXh0LCAudGhyb3csIGFuZCAucmV0dXJuIG1ldGhvZHMgb2YgdGhlDQogIC8vIEl0ZXJhdG9yIGludGVyZmFjZSBpbiB0ZXJtcyBvZiBhIHNpbmdsZSAuX2ludm9rZSBtZXRob2QuDQogIGZ1bmN0aW9uIGRlZmluZUl0ZXJhdG9yTWV0aG9kcyhwcm90b3R5cGUpIHsNCiAgICBbIm5leHQiLCAidGhyb3ciLCAicmV0dXJuIl0uZm9yRWFjaChmdW5jdGlvbihtZXRob2QpIHsNCiAgICAgIHByb3RvdHlwZVttZXRob2RdID0gZnVuY3Rpb24oYXJnKSB7DQogICAgICAgIHJldHVybiB0aGlzLl9pbnZva2UobWV0aG9kLCBhcmcpOw0KICAgICAgfTsNCiAgICB9KTsNCiAgfQ0KDQogIHJ1bnRpbWUuaXNHZW5lcmF0b3JGdW5jdGlvbiA9IGZ1bmN0aW9uKGdlbkZ1bikgew0KICAgIHZhciBjdG9yID0gdHlwZW9mIGdlbkZ1biA9PT0gImZ1bmN0aW9uIiAmJiBnZW5GdW4uY29uc3RydWN0b3I7DQogICAgcmV0dXJuIGN0b3INCiAgICAgID8gY3RvciA9PT0gR2VuZXJhdG9yRnVuY3Rpb24gfHwNCiAgICAgICAgLy8gRm9yIHRoZSBuYXRpdmUgR2VuZXJhdG9yRnVuY3Rpb24gY29uc3RydWN0b3IsIHRoZSBiZXN0IHdlIGNhbg0KICAgICAgICAvLyBkbyBpcyB0byBjaGVjayBpdHMgLm5hbWUgcHJvcGVydHkuDQogICAgICAgIChjdG9yLmRpc3BsYXlOYW1lIHx8IGN0b3IubmFtZSkgPT09ICJHZW5lcmF0b3JGdW5jdGlvbiINCiAgICAgIDogZmFsc2U7DQogIH07DQoNCiAgcnVudGltZS5tYXJrID0gZnVuY3Rpb24oZ2VuRnVuKSB7DQogICAgaWYgKE9iamVjdC5zZXRQcm90b3R5cGVPZikgew0KICAgICAgT2JqZWN0LnNldFByb3RvdHlwZU9mKGdlbkZ1biwgR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGUpOw0KICAgIH0gZWxzZSB7DQogICAgICBnZW5GdW4uX19wcm90b19fID0gR2VuZXJhdG9yRnVuY3Rpb25Qcm90b3R5cGU7DQogICAgICBpZiAoISh0b1N0cmluZ1RhZ1N5bWJvbCBpbiBnZW5GdW4pKSB7DQogICAgICAgIGdlbkZ1blt0b1N0cmluZ1RhZ1N5bWJvbF0gPSAiR2VuZXJhdG9yRnVuY3Rpb24iOw0KICAgICAgfQ0KICAgIH0NCiAgICBnZW5GdW4ucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShHcCk7DQogICAgcmV0dXJuIGdlbkZ1bjsNCiAgfTsNCg0KICAvLyBXaXRoaW4gdGhlIGJvZHkgb2YgYW55IGFzeW5jIGZ1bmN0aW9uLCBgYXdhaXQgeGAgaXMgdHJhbnNmb3JtZWQgdG8NCiAgLy8gYHlpZWxkIHJlZ2VuZXJhdG9yUnVudGltZS5hd3JhcCh4KWAsIHNvIHRoYXQgdGhlIHJ1bnRpbWUgY2FuIHRlc3QNCiAgLy8gYHZhbHVlIGluc3RhbmNlb2YgQXdhaXRBcmd1bWVudGAgdG8gZGV0ZXJtaW5lIGlmIHRoZSB5aWVsZGVkIHZhbHVlIGlzDQogIC8vIG1lYW50IHRvIGJlIGF3YWl0ZWQuIFNvbWUgbWF5IGNvbnNpZGVyIHRoZSBuYW1lIG9mIHRoaXMgbWV0aG9kIHRvbw0KICAvLyBjdXRlc3ksIGJ1dCB0aGV5IGFyZSBjdXJtdWRnZW9ucy4NCiAgcnVudGltZS5hd3JhcCA9IGZ1bmN0aW9uKGFyZykgew0KICAgIHJldHVybiBuZXcgQXdhaXRBcmd1bWVudChhcmcpOw0KICB9Ow0KDQogIGZ1bmN0aW9uIEF3YWl0QXJndW1lbnQoYXJnKSB7DQogICAgdGhpcy5hcmcgPSBhcmc7DQogIH0NCg0KICBmdW5jdGlvbiBBc3luY0l0ZXJhdG9yKGdlbmVyYXRvcikgew0KICAgIGZ1bmN0aW9uIGludm9rZShtZXRob2QsIGFyZywgcmVzb2x2ZSwgcmVqZWN0KSB7DQogICAgICB2YXIgcmVjb3JkID0gdHJ5Q2F0Y2goZ2VuZXJhdG9yW21ldGhvZF0sIGdlbmVyYXRvciwgYXJnKTsNCiAgICAgIGlmIChyZWNvcmQudHlwZSA9PT0gInRocm93Iikgew0KICAgICAgICByZWplY3QocmVjb3JkLmFyZyk7DQogICAgICB9IGVsc2Ugew0KICAgICAgICB2YXIgcmVzdWx0ID0gcmVjb3JkLmFyZzsNCiAgICAgICAgdmFyIHZhbHVlID0gcmVzdWx0LnZhbHVlOw0KICAgICAgICBpZiAodmFsdWUgaW5zdGFuY2VvZiBBd2FpdEFyZ3VtZW50KSB7DQogICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh2YWx1ZS5hcmcpLnRoZW4oZnVuY3Rpb24odmFsdWUpIHsNCiAgICAgICAgICAgIGludm9rZSgibmV4dCIsIHZhbHVlLCByZXNvbHZlLCByZWplY3QpOw0KICAgICAgICAgIH0sIGZ1bmN0aW9uKGVycikgew0KICAgICAgICAgICAgaW52b2tlKCJ0aHJvdyIsIGVyciwgcmVzb2x2ZSwgcmVqZWN0KTsNCiAgICAgICAgICB9KTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUodmFsdWUpLnRoZW4oZnVuY3Rpb24odW53cmFwcGVkKSB7DQogICAgICAgICAgLy8gV2hlbiBhIHlpZWxkZWQgUHJvbWlzZSBpcyByZXNvbHZlZCwgaXRzIGZpbmFsIHZhbHVlIGJlY29tZXMNCiAgICAgICAgICAvLyB0aGUgLnZhbHVlIG9mIHRoZSBQcm9taXNlPHt2YWx1ZSxkb25lfT4gcmVzdWx0IGZvciB0aGUNCiAgICAgICAgICAvLyBjdXJyZW50IGl0ZXJhdGlvbi4gSWYgdGhlIFByb21pc2UgaXMgcmVqZWN0ZWQsIGhvd2V2ZXIsIHRoZQ0KICAgICAgICAgIC8vIHJlc3VsdCBmb3IgdGhpcyBpdGVyYXRpb24gd2lsbCBiZSByZWplY3RlZCB3aXRoIHRoZSBzYW1lDQogICAgICAgICAgLy8gcmVhc29uLiBOb3RlIHRoYXQgcmVqZWN0aW9ucyBvZiB5aWVsZGVkIFByb21pc2VzIGFyZSBub3QNCiAgICAgICAgICAvLyB0aHJvd24gYmFjayBpbnRvIHRoZSBnZW5lcmF0b3IgZnVuY3Rpb24sIGFzIGlzIHRoZSBjYXNlDQogICAgICAgICAgLy8gd2hlbiBhbiBhd2FpdGVkIFByb21pc2UgaXMgcmVqZWN0ZWQuIFRoaXMgZGlmZmVyZW5jZSBpbg0KICAgICAgICAgIC8vIGJlaGF2aW9yIGJldHdlZW4geWllbGQgYW5kIGF3YWl0IGlzIGltcG9ydGFudCwgYmVjYXVzZSBpdA0KICAgICAgICAgIC8vIGFsbG93cyB0aGUgY29uc3VtZXIgdG8gZGVjaWRlIHdoYXQgdG8gZG8gd2l0aCB0aGUgeWllbGRlZA0KICAgICAgICAgIC8vIHJlamVjdGlvbiAoc3dhbGxvdyBpdCBhbmQgY29udGludWUsIG1hbnVhbGx5IC50aHJvdyBpdCBiYWNrDQogICAgICAgICAgLy8gaW50byB0aGUgZ2VuZXJhdG9yLCBhYmFuZG9uIGl0ZXJhdGlvbiwgd2hhdGV2ZXIpLiBXaXRoDQogICAgICAgICAgLy8gYXdhaXQsIGJ5IGNvbnRyYXN0LCB0aGVyZSBpcyBubyBvcHBvcnR1bml0eSB0byBleGFtaW5lIHRoZQ0KICAgICAgICAgIC8vIHJlamVjdGlvbiByZWFzb24gb3V0c2lkZSB0aGUgZ2VuZXJhdG9yIGZ1bmN0aW9uLCBzbyB0aGUNCiAgICAgICAgICAvLyBvbmx5IG9wdGlvbiBpcyB0byB0aHJvdyBpdCBmcm9tIHRoZSBhd2FpdCBleHByZXNzaW9uLCBhbmQNCiAgICAgICAgICAvLyBsZXQgdGhlIGdlbmVyYXRvciBmdW5jdGlvbiBoYW5kbGUgdGhlIGV4Y2VwdGlvbi4NCiAgICAgICAgICByZXN1bHQudmFsdWUgPSB1bndyYXBwZWQ7DQogICAgICAgICAgcmVzb2x2ZShyZXN1bHQpOw0KICAgICAgICB9LCByZWplY3QpOw0KICAgICAgfQ0KICAgIH0NCg0KICAgIGlmICh0eXBlb2YgcHJvY2VzcyA9PT0gIm9iamVjdCIgJiYgcHJvY2Vzcy5kb21haW4pIHsNCiAgICAgIGludm9rZSA9IHByb2Nlc3MuZG9tYWluLmJpbmQoaW52b2tlKTsNCiAgICB9DQoNCiAgICB2YXIgcHJldmlvdXNQcm9taXNlOw0KDQogICAgZnVuY3Rpb24gZW5xdWV1ZShtZXRob2QsIGFyZykgew0KICAgICAgZnVuY3Rpb24gY2FsbEludm9rZVdpdGhNZXRob2RBbmRBcmcoKSB7DQogICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHsNCiAgICAgICAgICBpbnZva2UobWV0aG9kLCBhcmcsIHJlc29sdmUsIHJlamVjdCk7DQogICAgICAgIH0pOw0KICAgICAgfQ0KDQogICAgICByZXR1cm4gcHJldmlvdXNQcm9taXNlID0NCiAgICAgICAgLy8gSWYgZW5xdWV1ZSBoYXMgYmVlbiBjYWxsZWQgYmVmb3JlLCB0aGVuIHdlIHdhbnQgdG8gd2FpdCB1bnRpbA0KICAgICAgICAvLyBhbGwgcHJldmlvdXMgUHJvbWlzZXMgaGF2ZSBiZWVuIHJlc29sdmVkIGJlZm9yZSBjYWxsaW5nIGludm9rZSwNCiAgICAgICAgLy8gc28gdGhhdCByZXN1bHRzIGFyZSBhbHdheXMgZGVsaXZlcmVkIGluIHRoZSBjb3JyZWN0IG9yZGVyLiBJZg0KICAgICAgICAvLyBlbnF1ZXVlIGhhcyBub3QgYmVlbiBjYWxsZWQgYmVmb3JlLCB0aGVuIGl0IGlzIGltcG9ydGFudCB0bw0KICAgICAgICAvLyBjYWxsIGludm9rZSBpbW1lZGlhdGVseSwgd2l0aG91dCB3YWl0aW5nIG9uIGEgY2FsbGJhY2sgdG8gZmlyZSwNCiAgICAgICAgLy8gc28gdGhhdCB0aGUgYXN5bmMgZ2VuZXJhdG9yIGZ1bmN0aW9uIGhhcyB0aGUgb3Bwb3J0dW5pdHkgdG8gZG8NCiAgICAgICAgLy8gYW55IG5lY2Vzc2FyeSBzZXR1cCBpbiBhIHByZWRpY3RhYmxlIHdheS4gVGhpcyBwcmVkaWN0YWJpbGl0eQ0KICAgICAgICAvLyBpcyB3aHkgdGhlIFByb21pc2UgY29uc3RydWN0b3Igc3luY2hyb25vdXNseSBpbnZva2VzIGl0cw0KICAgICAgICAvLyBleGVjdXRvciBjYWxsYmFjaywgYW5kIHdoeSBhc3luYyBmdW5jdGlvbnMgc3luY2hyb25vdXNseQ0KICAgICAgICAvLyBleGVjdXRlIGNvZGUgYmVmb3JlIHRoZSBmaXJzdCBhd2FpdC4gU2luY2Ugd2UgaW1wbGVtZW50IHNpbXBsZQ0KICAgICAgICAvLyBhc3luYyBmdW5jdGlvbnMgaW4gdGVybXMgb2YgYXN5bmMgZ2VuZXJhdG9ycywgaXQgaXMgZXNwZWNpYWxseQ0KICAgICAgICAvLyBpbXBvcnRhbnQgdG8gZ2V0IHRoaXMgcmlnaHQsIGV2ZW4gdGhvdWdoIGl0IHJlcXVpcmVzIGNhcmUuDQogICAgICAgIHByZXZpb3VzUHJvbWlzZSA/IHByZXZpb3VzUHJvbWlzZS50aGVuKA0KICAgICAgICAgIGNhbGxJbnZva2VXaXRoTWV0aG9kQW5kQXJnLA0KICAgICAgICAgIC8vIEF2b2lkIHByb3BhZ2F0aW5nIGZhaWx1cmVzIHRvIFByb21pc2VzIHJldHVybmVkIGJ5IGxhdGVyDQogICAgICAgICAgLy8gaW52b2NhdGlvbnMgb2YgdGhlIGl0ZXJhdG9yLg0KICAgICAgICAgIGNhbGxJbnZva2VXaXRoTWV0aG9kQW5kQXJnDQogICAgICAgICkgOiBjYWxsSW52b2tlV2l0aE1ldGhvZEFuZEFyZygpOw0KICAgIH0NCg0KICAgIC8vIERlZmluZSB0aGUgdW5pZmllZCBoZWxwZXIgbWV0aG9kIHRoYXQgaXMgdXNlZCB0byBpbXBsZW1lbnQgLm5leHQsDQogICAgLy8gLnRocm93LCBhbmQgLnJldHVybiAoc2VlIGRlZmluZUl0ZXJhdG9yTWV0aG9kcykuDQogICAgdGhpcy5faW52b2tlID0gZW5xdWV1ZTsNCiAgfQ0KDQogIGRlZmluZUl0ZXJhdG9yTWV0aG9kcyhBc3luY0l0ZXJhdG9yLnByb3RvdHlwZSk7DQoNCiAgLy8gTm90ZSB0aGF0IHNpbXBsZSBhc3luYyBmdW5jdGlvbnMgYXJlIGltcGxlbWVudGVkIG9uIHRvcCBvZg0KICAvLyBBc3luY0l0ZXJhdG9yIG9iamVjdHM7IHRoZXkganVzdCByZXR1cm4gYSBQcm9taXNlIGZvciB0aGUgdmFsdWUgb2YNCiAgLy8gdGhlIGZpbmFsIHJlc3VsdCBwcm9kdWNlZCBieSB0aGUgaXRlcmF0b3IuDQogIHJ1bnRpbWUuYXN5bmMgPSBmdW5jdGlvbihpbm5lckZuLCBvdXRlckZuLCBzZWxmLCB0cnlMb2NzTGlzdCkgew0KICAgIHZhciBpdGVyID0gbmV3IEFzeW5jSXRlcmF0b3IoDQogICAgICB3cmFwKGlubmVyRm4sIG91dGVyRm4sIHNlbGYsIHRyeUxvY3NMaXN0KQ0KICAgICk7DQoNCiAgICByZXR1cm4gcnVudGltZS5pc0dlbmVyYXRvckZ1bmN0aW9uKG91dGVyRm4pDQogICAgICA/IGl0ZXIgLy8gSWYgb3V0ZXJGbiBpcyBhIGdlbmVyYXRvciwgcmV0dXJuIHRoZSBmdWxsIGl0ZXJhdG9yLg0KICAgICAgOiBpdGVyLm5leHQoKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCkgew0KICAgICAgICAgIHJldHVybiByZXN1bHQuZG9uZSA/IHJlc3VsdC52YWx1ZSA6IGl0ZXIubmV4dCgpOw0KICAgICAgICB9KTsNCiAgfTsNCg0KICBmdW5jdGlvbiBtYWtlSW52b2tlTWV0aG9kKGlubmVyRm4sIHNlbGYsIGNvbnRleHQpIHsNCiAgICB2YXIgc3RhdGUgPSBHZW5TdGF0ZVN1c3BlbmRlZFN0YXJ0Ow0KDQogICAgcmV0dXJuIGZ1bmN0aW9uIGludm9rZShtZXRob2QsIGFyZykgew0KICAgICAgaWYgKHN0YXRlID09PSBHZW5TdGF0ZUV4ZWN1dGluZykgew0KICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIkdlbmVyYXRvciBpcyBhbHJlYWR5IHJ1bm5pbmciKTsNCiAgICAgIH0NCg0KICAgICAgaWYgKHN0YXRlID09PSBHZW5TdGF0ZUNvbXBsZXRlZCkgew0KICAgICAgICBpZiAobWV0aG9kID09PSAidGhyb3ciKSB7DQogICAgICAgICAgdGhyb3cgYXJnOw0KICAgICAgICB9DQoNCiAgICAgICAgLy8gQmUgZm9yZ2l2aW5nLCBwZXIgMjUuMy4zLjMuMyBvZiB0aGUgc3BlYzoNCiAgICAgICAgLy8gaHR0cHM6Ly9wZW9wbGUubW96aWxsYS5vcmcvfmpvcmVuZG9yZmYvZXM2LWRyYWZ0Lmh0bWwjc2VjLWdlbmVyYXRvcnJlc3VtZQ0KICAgICAgICByZXR1cm4gZG9uZVJlc3VsdCgpOw0KICAgICAgfQ0KDQogICAgICB3aGlsZSAodHJ1ZSkgew0KICAgICAgICB2YXIgZGVsZWdhdGUgPSBjb250ZXh0LmRlbGVnYXRlOw0KICAgICAgICBpZiAoZGVsZWdhdGUpIHsNCiAgICAgICAgICBpZiAobWV0aG9kID09PSAicmV0dXJuIiB8fA0KICAgICAgICAgICAgICAobWV0aG9kID09PSAidGhyb3ciICYmIGRlbGVnYXRlLml0ZXJhdG9yW21ldGhvZF0gPT09IHVuZGVmaW5lZCkpIHsNCiAgICAgICAgICAgIC8vIEEgcmV0dXJuIG9yIHRocm93ICh3aGVuIHRoZSBkZWxlZ2F0ZSBpdGVyYXRvciBoYXMgbm8gdGhyb3cNCiAgICAgICAgICAgIC8vIG1ldGhvZCkgYWx3YXlzIHRlcm1pbmF0ZXMgdGhlIHlpZWxkKiBsb29wLg0KICAgICAgICAgICAgY29udGV4dC5kZWxlZ2F0ZSA9IG51bGw7DQoNCiAgICAgICAgICAgIC8vIElmIHRoZSBkZWxlZ2F0ZSBpdGVyYXRvciBoYXMgYSByZXR1cm4gbWV0aG9kLCBnaXZlIGl0IGENCiAgICAgICAgICAgIC8vIGNoYW5jZSB0byBjbGVhbiB1cC4NCiAgICAgICAgICAgIHZhciByZXR1cm5NZXRob2QgPSBkZWxlZ2F0ZS5pdGVyYXRvclsicmV0dXJuIl07DQogICAgICAgICAgICBpZiAocmV0dXJuTWV0aG9kKSB7DQogICAgICAgICAgICAgIHZhciByZWNvcmQgPSB0cnlDYXRjaChyZXR1cm5NZXRob2QsIGRlbGVnYXRlLml0ZXJhdG9yLCBhcmcpOw0KICAgICAgICAgICAgICBpZiAocmVjb3JkLnR5cGUgPT09ICJ0aHJvdyIpIHsNCiAgICAgICAgICAgICAgICAvLyBJZiB0aGUgcmV0dXJuIG1ldGhvZCB0aHJldyBhbiBleGNlcHRpb24sIGxldCB0aGF0DQogICAgICAgICAgICAgICAgLy8gZXhjZXB0aW9uIHByZXZhaWwgb3ZlciB0aGUgb3JpZ2luYWwgcmV0dXJuIG9yIHRocm93Lg0KICAgICAgICAgICAgICAgIG1ldGhvZCA9ICJ0aHJvdyI7DQogICAgICAgICAgICAgICAgYXJnID0gcmVjb3JkLmFyZzsNCiAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAobWV0aG9kID09PSAicmV0dXJuIikgew0KICAgICAgICAgICAgICAvLyBDb250aW51ZSB3aXRoIHRoZSBvdXRlciByZXR1cm4sIG5vdyB0aGF0IHRoZSBkZWxlZ2F0ZQ0KICAgICAgICAgICAgICAvLyBpdGVyYXRvciBoYXMgYmVlbiB0ZXJtaW5hdGVkLg0KICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICB9DQoNCiAgICAgICAgICB2YXIgcmVjb3JkID0gdHJ5Q2F0Y2goDQogICAgICAgICAgICBkZWxlZ2F0ZS5pdGVyYXRvclttZXRob2RdLA0KICAgICAgICAgICAgZGVsZWdhdGUuaXRlcmF0b3IsDQogICAgICAgICAgICBhcmcNCiAgICAgICAgICApOw0KDQogICAgICAgICAgaWYgKHJlY29yZC50eXBlID09PSAidGhyb3ciKSB7DQogICAgICAgICAgICBjb250ZXh0LmRlbGVnYXRlID0gbnVsbDsNCg0KICAgICAgICAgICAgLy8gTGlrZSByZXR1cm5pbmcgZ2VuZXJhdG9yLnRocm93KHVuY2F1Z2h0KSwgYnV0IHdpdGhvdXQgdGhlDQogICAgICAgICAgICAvLyBvdmVyaGVhZCBvZiBhbiBleHRyYSBmdW5jdGlvbiBjYWxsLg0KICAgICAgICAgICAgbWV0aG9kID0gInRocm93IjsNCiAgICAgICAgICAgIGFyZyA9IHJlY29yZC5hcmc7DQogICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICB9DQoNCiAgICAgICAgICAvLyBEZWxlZ2F0ZSBnZW5lcmF0b3IgcmFuIGFuZCBoYW5kbGVkIGl0cyBvd24gZXhjZXB0aW9ucyBzbw0KICAgICAgICAgIC8vIHJlZ2FyZGxlc3Mgb2Ygd2hhdCB0aGUgbWV0aG9kIHdhcywgd2UgY29udGludWUgYXMgaWYgaXQgaXMNCiAgICAgICAgICAvLyAibmV4dCIgd2l0aCBhbiB1bmRlZmluZWQgYXJnLg0KICAgICAgICAgIG1ldGhvZCA9ICJuZXh0IjsNCiAgICAgICAgICBhcmcgPSB1bmRlZmluZWQ7DQoNCiAgICAgICAgICB2YXIgaW5mbyA9IHJlY29yZC5hcmc7DQogICAgICAgICAgaWYgKGluZm8uZG9uZSkgew0KICAgICAgICAgICAgY29udGV4dFtkZWxlZ2F0ZS5yZXN1bHROYW1lXSA9IGluZm8udmFsdWU7DQogICAgICAgICAgICBjb250ZXh0Lm5leHQgPSBkZWxlZ2F0ZS5uZXh0TG9jOw0KICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBzdGF0ZSA9IEdlblN0YXRlU3VzcGVuZGVkWWllbGQ7DQogICAgICAgICAgICByZXR1cm4gaW5mbzsNCiAgICAgICAgICB9DQoNCiAgICAgICAgICBjb250ZXh0LmRlbGVnYXRlID0gbnVsbDsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmIChtZXRob2QgPT09ICJuZXh0Iikgew0KICAgICAgICAgIC8vIFNldHRpbmcgY29udGV4dC5fc2VudCBmb3IgbGVnYWN5IHN1cHBvcnQgb2YgQmFiZWwncw0KICAgICAgICAgIC8vIGZ1bmN0aW9uLnNlbnQgaW1wbGVtZW50YXRpb24uDQogICAgICAgICAgY29udGV4dC5zZW50ID0gY29udGV4dC5fc2VudCA9IGFyZzsNCg0KICAgICAgICB9IGVsc2UgaWYgKG1ldGhvZCA9PT0gInRocm93Iikgew0KICAgICAgICAgIGlmIChzdGF0ZSA9PT0gR2VuU3RhdGVTdXNwZW5kZWRTdGFydCkgew0KICAgICAgICAgICAgc3RhdGUgPSBHZW5TdGF0ZUNvbXBsZXRlZDsNCiAgICAgICAgICAgIHRocm93IGFyZzsNCiAgICAgICAgICB9DQoNCiAgICAgICAgICBpZiAoY29udGV4dC5kaXNwYXRjaEV4Y2VwdGlvbihhcmcpKSB7DQogICAgICAgICAgICAvLyBJZiB0aGUgZGlzcGF0Y2hlZCBleGNlcHRpb24gd2FzIGNhdWdodCBieSBhIGNhdGNoIGJsb2NrLA0KICAgICAgICAgICAgLy8gdGhlbiBsZXQgdGhhdCBjYXRjaCBibG9jayBoYW5kbGUgdGhlIGV4Y2VwdGlvbiBub3JtYWxseS4NCiAgICAgICAgICAgIG1ldGhvZCA9ICJuZXh0IjsNCiAgICAgICAgICAgIGFyZyA9IHVuZGVmaW5lZDsNCiAgICAgICAgICB9DQoNCiAgICAgICAgfSBlbHNlIGlmIChtZXRob2QgPT09ICJyZXR1cm4iKSB7DQogICAgICAgICAgY29udGV4dC5hYnJ1cHQoInJldHVybiIsIGFyZyk7DQogICAgICAgIH0NCg0KICAgICAgICBzdGF0ZSA9IEdlblN0YXRlRXhlY3V0aW5nOw0KDQogICAgICAgIHZhciByZWNvcmQgPSB0cnlDYXRjaChpbm5lckZuLCBzZWxmLCBjb250ZXh0KTsNCiAgICAgICAgaWYgKHJlY29yZC50eXBlID09PSAibm9ybWFsIikgew0KICAgICAgICAgIC8vIElmIGFuIGV4Y2VwdGlvbiBpcyB0aHJvd24gZnJvbSBpbm5lckZuLCB3ZSBsZWF2ZSBzdGF0ZSA9PT0NCiAgICAgICAgICAvLyBHZW5TdGF0ZUV4ZWN1dGluZyBhbmQgbG9vcCBiYWNrIGZvciBhbm90aGVyIGludm9jYXRpb24uDQogICAgICAgICAgc3RhdGUgPSBjb250ZXh0LmRvbmUNCiAgICAgICAgICAgID8gR2VuU3RhdGVDb21wbGV0ZWQNCiAgICAgICAgICAgIDogR2VuU3RhdGVTdXNwZW5kZWRZaWVsZDsNCg0KICAgICAgICAgIHZhciBpbmZvID0gew0KICAgICAgICAgICAgdmFsdWU6IHJlY29yZC5hcmcsDQogICAgICAgICAgICBkb25lOiBjb250ZXh0LmRvbmUNCiAgICAgICAgICB9Ow0KDQogICAgICAgICAgaWYgKHJlY29yZC5hcmcgPT09IENvbnRpbnVlU2VudGluZWwpIHsNCiAgICAgICAgICAgIGlmIChjb250ZXh0LmRlbGVnYXRlICYmIG1ldGhvZCA9PT0gIm5leHQiKSB7DQogICAgICAgICAgICAgIC8vIERlbGliZXJhdGVseSBmb3JnZXQgdGhlIGxhc3Qgc2VudCB2YWx1ZSBzbyB0aGF0IHdlIGRvbid0DQogICAgICAgICAgICAgIC8vIGFjY2lkZW50YWxseSBwYXNzIGl0IG9uIHRvIHRoZSBkZWxlZ2F0ZS4NCiAgICAgICAgICAgICAgYXJnID0gdW5kZWZpbmVkOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICByZXR1cm4gaW5mbzsNCiAgICAgICAgICB9DQoNCiAgICAgICAgfSBlbHNlIGlmIChyZWNvcmQudHlwZSA9PT0gInRocm93Iikgew0KICAgICAgICAgIHN0YXRlID0gR2VuU3RhdGVDb21wbGV0ZWQ7DQogICAgICAgICAgLy8gRGlzcGF0Y2ggdGhlIGV4Y2VwdGlvbiBieSBsb29waW5nIGJhY2sgYXJvdW5kIHRvIHRoZQ0KICAgICAgICAgIC8vIGNvbnRleHQuZGlzcGF0Y2hFeGNlcHRpb24oYXJnKSBjYWxsIGFib3ZlLg0KICAgICAgICAgIG1ldGhvZCA9ICJ0aHJvdyI7DQogICAgICAgICAgYXJnID0gcmVjb3JkLmFyZzsNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgIH07DQogIH0NCg0KICAvLyBEZWZpbmUgR2VuZXJhdG9yLnByb3RvdHlwZS57bmV4dCx0aHJvdyxyZXR1cm59IGluIHRlcm1zIG9mIHRoZQ0KICAvLyB1bmlmaWVkIC5faW52b2tlIGhlbHBlciBtZXRob2QuDQogIGRlZmluZUl0ZXJhdG9yTWV0aG9kcyhHcCk7DQoNCiAgR3BbaXRlcmF0b3JTeW1ib2xdID0gZnVuY3Rpb24oKSB7DQogICAgcmV0dXJuIHRoaXM7DQogIH07DQoNCiAgR3BbdG9TdHJpbmdUYWdTeW1ib2xdID0gIkdlbmVyYXRvciI7DQoNCiAgR3AudG9TdHJpbmcgPSBmdW5jdGlvbigpIHsNCiAgICByZXR1cm4gIltvYmplY3QgR2VuZXJhdG9yXSI7DQogIH07DQoNCiAgZnVuY3Rpb24gcHVzaFRyeUVudHJ5KGxvY3MpIHsNCiAgICB2YXIgZW50cnkgPSB7IHRyeUxvYzogbG9jc1swXSB9Ow0KDQogICAgaWYgKDEgaW4gbG9jcykgew0KICAgICAgZW50cnkuY2F0Y2hMb2MgPSBsb2NzWzFdOw0KICAgIH0NCg0KICAgIGlmICgyIGluIGxvY3MpIHsNCiAgICAgIGVudHJ5LmZpbmFsbHlMb2MgPSBsb2NzWzJdOw0KICAgICAgZW50cnkuYWZ0ZXJMb2MgPSBsb2NzWzNdOw0KICAgIH0NCg0KICAgIHRoaXMudHJ5RW50cmllcy5wdXNoKGVudHJ5KTsNCiAgfQ0KDQogIGZ1bmN0aW9uIHJlc2V0VHJ5RW50cnkoZW50cnkpIHsNCiAgICB2YXIgcmVjb3JkID0gZW50cnkuY29tcGxldGlvbiB8fCB7fTsNCiAgICByZWNvcmQudHlwZSA9ICJub3JtYWwiOw0KICAgIGRlbGV0ZSByZWNvcmQuYXJnOw0KICAgIGVudHJ5LmNvbXBsZXRpb24gPSByZWNvcmQ7DQogIH0NCg0KICBmdW5jdGlvbiBDb250ZXh0KHRyeUxvY3NMaXN0KSB7DQogICAgLy8gVGhlIHJvb3QgZW50cnkgb2JqZWN0IChlZmZlY3RpdmVseSBhIHRyeSBzdGF0ZW1lbnQgd2l0aG91dCBhIGNhdGNoDQogICAgLy8gb3IgYSBmaW5hbGx5IGJsb2NrKSBnaXZlcyB1cyBhIHBsYWNlIHRvIHN0b3JlIHZhbHVlcyB0aHJvd24gZnJvbQ0KICAgIC8vIGxvY2F0aW9ucyB3aGVyZSB0aGVyZSBpcyBubyBlbmNsb3NpbmcgdHJ5IHN0YXRlbWVudC4NCiAgICB0aGlzLnRyeUVudHJpZXMgPSBbeyB0cnlMb2M6ICJyb290IiB9XTsNCiAgICB0cnlMb2NzTGlzdC5mb3JFYWNoKHB1c2hUcnlFbnRyeSwgdGhpcyk7DQogICAgdGhpcy5yZXNldCh0cnVlKTsNCiAgfQ0KDQogIHJ1bnRpbWUua2V5cyA9IGZ1bmN0aW9uKG9iamVjdCkgew0KICAgIHZhciBrZXlzID0gW107DQogICAgZm9yICh2YXIga2V5IGluIG9iamVjdCkgew0KICAgICAga2V5cy5wdXNoKGtleSk7DQogICAgfQ0KICAgIGtleXMucmV2ZXJzZSgpOw0KDQogICAgLy8gUmF0aGVyIHRoYW4gcmV0dXJuaW5nIGFuIG9iamVjdCB3aXRoIGEgbmV4dCBtZXRob2QsIHdlIGtlZXANCiAgICAvLyB0aGluZ3Mgc2ltcGxlIGFuZCByZXR1cm4gdGhlIG5leHQgZnVuY3Rpb24gaXRzZWxmLg0KICAgIHJldHVybiBmdW5jdGlvbiBuZXh0KCkgew0KICAgICAgd2hpbGUgKGtleXMubGVuZ3RoKSB7DQogICAgICAgIHZhciBrZXkgPSBrZXlzLnBvcCgpOw0KICAgICAgICBpZiAoa2V5IGluIG9iamVjdCkgew0KICAgICAgICAgIG5leHQudmFsdWUgPSBrZXk7DQogICAgICAgICAgbmV4dC5kb25lID0gZmFsc2U7DQogICAgICAgICAgcmV0dXJuIG5leHQ7DQogICAgICAgIH0NCiAgICAgIH0NCg0KICAgICAgLy8gVG8gYXZvaWQgY3JlYXRpbmcgYW4gYWRkaXRpb25hbCBvYmplY3QsIHdlIGp1c3QgaGFuZyB0aGUgLnZhbHVlDQogICAgICAvLyBhbmQgLmRvbmUgcHJvcGVydGllcyBvZmYgdGhlIG5leHQgZnVuY3Rpb24gb2JqZWN0IGl0c2VsZi4gVGhpcw0KICAgICAgLy8gYWxzbyBlbnN1cmVzIHRoYXQgdGhlIG1pbmlmaWVyIHdpbGwgbm90IGFub255bWl6ZSB0aGUgZnVuY3Rpb24uDQogICAgICBuZXh0LmRvbmUgPSB0cnVlOw0KICAgICAgcmV0dXJuIG5leHQ7DQogICAgfTsNCiAgfTsNCg0KICBmdW5jdGlvbiB2YWx1ZXMoaXRlcmFibGUpIHsNCiAgICBpZiAoaXRlcmFibGUpIHsNCiAgICAgIHZhciBpdGVyYXRvck1ldGhvZCA9IGl0ZXJhYmxlW2l0ZXJhdG9yU3ltYm9sXTsNCiAgICAgIGlmIChpdGVyYXRvck1ldGhvZCkgew0KICAgICAgICByZXR1cm4gaXRlcmF0b3JNZXRob2QuY2FsbChpdGVyYWJsZSk7DQogICAgICB9DQoNCiAgICAgIGlmICh0eXBlb2YgaXRlcmFibGUubmV4dCA9PT0gImZ1bmN0aW9uIikgew0KICAgICAgICByZXR1cm4gaXRlcmFibGU7DQogICAgICB9DQoNCiAgICAgIGlmICghaXNOYU4oaXRlcmFibGUubGVuZ3RoKSkgew0KICAgICAgICB2YXIgaSA9IC0xLCBuZXh0ID0gZnVuY3Rpb24gbmV4dCgpIHsNCiAgICAgICAgICB3aGlsZSAoKytpIDwgaXRlcmFibGUubGVuZ3RoKSB7DQogICAgICAgICAgICBpZiAoaGFzT3duLmNhbGwoaXRlcmFibGUsIGkpKSB7DQogICAgICAgICAgICAgIG5leHQudmFsdWUgPSBpdGVyYWJsZVtpXTsNCiAgICAgICAgICAgICAgbmV4dC5kb25lID0gZmFsc2U7DQogICAgICAgICAgICAgIHJldHVybiBuZXh0Ow0KICAgICAgICAgICAgfQ0KICAgICAgICAgIH0NCg0KICAgICAgICAgIG5leHQudmFsdWUgPSB1bmRlZmluZWQ7DQogICAgICAgICAgbmV4dC5kb25lID0gdHJ1ZTsNCg0KICAgICAgICAgIHJldHVybiBuZXh0Ow0KICAgICAgICB9Ow0KDQogICAgICAgIHJldHVybiBuZXh0Lm5leHQgPSBuZXh0Ow0KICAgICAgfQ0KICAgIH0NCg0KICAgIC8vIFJldHVybiBhbiBpdGVyYXRvciB3aXRoIG5vIHZhbHVlcy4NCiAgICByZXR1cm4geyBuZXh0OiBkb25lUmVzdWx0IH07DQogIH0NCiAgcnVudGltZS52YWx1ZXMgPSB2YWx1ZXM7DQoNCiAgZnVuY3Rpb24gZG9uZVJlc3VsdCgpIHsNCiAgICByZXR1cm4geyB2YWx1ZTogdW5kZWZpbmVkLCBkb25lOiB0cnVlIH07DQogIH0NCg0KICBDb250ZXh0LnByb3RvdHlwZSA9IHsNCiAgICBjb25zdHJ1Y3RvcjogQ29udGV4dCwNCg0KICAgIHJlc2V0OiBmdW5jdGlvbihza2lwVGVtcFJlc2V0KSB7DQogICAgICB0aGlzLnByZXYgPSAwOw0KICAgICAgdGhpcy5uZXh0ID0gMDsNCiAgICAgIC8vIFJlc2V0dGluZyBjb250ZXh0Ll9zZW50IGZvciBsZWdhY3kgc3VwcG9ydCBvZiBCYWJlbCdzDQogICAgICAvLyBmdW5jdGlvbi5zZW50IGltcGxlbWVudGF0aW9uLg0KICAgICAgdGhpcy5zZW50ID0gdGhpcy5fc2VudCA9IHVuZGVmaW5lZDsNCiAgICAgIHRoaXMuZG9uZSA9IGZhbHNlOw0KICAgICAgdGhpcy5kZWxlZ2F0ZSA9IG51bGw7DQoNCiAgICAgIHRoaXMudHJ5RW50cmllcy5mb3JFYWNoKHJlc2V0VHJ5RW50cnkpOw0KDQogICAgICBpZiAoIXNraXBUZW1wUmVzZXQpIHsNCiAgICAgICAgZm9yICh2YXIgbmFtZSBpbiB0aGlzKSB7DQogICAgICAgICAgLy8gTm90IHN1cmUgYWJvdXQgdGhlIG9wdGltYWwgb3JkZXIgb2YgdGhlc2UgY29uZGl0aW9uczoNCiAgICAgICAgICBpZiAobmFtZS5jaGFyQXQoMCkgPT09ICJ0IiAmJg0KICAgICAgICAgICAgICBoYXNPd24uY2FsbCh0aGlzLCBuYW1lKSAmJg0KICAgICAgICAgICAgICAhaXNOYU4oK25hbWUuc2xpY2UoMSkpKSB7DQogICAgICAgICAgICB0aGlzW25hbWVdID0gdW5kZWZpbmVkOw0KICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgfQ0KICAgIH0sDQoNCiAgICBzdG9wOiBmdW5jdGlvbigpIHsNCiAgICAgIHRoaXMuZG9uZSA9IHRydWU7DQoNCiAgICAgIHZhciByb290RW50cnkgPSB0aGlzLnRyeUVudHJpZXNbMF07DQogICAgICB2YXIgcm9vdFJlY29yZCA9IHJvb3RFbnRyeS5jb21wbGV0aW9uOw0KICAgICAgaWYgKHJvb3RSZWNvcmQudHlwZSA9PT0gInRocm93Iikgew0KICAgICAgICB0aHJvdyByb290UmVjb3JkLmFyZzsNCiAgICAgIH0NCg0KICAgICAgcmV0dXJuIHRoaXMucnZhbDsNCiAgICB9LA0KDQogICAgZGlzcGF0Y2hFeGNlcHRpb246IGZ1bmN0aW9uKGV4Y2VwdGlvbikgew0KICAgICAgaWYgKHRoaXMuZG9uZSkgew0KICAgICAgICB0aHJvdyBleGNlcHRpb247DQogICAgICB9DQoNCiAgICAgIHZhciBjb250ZXh0ID0gdGhpczsNCiAgICAgIGZ1bmN0aW9uIGhhbmRsZShsb2MsIGNhdWdodCkgew0KICAgICAgICByZWNvcmQudHlwZSA9ICJ0aHJvdyI7DQogICAgICAgIHJlY29yZC5hcmcgPSBleGNlcHRpb247DQogICAgICAgIGNvbnRleHQubmV4dCA9IGxvYzsNCiAgICAgICAgcmV0dXJuICEhY2F1Z2h0Ow0KICAgICAgfQ0KDQogICAgICBmb3IgKHZhciBpID0gdGhpcy50cnlFbnRyaWVzLmxlbmd0aCAtIDE7IGkgPj0gMDsgLS1pKSB7DQogICAgICAgIHZhciBlbnRyeSA9IHRoaXMudHJ5RW50cmllc1tpXTsNCiAgICAgICAgdmFyIHJlY29yZCA9IGVudHJ5LmNvbXBsZXRpb247DQoNCiAgICAgICAgaWYgKGVudHJ5LnRyeUxvYyA9PT0gInJvb3QiKSB7DQogICAgICAgICAgLy8gRXhjZXB0aW9uIHRocm93biBvdXRzaWRlIG9mIGFueSB0cnkgYmxvY2sgdGhhdCBjb3VsZCBoYW5kbGUNCiAgICAgICAgICAvLyBpdCwgc28gc2V0IHRoZSBjb21wbGV0aW9uIHZhbHVlIG9mIHRoZSBlbnRpcmUgZnVuY3Rpb24gdG8NCiAgICAgICAgICAvLyB0aHJvdyB0aGUgZXhjZXB0aW9uLg0KICAgICAgICAgIHJldHVybiBoYW5kbGUoImVuZCIpOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKGVudHJ5LnRyeUxvYyA8PSB0aGlzLnByZXYpIHsNCiAgICAgICAgICB2YXIgaGFzQ2F0Y2ggPSBoYXNPd24uY2FsbChlbnRyeSwgImNhdGNoTG9jIik7DQogICAgICAgICAgdmFyIGhhc0ZpbmFsbHkgPSBoYXNPd24uY2FsbChlbnRyeSwgImZpbmFsbHlMb2MiKTsNCg0KICAgICAgICAgIGlmIChoYXNDYXRjaCAmJiBoYXNGaW5hbGx5KSB7DQogICAgICAgICAgICBpZiAodGhpcy5wcmV2IDwgZW50cnkuY2F0Y2hMb2MpIHsNCiAgICAgICAgICAgICAgcmV0dXJuIGhhbmRsZShlbnRyeS5jYXRjaExvYywgdHJ1ZSk7DQogICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMucHJldiA8IGVudHJ5LmZpbmFsbHlMb2MpIHsNCiAgICAgICAgICAgICAgcmV0dXJuIGhhbmRsZShlbnRyeS5maW5hbGx5TG9jKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgIH0gZWxzZSBpZiAoaGFzQ2F0Y2gpIHsNCiAgICAgICAgICAgIGlmICh0aGlzLnByZXYgPCBlbnRyeS5jYXRjaExvYykgew0KICAgICAgICAgICAgICByZXR1cm4gaGFuZGxlKGVudHJ5LmNhdGNoTG9jLCB0cnVlKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgIH0gZWxzZSBpZiAoaGFzRmluYWxseSkgew0KICAgICAgICAgICAgaWYgKHRoaXMucHJldiA8IGVudHJ5LmZpbmFsbHlMb2MpIHsNCiAgICAgICAgICAgICAgcmV0dXJuIGhhbmRsZShlbnRyeS5maW5hbGx5TG9jKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoInRyeSBzdGF0ZW1lbnQgd2l0aG91dCBjYXRjaCBvciBmaW5hbGx5Iik7DQogICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICB9DQogICAgfSwNCg0KICAgIGFicnVwdDogZnVuY3Rpb24odHlwZSwgYXJnKSB7DQogICAgICBmb3IgKHZhciBpID0gdGhpcy50cnlFbnRyaWVzLmxlbmd0aCAtIDE7IGkgPj0gMDsgLS1pKSB7DQogICAgICAgIHZhciBlbnRyeSA9IHRoaXMudHJ5RW50cmllc1tpXTsNCiAgICAgICAgaWYgKGVudHJ5LnRyeUxvYyA8PSB0aGlzLnByZXYgJiYNCiAgICAgICAgICAgIGhhc093bi5jYWxsKGVudHJ5LCAiZmluYWxseUxvYyIpICYmDQogICAgICAgICAgICB0aGlzLnByZXYgPCBlbnRyeS5maW5hbGx5TG9jKSB7DQogICAgICAgICAgdmFyIGZpbmFsbHlFbnRyeSA9IGVudHJ5Ow0KICAgICAgICAgIGJyZWFrOw0KICAgICAgICB9DQogICAgICB9DQoNCiAgICAgIGlmIChmaW5hbGx5RW50cnkgJiYNCiAgICAgICAgICAodHlwZSA9PT0gImJyZWFrIiB8fA0KICAgICAgICAgICB0eXBlID09PSAiY29udGludWUiKSAmJg0KICAgICAgICAgIGZpbmFsbHlFbnRyeS50cnlMb2MgPD0gYXJnICYmDQogICAgICAgICAgYXJnIDw9IGZpbmFsbHlFbnRyeS5maW5hbGx5TG9jKSB7DQogICAgICAgIC8vIElnbm9yZSB0aGUgZmluYWxseSBlbnRyeSBpZiBjb250cm9sIGlzIG5vdCBqdW1waW5nIHRvIGENCiAgICAgICAgLy8gbG9jYXRpb24gb3V0c2lkZSB0aGUgdHJ5L2NhdGNoIGJsb2NrLg0KICAgICAgICBmaW5hbGx5RW50cnkgPSBudWxsOw0KICAgICAgfQ0KDQogICAgICB2YXIgcmVjb3JkID0gZmluYWxseUVudHJ5ID8gZmluYWxseUVudHJ5LmNvbXBsZXRpb24gOiB7fTsNCiAgICAgIHJlY29yZC50eXBlID0gdHlwZTsNCiAgICAgIHJlY29yZC5hcmcgPSBhcmc7DQoNCiAgICAgIGlmIChmaW5hbGx5RW50cnkpIHsNCiAgICAgICAgdGhpcy5uZXh0ID0gZmluYWxseUVudHJ5LmZpbmFsbHlMb2M7DQogICAgICB9IGVsc2Ugew0KICAgICAgICB0aGlzLmNvbXBsZXRlKHJlY29yZCk7DQogICAgICB9DQoNCiAgICAgIHJldHVybiBDb250aW51ZVNlbnRpbmVsOw0KICAgIH0sDQoNCiAgICBjb21wbGV0ZTogZnVuY3Rpb24ocmVjb3JkLCBhZnRlckxvYykgew0KICAgICAgaWYgKHJlY29yZC50eXBlID09PSAidGhyb3ciKSB7DQogICAgICAgIHRocm93IHJlY29yZC5hcmc7DQogICAgICB9DQoNCiAgICAgIGlmIChyZWNvcmQudHlwZSA9PT0gImJyZWFrIiB8fA0KICAgICAgICAgIHJlY29yZC50eXBlID09PSAiY29udGludWUiKSB7DQogICAgICAgIHRoaXMubmV4dCA9IHJlY29yZC5hcmc7DQogICAgICB9IGVsc2UgaWYgKHJlY29yZC50eXBlID09PSAicmV0dXJuIikgew0KICAgICAgICB0aGlzLnJ2YWwgPSByZWNvcmQuYXJnOw0KICAgICAgICB0aGlzLm5leHQgPSAiZW5kIjsNCiAgICAgIH0gZWxzZSBpZiAocmVjb3JkLnR5cGUgPT09ICJub3JtYWwiICYmIGFmdGVyTG9jKSB7DQogICAgICAgIHRoaXMubmV4dCA9IGFmdGVyTG9jOw0KICAgICAgfQ0KICAgIH0sDQoNCiAgICBmaW5pc2g6IGZ1bmN0aW9uKGZpbmFsbHlMb2MpIHsNCiAgICAgIGZvciAodmFyIGkgPSB0aGlzLnRyeUVudHJpZXMubGVuZ3RoIC0gMTsgaSA+PSAwOyAtLWkpIHsNCiAgICAgICAgdmFyIGVudHJ5ID0gdGhpcy50cnlFbnRyaWVzW2ldOw0KICAgICAgICBpZiAoZW50cnkuZmluYWxseUxvYyA9PT0gZmluYWxseUxvYykgew0KICAgICAgICAgIHRoaXMuY29tcGxldGUoZW50cnkuY29tcGxldGlvbiwgZW50cnkuYWZ0ZXJMb2MpOw0KICAgICAgICAgIHJlc2V0VHJ5RW50cnkoZW50cnkpOw0KICAgICAgICAgIHJldHVybiBDb250aW51ZVNlbnRpbmVsOw0KICAgICAgICB9DQogICAgICB9DQogICAgfSwNCg0KICAgICJjYXRjaCI6IGZ1bmN0aW9uKHRyeUxvYykgew0KICAgICAgZm9yICh2YXIgaSA9IHRoaXMudHJ5RW50cmllcy5sZW5ndGggLSAxOyBpID49IDA7IC0taSkgew0KICAgICAgICB2YXIgZW50cnkgPSB0aGlzLnRyeUVudHJpZXNbaV07DQogICAgICAgIGlmIChlbnRyeS50cnlMb2MgPT09IHRyeUxvYykgew0KICAgICAgICAgIHZhciByZWNvcmQgPSBlbnRyeS5jb21wbGV0aW9uOw0KICAgICAgICAgIGlmIChyZWNvcmQudHlwZSA9PT0gInRocm93Iikgew0KICAgICAgICAgICAgdmFyIHRocm93biA9IHJlY29yZC5hcmc7DQogICAgICAgICAgICByZXNldFRyeUVudHJ5KGVudHJ5KTsNCiAgICAgICAgICB9DQogICAgICAgICAgcmV0dXJuIHRocm93bjsNCiAgICAgICAgfQ0KICAgICAgfQ0KDQogICAgICAvLyBUaGUgY29udGV4dC5jYXRjaCBtZXRob2QgbXVzdCBvbmx5IGJlIGNhbGxlZCB3aXRoIGEgbG9jYXRpb24NCiAgICAgIC8vIGFyZ3VtZW50IHRoYXQgY29ycmVzcG9uZHMgdG8gYSBrbm93biBjYXRjaCBibG9jay4NCiAgICAgIHRocm93IG5ldyBFcnJvcigiaWxsZWdhbCBjYXRjaCBhdHRlbXB0Iik7DQogICAgfSwNCg0KICAgIGRlbGVnYXRlWWllbGQ6IGZ1bmN0aW9uKGl0ZXJhYmxlLCByZXN1bHROYW1lLCBuZXh0TG9jKSB7DQogICAgICB0aGlzLmRlbGVnYXRlID0gew0KICAgICAgICBpdGVyYXRvcjogdmFsdWVzKGl0ZXJhYmxlKSwNCiAgICAgICAgcmVzdWx0TmFtZTogcmVzdWx0TmFtZSwNCiAgICAgICAgbmV4dExvYzogbmV4dExvYw0KICAgICAgfTsNCg0KICAgICAgcmV0dXJuIENvbnRpbnVlU2VudGluZWw7DQogICAgfQ0KICB9Ow0KfSkoDQogIC8vIEFtb25nIHRoZSB2YXJpb3VzIHRyaWNrcyBmb3Igb2J0YWluaW5nIGEgcmVmZXJlbmNlIHRvIHRoZSBnbG9iYWwNCiAgLy8gb2JqZWN0LCB0aGlzIHNlZW1zIHRvIGJlIHRoZSBtb3N0IHJlbGlhYmxlIHRlY2huaXF1ZSB0aGF0IGRvZXMgbm90DQogIC8vIHVzZSBpbmRpcmVjdCBldmFsICh3aGljaCB2aW9sYXRlcyBDb250ZW50IFNlY3VyaXR5IFBvbGljeSkuDQogIHR5cGVvZiBnbG9iYWwgPT09ICJvYmplY3QiID8gZ2xvYmFsIDoNCiAgdHlwZW9mIHdpbmRvdyA9PT0gIm9iamVjdCIgPyB3aW5kb3cgOg0KICB0eXBlb2Ygc2VsZiA9PT0gIm9iamVjdCIgPyBzZWxmIDogdGhpcw0KKTsNCg0KfSx7fV0sMjk4OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCi8qKg0KKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YefjbyBlIFNpc3RlbWFzIFNBDQoqIENvcHlyaWdodCAyMDE2IElORVNDLUlEDQoqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTA0KKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVg0KKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0ENCiogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRw0KKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWUNCiogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU4NCioNCiogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7DQoqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4NCiogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0DQoqDQoqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wDQoqDQoqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUNCiogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywNCiogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuDQoqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQNCiogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuDQoqKi8NCg0KLy8gRGlzdHJpYnV0aW9uIGZpbGUgZm9yIE1lc3NhZ2VGYWN0b3J5LmpzIA0KLy8gdmVyc2lvbjogMC4zLjANCi8vIExhc3QgYnVpbGQ6IFdlZCBKdW4gMjkgMjAxNiAxODoxODozMiBHTVQrMDEwMCAoV0VTVCkNCg0KIWZ1bmN0aW9uKGUpe2lmKCJvYmplY3QiPT10eXBlb2YgZXhwb3J0cyYmInVuZGVmaW5lZCIhPXR5cGVvZiBtb2R1bGUpbW9kdWxlLmV4cG9ydHM9ZSgpO2Vsc2UgaWYoImZ1bmN0aW9uIj09dHlwZW9mIGRlZmluZSYmZGVmaW5lLmFtZClkZWZpbmUoW10sZSk7ZWxzZXt2YXIgdDt0PSJ1bmRlZmluZWQiIT10eXBlb2Ygd2luZG93P3dpbmRvdzoidW5kZWZpbmVkIiE9dHlwZW9mIGdsb2JhbD9nbG9iYWw6InVuZGVmaW5lZCIhPXR5cGVvZiBzZWxmP3NlbGY6dGhpcyx0Lk1lc3NhZ2VGYWN0b3J5PWUoKX19KGZ1bmN0aW9uKCl7dmFyIGU7cmV0dXJuIGZ1bmN0aW9uIHQoZSxyLG4pe2Z1bmN0aW9uIG8oYSxzKXtpZighclthXSl7aWYoIWVbYV0pe3ZhciB1PSJmdW5jdGlvbiI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlO2lmKCFzJiZ1KXJldHVybiB1KGEsITApO2lmKGkpcmV0dXJuIGkoYSwhMCk7dmFyIGw9bmV3IEVycm9yKCJDYW5ub3QgZmluZCBtb2R1bGUgJyIrYSsiJyIpO3Rocm93IGwuY29kZT0iTU9EVUxFX05PVF9GT1VORCIsbH12YXIgYz1yW2FdPXtleHBvcnRzOnt9fTtlW2FdWzBdLmNhbGwoYy5leHBvcnRzLGZ1bmN0aW9uKHQpe3ZhciByPWVbYV1bMV1bdF07cmV0dXJuIG8ocj9yOnQpfSxjLGMuZXhwb3J0cyx0LGUscixuKX1yZXR1cm4gclthXS5leHBvcnRzfWZvcih2YXIgaT0iZnVuY3Rpb24iPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZSxhPTA7YTxuLmxlbmd0aDthKyspbyhuW2FdKTtyZXR1cm4gb30oezE6W2Z1bmN0aW9uKGUsdCxyKXt0LmV4cG9ydHM9eyJkZWZhdWx0IjplKCJjb3JlLWpzL2xpYnJhcnkvZm4vb2JqZWN0L2NyZWF0ZSIpLF9fZXNNb2R1bGU6ITB9fSx7ImNvcmUtanMvbGlicmFyeS9mbi9vYmplY3QvY3JlYXRlIjoxN31dLDI6W2Z1bmN0aW9uKGUsdCxyKXt0LmV4cG9ydHM9eyJkZWZhdWx0IjplKCJjb3JlLWpzL2xpYnJhcnkvZm4vb2JqZWN0L2RlZmluZS1wcm9wZXJ0eSIpLF9fZXNNb2R1bGU6ITB9fSx7ImNvcmUtanMvbGlicmFyeS9mbi9vYmplY3QvZGVmaW5lLXByb3BlcnR5IjoxOH1dLDM6W2Z1bmN0aW9uKGUsdCxyKXt0LmV4cG9ydHM9eyJkZWZhdWx0IjplKCJjb3JlLWpzL2xpYnJhcnkvZm4vb2JqZWN0L2ZyZWV6ZSIpLF9fZXNNb2R1bGU6ITB9fSx7ImNvcmUtanMvbGlicmFyeS9mbi9vYmplY3QvZnJlZXplIjoxOX1dLDQ6W2Z1bmN0aW9uKGUsdCxyKXt0LmV4cG9ydHM9eyJkZWZhdWx0IjplKCJjb3JlLWpzL2xpYnJhcnkvZm4vb2JqZWN0L2dldC1vd24tcHJvcGVydHktZGVzY3JpcHRvciIpLF9fZXNNb2R1bGU6ITB9fSx7ImNvcmUtanMvbGlicmFyeS9mbi9vYmplY3QvZ2V0LW93bi1wcm9wZXJ0eS1kZXNjcmlwdG9yIjoyMH1dLDU6W2Z1bmN0aW9uKGUsdCxyKXt0LmV4cG9ydHM9eyJkZWZhdWx0IjplKCJjb3JlLWpzL2xpYnJhcnkvZm4vb2JqZWN0L2dldC1wcm90b3R5cGUtb2YiKSxfX2VzTW9kdWxlOiEwfX0seyJjb3JlLWpzL2xpYnJhcnkvZm4vb2JqZWN0L2dldC1wcm90b3R5cGUtb2YiOjIxfV0sNjpbZnVuY3Rpb24oZSx0LHIpe3QuZXhwb3J0cz17ImRlZmF1bHQiOmUoImNvcmUtanMvbGlicmFyeS9mbi9vYmplY3Qva2V5cyIpLF9fZXNNb2R1bGU6ITB9fSx7ImNvcmUtanMvbGlicmFyeS9mbi9vYmplY3Qva2V5cyI6MjJ9XSw3OltmdW5jdGlvbihlLHQscil7dC5leHBvcnRzPXsiZGVmYXVsdCI6ZSgiY29yZS1qcy9saWJyYXJ5L2ZuL29iamVjdC9zZXQtcHJvdG90eXBlLW9mIiksX19lc01vZHVsZTohMH19LHsiY29yZS1qcy9saWJyYXJ5L2ZuL29iamVjdC9zZXQtcHJvdG90eXBlLW9mIjoyM31dLDg6W2Z1bmN0aW9uKGUsdCxyKXt0LmV4cG9ydHM9eyJkZWZhdWx0IjplKCJjb3JlLWpzL2xpYnJhcnkvZm4vc3ltYm9sIiksX19lc01vZHVsZTohMH19LHsiY29yZS1qcy9saWJyYXJ5L2ZuL3N5bWJvbCI6MjR9XSw5OltmdW5jdGlvbihlLHQscil7dC5leHBvcnRzPXsiZGVmYXVsdCI6ZSgiY29yZS1qcy9saWJyYXJ5L2ZuL3N5bWJvbC9pdGVyYXRvciIpLF9fZXNNb2R1bGU6ITB9fSx7ImNvcmUtanMvbGlicmFyeS9mbi9zeW1ib2wvaXRlcmF0b3IiOjI1fV0sMTA6W2Z1bmN0aW9uKGUsdCxyKXsidXNlIHN0cmljdCI7ci5fX2VzTW9kdWxlPSEwLHJbImRlZmF1bHQiXT1mdW5jdGlvbihlLHQpe2lmKCEoZSBpbnN0YW5jZW9mIHQpKXRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpfX0se31dLDExOltmdW5jdGlvbihlLHQscil7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIG4oZSl7cmV0dXJuIGUmJmUuX19lc01vZHVsZT9lOnsiZGVmYXVsdCI6ZX19ci5fX2VzTW9kdWxlPSEwO3ZhciBvPWUoIi4uL2NvcmUtanMvb2JqZWN0L2RlZmluZS1wcm9wZXJ0eSIpLGk9bihvKTtyWyJkZWZhdWx0Il09ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKGUsdCl7Zm9yKHZhciByPTA7cjx0Lmxlbmd0aDtyKyspe3ZhciBuPXRbcl07bi5lbnVtZXJhYmxlPW4uZW51bWVyYWJsZXx8ITEsbi5jb25maWd1cmFibGU9ITAsInZhbHVlImluIG4mJihuLndyaXRhYmxlPSEwKSwoMCxpWyJkZWZhdWx0Il0pKGUsbi5rZXksbil9fXJldHVybiBmdW5jdGlvbih0LHIsbil7cmV0dXJuIHImJmUodC5wcm90b3R5cGUsciksbiYmZSh0LG4pLHR9fSgpfSx7Ii4uL2NvcmUtanMvb2JqZWN0L2RlZmluZS1wcm9wZXJ0eSI6Mn1dLDEyOltmdW5jdGlvbihlLHQscil7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIG4oZSl7cmV0dXJuIGUmJmUuX19lc01vZHVsZT9lOnsiZGVmYXVsdCI6ZX19ci5fX2VzTW9kdWxlPSEwO3ZhciBvPWUoIi4uL2NvcmUtanMvb2JqZWN0L2dldC1wcm90b3R5cGUtb2YiKSxpPW4obyksYT1lKCIuLi9jb3JlLWpzL29iamVjdC9nZXQtb3duLXByb3BlcnR5LWRlc2NyaXB0b3IiKSxzPW4oYSk7clsiZGVmYXVsdCJdPWZ1bmN0aW9uIHUoZSx0LHIpe251bGw9PT1lJiYoZT1GdW5jdGlvbi5wcm90b3R5cGUpO3ZhciBuPSgwLHNbImRlZmF1bHQiXSkoZSx0KTtpZih2b2lkIDA9PT1uKXt2YXIgbz0oMCxpWyJkZWZhdWx0Il0pKGUpO3JldHVybiBudWxsPT09bz92b2lkIDA6dShvLHQscil9aWYoInZhbHVlImluIG4pcmV0dXJuIG4udmFsdWU7dmFyIGE9bi5nZXQ7aWYodm9pZCAwIT09YSlyZXR1cm4gYS5jYWxsKHIpfX0seyIuLi9jb3JlLWpzL29iamVjdC9nZXQtb3duLXByb3BlcnR5LWRlc2NyaXB0b3IiOjQsIi4uL2NvcmUtanMvb2JqZWN0L2dldC1wcm90b3R5cGUtb2YiOjV9XSwxMzpbZnVuY3Rpb24oZSx0LHIpeyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiBuKGUpe3JldHVybiBlJiZlLl9fZXNNb2R1bGU/ZTp7ImRlZmF1bHQiOmV9fXIuX19lc01vZHVsZT0hMDt2YXIgbz1lKCIuLi9jb3JlLWpzL29iamVjdC9zZXQtcHJvdG90eXBlLW9mIiksaT1uKG8pLGE9ZSgiLi4vY29yZS1qcy9vYmplY3QvY3JlYXRlIikscz1uKGEpLHU9ZSgiLi4vaGVscGVycy90eXBlb2YiKSxsPW4odSk7clsiZGVmYXVsdCJdPWZ1bmN0aW9uKGUsdCl7aWYoImZ1bmN0aW9uIiE9dHlwZW9mIHQmJm51bGwhPT10KXRocm93IG5ldyBUeXBlRXJyb3IoIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgIisoInVuZGVmaW5lZCI9PXR5cGVvZiB0PyJ1bmRlZmluZWQiOigwLGxbImRlZmF1bHQiXSkodCkpKTtlLnByb3RvdHlwZT0oMCxzWyJkZWZhdWx0Il0pKHQmJnQucHJvdG90eXBlLHtjb25zdHJ1Y3Rvcjp7dmFsdWU6ZSxlbnVtZXJhYmxlOiExLHdyaXRhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH19KSx0JiYoaVsiZGVmYXVsdCJdPygwLGlbImRlZmF1bHQiXSkoZSx0KTplLl9fcHJvdG9fXz10KX19LHsiLi4vY29yZS1qcy9vYmplY3QvY3JlYXRlIjoxLCIuLi9jb3JlLWpzL29iamVjdC9zZXQtcHJvdG90eXBlLW9mIjo3LCIuLi9oZWxwZXJzL3R5cGVvZiI6MTV9XSwxNDpbZnVuY3Rpb24oZSx0LHIpeyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiBuKGUpe3JldHVybiBlJiZlLl9fZXNNb2R1bGU/ZTp7ImRlZmF1bHQiOmV9fXIuX19lc01vZHVsZT0hMDt2YXIgbz1lKCIuLi9oZWxwZXJzL3R5cGVvZiIpLGk9bihvKTtyWyJkZWZhdWx0Il09ZnVuY3Rpb24oZSx0KXtpZighZSl0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZCIpO3JldHVybiF0fHwib2JqZWN0IiE9PSgidW5kZWZpbmVkIj09dHlwZW9mIHQ/InVuZGVmaW5lZCI6KDAsaVsiZGVmYXVsdCJdKSh0KSkmJiJmdW5jdGlvbiIhPXR5cGVvZiB0P2U6dH19LHsiLi4vaGVscGVycy90eXBlb2YiOjE1fV0sMTU6W2Z1bmN0aW9uKGUsdCxyKXsidXNlIHN0cmljdCI7ZnVuY3Rpb24gbihlKXtyZXR1cm4gZSYmZS5fX2VzTW9kdWxlP2U6eyJkZWZhdWx0IjplfX1yLl9fZXNNb2R1bGU9ITA7dmFyIG89ZSgiLi4vY29yZS1qcy9zeW1ib2wvaXRlcmF0b3IiKSxpPW4obyksYT1lKCIuLi9jb3JlLWpzL3N5bWJvbCIpLHM9bihhKSx1PSJmdW5jdGlvbiI9PXR5cGVvZiBzWyJkZWZhdWx0Il0mJiJzeW1ib2wiPT10eXBlb2YgaVsiZGVmYXVsdCJdP2Z1bmN0aW9uKGUpe3JldHVybiB0eXBlb2YgZX06ZnVuY3Rpb24oZSl7cmV0dXJuIGUmJiJmdW5jdGlvbiI9PXR5cGVvZiBzWyJkZWZhdWx0Il0mJmUuY29uc3RydWN0b3I9PT1zWyJkZWZhdWx0Il0/InN5bWJvbCI6dHlwZW9mIGV9O3JbImRlZmF1bHQiXT0iZnVuY3Rpb24iPT10eXBlb2Ygc1siZGVmYXVsdCJdJiYic3ltYm9sIj09PXUoaVsiZGVmYXVsdCJdKT9mdW5jdGlvbihlKXtyZXR1cm4idW5kZWZpbmVkIj09dHlwZW9mIGU/InVuZGVmaW5lZCI6dShlKX06ZnVuY3Rpb24oZSl7cmV0dXJuIGUmJiJmdW5jdGlvbiI9PXR5cGVvZiBzWyJkZWZhdWx0Il0mJmUuY29uc3RydWN0b3I9PT1zWyJkZWZhdWx0Il0/InN5bWJvbCI6InVuZGVmaW5lZCI9PXR5cGVvZiBlPyJ1bmRlZmluZWQiOnUoZSl9fSx7Ii4uL2NvcmUtanMvc3ltYm9sIjo4LCIuLi9jb3JlLWpzL3N5bWJvbC9pdGVyYXRvciI6OX1dLDE2OltmdW5jdGlvbihlLHQscil7dC5leHBvcnRzPWUoInJlZ2VuZXJhdG9yLXJ1bnRpbWUiKX0seyJyZWdlbmVyYXRvci1ydW50aW1lIjo5OH1dLDE3OltmdW5jdGlvbihlLHQscil7ZSgiLi4vLi4vbW9kdWxlcy9lczYub2JqZWN0LmNyZWF0ZSIpO3ZhciBuPWUoIi4uLy4uL21vZHVsZXMvX2NvcmUiKS5PYmplY3Q7dC5leHBvcnRzPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIG4uY3JlYXRlKGUsdCl9fSx7Ii4uLy4uL21vZHVsZXMvX2NvcmUiOjMxLCIuLi8uLi9tb2R1bGVzL2VzNi5vYmplY3QuY3JlYXRlIjo4NX1dLDE4OltmdW5jdGlvbihlLHQscil7ZSgiLi4vLi4vbW9kdWxlcy9lczYub2JqZWN0LmRlZmluZS1wcm9wZXJ0eSIpO3ZhciBuPWUoIi4uLy4uL21vZHVsZXMvX2NvcmUiKS5PYmplY3Q7dC5leHBvcnRzPWZ1bmN0aW9uKGUsdCxyKXtyZXR1cm4gbi5kZWZpbmVQcm9wZXJ0eShlLHQscil9fSx7Ii4uLy4uL21vZHVsZXMvX2NvcmUiOjMxLCIuLi8uLi9tb2R1bGVzL2VzNi5vYmplY3QuZGVmaW5lLXByb3BlcnR5Ijo4Nn1dLDE5OltmdW5jdGlvbihlLHQscil7ZSgiLi4vLi4vbW9kdWxlcy9lczYub2JqZWN0LmZyZWV6ZSIpLHQuZXhwb3J0cz1lKCIuLi8uLi9tb2R1bGVzL19jb3JlIikuT2JqZWN0LmZyZWV6ZX0seyIuLi8uLi9tb2R1bGVzL19jb3JlIjozMSwiLi4vLi4vbW9kdWxlcy9lczYub2JqZWN0LmZyZWV6ZSI6ODd9XSwyMDpbZnVuY3Rpb24oZSx0LHIpe2UoIi4uLy4uL21vZHVsZXMvZXM2Lm9iamVjdC5nZXQtb3duLXByb3BlcnR5LWRlc2NyaXB0b3IiKTt2YXIgbj1lKCIuLi8uLi9tb2R1bGVzL19jb3JlIikuT2JqZWN0O3QuZXhwb3J0cz1mdW5jdGlvbihlLHQpe3JldHVybiBuLmdldE93blByb3BlcnR5RGVzY3JpcHRvcihlLHQpfX0seyIuLi8uLi9tb2R1bGVzL19jb3JlIjozMSwiLi4vLi4vbW9kdWxlcy9lczYub2JqZWN0LmdldC1vd24tcHJvcGVydHktZGVzY3JpcHRvciI6ODh9XSwyMTpbZnVuY3Rpb24oZSx0LHIpe2UoIi4uLy4uL21vZHVsZXMvZXM2Lm9iamVjdC5nZXQtcHJvdG90eXBlLW9mIiksdC5leHBvcnRzPWUoIi4uLy4uL21vZHVsZXMvX2NvcmUiKS5PYmplY3QuZ2V0UHJvdG90eXBlT2Z9LHsiLi4vLi4vbW9kdWxlcy9fY29yZSI6MzEsIi4uLy4uL21vZHVsZXMvZXM2Lm9iamVjdC5nZXQtcHJvdG90eXBlLW9mIjo4OX1dLDIyOltmdW5jdGlvbihlLHQscil7ZSgiLi4vLi4vbW9kdWxlcy9lczYub2JqZWN0LmtleXMiKSx0LmV4cG9ydHM9ZSgiLi4vLi4vbW9kdWxlcy9fY29yZSIpLk9iamVjdC5rZXlzfSx7Ii4uLy4uL21vZHVsZXMvX2NvcmUiOjMxLCIuLi8uLi9tb2R1bGVzL2VzNi5vYmplY3Qua2V5cyI6OTB9XSwyMzpbZnVuY3Rpb24oZSx0LHIpe2UoIi4uLy4uL21vZHVsZXMvZXM2Lm9iamVjdC5zZXQtcHJvdG90eXBlLW9mIiksdC5leHBvcnRzPWUoIi4uLy4uL21vZHVsZXMvX2NvcmUiKS5PYmplY3Quc2V0UHJvdG90eXBlT2Z9LHsiLi4vLi4vbW9kdWxlcy9fY29yZSI6MzEsIi4uLy4uL21vZHVsZXMvZXM2Lm9iamVjdC5zZXQtcHJvdG90eXBlLW9mIjo5MX1dLDI0OltmdW5jdGlvbihlLHQscil7ZSgiLi4vLi4vbW9kdWxlcy9lczYuc3ltYm9sIiksZSgiLi4vLi4vbW9kdWxlcy9lczYub2JqZWN0LnRvLXN0cmluZyIpLGUoIi4uLy4uL21vZHVsZXMvZXM3LnN5bWJvbC5hc3luYy1pdGVyYXRvciIpLGUoIi4uLy4uL21vZHVsZXMvZXM3LnN5bWJvbC5vYnNlcnZhYmxlIiksdC5leHBvcnRzPWUoIi4uLy4uL21vZHVsZXMvX2NvcmUiKS5TeW1ib2x9LHsiLi4vLi4vbW9kdWxlcy9fY29yZSI6MzEsIi4uLy4uL21vZHVsZXMvZXM2Lm9iamVjdC50by1zdHJpbmciOjkyLCIuLi8uLi9tb2R1bGVzL2VzNi5zeW1ib2wiOjk0LCIuLi8uLi9tb2R1bGVzL2VzNy5zeW1ib2wuYXN5bmMtaXRlcmF0b3IiOjk1LCIuLi8uLi9tb2R1bGVzL2VzNy5zeW1ib2wub2JzZXJ2YWJsZSI6OTZ9XSwyNTpbZnVuY3Rpb24oZSx0LHIpe2UoIi4uLy4uL21vZHVsZXMvZXM2LnN0cmluZy5pdGVyYXRvciIpLGUoIi4uLy4uL21vZHVsZXMvd2ViLmRvbS5pdGVyYWJsZSIpLHQuZXhwb3J0cz1lKCIuLi8uLi9tb2R1bGVzL193a3MtZXh0IikuZigiaXRlcmF0b3IiKX0seyIuLi8uLi9tb2R1bGVzL193a3MtZXh0Ijo4MiwiLi4vLi4vbW9kdWxlcy9lczYuc3RyaW5nLml0ZXJhdG9yIjo5MywiLi4vLi4vbW9kdWxlcy93ZWIuZG9tLml0ZXJhYmxlIjo5N31dLDI2OltmdW5jdGlvbihlLHQscil7dC5leHBvcnRzPWZ1bmN0aW9uKGUpe2lmKCJmdW5jdGlvbiIhPXR5cGVvZiBlKXRocm93IFR5cGVFcnJvcihlKyIgaXMgbm90IGEgZnVuY3Rpb24hIik7cmV0dXJuIGV9fSx7fV0sMjc6W2Z1bmN0aW9uKGUsdCxyKXt0LmV4cG9ydHM9ZnVuY3Rpb24oKXt9fSx7fV0sMjg6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuL19pcy1vYmplY3QiKTt0LmV4cG9ydHM9ZnVuY3Rpb24oZSl7aWYoIW4oZSkpdGhyb3cgVHlwZUVycm9yKGUrIiBpcyBub3QgYW4gb2JqZWN0ISIpO3JldHVybiBlfX0seyIuL19pcy1vYmplY3QiOjQ3fV0sMjk6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuL190by1pb2JqZWN0Iiksbz1lKCIuL190by1sZW5ndGgiKSxpPWUoIi4vX3RvLWluZGV4Iik7dC5leHBvcnRzPWZ1bmN0aW9uKGUpe3JldHVybiBmdW5jdGlvbih0LHIsYSl7dmFyIHMsdT1uKHQpLGw9byh1Lmxlbmd0aCksYz1pKGEsbCk7aWYoZSYmciE9cil7Zm9yKDtsPmM7KWlmKHM9dVtjKytdLHMhPXMpcmV0dXJuITB9ZWxzZSBmb3IoO2w+YztjKyspaWYoKGV8fGMgaW4gdSkmJnVbY109PT1yKXJldHVybiBlfHxjfHwwO3JldHVybiFlJiYtMX19fSx7Ii4vX3RvLWluZGV4Ijo3NCwiLi9fdG8taW9iamVjdCI6NzYsIi4vX3RvLWxlbmd0aCI6Nzd9XSwzMDpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPXt9LnRvU3RyaW5nO3QuZXhwb3J0cz1mdW5jdGlvbihlKXtyZXR1cm4gbi5jYWxsKGUpLnNsaWNlKDgsLTEpfX0se31dLDMxOltmdW5jdGlvbihlLHQscil7dmFyIG49dC5leHBvcnRzPXt2ZXJzaW9uOiIyLjQuMCJ9OyJudW1iZXIiPT10eXBlb2YgX19lJiYoX19lPW4pfSx7fV0sMzI6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuL19hLWZ1bmN0aW9uIik7dC5leHBvcnRzPWZ1bmN0aW9uKGUsdCxyKXtpZihuKGUpLHZvaWQgMD09PXQpcmV0dXJuIGU7c3dpdGNoKHIpe2Nhc2UgMTpyZXR1cm4gZnVuY3Rpb24ocil7cmV0dXJuIGUuY2FsbCh0LHIpfTtjYXNlIDI6cmV0dXJuIGZ1bmN0aW9uKHIsbil7cmV0dXJuIGUuY2FsbCh0LHIsbil9O2Nhc2UgMzpyZXR1cm4gZnVuY3Rpb24ocixuLG8pe3JldHVybiBlLmNhbGwodCxyLG4sbyl9fXJldHVybiBmdW5jdGlvbigpe3JldHVybiBlLmFwcGx5KHQsYXJndW1lbnRzKX19fSx7Ii4vX2EtZnVuY3Rpb24iOjI2fV0sMzM6W2Z1bmN0aW9uKGUsdCxyKXt0LmV4cG9ydHM9ZnVuY3Rpb24oZSl7aWYodm9pZCAwPT1lKXRocm93IFR5cGVFcnJvcigiQ2FuJ3QgY2FsbCBtZXRob2Qgb24gICIrZSk7cmV0dXJuIGV9fSx7fV0sMzQ6W2Z1bmN0aW9uKGUsdCxyKXt0LmV4cG9ydHM9IWUoIi4vX2ZhaWxzIikoZnVuY3Rpb24oKXtyZXR1cm4gNyE9T2JqZWN0LmRlZmluZVByb3BlcnR5KHt9LCJhIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIDd9fSkuYX0pfSx7Ii4vX2ZhaWxzIjozOX1dLDM1OltmdW5jdGlvbihlLHQscil7dmFyIG49ZSgiLi9faXMtb2JqZWN0Iiksbz1lKCIuL19nbG9iYWwiKS5kb2N1bWVudCxpPW4obykmJm4oby5jcmVhdGVFbGVtZW50KTt0LmV4cG9ydHM9ZnVuY3Rpb24oZSl7cmV0dXJuIGk/by5jcmVhdGVFbGVtZW50KGUpOnt9fX0seyIuL19nbG9iYWwiOjQwLCIuL19pcy1vYmplY3QiOjQ3fV0sMzY6W2Z1bmN0aW9uKGUsdCxyKXt0LmV4cG9ydHM9ImNvbnN0cnVjdG9yLGhhc093blByb3BlcnR5LGlzUHJvdG90eXBlT2YscHJvcGVydHlJc0VudW1lcmFibGUsdG9Mb2NhbGVTdHJpbmcsdG9TdHJpbmcsdmFsdWVPZiIuc3BsaXQoIiwiKX0se31dLDM3OltmdW5jdGlvbihlLHQscil7dmFyIG49ZSgiLi9fb2JqZWN0LWtleXMiKSxvPWUoIi4vX29iamVjdC1nb3BzIiksaT1lKCIuL19vYmplY3QtcGllIik7dC5leHBvcnRzPWZ1bmN0aW9uKGUpe3ZhciB0PW4oZSkscj1vLmY7aWYocilmb3IodmFyIGEscz1yKGUpLHU9aS5mLGw9MDtzLmxlbmd0aD5sOyl1LmNhbGwoZSxhPXNbbCsrXSkmJnQucHVzaChhKTtyZXR1cm4gdH19LHsiLi9fb2JqZWN0LWdvcHMiOjYxLCIuL19vYmplY3Qta2V5cyI6NjQsIi4vX29iamVjdC1waWUiOjY1fV0sMzg6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuL19nbG9iYWwiKSxvPWUoIi4vX2NvcmUiKSxpPWUoIi4vX2N0eCIpLGE9ZSgiLi9faGlkZSIpLHM9InByb3RvdHlwZSIsdT1mdW5jdGlvbihlLHQscil7dmFyIGwsYyxmLHA9ZSZ1LkYsZD1lJnUuRyxoPWUmdS5TLHk9ZSZ1LlAsbT1lJnUuQix2PWUmdS5XLF89ZD9vOm9bdF18fChvW3RdPXt9KSxiPV9bc10sZz1kP246aD9uW3RdOihuW3RdfHx7fSlbc107ZCYmKHI9dCk7Zm9yKGwgaW4gciljPSFwJiZnJiZ2b2lkIDAhPT1nW2xdLGMmJmwgaW4gX3x8KGY9Yz9nW2xdOnJbbF0sX1tsXT1kJiYiZnVuY3Rpb24iIT10eXBlb2YgZ1tsXT9yW2xdOm0mJmM/aShmLG4pOnYmJmdbbF09PWY/ZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24odCxyLG4pe2lmKHRoaXMgaW5zdGFuY2VvZiBlKXtzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCl7Y2FzZSAwOnJldHVybiBuZXcgZTtjYXNlIDE6cmV0dXJuIG5ldyBlKHQpO2Nhc2UgMjpyZXR1cm4gbmV3IGUodCxyKX1yZXR1cm4gbmV3IGUodCxyLG4pfXJldHVybiBlLmFwcGx5KHRoaXMsYXJndW1lbnRzKX07cmV0dXJuIHRbc109ZVtzXSx0fShmKTp5JiYiZnVuY3Rpb24iPT10eXBlb2YgZj9pKEZ1bmN0aW9uLmNhbGwsZik6Zix5JiYoKF8udmlydHVhbHx8KF8udmlydHVhbD17fSkpW2xdPWYsZSZ1LlImJmImJiFiW2xdJiZhKGIsbCxmKSkpfTt1LkY9MSx1Lkc9Mix1LlM9NCx1LlA9OCx1LkI9MTYsdS5XPTMyLHUuVT02NCx1LlI9MTI4LHQuZXhwb3J0cz11fSx7Ii4vX2NvcmUiOjMxLCIuL19jdHgiOjMyLCIuL19nbG9iYWwiOjQwLCIuL19oaWRlIjo0Mn1dLDM5OltmdW5jdGlvbihlLHQscil7dC5leHBvcnRzPWZ1bmN0aW9uKGUpe3RyeXtyZXR1cm4hIWUoKX1jYXRjaCh0KXtyZXR1cm4hMH19fSx7fV0sNDA6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj10LmV4cG9ydHM9InVuZGVmaW5lZCIhPXR5cGVvZiB3aW5kb3cmJndpbmRvdy5NYXRoPT1NYXRoP3dpbmRvdzoidW5kZWZpbmVkIiE9dHlwZW9mIHNlbGYmJnNlbGYuTWF0aD09TWF0aD9zZWxmOkZ1bmN0aW9uKCJyZXR1cm4gdGhpcyIpKCk7Im51bWJlciI9PXR5cGVvZiBfX2cmJihfX2c9bil9LHt9XSw0MTpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPXt9Lmhhc093blByb3BlcnR5O3QuZXhwb3J0cz1mdW5jdGlvbihlLHQpe3JldHVybiBuLmNhbGwoZSx0KX19LHt9XSw0MjpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPWUoIi4vX29iamVjdC1kcCIpLG89ZSgiLi9fcHJvcGVydHktZGVzYyIpO3QuZXhwb3J0cz1lKCIuL19kZXNjcmlwdG9ycyIpP2Z1bmN0aW9uKGUsdCxyKXtyZXR1cm4gbi5mKGUsdCxvKDEscikpfTpmdW5jdGlvbihlLHQscil7cmV0dXJuIGVbdF09cixlfX0seyIuL19kZXNjcmlwdG9ycyI6MzQsIi4vX29iamVjdC1kcCI6NTYsIi4vX3Byb3BlcnR5LWRlc2MiOjY3fV0sNDM6W2Z1bmN0aW9uKGUsdCxyKXt0LmV4cG9ydHM9ZSgiLi9fZ2xvYmFsIikuZG9jdW1lbnQmJmRvY3VtZW50LmRvY3VtZW50RWxlbWVudH0seyIuL19nbG9iYWwiOjQwfV0sNDQ6W2Z1bmN0aW9uKGUsdCxyKXt0LmV4cG9ydHM9IWUoIi4vX2Rlc2NyaXB0b3JzIikmJiFlKCIuL19mYWlscyIpKGZ1bmN0aW9uKCl7cmV0dXJuIDchPU9iamVjdC5kZWZpbmVQcm9wZXJ0eShlKCIuL19kb20tY3JlYXRlIikoImRpdiIpLCJhIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIDd9fSkuYX0pfSx7Ii4vX2Rlc2NyaXB0b3JzIjozNCwiLi9fZG9tLWNyZWF0ZSI6MzUsIi4vX2ZhaWxzIjozOX1dLDQ1OltmdW5jdGlvbihlLHQscil7dmFyIG49ZSgiLi9fY29mIik7dC5leHBvcnRzPU9iamVjdCgieiIpLnByb3BlcnR5SXNFbnVtZXJhYmxlKDApP09iamVjdDpmdW5jdGlvbihlKXtyZXR1cm4iU3RyaW5nIj09bihlKT9lLnNwbGl0KCIiKTpPYmplY3QoZSl9fSx7Ii4vX2NvZiI6MzB9XSw0NjpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPWUoIi4vX2NvZiIpO3QuZXhwb3J0cz1BcnJheS5pc0FycmF5fHxmdW5jdGlvbihlKXtyZXR1cm4iQXJyYXkiPT1uKGUpfX0seyIuL19jb2YiOjMwfV0sNDc6W2Z1bmN0aW9uKGUsdCxyKXt0LmV4cG9ydHM9ZnVuY3Rpb24oZSl7cmV0dXJuIm9iamVjdCI9PXR5cGVvZiBlP251bGwhPT1lOiJmdW5jdGlvbiI9PXR5cGVvZiBlfX0se31dLDQ4OltmdW5jdGlvbihlLHQscil7InVzZSBzdHJpY3QiO3ZhciBuPWUoIi4vX29iamVjdC1jcmVhdGUiKSxvPWUoIi4vX3Byb3BlcnR5LWRlc2MiKSxpPWUoIi4vX3NldC10by1zdHJpbmctdGFnIiksYT17fTtlKCIuL19oaWRlIikoYSxlKCIuL193a3MiKSgiaXRlcmF0b3IiKSxmdW5jdGlvbigpe3JldHVybiB0aGlzfSksdC5leHBvcnRzPWZ1bmN0aW9uKGUsdCxyKXtlLnByb3RvdHlwZT1uKGEse25leHQ6bygxLHIpfSksaShlLHQrIiBJdGVyYXRvciIpfX0seyIuL19oaWRlIjo0MiwiLi9fb2JqZWN0LWNyZWF0ZSI6NTUsIi4vX3Byb3BlcnR5LWRlc2MiOjY3LCIuL19zZXQtdG8tc3RyaW5nLXRhZyI6NzAsIi4vX3drcyI6ODN9XSw0OTpbZnVuY3Rpb24oZSx0LHIpeyJ1c2Ugc3RyaWN0Ijt2YXIgbj1lKCIuL19saWJyYXJ5Iiksbz1lKCIuL19leHBvcnQiKSxpPWUoIi4vX3JlZGVmaW5lIiksYT1lKCIuL19oaWRlIikscz1lKCIuL19oYXMiKSx1PWUoIi4vX2l0ZXJhdG9ycyIpLGw9ZSgiLi9faXRlci1jcmVhdGUiKSxjPWUoIi4vX3NldC10by1zdHJpbmctdGFnIiksZj1lKCIuL19vYmplY3QtZ3BvIikscD1lKCIuL193a3MiKSgiaXRlcmF0b3IiKSxkPSEoW10ua2V5cyYmIm5leHQiaW5bXS5rZXlzKCkpLGg9IkBAaXRlcmF0b3IiLHk9ImtleXMiLG09InZhbHVlcyIsdj1mdW5jdGlvbigpe3JldHVybiB0aGlzfTt0LmV4cG9ydHM9ZnVuY3Rpb24oZSx0LHIsXyxiLGcsRSl7bChyLHQsXyk7dmFyIGosdyxPLE09ZnVuY3Rpb24oZSl7aWYoIWQmJmUgaW4gUilyZXR1cm4gUltlXTtzd2l0Y2goZSl7Y2FzZSB5OnJldHVybiBmdW5jdGlvbigpe3JldHVybiBuZXcgcih0aGlzLGUpfTtjYXNlIG06cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIG5ldyByKHRoaXMsZSl9fXJldHVybiBmdW5jdGlvbigpe3JldHVybiBuZXcgcih0aGlzLGUpfX0seD10KyIgSXRlcmF0b3IiLFA9Yj09bSxrPSExLFI9ZS5wcm90b3R5cGUsUz1SW3BdfHxSW2hdfHxiJiZSW2JdLEE9U3x8TShiKSxUPWI/UD9NKCJlbnRyaWVzIik6QTp2b2lkIDAsTj0iQXJyYXkiPT10P1IuZW50cmllc3x8UzpTO2lmKE4mJihPPWYoTi5jYWxsKG5ldyBlKSksTyE9PU9iamVjdC5wcm90b3R5cGUmJihjKE8seCwhMCksbnx8cyhPLHApfHxhKE8scCx2KSkpLFAmJlMmJlMubmFtZSE9PW0mJihrPSEwLEE9ZnVuY3Rpb24oKXtyZXR1cm4gUy5jYWxsKHRoaXMpfSksbiYmIUV8fCFkJiYhayYmUltwXXx8YShSLHAsQSksdVt0XT1BLHVbeF09dixiKWlmKGo9e3ZhbHVlczpQP0E6TShtKSxrZXlzOmc/QTpNKHkpLGVudHJpZXM6VH0sRSlmb3IodyBpbiBqKXcgaW4gUnx8aShSLHcsalt3XSk7ZWxzZSBvKG8uUCtvLkYqKGR8fGspLHQsaik7cmV0dXJuIGp9fSx7Ii4vX2V4cG9ydCI6MzgsIi4vX2hhcyI6NDEsIi4vX2hpZGUiOjQyLCIuL19pdGVyLWNyZWF0ZSI6NDgsIi4vX2l0ZXJhdG9ycyI6NTEsIi4vX2xpYnJhcnkiOjUzLCIuL19vYmplY3QtZ3BvIjo2MiwiLi9fcmVkZWZpbmUiOjY4LCIuL19zZXQtdG8tc3RyaW5nLXRhZyI6NzAsIi4vX3drcyI6ODN9XSw1MDpbZnVuY3Rpb24oZSx0LHIpe3QuZXhwb3J0cz1mdW5jdGlvbihlLHQpe3JldHVybnt2YWx1ZTp0LGRvbmU6ISFlfX19LHt9XSw1MTpbZnVuY3Rpb24oZSx0LHIpe3QuZXhwb3J0cz17fX0se31dLDUyOltmdW5jdGlvbihlLHQscil7dmFyIG49ZSgiLi9fb2JqZWN0LWtleXMiKSxvPWUoIi4vX3RvLWlvYmplY3QiKTt0LmV4cG9ydHM9ZnVuY3Rpb24oZSx0KXtmb3IodmFyIHIsaT1vKGUpLGE9bihpKSxzPWEubGVuZ3RoLHU9MDtzPnU7KWlmKGlbcj1hW3UrK11dPT09dClyZXR1cm4gcn19LHsiLi9fb2JqZWN0LWtleXMiOjY0LCIuL190by1pb2JqZWN0Ijo3Nn1dLDUzOltmdW5jdGlvbihlLHQscil7dC5leHBvcnRzPSEwfSx7fV0sNTQ6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuL191aWQiKSgibWV0YSIpLG89ZSgiLi9faXMtb2JqZWN0IiksaT1lKCIuL19oYXMiKSxhPWUoIi4vX29iamVjdC1kcCIpLmYscz0wLHU9T2JqZWN0LmlzRXh0ZW5zaWJsZXx8ZnVuY3Rpb24oKXtyZXR1cm4hMH0sbD0hZSgiLi9fZmFpbHMiKShmdW5jdGlvbigpe3JldHVybiB1KE9iamVjdC5wcmV2ZW50RXh0ZW5zaW9ucyh7fSkpfSksYz1mdW5jdGlvbihlKXthKGUsbix7dmFsdWU6e2k6Ik8iKyArK3Msdzp7fX19KX0sZj1mdW5jdGlvbihlLHQpe2lmKCFvKGUpKXJldHVybiJzeW1ib2wiPT10eXBlb2YgZT9lOigic3RyaW5nIj09dHlwZW9mIGU/IlMiOiJQIikrZTtpZighaShlLG4pKXtpZighdShlKSlyZXR1cm4iRiI7aWYoIXQpcmV0dXJuIkUiO2MoZSl9cmV0dXJuIGVbbl0uaX0scD1mdW5jdGlvbihlLHQpe2lmKCFpKGUsbikpe2lmKCF1KGUpKXJldHVybiEwO2lmKCF0KXJldHVybiExO2MoZSl9cmV0dXJuIGVbbl0ud30sZD1mdW5jdGlvbihlKXtyZXR1cm4gbCYmaC5ORUVEJiZ1KGUpJiYhaShlLG4pJiZjKGUpLGV9LGg9dC5leHBvcnRzPXtLRVk6bixORUVEOiExLGZhc3RLZXk6ZixnZXRXZWFrOnAsb25GcmVlemU6ZH19LHsiLi9fZmFpbHMiOjM5LCIuL19oYXMiOjQxLCIuL19pcy1vYmplY3QiOjQ3LCIuL19vYmplY3QtZHAiOjU2LCIuL191aWQiOjgwfV0sNTU6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuL19hbi1vYmplY3QiKSxvPWUoIi4vX29iamVjdC1kcHMiKSxpPWUoIi4vX2VudW0tYnVnLWtleXMiKSxhPWUoIi4vX3NoYXJlZC1rZXkiKSgiSUVfUFJPVE8iKSxzPWZ1bmN0aW9uKCl7fSx1PSJwcm90b3R5cGUiLGw9ZnVuY3Rpb24oKXt2YXIgdCxyPWUoIi4vX2RvbS1jcmVhdGUiKSgiaWZyYW1lIiksbj1pLmxlbmd0aCxvPSI+Ijtmb3Ioci5zdHlsZS5kaXNwbGF5PSJub25lIixlKCIuL19odG1sIikuYXBwZW5kQ2hpbGQociksci5zcmM9ImphdmFzY3JpcHQ6Iix0PXIuY29udGVudFdpbmRvdy5kb2N1bWVudCx0Lm9wZW4oKSx0LndyaXRlKCI8c2NyaXB0PmRvY3VtZW50LkY9T2JqZWN0PC9zY3JpcHQiK28pLHQuY2xvc2UoKSxsPXQuRjtuLS07KWRlbGV0ZSBsW3VdW2lbbl1dO3JldHVybiBsKCl9O3QuZXhwb3J0cz1PYmplY3QuY3JlYXRlfHxmdW5jdGlvbihlLHQpe3ZhciByO3JldHVybiBudWxsIT09ZT8oc1t1XT1uKGUpLHI9bmV3IHMsc1t1XT1udWxsLHJbYV09ZSk6cj1sKCksdm9pZCAwPT09dD9yOm8ocix0KX19LHsiLi9fYW4tb2JqZWN0IjoyOCwiLi9fZG9tLWNyZWF0ZSI6MzUsIi4vX2VudW0tYnVnLWtleXMiOjM2LCIuL19odG1sIjo0MywiLi9fb2JqZWN0LWRwcyI6NTcsIi4vX3NoYXJlZC1rZXkiOjcxfV0sNTY6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuL19hbi1vYmplY3QiKSxvPWUoIi4vX2llOC1kb20tZGVmaW5lIiksaT1lKCIuL190by1wcmltaXRpdmUiKSxhPU9iamVjdC5kZWZpbmVQcm9wZXJ0eTtyLmY9ZSgiLi9fZGVzY3JpcHRvcnMiKT9PYmplY3QuZGVmaW5lUHJvcGVydHk6ZnVuY3Rpb24oZSx0LHIpe2lmKG4oZSksdD1pKHQsITApLG4ociksbyl0cnl7cmV0dXJuIGEoZSx0LHIpfWNhdGNoKHMpe31pZigiZ2V0ImluIHJ8fCJzZXQiaW4gcil0aHJvdyBUeXBlRXJyb3IoIkFjY2Vzc29ycyBub3Qgc3VwcG9ydGVkISIpO3JldHVybiJ2YWx1ZSJpbiByJiYoZVt0XT1yLnZhbHVlKSxlfX0seyIuL19hbi1vYmplY3QiOjI4LCIuL19kZXNjcmlwdG9ycyI6MzQsIi4vX2llOC1kb20tZGVmaW5lIjo0NCwiLi9fdG8tcHJpbWl0aXZlIjo3OX1dLDU3OltmdW5jdGlvbihlLHQscil7dmFyIG49ZSgiLi9fb2JqZWN0LWRwIiksbz1lKCIuL19hbi1vYmplY3QiKSxpPWUoIi4vX29iamVjdC1rZXlzIik7dC5leHBvcnRzPWUoIi4vX2Rlc2NyaXB0b3JzIik/T2JqZWN0LmRlZmluZVByb3BlcnRpZXM6ZnVuY3Rpb24oZSx0KXtvKGUpO2Zvcih2YXIgcixhPWkodCkscz1hLmxlbmd0aCx1PTA7cz51OyluLmYoZSxyPWFbdSsrXSx0W3JdKTtyZXR1cm4gZX19LHsiLi9fYW4tb2JqZWN0IjoyOCwiLi9fZGVzY3JpcHRvcnMiOjM0LCIuL19vYmplY3QtZHAiOjU2LCIuL19vYmplY3Qta2V5cyI6NjR9XSw1ODpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPWUoIi4vX29iamVjdC1waWUiKSxvPWUoIi4vX3Byb3BlcnR5LWRlc2MiKSxpPWUoIi4vX3RvLWlvYmplY3QiKSxhPWUoIi4vX3RvLXByaW1pdGl2ZSIpLHM9ZSgiLi9faGFzIiksdT1lKCIuL19pZTgtZG9tLWRlZmluZSIpLGw9T2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcjtyLmY9ZSgiLi9fZGVzY3JpcHRvcnMiKT9sOmZ1bmN0aW9uKGUsdCl7aWYoZT1pKGUpLHQ9YSh0LCEwKSx1KXRyeXtyZXR1cm4gbChlLHQpfWNhdGNoKHIpe31pZihzKGUsdCkpcmV0dXJuIG8oIW4uZi5jYWxsKGUsdCksZVt0XSl9fSx7Ii4vX2Rlc2NyaXB0b3JzIjozNCwiLi9faGFzIjo0MSwiLi9faWU4LWRvbS1kZWZpbmUiOjQ0LCIuL19vYmplY3QtcGllIjo2NSwiLi9fcHJvcGVydHktZGVzYyI6NjcsIi4vX3RvLWlvYmplY3QiOjc2LCIuL190by1wcmltaXRpdmUiOjc5fV0sNTk6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuL190by1pb2JqZWN0Iiksbz1lKCIuL19vYmplY3QtZ29wbiIpLmYsaT17fS50b1N0cmluZyxhPSJvYmplY3QiPT10eXBlb2Ygd2luZG93JiZ3aW5kb3cmJk9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzP09iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKHdpbmRvdyk6W10scz1mdW5jdGlvbihlKXt0cnl7cmV0dXJuIG8oZSl9Y2F0Y2godCl7cmV0dXJuIGEuc2xpY2UoKX19O3QuZXhwb3J0cy5mPWZ1bmN0aW9uKGUpe3JldHVybiBhJiYiW29iamVjdCBXaW5kb3ddIj09aS5jYWxsKGUpP3MoZSk6byhuKGUpKX19LHsiLi9fb2JqZWN0LWdvcG4iOjYwLCIuL190by1pb2JqZWN0Ijo3Nn1dLDYwOltmdW5jdGlvbihlLHQscil7dmFyIG49ZSgiLi9fb2JqZWN0LWtleXMtaW50ZXJuYWwiKSxvPWUoIi4vX2VudW0tYnVnLWtleXMiKS5jb25jYXQoImxlbmd0aCIsInByb3RvdHlwZSIpO3IuZj1PYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lc3x8ZnVuY3Rpb24oZSl7cmV0dXJuIG4oZSxvKX19LHsiLi9fZW51bS1idWcta2V5cyI6MzYsIi4vX29iamVjdC1rZXlzLWludGVybmFsIjo2M31dLDYxOltmdW5jdGlvbihlLHQscil7ci5mPU9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHN9LHt9XSw2MjpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPWUoIi4vX2hhcyIpLG89ZSgiLi9fdG8tb2JqZWN0IiksaT1lKCIuL19zaGFyZWQta2V5IikoIklFX1BST1RPIiksYT1PYmplY3QucHJvdG90eXBlO3QuZXhwb3J0cz1PYmplY3QuZ2V0UHJvdG90eXBlT2Z8fGZ1bmN0aW9uKGUpe3JldHVybiBlPW8oZSksbihlLGkpP2VbaV06ImZ1bmN0aW9uIj09dHlwZW9mIGUuY29uc3RydWN0b3ImJmUgaW5zdGFuY2VvZiBlLmNvbnN0cnVjdG9yP2UuY29uc3RydWN0b3IucHJvdG90eXBlOmUgaW5zdGFuY2VvZiBPYmplY3Q/YTpudWxsfX0seyIuL19oYXMiOjQxLCIuL19zaGFyZWQta2V5Ijo3MSwiLi9fdG8tb2JqZWN0Ijo3OH1dLDYzOltmdW5jdGlvbihlLHQscil7dmFyIG49ZSgiLi9faGFzIiksbz1lKCIuL190by1pb2JqZWN0IiksaT1lKCIuL19hcnJheS1pbmNsdWRlcyIpKCExKSxhPWUoIi4vX3NoYXJlZC1rZXkiKSgiSUVfUFJPVE8iKTt0LmV4cG9ydHM9ZnVuY3Rpb24oZSx0KXt2YXIgcixzPW8oZSksdT0wLGw9W107Zm9yKHIgaW4gcylyIT1hJiZuKHMscikmJmwucHVzaChyKTtmb3IoO3QubGVuZ3RoPnU7KW4ocyxyPXRbdSsrXSkmJih+aShsLHIpfHxsLnB1c2gocikpO3JldHVybiBsfX0seyIuL19hcnJheS1pbmNsdWRlcyI6MjksIi4vX2hhcyI6NDEsIi4vX3NoYXJlZC1rZXkiOjcxLCIuL190by1pb2JqZWN0Ijo3Nn1dLDY0OltmdW5jdGlvbihlLHQscil7dmFyIG49ZSgiLi9fb2JqZWN0LWtleXMtaW50ZXJuYWwiKSxvPWUoIi4vX2VudW0tYnVnLWtleXMiKTt0LmV4cG9ydHM9T2JqZWN0LmtleXN8fGZ1bmN0aW9uKGUpe3JldHVybiBuKGUsbyl9fSx7Ii4vX2VudW0tYnVnLWtleXMiOjM2LCIuL19vYmplY3Qta2V5cy1pbnRlcm5hbCI6NjN9XSw2NTpbZnVuY3Rpb24oZSx0LHIpe3IuZj17fS5wcm9wZXJ0eUlzRW51bWVyYWJsZX0se31dLDY2OltmdW5jdGlvbihlLHQscil7dmFyIG49ZSgiLi9fZXhwb3J0Iiksbz1lKCIuL19jb3JlIiksaT1lKCIuL19mYWlscyIpO3QuZXhwb3J0cz1mdW5jdGlvbihlLHQpe3ZhciByPShvLk9iamVjdHx8e30pW2VdfHxPYmplY3RbZV0sYT17fTthW2VdPXQociksbihuLlMrbi5GKmkoZnVuY3Rpb24oKXtyKDEpfSksIk9iamVjdCIsYSl9fSx7Ii4vX2NvcmUiOjMxLCIuL19leHBvcnQiOjM4LCIuL19mYWlscyI6Mzl9XSw2NzpbZnVuY3Rpb24oZSx0LHIpe3QuZXhwb3J0cz1mdW5jdGlvbihlLHQpe3JldHVybntlbnVtZXJhYmxlOiEoMSZlKSxjb25maWd1cmFibGU6ISgyJmUpLHdyaXRhYmxlOiEoNCZlKSx2YWx1ZTp0fX19LHt9XSw2ODpbZnVuY3Rpb24oZSx0LHIpe3QuZXhwb3J0cz1lKCIuL19oaWRlIil9LHsiLi9faGlkZSI6NDJ9XSw2OTpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPWUoIi4vX2lzLW9iamVjdCIpLG89ZSgiLi9fYW4tb2JqZWN0IiksaT1mdW5jdGlvbihlLHQpe2lmKG8oZSksIW4odCkmJm51bGwhPT10KXRocm93IFR5cGVFcnJvcih0KyI6IGNhbid0IHNldCBhcyBwcm90b3R5cGUhIil9O3QuZXhwb3J0cz17c2V0Ok9iamVjdC5zZXRQcm90b3R5cGVPZnx8KCJfX3Byb3RvX18iaW57fT9mdW5jdGlvbih0LHIsbil7dHJ5e249ZSgiLi9fY3R4IikoRnVuY3Rpb24uY2FsbCxlKCIuL19vYmplY3QtZ29wZCIpLmYoT2JqZWN0LnByb3RvdHlwZSwiX19wcm90b19fIikuc2V0LDIpLG4odCxbXSkscj0hKHQgaW5zdGFuY2VvZiBBcnJheSl9Y2F0Y2gobyl7cj0hMH1yZXR1cm4gZnVuY3Rpb24oZSx0KXtyZXR1cm4gaShlLHQpLHI/ZS5fX3Byb3RvX189dDpuKGUsdCksZX19KHt9LCExKTp2b2lkIDApLGNoZWNrOml9fSx7Ii4vX2FuLW9iamVjdCI6MjgsIi4vX2N0eCI6MzIsIi4vX2lzLW9iamVjdCI6NDcsIi4vX29iamVjdC1nb3BkIjo1OH1dLDcwOltmdW5jdGlvbihlLHQscil7dmFyIG49ZSgiLi9fb2JqZWN0LWRwIikuZixvPWUoIi4vX2hhcyIpLGk9ZSgiLi9fd2tzIikoInRvU3RyaW5nVGFnIik7dC5leHBvcnRzPWZ1bmN0aW9uKGUsdCxyKXtlJiYhbyhlPXI/ZTplLnByb3RvdHlwZSxpKSYmbihlLGkse2NvbmZpZ3VyYWJsZTohMCx2YWx1ZTp0fSl9fSx7Ii4vX2hhcyI6NDEsIi4vX29iamVjdC1kcCI6NTYsIi4vX3drcyI6ODN9XSw3MTpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPWUoIi4vX3NoYXJlZCIpKCJrZXlzIiksbz1lKCIuL191aWQiKTt0LmV4cG9ydHM9ZnVuY3Rpb24oZSl7cmV0dXJuIG5bZV18fChuW2VdPW8oZSkpfX0seyIuL19zaGFyZWQiOjcyLCIuL191aWQiOjgwfV0sNzI6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuL19nbG9iYWwiKSxvPSJfX2NvcmUtanNfc2hhcmVkX18iLGk9bltvXXx8KG5bb109e30pO3QuZXhwb3J0cz1mdW5jdGlvbihlKXtyZXR1cm4gaVtlXXx8KGlbZV09e30pfX0seyIuL19nbG9iYWwiOjQwfV0sNzM6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuL190by1pbnRlZ2VyIiksbz1lKCIuL19kZWZpbmVkIik7dC5leHBvcnRzPWZ1bmN0aW9uKGUpe3JldHVybiBmdW5jdGlvbih0LHIpe3ZhciBpLGEscz1TdHJpbmcobyh0KSksdT1uKHIpLGw9cy5sZW5ndGg7cmV0dXJuIHU8MHx8dT49bD9lPyIiOnZvaWQgMDooaT1zLmNoYXJDb2RlQXQodSksaTw1NTI5Nnx8aT41NjMxOXx8dSsxPT09bHx8KGE9cy5jaGFyQ29kZUF0KHUrMSkpPDU2MzIwfHxhPjU3MzQzP2U/cy5jaGFyQXQodSk6aTplP3Muc2xpY2UodSx1KzIpOihpLTU1Mjk2PDwxMCkrKGEtNTYzMjApKzY1NTM2KX19fSx7Ii4vX2RlZmluZWQiOjMzLCIuL190by1pbnRlZ2VyIjo3NX1dLDc0OltmdW5jdGlvbihlLHQscil7dmFyIG49ZSgiLi9fdG8taW50ZWdlciIpLG89TWF0aC5tYXgsaT1NYXRoLm1pbjt0LmV4cG9ydHM9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gZT1uKGUpLGU8MD9vKGUrdCwwKTppKGUsdCl9fSx7Ii4vX3RvLWludGVnZXIiOjc1fV0sNzU6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1NYXRoLmNlaWwsbz1NYXRoLmZsb29yO3QuZXhwb3J0cz1mdW5jdGlvbihlKXtyZXR1cm4gaXNOYU4oZT0rZSk/MDooZT4wP286bikoZSl9fSx7fV0sNzY6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuL19pb2JqZWN0Iiksbz1lKCIuL19kZWZpbmVkIik7dC5leHBvcnRzPWZ1bmN0aW9uKGUpe3JldHVybiBuKG8oZSkpfX0seyIuL19kZWZpbmVkIjozMywiLi9faW9iamVjdCI6NDV9XSw3NzpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPWUoIi4vX3RvLWludGVnZXIiKSxvPU1hdGgubWluO3QuZXhwb3J0cz1mdW5jdGlvbihlKXtyZXR1cm4gZT4wP28obihlKSw5MDA3MTk5MjU0NzQwOTkxKTowfX0seyIuL190by1pbnRlZ2VyIjo3NX1dLDc4OltmdW5jdGlvbihlLHQscil7dmFyIG49ZSgiLi9fZGVmaW5lZCIpO3QuZXhwb3J0cz1mdW5jdGlvbihlKXtyZXR1cm4gT2JqZWN0KG4oZSkpfX0seyIuL19kZWZpbmVkIjozM31dLDc5OltmdW5jdGlvbihlLHQscil7dmFyIG49ZSgiLi9faXMtb2JqZWN0Iik7dC5leHBvcnRzPWZ1bmN0aW9uKGUsdCl7aWYoIW4oZSkpcmV0dXJuIGU7dmFyIHIsbztpZih0JiYiZnVuY3Rpb24iPT10eXBlb2Yocj1lLnRvU3RyaW5nKSYmIW4obz1yLmNhbGwoZSkpKXJldHVybiBvO2lmKCJmdW5jdGlvbiI9PXR5cGVvZihyPWUudmFsdWVPZikmJiFuKG89ci5jYWxsKGUpKSlyZXR1cm4gbztpZighdCYmImZ1bmN0aW9uIj09dHlwZW9mKHI9ZS50b1N0cmluZykmJiFuKG89ci5jYWxsKGUpKSlyZXR1cm4gbzt0aHJvdyBUeXBlRXJyb3IoIkNhbid0IGNvbnZlcnQgb2JqZWN0IHRvIHByaW1pdGl2ZSB2YWx1ZSIpfX0seyIuL19pcy1vYmplY3QiOjQ3fV0sODA6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj0wLG89TWF0aC5yYW5kb20oKTt0LmV4cG9ydHM9ZnVuY3Rpb24oZSl7cmV0dXJuIlN5bWJvbCgiLmNvbmNhdCh2b2lkIDA9PT1lPyIiOmUsIilfIiwoKytuK28pLnRvU3RyaW5nKDM2KSl9fSx7fV0sODE6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuL19nbG9iYWwiKSxvPWUoIi4vX2NvcmUiKSxpPWUoIi4vX2xpYnJhcnkiKSxhPWUoIi4vX3drcy1leHQiKSxzPWUoIi4vX29iamVjdC1kcCIpLmY7dC5leHBvcnRzPWZ1bmN0aW9uKGUpe3ZhciB0PW8uU3ltYm9sfHwoby5TeW1ib2w9aT97fTpuLlN5bWJvbHx8e30pOyJfIj09ZS5jaGFyQXQoMCl8fGUgaW4gdHx8cyh0LGUse3ZhbHVlOmEuZihlKX0pfX0seyIuL19jb3JlIjozMSwiLi9fZ2xvYmFsIjo0MCwiLi9fbGlicmFyeSI6NTMsIi4vX29iamVjdC1kcCI6NTYsIi4vX3drcy1leHQiOjgyfV0sODI6W2Z1bmN0aW9uKGUsdCxyKXtyLmY9ZSgiLi9fd2tzIil9LHsiLi9fd2tzIjo4M31dLDgzOltmdW5jdGlvbihlLHQscil7dmFyIG49ZSgiLi9fc2hhcmVkIikoIndrcyIpLG89ZSgiLi9fdWlkIiksaT1lKCIuL19nbG9iYWwiKS5TeW1ib2wsYT0iZnVuY3Rpb24iPT10eXBlb2YgaSxzPXQuZXhwb3J0cz1mdW5jdGlvbihlKXtyZXR1cm4gbltlXXx8KG5bZV09YSYmaVtlXXx8KGE/aTpvKSgiU3ltYm9sLiIrZSkpfTtzLnN0b3JlPW59LHsiLi9fZ2xvYmFsIjo0MCwiLi9fc2hhcmVkIjo3MiwiLi9fdWlkIjo4MH1dLDg0OltmdW5jdGlvbihlLHQscil7InVzZSBzdHJpY3QiO3ZhciBuPWUoIi4vX2FkZC10by11bnNjb3BhYmxlcyIpLG89ZSgiLi9faXRlci1zdGVwIiksaT1lKCIuL19pdGVyYXRvcnMiKSxhPWUoIi4vX3RvLWlvYmplY3QiKTt0LmV4cG9ydHM9ZSgiLi9faXRlci1kZWZpbmUiKShBcnJheSwiQXJyYXkiLGZ1bmN0aW9uKGUsdCl7dGhpcy5fdD1hKGUpLHRoaXMuX2k9MCx0aGlzLl9rPXR9LGZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5fdCx0PXRoaXMuX2sscj10aGlzLl9pKys7cmV0dXJuIWV8fHI+PWUubGVuZ3RoPyh0aGlzLl90PXZvaWQgMCxvKDEpKToia2V5cyI9PXQ/bygwLHIpOiJ2YWx1ZXMiPT10P28oMCxlW3JdKTpvKDAsW3IsZVtyXV0pfSwidmFsdWVzIiksaS5Bcmd1bWVudHM9aS5BcnJheSxuKCJrZXlzIiksbigidmFsdWVzIiksbigiZW50cmllcyIpfSx7Ii4vX2FkZC10by11bnNjb3BhYmxlcyI6MjcsIi4vX2l0ZXItZGVmaW5lIjo0OSwiLi9faXRlci1zdGVwIjo1MCwiLi9faXRlcmF0b3JzIjo1MSwiLi9fdG8taW9iamVjdCI6NzZ9XSw4NTpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPWUoIi4vX2V4cG9ydCIpO24obi5TLCJPYmplY3QiLHtjcmVhdGU6ZSgiLi9fb2JqZWN0LWNyZWF0ZSIpfSl9LHsiLi9fZXhwb3J0IjozOCwiLi9fb2JqZWN0LWNyZWF0ZSI6NTV9XSw4NjpbZnVuY3Rpb24oZSx0LHIpe3ZhciBuPWUoIi4vX2V4cG9ydCIpO24obi5TK24uRiohZSgiLi9fZGVzY3JpcHRvcnMiKSwiT2JqZWN0Iix7ZGVmaW5lUHJvcGVydHk6ZSgiLi9fb2JqZWN0LWRwIikuZn0pfSx7Ii4vX2Rlc2NyaXB0b3JzIjozNCwiLi9fZXhwb3J0IjozOCwiLi9fb2JqZWN0LWRwIjo1Nn1dLDg3OltmdW5jdGlvbihlLHQscil7dmFyIG49ZSgiLi9faXMtb2JqZWN0Iiksbz1lKCIuL19tZXRhIikub25GcmVlemU7ZSgiLi9fb2JqZWN0LXNhcCIpKCJmcmVlemUiLGZ1bmN0aW9uKGUpe3JldHVybiBmdW5jdGlvbih0KXtyZXR1cm4gZSYmbih0KT9lKG8odCkpOnR9fSl9LHsiLi9faXMtb2JqZWN0Ijo0NywiLi9fbWV0YSI6NTQsIi4vX29iamVjdC1zYXAiOjY2fV0sODg6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuL190by1pb2JqZWN0Iiksbz1lKCIuL19vYmplY3QtZ29wZCIpLmY7ZSgiLi9fb2JqZWN0LXNhcCIpKCJnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IiLGZ1bmN0aW9uKCl7cmV0dXJuIGZ1bmN0aW9uKGUsdCl7cmV0dXJuIG8obihlKSx0KX19KX0seyIuL19vYmplY3QtZ29wZCI6NTgsIi4vX29iamVjdC1zYXAiOjY2LCIuL190by1pb2JqZWN0Ijo3Nn1dLDg5OltmdW5jdGlvbihlLHQscil7dmFyIG49ZSgiLi9fdG8tb2JqZWN0Iiksbz1lKCIuL19vYmplY3QtZ3BvIik7ZSgiLi9fb2JqZWN0LXNhcCIpKCJnZXRQcm90b3R5cGVPZiIsZnVuY3Rpb24oKXtyZXR1cm4gZnVuY3Rpb24oZSl7cmV0dXJuIG8obihlKSl9fSl9LHsiLi9fb2JqZWN0LWdwbyI6NjIsIi4vX29iamVjdC1zYXAiOjY2LCIuL190by1vYmplY3QiOjc4fV0sOTA6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuL190by1vYmplY3QiKSxvPWUoIi4vX29iamVjdC1rZXlzIik7ZSgiLi9fb2JqZWN0LXNhcCIpKCJrZXlzIixmdW5jdGlvbigpe3JldHVybiBmdW5jdGlvbihlKXtyZXR1cm4gbyhuKGUpKX19KX0seyIuL19vYmplY3Qta2V5cyI6NjQsIi4vX29iamVjdC1zYXAiOjY2LCIuL190by1vYmplY3QiOjc4fV0sOTE6W2Z1bmN0aW9uKGUsdCxyKXt2YXIgbj1lKCIuL19leHBvcnQiKTtuKG4uUywiT2JqZWN0Iix7c2V0UHJvdG90eXBlT2Y6ZSgiLi9fc2V0LXByb3RvIikuc2V0fSl9LHsiLi9fZXhwb3J0IjozOCwiLi9fc2V0LXByb3RvIjo2OX1dLDkyOltmdW5jdGlvbihlLHQscil7fSx7fV0sOTM6W2Z1bmN0aW9uKGUsdCxyKXsidXNlIHN0cmljdCI7dmFyIG49ZSgiLi9fc3RyaW5nLWF0IikoITApO2UoIi4vX2l0ZXItZGVmaW5lIikoU3RyaW5nLCJTdHJpbmciLGZ1bmN0aW9uKGUpe3RoaXMuX3Q9U3RyaW5nKGUpLHRoaXMuX2k9MH0sZnVuY3Rpb24oKXt2YXIgZSx0PXRoaXMuX3Qscj10aGlzLl9pO3JldHVybiByPj10Lmxlbmd0aD97dmFsdWU6dm9pZCAwLGRvbmU6ITB9OihlPW4odCxyKSx0aGlzLl9pKz1lLmxlbmd0aCx7dmFsdWU6ZSxkb25lOiExfSl9KX0seyIuL19pdGVyLWRlZmluZSI6NDksIi4vX3N0cmluZy1hdCI6NzN9XSw5NDpbZnVuY3Rpb24oZSx0LHIpeyJ1c2Ugc3RyaWN0Ijt2YXIgbj1lKCIuL19nbG9iYWwiKSxvPWUoIi4vX2hhcyIpLGk9ZSgiLi9fZGVzY3JpcHRvcnMiKSxhPWUoIi4vX2V4cG9ydCIpLHM9ZSgiLi9fcmVkZWZpbmUiKSx1PWUoIi4vX21ldGEiKS5LRVksbD1lKCIuL19mYWlscyIpLGM9ZSgiLi9fc2hhcmVkIiksZj1lKCIuL19zZXQtdG8tc3RyaW5nLXRhZyIpLHA9ZSgiLi9fdWlkIiksZD1lKCIuL193a3MiKSxoPWUoIi4vX3drcy1leHQiKSx5PWUoIi4vX3drcy1kZWZpbmUiKSxtPWUoIi4vX2tleW9mIiksdj1lKCIuL19lbnVtLWtleXMiKSxfPWUoIi4vX2lzLWFycmF5IiksYj1lKCIuL19hbi1vYmplY3QiKSxnPWUoIi4vX3RvLWlvYmplY3QiKSxFPWUoIi4vX3RvLXByaW1pdGl2ZSIpLGo9ZSgiLi9fcHJvcGVydHktZGVzYyIpLHc9ZSgiLi9fb2JqZWN0LWNyZWF0ZSIpLE89ZSgiLi9fb2JqZWN0LWdvcG4tZXh0IiksTT1lKCIuL19vYmplY3QtZ29wZCIpLHg9ZSgiLi9fb2JqZWN0LWRwIiksUD1lKCIuL19vYmplY3Qta2V5cyIpLGs9TS5mLFI9eC5mLFM9Ty5mLEE9bi5TeW1ib2wsVD1uLkpTT04sTj1UJiZULnN0cmluZ2lmeSxJPSJwcm90b3R5cGUiLFU9ZCgiX2hpZGRlbiIpLEM9ZCgidG9QcmltaXRpdmUiKSxMPXt9LnByb3BlcnR5SXNFbnVtZXJhYmxlLEY9Yygic3ltYm9sLXJlZ2lzdHJ5IiksQj1jKCJzeW1ib2xzIiksRD1jKCJvcC1zeW1ib2xzIiksRz1PYmplY3RbSV0sSz0iZnVuY3Rpb24iPT10eXBlb2YgQSxZPW4uUU9iamVjdCxxPSFZfHwhWVtJXXx8IVlbSV0uZmluZENoaWxkLHo9aSYmbChmdW5jdGlvbigpe3JldHVybiA3IT13KFIoe30sImEiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gUih0aGlzLCJhIix7dmFsdWU6N30pLmF9fSkpLmF9KT9mdW5jdGlvbihlLHQscil7dmFyIG49ayhHLHQpO24mJmRlbGV0ZSBHW3RdLFIoZSx0LHIpLG4mJmUhPT1HJiZSKEcsdCxuKX06UixXPWZ1bmN0aW9uKGUpe3ZhciB0PUJbZV09dyhBW0ldKTtyZXR1cm4gdC5faz1lLHR9LEg9SyYmInN5bWJvbCI9PXR5cGVvZiBBLml0ZXJhdG9yP2Z1bmN0aW9uKGUpe3JldHVybiJzeW1ib2wiPT10eXBlb2YgZX06ZnVuY3Rpb24oZSl7cmV0dXJuIGUgaW5zdGFuY2VvZiBBfSxWPWZ1bmN0aW9uKGUsdCxyKXtyZXR1cm4gZT09PUcmJlYoRCx0LHIpLGIoZSksdD1FKHQsITApLGIociksbyhCLHQpPyhyLmVudW1lcmFibGU/KG8oZSxVKSYmZVtVXVt0XSYmKGVbVV1bdF09ITEpLHI9dyhyLHtlbnVtZXJhYmxlOmooMCwhMSl9KSk6KG8oZSxVKXx8UihlLFUsaigxLHt9KSksZVtVXVt0XT0hMCkseihlLHQscikpOlIoZSx0LHIpfSxKPWZ1bmN0aW9uKGUsdCl7YihlKTtmb3IodmFyIHIsbj12KHQ9Zyh0KSksbz0wLGk9bi5sZW5ndGg7aT5vOylWKGUscj1uW28rK10sdFtyXSk7cmV0dXJuIGV9LCQ9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdm9pZCAwPT09dD93KGUpOkoodyhlKSx0KX0sWD1mdW5jdGlvbihlKXt2YXIgdD1MLmNhbGwodGhpcyxlPUUoZSwhMCkpO3JldHVybiEodGhpcz09PUcmJm8oQixlKSYmIW8oRCxlKSkmJighKHR8fCFvKHRoaXMsZSl8fCFvKEIsZSl8fG8odGhpcyxVKSYmdGhpc1tVXVtlXSl8fHQpfSxRPWZ1bmN0aW9uKGUsdCl7aWYoZT1nKGUpLHQ9RSh0LCEwKSxlIT09R3x8IW8oQix0KXx8byhELHQpKXt2YXIgcj1rKGUsdCk7cmV0dXJuIXJ8fCFvKEIsdCl8fG8oZSxVKSYmZVtVXVt0XXx8KHIuZW51bWVyYWJsZT0hMCkscn19LFo9ZnVuY3Rpb24oZSl7Zm9yKHZhciB0LHI9UyhnKGUpKSxuPVtdLGk9MDtyLmxlbmd0aD5pOylvKEIsdD1yW2krK10pfHx0PT1VfHx0PT11fHxuLnB1c2godCk7cmV0dXJuIG59LGVlPWZ1bmN0aW9uKGUpe2Zvcih2YXIgdCxyPWU9PT1HLG49UyhyP0Q6ZyhlKSksaT1bXSxhPTA7bi5sZW5ndGg+YTspIW8oQix0PW5bYSsrXSl8fHImJiFvKEcsdCl8fGkucHVzaChCW3RdKTtyZXR1cm4gaX07S3x8KEE9ZnVuY3Rpb24oKXtpZih0aGlzIGluc3RhbmNlb2YgQSl0aHJvdyBUeXBlRXJyb3IoIlN5bWJvbCBpcyBub3QgYSBjb25zdHJ1Y3RvciEiKTt2YXIgZT1wKGFyZ3VtZW50cy5sZW5ndGg+MD9hcmd1bWVudHNbMF06dm9pZCAwKSx0PWZ1bmN0aW9uKHIpe3RoaXM9PT1HJiZ0LmNhbGwoRCxyKSxvKHRoaXMsVSkmJm8odGhpc1tVXSxlKSYmKHRoaXNbVV1bZV09ITEpLHoodGhpcyxlLGooMSxyKSl9O3JldHVybiBpJiZxJiZ6KEcsZSx7Y29uZmlndXJhYmxlOiEwLHNldDp0fSksVyhlKX0scyhBW0ldLCJ0b1N0cmluZyIsZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fa30pLE0uZj1RLHguZj1WLGUoIi4vX29iamVjdC1nb3BuIikuZj1PLmY9WixlKCIuL19vYmplY3QtcGllIikuZj1YLGUoIi4vX29iamVjdC1nb3BzIikuZj1lZSxpJiYhZSgiLi9fbGlicmFyeSIpJiZzKEcsInByb3BlcnR5SXNFbnVtZXJhYmxlIixYLCEwKSxoLmY9ZnVuY3Rpb24oZSl7cmV0dXJuIFcoZChlKSl9KSxhKGEuRythLlcrYS5GKiFLLHtTeW1ib2w6QX0pO2Zvcih2YXIgdGU9Imhhc0luc3RhbmNlLGlzQ29uY2F0U3ByZWFkYWJsZSxpdGVyYXRvcixtYXRjaCxyZXBsYWNlLHNlYXJjaCxzcGVjaWVzLHNwbGl0LHRvUHJpbWl0aXZlLHRvU3RyaW5nVGFnLHVuc2NvcGFibGVzIi5zcGxpdCgiLCIpLHJlPTA7dGUubGVuZ3RoPnJlOylkKHRlW3JlKytdKTtmb3IodmFyIHRlPVAoZC5zdG9yZSkscmU9MDt0ZS5sZW5ndGg+cmU7KXkodGVbcmUrK10pO2EoYS5TK2EuRiohSywiU3ltYm9sIix7ImZvciI6ZnVuY3Rpb24oZSl7cmV0dXJuIG8oRixlKz0iIik/RltlXTpGW2VdPUEoZSl9LGtleUZvcjpmdW5jdGlvbihlKXtpZihIKGUpKXJldHVybiBtKEYsZSk7dGhyb3cgVHlwZUVycm9yKGUrIiBpcyBub3QgYSBzeW1ib2whIil9LHVzZVNldHRlcjpmdW5jdGlvbigpe3E9ITB9LHVzZVNpbXBsZTpmdW5jdGlvbigpe3E9ITF9fSksYShhLlMrYS5GKiFLLCJPYmplY3QiLHtjcmVhdGU6JCxkZWZpbmVQcm9wZXJ0eTpWLGRlZmluZVByb3BlcnRpZXM6SixnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3I6USxnZXRPd25Qcm9wZXJ0eU5hbWVzOlosZ2V0T3duUHJvcGVydHlTeW1ib2xzOmVlfSksVCYmYShhLlMrYS5GKighS3x8bChmdW5jdGlvbigpe3ZhciBlPUEoKTtyZXR1cm4iW251bGxdIiE9TihbZV0pfHwie30iIT1OKHthOmV9KXx8Int9IiE9TihPYmplY3QoZSkpfSkpLCJKU09OIix7c3RyaW5naWZ5OmZ1bmN0aW9uKGUpe2lmKHZvaWQgMCE9PWUmJiFIKGUpKXtmb3IodmFyIHQscixuPVtlXSxvPTE7YXJndW1lbnRzLmxlbmd0aD5vOyluLnB1c2goYXJndW1lbnRzW28rK10pO3JldHVybiB0PW5bMV0sImZ1bmN0aW9uIj09dHlwZW9mIHQmJihyPXQpLCFyJiZfKHQpfHwodD1mdW5jdGlvbihlLHQpe2lmKHImJih0PXIuY2FsbCh0aGlzLGUsdCkpLCFIKHQpKXJldHVybiB0fSksblsxXT10LE4uYXBwbHkoVCxuKX19fSksQVtJXVtDXXx8ZSgiLi9faGlkZSIpKEFbSV0sQyxBW0ldLnZhbHVlT2YpLGYoQSwiU3ltYm9sIiksZihNYXRoLCJNYXRoIiwhMCksZihuLkpTT04sIkpTT04iLCEwKX0seyIuL19hbi1vYmplY3QiOjI4LCIuL19kZXNjcmlwdG9ycyI6MzQsIi4vX2VudW0ta2V5cyI6MzcsIi4vX2V4cG9ydCI6MzgsIi4vX2ZhaWxzIjozOSwiLi9fZ2xvYmFsIjo0MCwiLi9faGFzIjo0MSwiLi9faGlkZSI6NDIsIi4vX2lzLWFycmF5Ijo0NiwiLi9fa2V5b2YiOjUyLCIuL19saWJyYXJ5Ijo1MywiLi9fbWV0YSI6NTQsIi4vX29iamVjdC1jcmVhdGUiOjU1LCIuL19vYmplY3QtZHAiOjU2LCIuL19vYmplY3QtZ29wZCI6NTgsIi4vX29iamVjdC1nb3BuIjo2MCwiLi9fb2JqZWN0LWdvcG4tZXh0Ijo1OSwiLi9fb2JqZWN0LWdvcHMiOjYxLCIuL19vYmplY3Qta2V5cyI6NjQsIi4vX29iamVjdC1waWUiOjY1LCIuL19wcm9wZXJ0eS1kZXNjIjo2NywiLi9fcmVkZWZpbmUiOjY4LCIuL19zZXQtdG8tc3RyaW5nLXRhZyI6NzAsIi4vX3NoYXJlZCI6NzIsIi4vX3RvLWlvYmplY3QiOjc2LCIuL190by1wcmltaXRpdmUiOjc5LCIuL191aWQiOjgwLCIuL193a3MiOjgzLCIuL193a3MtZGVmaW5lIjo4MSwiLi9fd2tzLWV4dCI6ODJ9XSw5NTpbZnVuY3Rpb24oZSx0LHIpe2UoIi4vX3drcy1kZWZpbmUiKSgiYXN5bmNJdGVyYXRvciIpfSx7Ii4vX3drcy1kZWZpbmUiOjgxfV0sOTY6W2Z1bmN0aW9uKGUsdCxyKXtlKCIuL193a3MtZGVmaW5lIikoIm9ic2VydmFibGUiKX0seyIuL193a3MtZGVmaW5lIjo4MX1dLDk3OltmdW5jdGlvbihlLHQscil7ZSgiLi9lczYuYXJyYXkuaXRlcmF0b3IiKTtmb3IodmFyIG49ZSgiLi9fZ2xvYmFsIiksbz1lKCIuL19oaWRlIiksaT1lKCIuL19pdGVyYXRvcnMiKSxhPWUoIi4vX3drcyIpKCJ0b1N0cmluZ1RhZyIpLHM9WyJOb2RlTGlzdCIsIkRPTVRva2VuTGlzdCIsIk1lZGlhTGlzdCIsIlN0eWxlU2hlZXRMaXN0IiwiQ1NTUnVsZUxpc3QiXSx1PTA7dTw1O3UrKyl7dmFyIGw9c1t1XSxjPW5bbF0sZj1jJiZjLnByb3RvdHlwZTtmJiYhZlthXSYmbyhmLGEsbCksaVtsXT1pLkFycmF5fX0seyIuL19nbG9iYWwiOjQwLCIuL19oaWRlIjo0MiwiLi9faXRlcmF0b3JzIjo1MSwiLi9fd2tzIjo4MywiLi9lczYuYXJyYXkuaXRlcmF0b3IiOjg0fV0sOTg6W2Z1bmN0aW9uKGUsdCxyKXsoZnVuY3Rpb24ocil7dmFyIG49Im9iamVjdCI9PXR5cGVvZiByP3I6Im9iamVjdCI9PXR5cGVvZiB3aW5kb3c/d2luZG93OiJvYmplY3QiPT10eXBlb2Ygc2VsZj9zZWxmOnRoaXMsbz1uLnJlZ2VuZXJhdG9yUnVudGltZSYmT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMobikuaW5kZXhPZigicmVnZW5lcmF0b3JSdW50aW1lIik+PTAsaT1vJiZuLnJlZ2VuZXJhdG9yUnVudGltZTtpZihuLnJlZ2VuZXJhdG9yUnVudGltZT12b2lkIDAsdC5leHBvcnRzPWUoIi4vcnVudGltZSIpLG8pbi5yZWdlbmVyYXRvclJ1bnRpbWU9aTtlbHNlIHRyeXtkZWxldGUgbi5yZWdlbmVyYXRvclJ1bnRpbWV9Y2F0Y2goYSl7bi5yZWdlbmVyYXRvclJ1bnRpbWU9dm9pZCAwfX0pLmNhbGwodGhpcywidW5kZWZpbmVkIiE9dHlwZW9mIGdsb2JhbD9nbG9iYWw6InVuZGVmaW5lZCIhPXR5cGVvZiBzZWxmP3NlbGY6InVuZGVmaW5lZCIhPXR5cGVvZiB3aW5kb3c/d2luZG93Ont9KX0seyIuL3J1bnRpbWUiOjk5fV0sOTk6W2Z1bmN0aW9uKGUsdCxyKXsoZnVuY3Rpb24oZSl7IWZ1bmN0aW9uKGUpeyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiByKGUsdCxyLG4pe3ZhciBpPU9iamVjdC5jcmVhdGUoKHR8fG8pLnByb3RvdHlwZSksYT1uZXcgZChufHxbXSk7cmV0dXJuIGkuX2ludm9rZT1jKGUscixhKSxpfWZ1bmN0aW9uIG4oZSx0LHIpe3RyeXtyZXR1cm57dHlwZToibm9ybWFsIixhcmc6ZS5jYWxsKHQscil9fWNhdGNoKG4pe3JldHVybnt0eXBlOiJ0aHJvdyIsYXJnOm59fX1mdW5jdGlvbiBvKCl7fWZ1bmN0aW9uIGkoKXt9ZnVuY3Rpb24gYSgpe31mdW5jdGlvbiBzKGUpe1sibmV4dCIsInRocm93IiwicmV0dXJuIl0uZm9yRWFjaChmdW5jdGlvbih0KXtlW3RdPWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLl9pbnZva2UodCxlKX19KX1mdW5jdGlvbiB1KGUpe3RoaXMuYXJnPWV9ZnVuY3Rpb24gbChlKXtmdW5jdGlvbiB0KHIsbyxpLGEpe3ZhciBzPW4oZVtyXSxlLG8pO2lmKCJ0aHJvdyIhPT1zLnR5cGUpe3ZhciBsPXMuYXJnLGM9bC52YWx1ZTtyZXR1cm4gYyBpbnN0YW5jZW9mIHU/UHJvbWlzZS5yZXNvbHZlKGMuYXJnKS50aGVuKGZ1bmN0aW9uKGUpe3QoIm5leHQiLGUsaSxhKX0sZnVuY3Rpb24oZSl7dCgidGhyb3ciLGUsaSxhKX0pOlByb21pc2UucmVzb2x2ZShjKS50aGVuKGZ1bmN0aW9uKGUpe2wudmFsdWU9ZSxpKGwpfSxhKX1hKHMuYXJnKX1mdW5jdGlvbiByKGUscil7ZnVuY3Rpb24gbigpe3JldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihuLG8pe3QoZSxyLG4sbyl9KX1yZXR1cm4gbz1vP28udGhlbihuLG4pOm4oKX0ib2JqZWN0Ij09dHlwZW9mIHByb2Nlc3MmJnByb2Nlc3MuZG9tYWluJiYodD1wcm9jZXNzLmRvbWFpbi5iaW5kKHQpKTt2YXIgbzt0aGlzLl9pbnZva2U9cn1mdW5jdGlvbiBjKGUsdCxyKXt2YXIgbz13O3JldHVybiBmdW5jdGlvbihpLGEpe2lmKG89PT1NKXRocm93IG5ldyBFcnJvcigiR2VuZXJhdG9yIGlzIGFscmVhZHkgcnVubmluZyIpO2lmKG89PT14KXtpZigidGhyb3ciPT09aSl0aHJvdyBhO3JldHVybiB5KCl9Zm9yKDs7KXt2YXIgcz1yLmRlbGVnYXRlO2lmKHMpe2lmKCJyZXR1cm4iPT09aXx8InRocm93Ij09PWkmJnMuaXRlcmF0b3JbaV09PT1tKXtyLmRlbGVnYXRlPW51bGw7dmFyIHU9cy5pdGVyYXRvclsicmV0dXJuIl07aWYodSl7dmFyIGw9bih1LHMuaXRlcmF0b3IsYSk7aWYoInRocm93Ij09PWwudHlwZSl7aT0idGhyb3ciLGE9bC5hcmc7Y29udGludWV9fWlmKCJyZXR1cm4iPT09aSljb250aW51ZX12YXIgbD1uKHMuaXRlcmF0b3JbaV0scy5pdGVyYXRvcixhKTtpZigidGhyb3ciPT09bC50eXBlKXtyLmRlbGVnYXRlPW51bGwsaT0idGhyb3ciLGE9bC5hcmc7Y29udGludWV9aT0ibmV4dCIsYT1tO3ZhciBjPWwuYXJnO2lmKCFjLmRvbmUpcmV0dXJuIG89TyxjO3Jbcy5yZXN1bHROYW1lXT1jLnZhbHVlLHIubmV4dD1zLm5leHRMb2Msci5kZWxlZ2F0ZT1udWxsfWlmKCJuZXh0Ij09PWkpci5zZW50PXIuX3NlbnQ9YTtlbHNlIGlmKCJ0aHJvdyI9PT1pKXtpZihvPT09dyl0aHJvdyBvPXgsYTtyLmRpc3BhdGNoRXhjZXB0aW9uKGEpJiYoaT0ibmV4dCIsYT1tKX1lbHNlInJldHVybiI9PT1pJiZyLmFicnVwdCgicmV0dXJuIixhKTtvPU07dmFyIGw9bihlLHQscik7aWYoIm5vcm1hbCI9PT1sLnR5cGUpe289ci5kb25lP3g6Tzt2YXIgYz17dmFsdWU6bC5hcmcsZG9uZTpyLmRvbmV9O2lmKGwuYXJnIT09UClyZXR1cm4gYztyLmRlbGVnYXRlJiYibmV4dCI9PT1pJiYoYT1tKX1lbHNlInRocm93Ij09PWwudHlwZSYmKG89eCxpPSJ0aHJvdyIsYT1sLmFyZyl9fX1mdW5jdGlvbiBmKGUpe3ZhciB0PXt0cnlMb2M6ZVswXX07MSBpbiBlJiYodC5jYXRjaExvYz1lWzFdKSwyIGluIGUmJih0LmZpbmFsbHlMb2M9ZVsyXSx0LmFmdGVyTG9jPWVbM10pLHRoaXMudHJ5RW50cmllcy5wdXNoKHQpfWZ1bmN0aW9uIHAoZSl7dmFyIHQ9ZS5jb21wbGV0aW9ufHx7fTt0LnR5cGU9Im5vcm1hbCIsZGVsZXRlIHQuYXJnLGUuY29tcGxldGlvbj10fWZ1bmN0aW9uIGQoZSl7dGhpcy50cnlFbnRyaWVzPVt7dHJ5TG9jOiJyb290In1dLGUuZm9yRWFjaChmLHRoaXMpLHRoaXMucmVzZXQoITApfWZ1bmN0aW9uIGgoZSl7aWYoZSl7dmFyIHQ9ZVtiXTtpZih0KXJldHVybiB0LmNhbGwoZSk7aWYoImZ1bmN0aW9uIj09dHlwZW9mIGUubmV4dClyZXR1cm4gZTtpZighaXNOYU4oZS5sZW5ndGgpKXt2YXIgcj0tMSxuPWZ1bmN0aW9uIG8oKXtmb3IoOysrcjxlLmxlbmd0aDspaWYodi5jYWxsKGUscikpcmV0dXJuIG8udmFsdWU9ZVtyXSxvLmRvbmU9ITEsbztyZXR1cm4gby52YWx1ZT1tLG8uZG9uZT0hMCxvfTtyZXR1cm4gbi5uZXh0PW59fXJldHVybntuZXh0Onl9fWZ1bmN0aW9uIHkoKXtyZXR1cm57dmFsdWU6bSxkb25lOiEwfX12YXIgbSx2PU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHksXz0iZnVuY3Rpb24iPT10eXBlb2YgU3ltYm9sP1N5bWJvbDp7fSxiPV8uaXRlcmF0b3J8fCJAQGl0ZXJhdG9yIixnPV8udG9TdHJpbmdUYWd8fCJAQHRvU3RyaW5nVGFnIixFPSJvYmplY3QiPT10eXBlb2YgdCxqPWUucmVnZW5lcmF0b3JSdW50aW1lO2lmKGopcmV0dXJuIHZvaWQoRSYmKHQuZXhwb3J0cz1qKSk7aj1lLnJlZ2VuZXJhdG9yUnVudGltZT1FP3QuZXhwb3J0czp7fSxqLndyYXA9cjt2YXIgdz0ic3VzcGVuZGVkU3RhcnQiLE89InN1c3BlbmRlZFlpZWxkIixNPSJleGVjdXRpbmciLHg9ImNvbXBsZXRlZCIsUD17fSxrPWEucHJvdG90eXBlPW8ucHJvdG90eXBlO2kucHJvdG90eXBlPWsuY29uc3RydWN0b3I9YSxhLmNvbnN0cnVjdG9yPWksYVtnXT1pLmRpc3BsYXlOYW1lPSJHZW5lcmF0b3JGdW5jdGlvbiIsai5pc0dlbmVyYXRvckZ1bmN0aW9uPWZ1bmN0aW9uKGUpe3ZhciB0PSJmdW5jdGlvbiI9PXR5cGVvZiBlJiZlLmNvbnN0cnVjdG9yO3JldHVybiEhdCYmKHQ9PT1pfHwiR2VuZXJhdG9yRnVuY3Rpb24iPT09KHQuZGlzcGxheU5hbWV8fHQubmFtZSkpfSxqLm1hcms9ZnVuY3Rpb24oZSl7cmV0dXJuIE9iamVjdC5zZXRQcm90b3R5cGVPZj9PYmplY3Quc2V0UHJvdG90eXBlT2YoZSxhKTooZS5fX3Byb3RvX189YSxnIGluIGV8fChlW2ddPSJHZW5lcmF0b3JGdW5jdGlvbiIpKSxlLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKGspLGV9LGouYXdyYXA9ZnVuY3Rpb24oZSl7cmV0dXJuIG5ldyB1KGUpfSxzKGwucHJvdG90eXBlKSxqLmFzeW5jPWZ1bmN0aW9uKGUsdCxuLG8pe3ZhciBpPW5ldyBsKHIoZSx0LG4sbykpO3JldHVybiBqLmlzR2VuZXJhdG9yRnVuY3Rpb24odCk/aTppLm5leHQoKS50aGVuKGZ1bmN0aW9uKGUpe3JldHVybiBlLmRvbmU/ZS52YWx1ZTppLm5leHQoKX0pfSxzKGspLGtbYl09ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc30sa1tnXT0iR2VuZXJhdG9yIixrLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIltvYmplY3QgR2VuZXJhdG9yXSJ9LGoua2V5cz1mdW5jdGlvbihlKXt2YXIgdD1bXTtmb3IodmFyIHIgaW4gZSl0LnB1c2gocik7cmV0dXJuIHQucmV2ZXJzZSgpLGZ1bmN0aW9uIG4oKXtmb3IoO3QubGVuZ3RoOyl7dmFyIHI9dC5wb3AoKTtpZihyIGluIGUpcmV0dXJuIG4udmFsdWU9cixuLmRvbmU9ITEsbn1yZXR1cm4gbi5kb25lPSEwLG59fSxqLnZhbHVlcz1oLGQucHJvdG90eXBlPXtjb25zdHJ1Y3RvcjpkLHJlc2V0OmZ1bmN0aW9uKGUpe2lmKHRoaXMucHJldj0wLHRoaXMubmV4dD0wLHRoaXMuc2VudD10aGlzLl9zZW50PW0sdGhpcy5kb25lPSExLHRoaXMuZGVsZWdhdGU9bnVsbCx0aGlzLnRyeUVudHJpZXMuZm9yRWFjaChwKSwhZSlmb3IodmFyIHQgaW4gdGhpcykidCI9PT10LmNoYXJBdCgwKSYmdi5jYWxsKHRoaXMsdCkmJiFpc05hTigrdC5zbGljZSgxKSkmJih0aGlzW3RdPW0pOw0KfSxzdG9wOmZ1bmN0aW9uKCl7dGhpcy5kb25lPSEwO3ZhciBlPXRoaXMudHJ5RW50cmllc1swXSx0PWUuY29tcGxldGlvbjtpZigidGhyb3ciPT09dC50eXBlKXRocm93IHQuYXJnO3JldHVybiB0aGlzLnJ2YWx9LGRpc3BhdGNoRXhjZXB0aW9uOmZ1bmN0aW9uKGUpe2Z1bmN0aW9uIHQodCxuKXtyZXR1cm4gaS50eXBlPSJ0aHJvdyIsaS5hcmc9ZSxyLm5leHQ9dCwhIW59aWYodGhpcy5kb25lKXRocm93IGU7Zm9yKHZhciByPXRoaXMsbj10aGlzLnRyeUVudHJpZXMubGVuZ3RoLTE7bj49MDstLW4pe3ZhciBvPXRoaXMudHJ5RW50cmllc1tuXSxpPW8uY29tcGxldGlvbjtpZigicm9vdCI9PT1vLnRyeUxvYylyZXR1cm4gdCgiZW5kIik7aWYoby50cnlMb2M8PXRoaXMucHJldil7dmFyIGE9di5jYWxsKG8sImNhdGNoTG9jIikscz12LmNhbGwobywiZmluYWxseUxvYyIpO2lmKGEmJnMpe2lmKHRoaXMucHJldjxvLmNhdGNoTG9jKXJldHVybiB0KG8uY2F0Y2hMb2MsITApO2lmKHRoaXMucHJldjxvLmZpbmFsbHlMb2MpcmV0dXJuIHQoby5maW5hbGx5TG9jKX1lbHNlIGlmKGEpe2lmKHRoaXMucHJldjxvLmNhdGNoTG9jKXJldHVybiB0KG8uY2F0Y2hMb2MsITApfWVsc2V7aWYoIXMpdGhyb3cgbmV3IEVycm9yKCJ0cnkgc3RhdGVtZW50IHdpdGhvdXQgY2F0Y2ggb3IgZmluYWxseSIpO2lmKHRoaXMucHJldjxvLmZpbmFsbHlMb2MpcmV0dXJuIHQoby5maW5hbGx5TG9jKX19fX0sYWJydXB0OmZ1bmN0aW9uKGUsdCl7Zm9yKHZhciByPXRoaXMudHJ5RW50cmllcy5sZW5ndGgtMTtyPj0wOy0tcil7dmFyIG49dGhpcy50cnlFbnRyaWVzW3JdO2lmKG4udHJ5TG9jPD10aGlzLnByZXYmJnYuY2FsbChuLCJmaW5hbGx5TG9jIikmJnRoaXMucHJldjxuLmZpbmFsbHlMb2Mpe3ZhciBvPW47YnJlYWt9fW8mJigiYnJlYWsiPT09ZXx8ImNvbnRpbnVlIj09PWUpJiZvLnRyeUxvYzw9dCYmdDw9by5maW5hbGx5TG9jJiYobz1udWxsKTt2YXIgaT1vP28uY29tcGxldGlvbjp7fTtyZXR1cm4gaS50eXBlPWUsaS5hcmc9dCxvP3RoaXMubmV4dD1vLmZpbmFsbHlMb2M6dGhpcy5jb21wbGV0ZShpKSxQfSxjb21wbGV0ZTpmdW5jdGlvbihlLHQpe2lmKCJ0aHJvdyI9PT1lLnR5cGUpdGhyb3cgZS5hcmc7ImJyZWFrIj09PWUudHlwZXx8ImNvbnRpbnVlIj09PWUudHlwZT90aGlzLm5leHQ9ZS5hcmc6InJldHVybiI9PT1lLnR5cGU/KHRoaXMucnZhbD1lLmFyZyx0aGlzLm5leHQ9ImVuZCIpOiJub3JtYWwiPT09ZS50eXBlJiZ0JiYodGhpcy5uZXh0PXQpfSxmaW5pc2g6ZnVuY3Rpb24oZSl7Zm9yKHZhciB0PXRoaXMudHJ5RW50cmllcy5sZW5ndGgtMTt0Pj0wOy0tdCl7dmFyIHI9dGhpcy50cnlFbnRyaWVzW3RdO2lmKHIuZmluYWxseUxvYz09PWUpcmV0dXJuIHRoaXMuY29tcGxldGUoci5jb21wbGV0aW9uLHIuYWZ0ZXJMb2MpLHAociksUH19LCJjYXRjaCI6ZnVuY3Rpb24oZSl7Zm9yKHZhciB0PXRoaXMudHJ5RW50cmllcy5sZW5ndGgtMTt0Pj0wOy0tdCl7dmFyIHI9dGhpcy50cnlFbnRyaWVzW3RdO2lmKHIudHJ5TG9jPT09ZSl7dmFyIG49ci5jb21wbGV0aW9uO2lmKCJ0aHJvdyI9PT1uLnR5cGUpe3ZhciBvPW4uYXJnO3Aocil9cmV0dXJuIG99fXRocm93IG5ldyBFcnJvcigiaWxsZWdhbCBjYXRjaCBhdHRlbXB0Iil9LGRlbGVnYXRlWWllbGQ6ZnVuY3Rpb24oZSx0LHIpe3JldHVybiB0aGlzLmRlbGVnYXRlPXtpdGVyYXRvcjpoKGUpLHJlc3VsdE5hbWU6dCxuZXh0TG9jOnJ9LFB9fX0oIm9iamVjdCI9PXR5cGVvZiBlP2U6Im9iamVjdCI9PXR5cGVvZiB3aW5kb3c/d2luZG93OiJvYmplY3QiPT10eXBlb2Ygc2VsZj9zZWxmOnRoaXMpfSkuY2FsbCh0aGlzLCJ1bmRlZmluZWQiIT10eXBlb2YgZ2xvYmFsP2dsb2JhbDoidW5kZWZpbmVkIiE9dHlwZW9mIHNlbGY/c2VsZjoidW5kZWZpbmVkIiE9dHlwZW9mIHdpbmRvdz93aW5kb3c6e30pfSx7fV0sMTAwOltmdW5jdGlvbih0LHIsbil7IWZ1bmN0aW9uKHQsbil7ImZ1bmN0aW9uIj09dHlwZW9mIGUmJmUuYW1kP2UoW10sbik6InVuZGVmaW5lZCIhPXR5cGVvZiByJiZyLmV4cG9ydHM/ci5leHBvcnRzPW4oKTp0LnR2ND1uKCl9KHRoaXMsZnVuY3Rpb24oKXtmdW5jdGlvbiBlKGUpe3JldHVybiBlbmNvZGVVUkkoZSkucmVwbGFjZSgvJTI1WzAtOV1bMC05XS9nLGZ1bmN0aW9uKGUpe3JldHVybiIlIitlLnN1YnN0cmluZygzKX0pfWZ1bmN0aW9uIHQodCl7dmFyIHI9IiI7cFt0LmNoYXJBdCgwKV0mJihyPXQuY2hhckF0KDApLHQ9dC5zdWJzdHJpbmcoMSkpO3ZhciBuPSIiLG89IiIsaT0hMCxhPSExLHM9ITE7IisiPT09cj9pPSExOiIuIj09PXI/KG89Ii4iLG49Ii4iKToiLyI9PT1yPyhvPSIvIixuPSIvIik6IiMiPT09cj8obz0iIyIsaT0hMSk6IjsiPT09cj8obz0iOyIsbj0iOyIsYT0hMCxzPSEwKToiPyI9PT1yPyhvPSI/IixuPSImIixhPSEwKToiJiI9PT1yJiYobz0iJiIsbj0iJiIsYT0hMCk7Zm9yKHZhciB1PVtdLGw9dC5zcGxpdCgiLCIpLGM9W10sZj17fSxoPTA7aDxsLmxlbmd0aDtoKyspe3ZhciB5PWxbaF0sbT1udWxsO2lmKHkuaW5kZXhPZigiOiIpIT09LTEpe3ZhciB2PXkuc3BsaXQoIjoiKTt5PXZbMF0sbT1wYXJzZUludCh2WzFdLDEwKX1mb3IodmFyIF89e307ZFt5LmNoYXJBdCh5Lmxlbmd0aC0xKV07KV9beS5jaGFyQXQoeS5sZW5ndGgtMSldPSEwLHk9eS5zdWJzdHJpbmcoMCx5Lmxlbmd0aC0xKTt2YXIgYj17dHJ1bmNhdGU6bSxuYW1lOnksc3VmZmljZXM6X307Yy5wdXNoKGIpLGZbeV09Yix1LnB1c2goeSl9dmFyIGc9ZnVuY3Rpb24odCl7Zm9yKHZhciByPSIiLHU9MCxsPTA7bDxjLmxlbmd0aDtsKyspe3ZhciBmPWNbbF0scD10KGYubmFtZSk7aWYobnVsbD09PXB8fHZvaWQgMD09PXB8fEFycmF5LmlzQXJyYXkocCkmJjA9PT1wLmxlbmd0aHx8Im9iamVjdCI9PXR5cGVvZiBwJiYwPT09T2JqZWN0LmtleXMocCkubGVuZ3RoKXUrKztlbHNlIGlmKHIrPWw9PT11P286bnx8IiwiLEFycmF5LmlzQXJyYXkocCkpe2EmJihyKz1mLm5hbWUrIj0iKTtmb3IodmFyIGQ9MDtkPHAubGVuZ3RoO2QrKylkPjAmJihyKz1mLnN1ZmZpY2VzWyIqIl0/bnx8IiwiOiIsIixmLnN1ZmZpY2VzWyIqIl0mJmEmJihyKz1mLm5hbWUrIj0iKSkscis9aT9lbmNvZGVVUklDb21wb25lbnQocFtkXSkucmVwbGFjZSgvIS9nLCIlMjEiKTplKHBbZF0pfWVsc2UgaWYoIm9iamVjdCI9PXR5cGVvZiBwKXthJiYhZi5zdWZmaWNlc1siKiJdJiYocis9Zi5uYW1lKyI9Iik7dmFyIGg9ITA7Zm9yKHZhciB5IGluIHApaHx8KHIrPWYuc3VmZmljZXNbIioiXT9ufHwiLCI6IiwiKSxoPSExLHIrPWk/ZW5jb2RlVVJJQ29tcG9uZW50KHkpLnJlcGxhY2UoLyEvZywiJTIxIik6ZSh5KSxyKz1mLnN1ZmZpY2VzWyIqIl0/Ij0iOiIsIixyKz1pP2VuY29kZVVSSUNvbXBvbmVudChwW3ldKS5yZXBsYWNlKC8hL2csIiUyMSIpOmUocFt5XSl9ZWxzZSBhJiYocis9Zi5uYW1lLHMmJiIiPT09cHx8KHIrPSI9IikpLG51bGwhPWYudHJ1bmNhdGUmJihwPXAuc3Vic3RyaW5nKDAsZi50cnVuY2F0ZSkpLHIrPWk/ZW5jb2RlVVJJQ29tcG9uZW50KHApLnJlcGxhY2UoLyEvZywiJTIxIik6ZShwKX1yZXR1cm4gcn07cmV0dXJuIGcudmFyTmFtZXM9dSx7cHJlZml4Om8sc3Vic3RpdHV0aW9uOmd9fWZ1bmN0aW9uIHIoZSl7aWYoISh0aGlzIGluc3RhbmNlb2YgcikpcmV0dXJuIG5ldyByKGUpO2Zvcih2YXIgbj1lLnNwbGl0KCJ7Iiksbz1bbi5zaGlmdCgpXSxpPVtdLGE9W10scz1bXTtuLmxlbmd0aD4wOyl7dmFyIHU9bi5zaGlmdCgpLGw9dS5zcGxpdCgifSIpWzBdLGM9dS5zdWJzdHJpbmcobC5sZW5ndGgrMSksZj10KGwpO2EucHVzaChmLnN1YnN0aXR1dGlvbiksaS5wdXNoKGYucHJlZml4KSxvLnB1c2goYykscz1zLmNvbmNhdChmLnN1YnN0aXR1dGlvbi52YXJOYW1lcyl9dGhpcy5maWxsPWZ1bmN0aW9uKGUpe2Zvcih2YXIgdD1vWzBdLHI9MDtyPGEubGVuZ3RoO3IrKyl7dmFyIG49YVtyXTt0Kz1uKGUpLHQrPW9bcisxXX1yZXR1cm4gdH0sdGhpcy52YXJOYW1lcz1zLHRoaXMudGVtcGxhdGU9ZX1mdW5jdGlvbiBuKGUsdCl7aWYoZT09PXQpcmV0dXJuITA7aWYoZSYmdCYmIm9iamVjdCI9PXR5cGVvZiBlJiYib2JqZWN0Ij09dHlwZW9mIHQpe2lmKEFycmF5LmlzQXJyYXkoZSkhPT1BcnJheS5pc0FycmF5KHQpKXJldHVybiExO2lmKEFycmF5LmlzQXJyYXkoZSkpe2lmKGUubGVuZ3RoIT09dC5sZW5ndGgpcmV0dXJuITE7Zm9yKHZhciByPTA7cjxlLmxlbmd0aDtyKyspaWYoIW4oZVtyXSx0W3JdKSlyZXR1cm4hMX1lbHNle3ZhciBvO2ZvcihvIGluIGUpaWYodm9pZCAwPT09dFtvXSYmdm9pZCAwIT09ZVtvXSlyZXR1cm4hMTtmb3IobyBpbiB0KWlmKHZvaWQgMD09PWVbb10mJnZvaWQgMCE9PXRbb10pcmV0dXJuITE7Zm9yKG8gaW4gZSlpZighbihlW29dLHRbb10pKXJldHVybiExfXJldHVybiEwfXJldHVybiExfWZ1bmN0aW9uIG8oZSl7dmFyIHQ9U3RyaW5nKGUpLnJlcGxhY2UoL15ccyt8XHMrJC9nLCIiKS5tYXRjaCgvXihbXjpcLz8jXSs6KT8oXC9cLyg/OlteOkBdKig/OjpbXjpAXSopP0ApPygoW146XC8/I10qKSg/OjooXGQqKSk/KSk/KFtePyNdKikoXD9bXiNdKik/KCNbXHNcU10qKT8vKTtyZXR1cm4gdD97aHJlZjp0WzBdfHwiIixwcm90b2NvbDp0WzFdfHwiIixhdXRob3JpdHk6dFsyXXx8IiIsaG9zdDp0WzNdfHwiIixob3N0bmFtZTp0WzRdfHwiIixwb3J0OnRbNV18fCIiLHBhdGhuYW1lOnRbNl18fCIiLHNlYXJjaDp0WzddfHwiIixoYXNoOnRbOF18fCIifTpudWxsfWZ1bmN0aW9uIGkoZSx0KXtmdW5jdGlvbiByKGUpe3ZhciB0PVtdO3JldHVybiBlLnJlcGxhY2UoL14oXC5cLj8oXC98JCkpKy8sIiIpLnJlcGxhY2UoL1wvKFwuKFwvfCQpKSsvZywiLyIpLnJlcGxhY2UoL1wvXC5cLiQvLCIvLi4vIikucmVwbGFjZSgvXC8/W15cL10qL2csZnVuY3Rpb24oZSl7Ii8uLiI9PT1lP3QucG9wKCk6dC5wdXNoKGUpfSksdC5qb2luKCIiKS5yZXBsYWNlKC9eXC8vLCIvIj09PWUuY2hhckF0KDApPyIvIjoiIil9cmV0dXJuIHQ9byh0fHwiIiksZT1vKGV8fCIiKSx0JiZlPyh0LnByb3RvY29sfHxlLnByb3RvY29sKSsodC5wcm90b2NvbHx8dC5hdXRob3JpdHk/dC5hdXRob3JpdHk6ZS5hdXRob3JpdHkpK3IodC5wcm90b2NvbHx8dC5hdXRob3JpdHl8fCIvIj09PXQucGF0aG5hbWUuY2hhckF0KDApP3QucGF0aG5hbWU6dC5wYXRobmFtZT8oZS5hdXRob3JpdHkmJiFlLnBhdGhuYW1lPyIvIjoiIikrZS5wYXRobmFtZS5zbGljZSgwLGUucGF0aG5hbWUubGFzdEluZGV4T2YoIi8iKSsxKSt0LnBhdGhuYW1lOmUucGF0aG5hbWUpKyh0LnByb3RvY29sfHx0LmF1dGhvcml0eXx8dC5wYXRobmFtZT90LnNlYXJjaDp0LnNlYXJjaHx8ZS5zZWFyY2gpK3QuaGFzaDpudWxsfWZ1bmN0aW9uIGEoZSl7cmV0dXJuIGUuc3BsaXQoIiMiKVswXX1mdW5jdGlvbiBzKGUsdCl7aWYoZSYmIm9iamVjdCI9PXR5cGVvZiBlKWlmKHZvaWQgMD09PXQ/dD1lLmlkOiJzdHJpbmciPT10eXBlb2YgZS5pZCYmKHQ9aSh0LGUuaWQpLGUuaWQ9dCksQXJyYXkuaXNBcnJheShlKSlmb3IodmFyIHI9MDtyPGUubGVuZ3RoO3IrKylzKGVbcl0sdCk7ZWxzZXsic3RyaW5nIj09dHlwZW9mIGUuJHJlZiYmKGUuJHJlZj1pKHQsZS4kcmVmKSk7Zm9yKHZhciBuIGluIGUpImVudW0iIT09biYmcyhlW25dLHQpfX1mdW5jdGlvbiB1KGUpe2U9ZXx8ImVuIjt2YXIgdD1FW2VdO3JldHVybiBmdW5jdGlvbihlKXt2YXIgcj10W2UuY29kZV18fGdbZS5jb2RlXTtpZigic3RyaW5nIiE9dHlwZW9mIHIpcmV0dXJuIlVua25vd24gZXJyb3IgY29kZSAiK2UuY29kZSsiOiAiK0pTT04uc3RyaW5naWZ5KGUubWVzc2FnZVBhcmFtcyk7dmFyIG49ZS5wYXJhbXM7cmV0dXJuIHIucmVwbGFjZSgvXHsoW157fV0qKVx9L2csZnVuY3Rpb24oZSx0KXt2YXIgcj1uW3RdO3JldHVybiJzdHJpbmciPT10eXBlb2Ygcnx8Im51bWJlciI9PXR5cGVvZiByP3I6ZX0pfX1mdW5jdGlvbiBsKGUsdCxyLG4sbyl7aWYoRXJyb3IuY2FsbCh0aGlzKSx2b2lkIDA9PT1lKXRocm93IG5ldyBFcnJvcigiTm8gZXJyb3IgY29kZSBzdXBwbGllZDogIituKTt0aGlzLm1lc3NhZ2U9IiIsdGhpcy5wYXJhbXM9dCx0aGlzLmNvZGU9ZSx0aGlzLmRhdGFQYXRoPXJ8fCIiLHRoaXMuc2NoZW1hUGF0aD1ufHwiIix0aGlzLnN1YkVycm9ycz1vfHxudWxsO3ZhciBpPW5ldyBFcnJvcih0aGlzLm1lc3NhZ2UpO2lmKHRoaXMuc3RhY2s9aS5zdGFja3x8aS5zdGFja3RyYWNlLCF0aGlzLnN0YWNrKXRyeXt0aHJvdyBpfWNhdGNoKGkpe3RoaXMuc3RhY2s9aS5zdGFja3x8aS5zdGFja3RyYWNlfX1mdW5jdGlvbiBjKGUsdCl7aWYodC5zdWJzdHJpbmcoMCxlLmxlbmd0aCk9PT1lKXt2YXIgcj10LnN1YnN0cmluZyhlLmxlbmd0aCk7aWYodC5sZW5ndGg+MCYmIi8iPT09dC5jaGFyQXQoZS5sZW5ndGgtMSl8fCIjIj09PXIuY2hhckF0KDApfHwiPyI9PT1yLmNoYXJBdCgwKSlyZXR1cm4hMH1yZXR1cm4hMX1mdW5jdGlvbiBmKGUpe3ZhciB0LHIsbj1uZXcgaCxvPXtzZXRFcnJvclJlcG9ydGVyOmZ1bmN0aW9uKGUpe3JldHVybiJzdHJpbmciPT10eXBlb2YgZT90aGlzLmxhbmd1YWdlKGUpOihyPWUsITApfSxhZGRGb3JtYXQ6ZnVuY3Rpb24oKXtuLmFkZEZvcm1hdC5hcHBseShuLGFyZ3VtZW50cyl9LGxhbmd1YWdlOmZ1bmN0aW9uKGUpe3JldHVybiBlPyhFW2VdfHwoZT1lLnNwbGl0KCItIilbMF0pLCEhRVtlXSYmKHQ9ZSxlKSk6dH0sYWRkTGFuZ3VhZ2U6ZnVuY3Rpb24oZSx0KXt2YXIgcjtmb3IociBpbiB2KXRbcl0mJiF0W3Zbcl1dJiYodFt2W3JdXT10W3JdKTt2YXIgbj1lLnNwbGl0KCItIilbMF07aWYoRVtuXSl7RVtlXT1PYmplY3QuY3JlYXRlKEVbbl0pO2ZvcihyIGluIHQpInVuZGVmaW5lZCI9PXR5cGVvZiBFW25dW3JdJiYoRVtuXVtyXT10W3JdKSxFW2VdW3JdPXRbcl19ZWxzZSBFW2VdPXQsRVtuXT10O3JldHVybiB0aGlzfSxmcmVzaEFwaTpmdW5jdGlvbihlKXt2YXIgdD1mKCk7cmV0dXJuIGUmJnQubGFuZ3VhZ2UoZSksdH0sdmFsaWRhdGU6ZnVuY3Rpb24oZSxvLGksYSl7dmFyIHM9dSh0KSxsPXI/ZnVuY3Rpb24oZSx0LG4pe3JldHVybiByKGUsdCxuKXx8cyhlLHQsbil9OnMsYz1uZXcgaChuLCghMSksbCxpLGEpOyJzdHJpbmciPT10eXBlb2YgbyYmKG89eyRyZWY6b30pLGMuYWRkU2NoZW1hKCIiLG8pO3ZhciBmPWMudmFsaWRhdGVBbGwoZSxvLG51bGwsbnVsbCwiIik7cmV0dXJuIWYmJmEmJihmPWMuYmFuVW5rbm93blByb3BlcnRpZXMoZSxvKSksdGhpcy5lcnJvcj1mLHRoaXMubWlzc2luZz1jLm1pc3NpbmcsdGhpcy52YWxpZD1udWxsPT09Zix0aGlzLnZhbGlkfSx2YWxpZGF0ZVJlc3VsdDpmdW5jdGlvbigpe3ZhciBlPXt9O3JldHVybiB0aGlzLnZhbGlkYXRlLmFwcGx5KGUsYXJndW1lbnRzKSxlfSx2YWxpZGF0ZU11bHRpcGxlOmZ1bmN0aW9uKGUsbyxpLGEpe3ZhciBzPXUodCksbD1yP2Z1bmN0aW9uKGUsdCxuKXtyZXR1cm4gcihlLHQsbil8fHMoZSx0LG4pfTpzLGM9bmV3IGgobiwoITApLGwsaSxhKTsic3RyaW5nIj09dHlwZW9mIG8mJihvPXskcmVmOm99KSxjLmFkZFNjaGVtYSgiIixvKSxjLnZhbGlkYXRlQWxsKGUsbyxudWxsLG51bGwsIiIpLGEmJmMuYmFuVW5rbm93blByb3BlcnRpZXMoZSxvKTt2YXIgZj17fTtyZXR1cm4gZi5lcnJvcnM9Yy5lcnJvcnMsZi5taXNzaW5nPWMubWlzc2luZyxmLnZhbGlkPTA9PT1mLmVycm9ycy5sZW5ndGgsZn0sYWRkU2NoZW1hOmZ1bmN0aW9uKCl7cmV0dXJuIG4uYWRkU2NoZW1hLmFwcGx5KG4sYXJndW1lbnRzKX0sZ2V0U2NoZW1hOmZ1bmN0aW9uKCl7cmV0dXJuIG4uZ2V0U2NoZW1hLmFwcGx5KG4sYXJndW1lbnRzKX0sZ2V0U2NoZW1hTWFwOmZ1bmN0aW9uKCl7cmV0dXJuIG4uZ2V0U2NoZW1hTWFwLmFwcGx5KG4sYXJndW1lbnRzKX0sZ2V0U2NoZW1hVXJpczpmdW5jdGlvbigpe3JldHVybiBuLmdldFNjaGVtYVVyaXMuYXBwbHkobixhcmd1bWVudHMpfSxnZXRNaXNzaW5nVXJpczpmdW5jdGlvbigpe3JldHVybiBuLmdldE1pc3NpbmdVcmlzLmFwcGx5KG4sYXJndW1lbnRzKX0sZHJvcFNjaGVtYXM6ZnVuY3Rpb24oKXtuLmRyb3BTY2hlbWFzLmFwcGx5KG4sYXJndW1lbnRzKX0sZGVmaW5lS2V5d29yZDpmdW5jdGlvbigpe24uZGVmaW5lS2V5d29yZC5hcHBseShuLGFyZ3VtZW50cyl9LGRlZmluZUVycm9yOmZ1bmN0aW9uKGUsdCxyKXtpZigic3RyaW5nIiE9dHlwZW9mIGV8fCEvXltBLVpdKyhfW0EtWl0rKSokLy50ZXN0KGUpKXRocm93IG5ldyBFcnJvcigiQ29kZSBuYW1lIG11c3QgYmUgYSBzdHJpbmcgaW4gVVBQRVJfQ0FTRV9XSVRIX1VOREVSU0NPUkVTIik7aWYoIm51bWJlciIhPXR5cGVvZiB0fHx0JTEhPT0wfHx0PDFlNCl0aHJvdyBuZXcgRXJyb3IoIkNvZGUgbnVtYmVyIG11c3QgYmUgYW4gaW50ZWdlciA+IDEwMDAwIik7aWYoInVuZGVmaW5lZCIhPXR5cGVvZiB2W2VdKXRocm93IG5ldyBFcnJvcigiRXJyb3IgYWxyZWFkeSBkZWZpbmVkOiAiK2UrIiBhcyAiK3ZbZV0pO2lmKCJ1bmRlZmluZWQiIT10eXBlb2YgX1t0XSl0aHJvdyBuZXcgRXJyb3IoIkVycm9yIGNvZGUgYWxyZWFkeSB1c2VkOiAiK19bdF0rIiBhcyAiK3QpO3ZbZV09dCxfW3RdPWUsZ1tlXT1nW3RdPXI7Zm9yKHZhciBuIGluIEUpe3ZhciBvPUVbbl07b1tlXSYmKG9bdF09b1t0XXx8b1tlXSl9fSxyZXNldDpmdW5jdGlvbigpe24ucmVzZXQoKSx0aGlzLmVycm9yPW51bGwsdGhpcy5taXNzaW5nPVtdLHRoaXMudmFsaWQ9ITB9LG1pc3Npbmc6W10sZXJyb3I6bnVsbCx2YWxpZDohMCxub3JtU2NoZW1hOnMscmVzb2x2ZVVybDppLGdldERvY3VtZW50VXJpOmEsZXJyb3JDb2Rlczp2fTtyZXR1cm4gby5sYW5ndWFnZShlfHwiZW4iKSxvfU9iamVjdC5rZXlzfHwoT2JqZWN0LmtleXM9ZnVuY3Rpb24oKXt2YXIgZT1PYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LHQ9IXt0b1N0cmluZzpudWxsfS5wcm9wZXJ0eUlzRW51bWVyYWJsZSgidG9TdHJpbmciKSxyPVsidG9TdHJpbmciLCJ0b0xvY2FsZVN0cmluZyIsInZhbHVlT2YiLCJoYXNPd25Qcm9wZXJ0eSIsImlzUHJvdG90eXBlT2YiLCJwcm9wZXJ0eUlzRW51bWVyYWJsZSIsImNvbnN0cnVjdG9yIl0sbj1yLmxlbmd0aDtyZXR1cm4gZnVuY3Rpb24obyl7aWYoIm9iamVjdCIhPXR5cGVvZiBvJiYiZnVuY3Rpb24iIT10eXBlb2Ygb3x8bnVsbD09PW8pdGhyb3cgbmV3IFR5cGVFcnJvcigiT2JqZWN0LmtleXMgY2FsbGVkIG9uIG5vbi1vYmplY3QiKTt2YXIgaT1bXTtmb3IodmFyIGEgaW4gbyllLmNhbGwobyxhKSYmaS5wdXNoKGEpO2lmKHQpZm9yKHZhciBzPTA7czxuO3MrKyllLmNhbGwobyxyW3NdKSYmaS5wdXNoKHJbc10pO3JldHVybiBpfX0oKSksT2JqZWN0LmNyZWF0ZXx8KE9iamVjdC5jcmVhdGU9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKCl7fXJldHVybiBmdW5jdGlvbih0KXtpZigxIT09YXJndW1lbnRzLmxlbmd0aCl0aHJvdyBuZXcgRXJyb3IoIk9iamVjdC5jcmVhdGUgaW1wbGVtZW50YXRpb24gb25seSBhY2NlcHRzIG9uZSBwYXJhbWV0ZXIuIik7cmV0dXJuIGUucHJvdG90eXBlPXQsbmV3IGV9fSgpKSxBcnJheS5pc0FycmF5fHwoQXJyYXkuaXNBcnJheT1mdW5jdGlvbihlKXtyZXR1cm4iW29iamVjdCBBcnJheV0iPT09T2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGUpfSksQXJyYXkucHJvdG90eXBlLmluZGV4T2Z8fChBcnJheS5wcm90b3R5cGUuaW5kZXhPZj1mdW5jdGlvbihlKXtpZihudWxsPT09dGhpcyl0aHJvdyBuZXcgVHlwZUVycm9yO3ZhciB0PU9iamVjdCh0aGlzKSxyPXQubGVuZ3RoPj4+MDtpZigwPT09cilyZXR1cm4tMTt2YXIgbj0wO2lmKGFyZ3VtZW50cy5sZW5ndGg+MSYmKG49TnVtYmVyKGFyZ3VtZW50c1sxXSksbiE9PW4/bj0wOjAhPT1uJiZuIT09MS8wJiZuIT09LSgxLzApJiYobj0obj4wfHwtMSkqTWF0aC5mbG9vcihNYXRoLmFicyhuKSkpKSxuPj1yKXJldHVybi0xO2Zvcih2YXIgbz1uPj0wP246TWF0aC5tYXgoci1NYXRoLmFicyhuKSwwKTtvPHI7bysrKWlmKG8gaW4gdCYmdFtvXT09PWUpcmV0dXJuIG87cmV0dXJuLTF9KSxPYmplY3QuaXNGcm96ZW58fChPYmplY3QuaXNGcm96ZW49ZnVuY3Rpb24oZSl7Zm9yKHZhciB0PSJ0djRfdGVzdF9mcm96ZW5fa2V5IjtlLmhhc093blByb3BlcnR5KHQpOyl0Kz1NYXRoLnJhbmRvbSgpO3RyeXtyZXR1cm4gZVt0XT0hMCxkZWxldGUgZVt0XSwhMX1jYXRjaChyKXtyZXR1cm4hMH19KTt2YXIgcD17IisiOiEwLCIjIjohMCwiLiI6ITAsIi8iOiEwLCI7IjohMCwiPyI6ITAsIiYiOiEwfSxkPXsiKiI6ITB9O3IucHJvdG90eXBlPXt0b1N0cmluZzpmdW5jdGlvbigpe3JldHVybiB0aGlzLnRlbXBsYXRlfSxmaWxsRnJvbU9iamVjdDpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5maWxsKGZ1bmN0aW9uKHQpe3JldHVybiBlW3RdfSl9fTt2YXIgaD1mdW5jdGlvbihlLHQscixuLG8pe2lmKHRoaXMubWlzc2luZz1bXSx0aGlzLm1pc3NpbmdNYXA9e30sdGhpcy5mb3JtYXRWYWxpZGF0b3JzPWU/T2JqZWN0LmNyZWF0ZShlLmZvcm1hdFZhbGlkYXRvcnMpOnt9LHRoaXMuc2NoZW1hcz1lP09iamVjdC5jcmVhdGUoZS5zY2hlbWFzKTp7fSx0aGlzLmNvbGxlY3RNdWx0aXBsZT10LHRoaXMuZXJyb3JzPVtdLHRoaXMuaGFuZGxlRXJyb3I9dD90aGlzLmNvbGxlY3RFcnJvcjp0aGlzLnJldHVybkVycm9yLG4mJih0aGlzLmNoZWNrUmVjdXJzaXZlPSEwLHRoaXMuc2Nhbm5lZD1bXSx0aGlzLnNjYW5uZWRGcm96ZW49W10sdGhpcy5zY2FubmVkRnJvemVuU2NoZW1hcz1bXSx0aGlzLnNjYW5uZWRGcm96ZW5WYWxpZGF0aW9uRXJyb3JzPVtdLHRoaXMudmFsaWRhdGVkU2NoZW1hc0tleT0idHY0X3ZhbGlkYXRpb25faWQiLHRoaXMudmFsaWRhdGlvbkVycm9yc0tleT0idHY0X3ZhbGlkYXRpb25fZXJyb3JzX2lkIiksbyYmKHRoaXMudHJhY2tVbmtub3duUHJvcGVydGllcz0hMCx0aGlzLmtub3duUHJvcGVydHlQYXRocz17fSx0aGlzLnVua25vd25Qcm9wZXJ0eVBhdGhzPXt9KSx0aGlzLmVycm9yUmVwb3J0ZXI9cnx8dSgiZW4iKSwic3RyaW5nIj09dHlwZW9mIHRoaXMuZXJyb3JSZXBvcnRlcil0aHJvdyBuZXcgRXJyb3IoImRlYnVnIik7aWYodGhpcy5kZWZpbmVkS2V5d29yZHM9e30sZSlmb3IodmFyIGkgaW4gZS5kZWZpbmVkS2V5d29yZHMpdGhpcy5kZWZpbmVkS2V5d29yZHNbaV09ZS5kZWZpbmVkS2V5d29yZHNbaV0uc2xpY2UoMCl9O2gucHJvdG90eXBlLmRlZmluZUtleXdvcmQ9ZnVuY3Rpb24oZSx0KXt0aGlzLmRlZmluZWRLZXl3b3Jkc1tlXT10aGlzLmRlZmluZWRLZXl3b3Jkc1tlXXx8W10sdGhpcy5kZWZpbmVkS2V5d29yZHNbZV0ucHVzaCh0KX0saC5wcm90b3R5cGUuY3JlYXRlRXJyb3I9ZnVuY3Rpb24oZSx0LHIsbixvLGksYSl7dmFyIHM9bmV3IGwoZSx0LHIsbixvKTtyZXR1cm4gcy5tZXNzYWdlPXRoaXMuZXJyb3JSZXBvcnRlcihzLGksYSksc30saC5wcm90b3R5cGUucmV0dXJuRXJyb3I9ZnVuY3Rpb24oZSl7cmV0dXJuIGV9LGgucHJvdG90eXBlLmNvbGxlY3RFcnJvcj1mdW5jdGlvbihlKXtyZXR1cm4gZSYmdGhpcy5lcnJvcnMucHVzaChlKSxudWxsfSxoLnByb3RvdHlwZS5wcmVmaXhFcnJvcnM9ZnVuY3Rpb24oZSx0LHIpe2Zvcih2YXIgbj1lO248dGhpcy5lcnJvcnMubGVuZ3RoO24rKyl0aGlzLmVycm9yc1tuXT10aGlzLmVycm9yc1tuXS5wcmVmaXhXaXRoKHQscik7cmV0dXJuIHRoaXN9LGgucHJvdG90eXBlLmJhblVua25vd25Qcm9wZXJ0aWVzPWZ1bmN0aW9uKGUsdCl7Zm9yKHZhciByIGluIHRoaXMudW5rbm93blByb3BlcnR5UGF0aHMpe3ZhciBuPXRoaXMuY3JlYXRlRXJyb3Iodi5VTktOT1dOX1BST1BFUlRZLHtwYXRoOnJ9LHIsIiIsbnVsbCxlLHQpLG89dGhpcy5oYW5kbGVFcnJvcihuKTtpZihvKXJldHVybiBvfXJldHVybiBudWxsfSxoLnByb3RvdHlwZS5hZGRGb3JtYXQ9ZnVuY3Rpb24oZSx0KXtpZigib2JqZWN0Ij09dHlwZW9mIGUpe2Zvcih2YXIgciBpbiBlKXRoaXMuYWRkRm9ybWF0KHIsZVtyXSk7cmV0dXJuIHRoaXN9dGhpcy5mb3JtYXRWYWxpZGF0b3JzW2VdPXR9LGgucHJvdG90eXBlLnJlc29sdmVSZWZzPWZ1bmN0aW9uKGUsdCl7aWYodm9pZCAwIT09ZS4kcmVmKXtpZih0PXR8fHt9LHRbZS4kcmVmXSlyZXR1cm4gdGhpcy5jcmVhdGVFcnJvcih2LkNJUkNVTEFSX1JFRkVSRU5DRSx7dXJsczpPYmplY3Qua2V5cyh0KS5qb2luKCIsICIpfSwiIiwiIixudWxsLHZvaWQgMCxlKTt0W2UuJHJlZl09ITAsZT10aGlzLmdldFNjaGVtYShlLiRyZWYsdCl9cmV0dXJuIGV9LGgucHJvdG90eXBlLmdldFNjaGVtYT1mdW5jdGlvbihlLHQpe3ZhciByO2lmKHZvaWQgMCE9PXRoaXMuc2NoZW1hc1tlXSlyZXR1cm4gcj10aGlzLnNjaGVtYXNbZV0sdGhpcy5yZXNvbHZlUmVmcyhyLHQpO3ZhciBuPWUsbz0iIjtpZihlLmluZGV4T2YoIiMiKSE9PS0xJiYobz1lLnN1YnN0cmluZyhlLmluZGV4T2YoIiMiKSsxKSxuPWUuc3Vic3RyaW5nKDAsZS5pbmRleE9mKCIjIikpKSwib2JqZWN0Ij09dHlwZW9mIHRoaXMuc2NoZW1hc1tuXSl7cj10aGlzLnNjaGVtYXNbbl07dmFyIGk9ZGVjb2RlVVJJQ29tcG9uZW50KG8pO2lmKCIiPT09aSlyZXR1cm4gdGhpcy5yZXNvbHZlUmVmcyhyLHQpO2lmKCIvIiE9PWkuY2hhckF0KDApKXJldHVybjtmb3IodmFyIGE9aS5zcGxpdCgiLyIpLnNsaWNlKDEpLHM9MDtzPGEubGVuZ3RoO3MrKyl7dmFyIHU9YVtzXS5yZXBsYWNlKC9+MS9nLCIvIikucmVwbGFjZSgvfjAvZywifiIpO2lmKHZvaWQgMD09PXJbdV0pe3I9dm9pZCAwO2JyZWFrfXI9clt1XX1pZih2b2lkIDAhPT1yKXJldHVybiB0aGlzLnJlc29sdmVSZWZzKHIsdCl9dm9pZCAwPT09dGhpcy5taXNzaW5nW25dJiYodGhpcy5taXNzaW5nLnB1c2gobiksdGhpcy5taXNzaW5nW25dPW4sdGhpcy5taXNzaW5nTWFwW25dPW4pfSxoLnByb3RvdHlwZS5zZWFyY2hTY2hlbWFzPWZ1bmN0aW9uKGUsdCl7aWYoQXJyYXkuaXNBcnJheShlKSlmb3IodmFyIHI9MDtyPGUubGVuZ3RoO3IrKyl0aGlzLnNlYXJjaFNjaGVtYXMoZVtyXSx0KTtlbHNlIGlmKGUmJiJvYmplY3QiPT10eXBlb2YgZSl7InN0cmluZyI9PXR5cGVvZiBlLmlkJiZjKHQsZS5pZCkmJnZvaWQgMD09PXRoaXMuc2NoZW1hc1tlLmlkXSYmKHRoaXMuc2NoZW1hc1tlLmlkXT1lKTtmb3IodmFyIG4gaW4gZSlpZigiZW51bSIhPT1uKWlmKCJvYmplY3QiPT10eXBlb2YgZVtuXSl0aGlzLnNlYXJjaFNjaGVtYXMoZVtuXSx0KTtlbHNlIGlmKCIkcmVmIj09PW4pe3ZhciBvPWEoZVtuXSk7byYmdm9pZCAwPT09dGhpcy5zY2hlbWFzW29dJiZ2b2lkIDA9PT10aGlzLm1pc3NpbmdNYXBbb10mJih0aGlzLm1pc3NpbmdNYXBbb109byl9fX0saC5wcm90b3R5cGUuYWRkU2NoZW1hPWZ1bmN0aW9uKGUsdCl7aWYoInN0cmluZyIhPXR5cGVvZiBlfHwidW5kZWZpbmVkIj09dHlwZW9mIHQpe2lmKCJvYmplY3QiIT10eXBlb2YgZXx8InN0cmluZyIhPXR5cGVvZiBlLmlkKXJldHVybjt0PWUsZT10LmlkfWU9PT1hKGUpKyIjIiYmKGU9YShlKSksdGhpcy5zY2hlbWFzW2VdPXQsZGVsZXRlIHRoaXMubWlzc2luZ01hcFtlXSxzKHQsZSksdGhpcy5zZWFyY2hTY2hlbWFzKHQsZSl9LGgucHJvdG90eXBlLmdldFNjaGVtYU1hcD1mdW5jdGlvbigpe3ZhciBlPXt9O2Zvcih2YXIgdCBpbiB0aGlzLnNjaGVtYXMpZVt0XT10aGlzLnNjaGVtYXNbdF07cmV0dXJuIGV9LGgucHJvdG90eXBlLmdldFNjaGVtYVVyaXM9ZnVuY3Rpb24oZSl7dmFyIHQ9W107Zm9yKHZhciByIGluIHRoaXMuc2NoZW1hcyllJiYhZS50ZXN0KHIpfHx0LnB1c2gocik7cmV0dXJuIHR9LGgucHJvdG90eXBlLmdldE1pc3NpbmdVcmlzPWZ1bmN0aW9uKGUpe3ZhciB0PVtdO2Zvcih2YXIgciBpbiB0aGlzLm1pc3NpbmdNYXApZSYmIWUudGVzdChyKXx8dC5wdXNoKHIpO3JldHVybiB0fSxoLnByb3RvdHlwZS5kcm9wU2NoZW1hcz1mdW5jdGlvbigpe3RoaXMuc2NoZW1hcz17fSx0aGlzLnJlc2V0KCl9LGgucHJvdG90eXBlLnJlc2V0PWZ1bmN0aW9uKCl7dGhpcy5taXNzaW5nPVtdLHRoaXMubWlzc2luZ01hcD17fSx0aGlzLmVycm9ycz1bXX0saC5wcm90b3R5cGUudmFsaWRhdGVBbGw9ZnVuY3Rpb24oZSx0LHIsbixvKXt2YXIgaTtpZih0PXRoaXMucmVzb2x2ZVJlZnModCksIXQpcmV0dXJuIG51bGw7aWYodCBpbnN0YW5jZW9mIGwpcmV0dXJuIHRoaXMuZXJyb3JzLnB1c2godCksdDt2YXIgYSxzPXRoaXMuZXJyb3JzLmxlbmd0aCx1PW51bGwsYz1udWxsO2lmKHRoaXMuY2hlY2tSZWN1cnNpdmUmJmUmJiJvYmplY3QiPT10eXBlb2YgZSl7aWYoaT0hdGhpcy5zY2FubmVkLmxlbmd0aCxlW3RoaXMudmFsaWRhdGVkU2NoZW1hc0tleV0pe3ZhciBmPWVbdGhpcy52YWxpZGF0ZWRTY2hlbWFzS2V5XS5pbmRleE9mKHQpO2lmKGYhPT0tMSlyZXR1cm4gdGhpcy5lcnJvcnM9dGhpcy5lcnJvcnMuY29uY2F0KGVbdGhpcy52YWxpZGF0aW9uRXJyb3JzS2V5XVtmXSksbnVsbH1pZihPYmplY3QuaXNGcm96ZW4oZSkmJihhPXRoaXMuc2Nhbm5lZEZyb3plbi5pbmRleE9mKGUpLGEhPT0tMSkpe3ZhciBwPXRoaXMuc2Nhbm5lZEZyb3plblNjaGVtYXNbYV0uaW5kZXhPZih0KTtpZihwIT09LTEpcmV0dXJuIHRoaXMuZXJyb3JzPXRoaXMuZXJyb3JzLmNvbmNhdCh0aGlzLnNjYW5uZWRGcm96ZW5WYWxpZGF0aW9uRXJyb3JzW2FdW3BdKSxudWxsfWlmKHRoaXMuc2Nhbm5lZC5wdXNoKGUpLE9iamVjdC5pc0Zyb3plbihlKSlhPT09LTEmJihhPXRoaXMuc2Nhbm5lZEZyb3plbi5sZW5ndGgsdGhpcy5zY2FubmVkRnJvemVuLnB1c2goZSksdGhpcy5zY2FubmVkRnJvemVuU2NoZW1hcy5wdXNoKFtdKSksdT10aGlzLnNjYW5uZWRGcm96ZW5TY2hlbWFzW2FdLmxlbmd0aCx0aGlzLnNjYW5uZWRGcm96ZW5TY2hlbWFzW2FdW3VdPXQsdGhpcy5zY2FubmVkRnJvemVuVmFsaWRhdGlvbkVycm9yc1thXVt1XT1bXTtlbHNle2lmKCFlW3RoaXMudmFsaWRhdGVkU2NoZW1hc0tleV0pdHJ5e09iamVjdC5kZWZpbmVQcm9wZXJ0eShlLHRoaXMudmFsaWRhdGVkU2NoZW1hc0tleSx7dmFsdWU6W10sY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGUsdGhpcy52YWxpZGF0aW9uRXJyb3JzS2V5LHt2YWx1ZTpbXSxjb25maWd1cmFibGU6ITB9KX1jYXRjaChkKXtlW3RoaXMudmFsaWRhdGVkU2NoZW1hc0tleV09W10sZVt0aGlzLnZhbGlkYXRpb25FcnJvcnNLZXldPVtdfWM9ZVt0aGlzLnZhbGlkYXRlZFNjaGVtYXNLZXldLmxlbmd0aCxlW3RoaXMudmFsaWRhdGVkU2NoZW1hc0tleV1bY109dCxlW3RoaXMudmFsaWRhdGlvbkVycm9yc0tleV1bY109W119fXZhciBoPXRoaXMuZXJyb3JzLmxlbmd0aCx5PXRoaXMudmFsaWRhdGVCYXNpYyhlLHQsbyl8fHRoaXMudmFsaWRhdGVOdW1lcmljKGUsdCxvKXx8dGhpcy52YWxpZGF0ZVN0cmluZyhlLHQsbyl8fHRoaXMudmFsaWRhdGVBcnJheShlLHQsbyl8fHRoaXMudmFsaWRhdGVPYmplY3QoZSx0LG8pfHx0aGlzLnZhbGlkYXRlQ29tYmluYXRpb25zKGUsdCxvKXx8dGhpcy52YWxpZGF0ZUh5cGVybWVkaWEoZSx0LG8pfHx0aGlzLnZhbGlkYXRlRm9ybWF0KGUsdCxvKXx8dGhpcy52YWxpZGF0ZURlZmluZWRLZXl3b3JkcyhlLHQsbyl8fG51bGw7aWYoaSl7Zm9yKDt0aGlzLnNjYW5uZWQubGVuZ3RoOyl7dmFyIG09dGhpcy5zY2FubmVkLnBvcCgpO2RlbGV0ZSBtW3RoaXMudmFsaWRhdGVkU2NoZW1hc0tleV19dGhpcy5zY2FubmVkRnJvemVuPVtdLHRoaXMuc2Nhbm5lZEZyb3plblNjaGVtYXM9W119aWYoeXx8aCE9PXRoaXMuZXJyb3JzLmxlbmd0aClmb3IoO3ImJnIubGVuZ3RofHxuJiZuLmxlbmd0aDspe3ZhciB2PXImJnIubGVuZ3RoPyIiK3IucG9wKCk6bnVsbCxfPW4mJm4ubGVuZ3RoPyIiK24ucG9wKCk6bnVsbDt5JiYoeT15LnByZWZpeFdpdGgodixfKSksdGhpcy5wcmVmaXhFcnJvcnMoaCx2LF8pfXJldHVybiBudWxsIT09dT90aGlzLnNjYW5uZWRGcm96ZW5WYWxpZGF0aW9uRXJyb3JzW2FdW3VdPXRoaXMuZXJyb3JzLnNsaWNlKHMpOm51bGwhPT1jJiYoZVt0aGlzLnZhbGlkYXRpb25FcnJvcnNLZXldW2NdPXRoaXMuZXJyb3JzLnNsaWNlKHMpKSx0aGlzLmhhbmRsZUVycm9yKHkpfSxoLnByb3RvdHlwZS52YWxpZGF0ZUZvcm1hdD1mdW5jdGlvbihlLHQpe2lmKCJzdHJpbmciIT10eXBlb2YgdC5mb3JtYXR8fCF0aGlzLmZvcm1hdFZhbGlkYXRvcnNbdC5mb3JtYXRdKXJldHVybiBudWxsO3ZhciByPXRoaXMuZm9ybWF0VmFsaWRhdG9yc1t0LmZvcm1hdF0uY2FsbChudWxsLGUsdCk7cmV0dXJuInN0cmluZyI9PXR5cGVvZiByfHwibnVtYmVyIj09dHlwZW9mIHI/dGhpcy5jcmVhdGVFcnJvcih2LkZPUk1BVF9DVVNUT00se21lc3NhZ2U6cn0sIiIsIi9mb3JtYXQiLG51bGwsZSx0KTpyJiYib2JqZWN0Ij09dHlwZW9mIHI/dGhpcy5jcmVhdGVFcnJvcih2LkZPUk1BVF9DVVNUT00se21lc3NhZ2U6ci5tZXNzYWdlfHwiPyJ9LHIuZGF0YVBhdGh8fCIiLHIuc2NoZW1hUGF0aHx8Ii9mb3JtYXQiLG51bGwsZSx0KTpudWxsfSxoLnByb3RvdHlwZS52YWxpZGF0ZURlZmluZWRLZXl3b3Jkcz1mdW5jdGlvbihlLHQscil7Zm9yKHZhciBuIGluIHRoaXMuZGVmaW5lZEtleXdvcmRzKWlmKCJ1bmRlZmluZWQiIT10eXBlb2YgdFtuXSlmb3IodmFyIG89dGhpcy5kZWZpbmVkS2V5d29yZHNbbl0saT0wO2k8by5sZW5ndGg7aSsrKXt2YXIgYT1vW2ldLHM9YShlLHRbbl0sdCxyKTtpZigic3RyaW5nIj09dHlwZW9mIHN8fCJudW1iZXIiPT10eXBlb2YgcylyZXR1cm4gdGhpcy5jcmVhdGVFcnJvcih2LktFWVdPUkRfQ1VTVE9NLHtrZXk6bixtZXNzYWdlOnN9LCIiLCIiLG51bGwsZSx0KS5wcmVmaXhXaXRoKG51bGwsbik7aWYocyYmIm9iamVjdCI9PXR5cGVvZiBzKXt2YXIgdT1zLmNvZGU7aWYoInN0cmluZyI9PXR5cGVvZiB1KXtpZighdlt1XSl0aHJvdyBuZXcgRXJyb3IoIlVuZGVmaW5lZCBlcnJvciBjb2RlICh1c2UgZGVmaW5lRXJyb3IpOiAiK3UpO3U9dlt1XX1lbHNlIm51bWJlciIhPXR5cGVvZiB1JiYodT12LktFWVdPUkRfQ1VTVE9NKTt2YXIgbD0ib2JqZWN0Ij09dHlwZW9mIHMubWVzc2FnZT9zLm1lc3NhZ2U6e2tleTpuLG1lc3NhZ2U6cy5tZXNzYWdlfHwiPyJ9LGM9cy5zY2hlbWFQYXRofHwiLyIrbi5yZXBsYWNlKC9+L2csIn4wIikucmVwbGFjZSgvXC8vZywifjEiKTtyZXR1cm4gdGhpcy5jcmVhdGVFcnJvcih1LGwscy5kYXRhUGF0aHx8bnVsbCxjLG51bGwsZSx0KX19cmV0dXJuIG51bGx9LGgucHJvdG90eXBlLnZhbGlkYXRlQmFzaWM9ZnVuY3Rpb24oZSx0LHIpe3ZhciBuO3JldHVybihuPXRoaXMudmFsaWRhdGVUeXBlKGUsdCxyKSk/bi5wcmVmaXhXaXRoKG51bGwsInR5cGUiKToobj10aGlzLnZhbGlkYXRlRW51bShlLHQscikpP24ucHJlZml4V2l0aChudWxsLCJ0eXBlIik6bnVsbH0saC5wcm90b3R5cGUudmFsaWRhdGVUeXBlPWZ1bmN0aW9uKGUsdCl7aWYodm9pZCAwPT09dC50eXBlKXJldHVybiBudWxsO3ZhciByPXR5cGVvZiBlO251bGw9PT1lP3I9Im51bGwiOkFycmF5LmlzQXJyYXkoZSkmJihyPSJhcnJheSIpO3ZhciBuPXQudHlwZTtBcnJheS5pc0FycmF5KG4pfHwobj1bbl0pO2Zvcih2YXIgbz0wO288bi5sZW5ndGg7bysrKXt2YXIgaT1uW29dO2lmKGk9PT1yfHwiaW50ZWdlciI9PT1pJiYibnVtYmVyIj09PXImJmUlMT09PTApcmV0dXJuIG51bGx9cmV0dXJuIHRoaXMuY3JlYXRlRXJyb3Iodi5JTlZBTElEX1RZUEUse3R5cGU6cixleHBlY3RlZDpuLmpvaW4oIi8iKX0sIiIsIiIsbnVsbCxlLHQpfSxoLnByb3RvdHlwZS52YWxpZGF0ZUVudW09ZnVuY3Rpb24oZSx0KXtpZih2b2lkIDA9PT10WyJlbnVtIl0pcmV0dXJuIG51bGw7Zm9yKHZhciByPTA7cjx0WyJlbnVtIl0ubGVuZ3RoO3IrKyl7dmFyIG89dFsiZW51bSJdW3JdO2lmKG4oZSxvKSlyZXR1cm4gbnVsbH1yZXR1cm4gdGhpcy5jcmVhdGVFcnJvcih2LkVOVU1fTUlTTUFUQ0gse3ZhbHVlOiJ1bmRlZmluZWQiIT10eXBlb2YgSlNPTj9KU09OLnN0cmluZ2lmeShlKTplfSwiIiwiIixudWxsLGUsdCl9LGgucHJvdG90eXBlLnZhbGlkYXRlTnVtZXJpYz1mdW5jdGlvbihlLHQscil7cmV0dXJuIHRoaXMudmFsaWRhdGVNdWx0aXBsZU9mKGUsdCxyKXx8dGhpcy52YWxpZGF0ZU1pbk1heChlLHQscil8fHRoaXMudmFsaWRhdGVOYU4oZSx0LHIpfHxudWxsfTt2YXIgeT1NYXRoLnBvdygyLC01MSksbT0xLXk7aC5wcm90b3R5cGUudmFsaWRhdGVNdWx0aXBsZU9mPWZ1bmN0aW9uKGUsdCl7dmFyIHI9dC5tdWx0aXBsZU9mfHx0LmRpdmlzaWJsZUJ5O2lmKHZvaWQgMD09PXIpcmV0dXJuIG51bGw7aWYoIm51bWJlciI9PXR5cGVvZiBlKXt2YXIgbj1lL3IlMTtpZihuPj15JiZuPG0pcmV0dXJuIHRoaXMuY3JlYXRlRXJyb3Iodi5OVU1CRVJfTVVMVElQTEVfT0Yse3ZhbHVlOmUsbXVsdGlwbGVPZjpyfSwiIiwiIixudWxsLGUsdCl9cmV0dXJuIG51bGx9LGgucHJvdG90eXBlLnZhbGlkYXRlTWluTWF4PWZ1bmN0aW9uKGUsdCl7aWYoIm51bWJlciIhPXR5cGVvZiBlKXJldHVybiBudWxsO2lmKHZvaWQgMCE9PXQubWluaW11bSl7aWYoZTx0Lm1pbmltdW0pcmV0dXJuIHRoaXMuY3JlYXRlRXJyb3Iodi5OVU1CRVJfTUlOSU1VTSx7dmFsdWU6ZSxtaW5pbXVtOnQubWluaW11bX0sIiIsIi9taW5pbXVtIixudWxsLGUsdCk7aWYodC5leGNsdXNpdmVNaW5pbXVtJiZlPT09dC5taW5pbXVtKXJldHVybiB0aGlzLmNyZWF0ZUVycm9yKHYuTlVNQkVSX01JTklNVU1fRVhDTFVTSVZFLHt2YWx1ZTplLG1pbmltdW06dC5taW5pbXVtfSwiIiwiL2V4Y2x1c2l2ZU1pbmltdW0iLG51bGwsZSx0KX1pZih2b2lkIDAhPT10Lm1heGltdW0pe2lmKGU+dC5tYXhpbXVtKXJldHVybiB0aGlzLmNyZWF0ZUVycm9yKHYuTlVNQkVSX01BWElNVU0se3ZhbHVlOmUsbWF4aW11bTp0Lm1heGltdW19LCIiLCIvbWF4aW11bSIsbnVsbCxlLHQpO2lmKHQuZXhjbHVzaXZlTWF4aW11bSYmZT09PXQubWF4aW11bSlyZXR1cm4gdGhpcy5jcmVhdGVFcnJvcih2Lk5VTUJFUl9NQVhJTVVNX0VYQ0xVU0lWRSx7dmFsdWU6ZSxtYXhpbXVtOnQubWF4aW11bX0sIiIsIi9leGNsdXNpdmVNYXhpbXVtIixudWxsLGUsdCl9cmV0dXJuIG51bGx9LGgucHJvdG90eXBlLnZhbGlkYXRlTmFOPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIm51bWJlciIhPXR5cGVvZiBlP251bGw6aXNOYU4oZSk9PT0hMHx8ZT09PTEvMHx8ZT09PS0oMS8wKT90aGlzLmNyZWF0ZUVycm9yKHYuTlVNQkVSX05PVF9BX05VTUJFUix7dmFsdWU6ZX0sIiIsIi90eXBlIixudWxsLGUsdCk6bnVsbH0saC5wcm90b3R5cGUudmFsaWRhdGVTdHJpbmc9ZnVuY3Rpb24oZSx0LHIpe3JldHVybiB0aGlzLnZhbGlkYXRlU3RyaW5nTGVuZ3RoKGUsdCxyKXx8dGhpcy52YWxpZGF0ZVN0cmluZ1BhdHRlcm4oZSx0LHIpfHxudWxsfSxoLnByb3RvdHlwZS52YWxpZGF0ZVN0cmluZ0xlbmd0aD1mdW5jdGlvbihlLHQpe3JldHVybiJzdHJpbmciIT10eXBlb2YgZT9udWxsOnZvaWQgMCE9PXQubWluTGVuZ3RoJiZlLmxlbmd0aDx0Lm1pbkxlbmd0aD90aGlzLmNyZWF0ZUVycm9yKHYuU1RSSU5HX0xFTkdUSF9TSE9SVCx7bGVuZ3RoOmUubGVuZ3RoLG1pbmltdW06dC5taW5MZW5ndGh9LCIiLCIvbWluTGVuZ3RoIixudWxsLGUsdCk6dm9pZCAwIT09dC5tYXhMZW5ndGgmJmUubGVuZ3RoPnQubWF4TGVuZ3RoP3RoaXMuY3JlYXRlRXJyb3Iodi5TVFJJTkdfTEVOR1RIX0xPTkcse2xlbmd0aDplLmxlbmd0aCxtYXhpbXVtOnQubWF4TGVuZ3RofSwiIiwiL21heExlbmd0aCIsbnVsbCxlLHQpOm51bGx9LGgucHJvdG90eXBlLnZhbGlkYXRlU3RyaW5nUGF0dGVybj1mdW5jdGlvbihlLHQpe2lmKCJzdHJpbmciIT10eXBlb2YgZXx8InN0cmluZyIhPXR5cGVvZiB0LnBhdHRlcm4mJiEodC5wYXR0ZXJuIGluc3RhbmNlb2YgUmVnRXhwKSlyZXR1cm4gbnVsbDt2YXIgcjtpZih0LnBhdHRlcm4gaW5zdGFuY2VvZiBSZWdFeHApcj10LnBhdHRlcm47ZWxzZXt2YXIgbixvPSIiLGk9dC5wYXR0ZXJuLm1hdGNoKC9eXC8oLispXC8oW2ltZ10qKSQvKTtpPyhuPWlbMV0sbz1pWzJdKTpuPXQucGF0dGVybixyPW5ldyBSZWdFeHAobixvKX1yZXR1cm4gci50ZXN0KGUpP251bGw6dGhpcy5jcmVhdGVFcnJvcih2LlNUUklOR19QQVRURVJOLHtwYXR0ZXJuOnQucGF0dGVybn0sIiIsIi9wYXR0ZXJuIixudWxsLGUsdCl9LGgucHJvdG90eXBlLnZhbGlkYXRlQXJyYXk9ZnVuY3Rpb24oZSx0LHIpe3JldHVybiBBcnJheS5pc0FycmF5KGUpP3RoaXMudmFsaWRhdGVBcnJheUxlbmd0aChlLHQscil8fHRoaXMudmFsaWRhdGVBcnJheVVuaXF1ZUl0ZW1zKGUsdCxyKXx8dGhpcy52YWxpZGF0ZUFycmF5SXRlbXMoZSx0LHIpfHxudWxsOm51bGx9LGgucHJvdG90eXBlLnZhbGlkYXRlQXJyYXlMZW5ndGg9ZnVuY3Rpb24oZSx0KXt2YXIgcjtyZXR1cm4gdm9pZCAwIT09dC5taW5JdGVtcyYmZS5sZW5ndGg8dC5taW5JdGVtcyYmKHI9dGhpcy5jcmVhdGVFcnJvcih2LkFSUkFZX0xFTkdUSF9TSE9SVCx7bGVuZ3RoOmUubGVuZ3RoLG1pbmltdW06dC5taW5JdGVtc30sIiIsIi9taW5JdGVtcyIsbnVsbCxlLHQpLHRoaXMuaGFuZGxlRXJyb3IocikpP3I6dm9pZCAwIT09dC5tYXhJdGVtcyYmZS5sZW5ndGg+dC5tYXhJdGVtcyYmKHI9dGhpcy5jcmVhdGVFcnJvcih2LkFSUkFZX0xFTkdUSF9MT05HLHtsZW5ndGg6ZS5sZW5ndGgsbWF4aW11bTp0Lm1heEl0ZW1zfSwiIiwiL21heEl0ZW1zIixudWxsLGUsdCksdGhpcy5oYW5kbGVFcnJvcihyKSk/cjpudWxsfSxoLnByb3RvdHlwZS52YWxpZGF0ZUFycmF5VW5pcXVlSXRlbXM9ZnVuY3Rpb24oZSx0KXtpZih0LnVuaXF1ZUl0ZW1zKWZvcih2YXIgcj0wO3I8ZS5sZW5ndGg7cisrKWZvcih2YXIgbz1yKzE7bzxlLmxlbmd0aDtvKyspaWYobihlW3JdLGVbb10pKXt2YXIgaT10aGlzLmNyZWF0ZUVycm9yKHYuQVJSQVlfVU5JUVVFLHttYXRjaDE6cixtYXRjaDI6b30sIiIsIi91bmlxdWVJdGVtcyIsbnVsbCxlLHQpO2lmKHRoaXMuaGFuZGxlRXJyb3IoaSkpcmV0dXJuIGl9cmV0dXJuIG51bGx9LGgucHJvdG90eXBlLnZhbGlkYXRlQXJyYXlJdGVtcz1mdW5jdGlvbihlLHQscil7aWYodm9pZCAwPT09dC5pdGVtcylyZXR1cm4gbnVsbDt2YXIgbixvO2lmKEFycmF5LmlzQXJyYXkodC5pdGVtcykpe2ZvcihvPTA7bzxlLmxlbmd0aDtvKyspaWYobzx0Lml0ZW1zLmxlbmd0aCl7aWYobj10aGlzLnZhbGlkYXRlQWxsKGVbb10sdC5pdGVtc1tvXSxbb10sWyJpdGVtcyIsb10scisiLyIrbykpcmV0dXJuIG59ZWxzZSBpZih2b2lkIDAhPT10LmFkZGl0aW9uYWxJdGVtcylpZigiYm9vbGVhbiI9PXR5cGVvZiB0LmFkZGl0aW9uYWxJdGVtcyl7aWYoIXQuYWRkaXRpb25hbEl0ZW1zJiYobj10aGlzLmNyZWF0ZUVycm9yKHYuQVJSQVlfQURESVRJT05BTF9JVEVNUyx7fSwiLyIrbywiL2FkZGl0aW9uYWxJdGVtcyIsbnVsbCxlLHQpLHRoaXMuaGFuZGxlRXJyb3IobikpKXJldHVybiBufWVsc2UgaWYobj10aGlzLnZhbGlkYXRlQWxsKGVbb10sdC5hZGRpdGlvbmFsSXRlbXMsW29dLFsiYWRkaXRpb25hbEl0ZW1zIl0scisiLyIrbykpcmV0dXJuIG59ZWxzZSBmb3Iobz0wO288ZS5sZW5ndGg7bysrKWlmKG49dGhpcy52YWxpZGF0ZUFsbChlW29dLHQuaXRlbXMsW29dLFsiaXRlbXMiXSxyKyIvIitvKSlyZXR1cm4gbjtyZXR1cm4gbnVsbH0saC5wcm90b3R5cGUudmFsaWRhdGVPYmplY3Q9ZnVuY3Rpb24oZSx0LHIpe3JldHVybiJvYmplY3QiIT10eXBlb2YgZXx8bnVsbD09PWV8fEFycmF5LmlzQXJyYXkoZSk/bnVsbDp0aGlzLnZhbGlkYXRlT2JqZWN0TWluTWF4UHJvcGVydGllcyhlLHQscil8fHRoaXMudmFsaWRhdGVPYmplY3RSZXF1aXJlZFByb3BlcnRpZXMoZSx0LHIpfHx0aGlzLnZhbGlkYXRlT2JqZWN0UHJvcGVydGllcyhlLHQscil8fHRoaXMudmFsaWRhdGVPYmplY3REZXBlbmRlbmNpZXMoZSx0LHIpfHxudWxsfSxoLnByb3RvdHlwZS52YWxpZGF0ZU9iamVjdE1pbk1heFByb3BlcnRpZXM9ZnVuY3Rpb24oZSx0KXt2YXIgcixuPU9iamVjdC5rZXlzKGUpO3JldHVybiB2b2lkIDAhPT10Lm1pblByb3BlcnRpZXMmJm4ubGVuZ3RoPHQubWluUHJvcGVydGllcyYmKHI9dGhpcy5jcmVhdGVFcnJvcih2Lk9CSkVDVF9QUk9QRVJUSUVTX01JTklNVU0se3Byb3BlcnR5Q291bnQ6bi5sZW5ndGgsbWluaW11bTp0Lm1pblByb3BlcnRpZXN9LCIiLCIvbWluUHJvcGVydGllcyIsbnVsbCxlLHQpLHRoaXMuaGFuZGxlRXJyb3IocikpP3I6dm9pZCAwIT09dC5tYXhQcm9wZXJ0aWVzJiZuLmxlbmd0aD50Lm1heFByb3BlcnRpZXMmJihyPXRoaXMuY3JlYXRlRXJyb3Iodi5PQkpFQ1RfUFJPUEVSVElFU19NQVhJTVVNLHtwcm9wZXJ0eUNvdW50Om4ubGVuZ3RoLG1heGltdW06dC5tYXhQcm9wZXJ0aWVzfSwiIiwiL21heFByb3BlcnRpZXMiLG51bGwsZSx0KSx0aGlzLmhhbmRsZUVycm9yKHIpKT9yOm51bGx9LGgucHJvdG90eXBlLnZhbGlkYXRlT2JqZWN0UmVxdWlyZWRQcm9wZXJ0aWVzPWZ1bmN0aW9uKGUsdCl7aWYodm9pZCAwIT09dC5yZXF1aXJlZClmb3IodmFyIHI9MDtyPHQucmVxdWlyZWQubGVuZ3RoO3IrKyl7dmFyIG49dC5yZXF1aXJlZFtyXTtpZih2b2lkIDA9PT1lW25dKXt2YXIgbz10aGlzLmNyZWF0ZUVycm9yKHYuT0JKRUNUX1JFUVVJUkVELHtrZXk6bn0sIiIsIi9yZXF1aXJlZC8iK3IsbnVsbCxlLHQpO2lmKHRoaXMuaGFuZGxlRXJyb3IobykpcmV0dXJuIG99fXJldHVybiBudWxsfSxoLnByb3RvdHlwZS52YWxpZGF0ZU9iamVjdFByb3BlcnRpZXM9ZnVuY3Rpb24oZSx0LHIpe3ZhciBuO2Zvcih2YXIgbyBpbiBlKXt2YXIgaT1yKyIvIitvLnJlcGxhY2UoL34vZywifjAiKS5yZXBsYWNlKC9cLy9nLCJ+MSIpLGE9ITE7aWYodm9pZCAwIT09dC5wcm9wZXJ0aWVzJiZ2b2lkIDAhPT10LnByb3BlcnRpZXNbb10mJihhPSEwLG49dGhpcy52YWxpZGF0ZUFsbChlW29dLHQucHJvcGVydGllc1tvXSxbb10sWyJwcm9wZXJ0aWVzIixvXSxpKSkpcmV0dXJuIG47aWYodm9pZCAwIT09dC5wYXR0ZXJuUHJvcGVydGllcylmb3IodmFyIHMgaW4gdC5wYXR0ZXJuUHJvcGVydGllcyl7dmFyIHU9bmV3IFJlZ0V4cChzKTtpZih1LnRlc3QobykmJihhPSEwLG49dGhpcy52YWxpZGF0ZUFsbChlW29dLHQucGF0dGVyblByb3BlcnRpZXNbc10sW29dLFsicGF0dGVyblByb3BlcnRpZXMiLHNdLGkpKSlyZXR1cm4gbn1pZihhKXRoaXMudHJhY2tVbmtub3duUHJvcGVydGllcyYmKHRoaXMua25vd25Qcm9wZXJ0eVBhdGhzW2ldPSEwLGRlbGV0ZSB0aGlzLnVua25vd25Qcm9wZXJ0eVBhdGhzW2ldKTtlbHNlIGlmKHZvaWQgMCE9PXQuYWRkaXRpb25hbFByb3BlcnRpZXMpe2lmKHRoaXMudHJhY2tVbmtub3duUHJvcGVydGllcyYmKHRoaXMua25vd25Qcm9wZXJ0eVBhdGhzW2ldPSEwLGRlbGV0ZSB0aGlzLnVua25vd25Qcm9wZXJ0eVBhdGhzW2ldKSwiYm9vbGVhbiI9PXR5cGVvZiB0LmFkZGl0aW9uYWxQcm9wZXJ0aWVzKXtpZighdC5hZGRpdGlvbmFsUHJvcGVydGllcyYmKG49dGhpcy5jcmVhdGVFcnJvcih2Lk9CSkVDVF9BRERJVElPTkFMX1BST1BFUlRJRVMse2tleTpvfSwiIiwiL2FkZGl0aW9uYWxQcm9wZXJ0aWVzIixudWxsLGUsdCkucHJlZml4V2l0aChvLG51bGwpLHRoaXMuaGFuZGxlRXJyb3IobikpKXJldHVybiBufWVsc2UgaWYobj10aGlzLnZhbGlkYXRlQWxsKGVbb10sdC5hZGRpdGlvbmFsUHJvcGVydGllcyxbb10sWyJhZGRpdGlvbmFsUHJvcGVydGllcyJdLGkpKXJldHVybiBufWVsc2UgdGhpcy50cmFja1Vua25vd25Qcm9wZXJ0aWVzJiYhdGhpcy5rbm93blByb3BlcnR5UGF0aHNbaV0mJih0aGlzLnVua25vd25Qcm9wZXJ0eVBhdGhzW2ldPSEwKX1yZXR1cm4gbnVsbH0saC5wcm90b3R5cGUudmFsaWRhdGVPYmplY3REZXBlbmRlbmNpZXM9ZnVuY3Rpb24oZSx0LHIpe3ZhciBuO2lmKHZvaWQgMCE9PXQuZGVwZW5kZW5jaWVzKWZvcih2YXIgbyBpbiB0LmRlcGVuZGVuY2llcylpZih2b2lkIDAhPT1lW29dKXt2YXIgaT10LmRlcGVuZGVuY2llc1tvXTtpZigic3RyaW5nIj09dHlwZW9mIGkpe2lmKHZvaWQgMD09PWVbaV0mJihuPXRoaXMuY3JlYXRlRXJyb3Iodi5PQkpFQ1RfREVQRU5ERU5DWV9LRVkse2tleTpvLG1pc3Npbmc6aX0sIiIsIiIsbnVsbCxlLHQpLnByZWZpeFdpdGgobnVsbCxvKS5wcmVmaXhXaXRoKG51bGwsImRlcGVuZGVuY2llcyIpLHRoaXMuaGFuZGxlRXJyb3IobikpKXJldHVybiBufWVsc2UgaWYoQXJyYXkuaXNBcnJheShpKSlmb3IodmFyIGE9MDthPGkubGVuZ3RoO2ErKyl7dmFyIHM9aVthXTtpZih2b2lkIDA9PT1lW3NdJiYobj10aGlzLmNyZWF0ZUVycm9yKHYuT0JKRUNUX0RFUEVOREVOQ1lfS0VZLHtrZXk6byxtaXNzaW5nOnN9LCIiLCIvIithLG51bGwsZSx0KS5wcmVmaXhXaXRoKG51bGwsbykucHJlZml4V2l0aChudWxsLCJkZXBlbmRlbmNpZXMiKSx0aGlzLmhhbmRsZUVycm9yKG4pKSlyZXR1cm4gbn1lbHNlIGlmKG49dGhpcy52YWxpZGF0ZUFsbChlLGksW10sWyJkZXBlbmRlbmNpZXMiLG9dLHIpKXJldHVybiBufXJldHVybiBudWxsfSxoLnByb3RvdHlwZS52YWxpZGF0ZUNvbWJpbmF0aW9ucz1mdW5jdGlvbihlLHQscil7cmV0dXJuIHRoaXMudmFsaWRhdGVBbGxPZihlLHQscil8fHRoaXMudmFsaWRhdGVBbnlPZihlLHQscil8fHRoaXMudmFsaWRhdGVPbmVPZihlLHQscil8fHRoaXMudmFsaWRhdGVOb3QoZSx0LHIpfHxudWxsfSxoLnByb3RvdHlwZS52YWxpZGF0ZUFsbE9mPWZ1bmN0aW9uKGUsdCxyKXtpZih2b2lkIDA9PT10LmFsbE9mKXJldHVybiBudWxsO2Zvcih2YXIgbixvPTA7bzx0LmFsbE9mLmxlbmd0aDtvKyspe3ZhciBpPXQuYWxsT2Zbb107aWYobj10aGlzLnZhbGlkYXRlQWxsKGUsaSxbXSxbImFsbE9mIixvXSxyKSlyZXR1cm4gbn1yZXR1cm4gbnVsbH0saC5wcm90b3R5cGUudmFsaWRhdGVBbnlPZj1mdW5jdGlvbihlLHQscil7aWYodm9pZCAwPT09dC5hbnlPZilyZXR1cm4gbnVsbDt2YXIgbixvLGk9W10sYT10aGlzLmVycm9ycy5sZW5ndGg7dGhpcy50cmFja1Vua25vd25Qcm9wZXJ0aWVzJiYobj10aGlzLnVua25vd25Qcm9wZXJ0eVBhdGhzLG89dGhpcy5rbm93blByb3BlcnR5UGF0aHMpO2Zvcih2YXIgcz0hMCx1PTA7dTx0LmFueU9mLmxlbmd0aDt1Kyspe3RoaXMudHJhY2tVbmtub3duUHJvcGVydGllcyYmKHRoaXMudW5rbm93blByb3BlcnR5UGF0aHM9e30sdGhpcy5rbm93blByb3BlcnR5UGF0aHM9e30pO3ZhciBsPXQuYW55T2ZbdV0sYz10aGlzLmVycm9ycy5sZW5ndGgsZj10aGlzLnZhbGlkYXRlQWxsKGUsbCxbXSxbImFueU9mIix1XSxyKTtpZihudWxsPT09ZiYmYz09PXRoaXMuZXJyb3JzLmxlbmd0aCl7aWYodGhpcy5lcnJvcnM9dGhpcy5lcnJvcnMuc2xpY2UoMCxhKSx0aGlzLnRyYWNrVW5rbm93blByb3BlcnRpZXMpe2Zvcih2YXIgcCBpbiB0aGlzLmtub3duUHJvcGVydHlQYXRocylvW3BdPSEwLGRlbGV0ZSBuW3BdO2Zvcih2YXIgZCBpbiB0aGlzLnVua25vd25Qcm9wZXJ0eVBhdGhzKW9bZF18fChuW2RdPSEwKTtzPSExO2NvbnRpbnVlfXJldHVybiBudWxsfWYmJmkucHVzaChmLnByZWZpeFdpdGgobnVsbCwiIit1KS5wcmVmaXhXaXRoKG51bGwsImFueU9mIikpfXJldHVybiB0aGlzLnRyYWNrVW5rbm93blByb3BlcnRpZXMmJih0aGlzLnVua25vd25Qcm9wZXJ0eVBhdGhzPW4sdGhpcy5rbm93blByb3BlcnR5UGF0aHM9bykscz8oaT1pLmNvbmNhdCh0aGlzLmVycm9ycy5zbGljZShhKSksdGhpcy5lcnJvcnM9dGhpcy5lcnJvcnMuc2xpY2UoMCxhKSx0aGlzLmNyZWF0ZUVycm9yKHYuQU5ZX09GX01JU1NJTkcse30sIiIsIi9hbnlPZiIsaSxlLHQpKTp2b2lkIDB9LGgucHJvdG90eXBlLnZhbGlkYXRlT25lT2Y9ZnVuY3Rpb24oZSx0LHIpe2lmKHZvaWQgMD09PXQub25lT2YpcmV0dXJuIG51bGw7dmFyIG4sbyxpPW51bGwsYT1bXSxzPXRoaXMuZXJyb3JzLmxlbmd0aDt0aGlzLnRyYWNrVW5rbm93blByb3BlcnRpZXMmJihuPXRoaXMudW5rbm93blByb3BlcnR5UGF0aHMsbz10aGlzLmtub3duUHJvcGVydHlQYXRocyk7Zm9yKHZhciB1PTA7dTx0Lm9uZU9mLmxlbmd0aDt1Kyspe3RoaXMudHJhY2tVbmtub3duUHJvcGVydGllcyYmKHRoaXMudW5rbm93blByb3BlcnR5UGF0aHM9e30sdGhpcy5rbm93blByb3BlcnR5UGF0aHM9e30pO3ZhciBsPXQub25lT2ZbdV0sYz10aGlzLmVycm9ycy5sZW5ndGgsZj10aGlzLnZhbGlkYXRlQWxsKGUsbCxbXSxbIm9uZU9mIix1XSxyKTtpZihudWxsPT09ZiYmYz09PXRoaXMuZXJyb3JzLmxlbmd0aCl7aWYobnVsbCE9PWkpcmV0dXJuIHRoaXMuZXJyb3JzPXRoaXMuZXJyb3JzLnNsaWNlKDAscyksdGhpcy5jcmVhdGVFcnJvcih2Lk9ORV9PRl9NVUxUSVBMRSx7aW5kZXgxOmksaW5kZXgyOnV9LCIiLCIvb25lT2YiLG51bGwsZSx0KTtpZihpPXUsdGhpcy50cmFja1Vua25vd25Qcm9wZXJ0aWVzKXtmb3IodmFyIHAgaW4gdGhpcy5rbm93blByb3BlcnR5UGF0aHMpb1twXT0hMCxkZWxldGUgbltwXTtmb3IodmFyIGQgaW4gdGhpcy51bmtub3duUHJvcGVydHlQYXRocylvW2RdfHwobltkXT0hMCl9fWVsc2UgZiYmYS5wdXNoKGYpfXJldHVybiB0aGlzLnRyYWNrVW5rbm93blByb3BlcnRpZXMmJih0aGlzLnVua25vd25Qcm9wZXJ0eVBhdGhzPW4sdGhpcy5rbm93blByb3BlcnR5UGF0aHM9byksbnVsbD09PWk/KGE9YS5jb25jYXQodGhpcy5lcnJvcnMuc2xpY2UocykpLHRoaXMuZXJyb3JzPXRoaXMuZXJyb3JzLnNsaWNlKDAscyksdGhpcy5jcmVhdGVFcnJvcih2Lk9ORV9PRl9NSVNTSU5HLHt9LCIiLCIvb25lT2YiLGEsZSx0KSk6KHRoaXMuZXJyb3JzPXRoaXMuZXJyb3JzLnNsaWNlKDAscyksbnVsbCl9LGgucHJvdG90eXBlLnZhbGlkYXRlTm90PWZ1bmN0aW9uKGUsdCxyKXtpZih2b2lkIDA9PT10Lm5vdClyZXR1cm4gbnVsbDt2YXIgbixvLGk9dGhpcy5lcnJvcnMubGVuZ3RoO3RoaXMudHJhY2tVbmtub3duUHJvcGVydGllcyYmKG49dGhpcy51bmtub3duUHJvcGVydHlQYXRocyxvPXRoaXMua25vd25Qcm9wZXJ0eVBhdGhzLHRoaXMudW5rbm93blByb3BlcnR5UGF0aHM9e30sdGhpcy5rbm93blByb3BlcnR5UGF0aHM9e30pO3ZhciBhPXRoaXMudmFsaWRhdGVBbGwoZSx0Lm5vdCxudWxsLG51bGwscikscz10aGlzLmVycm9ycy5zbGljZShpKTtyZXR1cm4gdGhpcy5lcnJvcnM9dGhpcy5lcnJvcnMuc2xpY2UoMCxpKSx0aGlzLnRyYWNrVW5rbm93blByb3BlcnRpZXMmJih0aGlzLnVua25vd25Qcm9wZXJ0eVBhdGhzPW4sdGhpcy5rbm93blByb3BlcnR5UGF0aHM9byksbnVsbD09PWEmJjA9PT1zLmxlbmd0aD90aGlzLmNyZWF0ZUVycm9yKHYuTk9UX1BBU1NFRCx7fSwiIiwiL25vdCIsbnVsbCxlLHQpOm51bGx9LGgucHJvdG90eXBlLnZhbGlkYXRlSHlwZXJtZWRpYT1mdW5jdGlvbihlLHQsbil7aWYoIXQubGlua3MpcmV0dXJuIG51bGw7Zm9yKHZhciBvLGk9MDtpPHQubGlua3MubGVuZ3RoO2krKyl7dmFyIGE9dC5saW5rc1tpXTtpZigiZGVzY3JpYmVkYnkiPT09YS5yZWwpe2Zvcih2YXIgcz1uZXcgcihhLmhyZWYpLHU9ITAsbD0wO2w8cy52YXJOYW1lcy5sZW5ndGg7bCsrKWlmKCEocy52YXJOYW1lc1tsXWluIGUpKXt1PSExO2JyZWFrfWlmKHUpe3ZhciBjPXMuZmlsbEZyb21PYmplY3QoZSksZj17JHJlZjpjfTtpZihvPXRoaXMudmFsaWRhdGVBbGwoZSxmLFtdLFsibGlua3MiLGldLG4pKXJldHVybiBvfX19fTt2YXIgdj17SU5WQUxJRF9UWVBFOjAsRU5VTV9NSVNNQVRDSDoxLEFOWV9PRl9NSVNTSU5HOjEwLE9ORV9PRl9NSVNTSU5HOjExLE9ORV9PRl9NVUxUSVBMRToxMixOT1RfUEFTU0VEOjEzLE5VTUJFUl9NVUxUSVBMRV9PRjoxMDAsTlVNQkVSX01JTklNVU06MTAxLE5VTUJFUl9NSU5JTVVNX0VYQ0xVU0lWRToxMDIsTlVNQkVSX01BWElNVU06MTAzLE5VTUJFUl9NQVhJTVVNX0VYQ0xVU0lWRToxMDQsTlVNQkVSX05PVF9BX05VTUJFUjoxMDUsU1RSSU5HX0xFTkdUSF9TSE9SVDoyMDAsU1RSSU5HX0xFTkdUSF9MT05HOjIwMSxTVFJJTkdfUEFUVEVSTjoyMDIsT0JKRUNUX1BST1BFUlRJRVNfTUlOSU1VTTozMDAsT0JKRUNUX1BST1BFUlRJRVNfTUFYSU1VTTozMDEsT0JKRUNUX1JFUVVJUkVEOjMwMixPQkpFQ1RfQURESVRJT05BTF9QUk9QRVJUSUVTOjMwMyxPQkpFQ1RfREVQRU5ERU5DWV9LRVk6MzA0LEFSUkFZX0xFTkdUSF9TSE9SVDo0MDAsQVJSQVlfTEVOR1RIX0xPTkc6NDAxLEFSUkFZX1VOSVFVRTo0MDIsQVJSQVlfQURESVRJT05BTF9JVEVNUzo0MDMsRk9STUFUX0NVU1RPTTo1MDAsS0VZV09SRF9DVVNUT006NTAxLENJUkNVTEFSX1JFRkVSRU5DRTo2MDAsVU5LTk9XTl9QUk9QRVJUWToxZTN9LF89e307Zm9yKHZhciBiIGluIHYpX1t2W2JdXT1iO3ZhciBnPXtJTlZBTElEX1RZUEU6IkludmFsaWQgdHlwZToge3R5cGV9IChleHBlY3RlZCB7ZXhwZWN0ZWR9KSIsRU5VTV9NSVNNQVRDSDoiTm8gZW51bSBtYXRjaCBmb3I6IHt2YWx1ZX0iLEFOWV9PRl9NSVNTSU5HOidEYXRhIGRvZXMgbm90IG1hdGNoIGFueSBzY2hlbWFzIGZyb20gImFueU9mIicsT05FX09GX01JU1NJTkc6J0RhdGEgZG9lcyBub3QgbWF0Y2ggYW55IHNjaGVtYXMgZnJvbSAib25lT2YiJyxPTkVfT0ZfTVVMVElQTEU6J0RhdGEgaXMgdmFsaWQgYWdhaW5zdCBtb3JlIHRoYW4gb25lIHNjaGVtYSBmcm9tICJvbmVPZiI6IGluZGljZXMge2luZGV4MX0gYW5kIHtpbmRleDJ9JyxOT1RfUEFTU0VEOidEYXRhIG1hdGNoZXMgc2NoZW1hIGZyb20gIm5vdCInLE5VTUJFUl9NVUxUSVBMRV9PRjoiVmFsdWUge3ZhbHVlfSBpcyBub3QgYSBtdWx0aXBsZSBvZiB7bXVsdGlwbGVPZn0iLE5VTUJFUl9NSU5JTVVNOiJWYWx1ZSB7dmFsdWV9IGlzIGxlc3MgdGhhbiBtaW5pbXVtIHttaW5pbXVtfSIsTlVNQkVSX01JTklNVU1fRVhDTFVTSVZFOiJWYWx1ZSB7dmFsdWV9IGlzIGVxdWFsIHRvIGV4Y2x1c2l2ZSBtaW5pbXVtIHttaW5pbXVtfSIsTlVNQkVSX01BWElNVU06IlZhbHVlIHt2YWx1ZX0gaXMgZ3JlYXRlciB0aGFuIG1heGltdW0ge21heGltdW19IixOVU1CRVJfTUFYSU1VTV9FWENMVVNJVkU6IlZhbHVlIHt2YWx1ZX0gaXMgZXF1YWwgdG8gZXhjbHVzaXZlIG1heGltdW0ge21heGltdW19IixOVU1CRVJfTk9UX0FfTlVNQkVSOiJWYWx1ZSB7dmFsdWV9IGlzIG5vdCBhIHZhbGlkIG51bWJlciIsU1RSSU5HX0xFTkdUSF9TSE9SVDoiU3RyaW5nIGlzIHRvbyBzaG9ydCAoe2xlbmd0aH0gY2hhcnMpLCBtaW5pbXVtIHttaW5pbXVtfSIsU1RSSU5HX0xFTkdUSF9MT05HOiJTdHJpbmcgaXMgdG9vIGxvbmcgKHtsZW5ndGh9IGNoYXJzKSwgbWF4aW11bSB7bWF4aW11bX0iLFNUUklOR19QQVRURVJOOiJTdHJpbmcgZG9lcyBub3QgbWF0Y2ggcGF0dGVybjoge3BhdHRlcm59IixPQkpFQ1RfUFJPUEVSVElFU19NSU5JTVVNOiJUb28gZmV3IHByb3BlcnRpZXMgZGVmaW5lZCAoe3Byb3BlcnR5Q291bnR9KSwgbWluaW11bSB7bWluaW11bX0iLE9CSkVDVF9QUk9QRVJUSUVTX01BWElNVU06IlRvbyBtYW55IHByb3BlcnRpZXMgZGVmaW5lZCAoe3Byb3BlcnR5Q291bnR9KSwgbWF4aW11bSB7bWF4aW11bX0iLE9CSkVDVF9SRVFVSVJFRDoiTWlzc2luZyByZXF1aXJlZCBwcm9wZXJ0eToge2tleX0iLE9CSkVDVF9BRERJVElPTkFMX1BST1BFUlRJRVM6IkFkZGl0aW9uYWwgcHJvcGVydGllcyBub3QgYWxsb3dlZCIsT0JKRUNUX0RFUEVOREVOQ1lfS0VZOiJEZXBlbmRlbmN5IGZhaWxlZCAtIGtleSBtdXN0IGV4aXN0OiB7bWlzc2luZ30gKGR1ZSB0byBrZXk6IHtrZXl9KSIsQVJSQVlfTEVOR1RIX1NIT1JUOiJBcnJheSBpcyB0b28gc2hvcnQgKHtsZW5ndGh9KSwgbWluaW11bSB7bWluaW11bX0iLEFSUkFZX0xFTkdUSF9MT05HOiJBcnJheSBpcyB0b28gbG9uZyAoe2xlbmd0aH0pLCBtYXhpbXVtIHttYXhpbXVtfSIsQVJSQVlfVU5JUVVFOiJBcnJheSBpdGVtcyBhcmUgbm90IHVuaXF1ZSAoaW5kaWNlcyB7bWF0Y2gxfSBhbmQge21hdGNoMn0pIixBUlJBWV9BRERJVElPTkFMX0lURU1TOiJBZGRpdGlvbmFsIGl0ZW1zIG5vdCBhbGxvd2VkIixGT1JNQVRfQ1VTVE9NOiJGb3JtYXQgdmFsaWRhdGlvbiBmYWlsZWQgKHttZXNzYWdlfSkiLEtFWVdPUkRfQ1VTVE9NOiJLZXl3b3JkIGZhaWxlZDoge2tleX0gKHttZXNzYWdlfSkiLENJUkNVTEFSX1JFRkVSRU5DRToiQ2lyY3VsYXIgJHJlZnM6IHt1cmxzfSIsVU5LTk9XTl9QUk9QRVJUWToiVW5rbm93biBwcm9wZXJ0eSAobm90IGluIHNjaGVtYSkifTtsLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKEVycm9yLnByb3RvdHlwZSksbC5wcm90b3R5cGUuY29uc3RydWN0b3I9bCxsLnByb3RvdHlwZS5uYW1lPSJWYWxpZGF0aW9uRXJyb3IiLGwucHJvdG90eXBlLnByZWZpeFdpdGg9ZnVuY3Rpb24oZSx0KXtpZihudWxsIT09ZSYmKGU9ZS5yZXBsYWNlKC9+L2csIn4wIikucmVwbGFjZSgvXC8vZywifjEiKSx0aGlzLmRhdGFQYXRoPSIvIitlK3RoaXMuZGF0YVBhdGgpLG51bGwhPT10JiYodD10LnJlcGxhY2UoL34vZywifjAiKS5yZXBsYWNlKC9cLy9nLCJ+MSIpLHRoaXMuc2NoZW1hUGF0aD0iLyIrdCt0aGlzLnNjaGVtYVBhdGgpLG51bGwhPT10aGlzLnN1YkVycm9ycylmb3IodmFyIHI9MDtyPHRoaXMuc3ViRXJyb3JzLmxlbmd0aDtyKyspdGhpcy5zdWJFcnJvcnNbcl0ucHJlZml4V2l0aChlLHQpO3JldHVybiB0aGlzfTt2YXIgRT17fSxqPWYoKTtyZXR1cm4gai5hZGRMYW5ndWFnZSgiZW4tZ2IiLGcpLGoudHY0PWosan0pfSx7fV0sMTAxOltmdW5jdGlvbihlLHQscil7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIG4oZSl7cmV0dXJuIGUmJmUuX19lc01vZHVsZT9lOnsiZGVmYXVsdCI6ZX19T2JqZWN0LmRlZmluZVByb3BlcnR5KHIsIl9fZXNNb2R1bGUiLHt2YWx1ZTohMH0pLHIuTWVzc2FnZUZhY3Rvcnk9dm9pZCAwO3ZhciBvPWUoIi4vbWVzc2FnZS1mYWN0b3J5L01lc3NhZ2VGYWN0b3J5IiksaT1uKG8pO3IuTWVzc2FnZUZhY3Rvcnk9aVsiZGVmYXVsdCJdfSx7Ii4vbWVzc2FnZS1mYWN0b3J5L01lc3NhZ2VGYWN0b3J5IjoxMDR9XSwxMDI6W2Z1bmN0aW9uKGUsdCxyKXsidXNlIHN0cmljdCI7ZnVuY3Rpb24gbihlKXtyZXR1cm4gZSYmZS5fX2VzTW9kdWxlP2U6eyJkZWZhdWx0IjplfX1PYmplY3QuZGVmaW5lUHJvcGVydHkociwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSksci5NZXNzYWdlVHlwZT1yLk1lc3NhZ2U9dm9pZCAwO3ZhciBvPWUoImJhYmVsLXJ1bnRpbWUvaGVscGVycy9jbGFzc0NhbGxDaGVjayIpLGk9bihvKSxhPWUoImJhYmVsLXJ1bnRpbWUvaGVscGVycy9jcmVhdGVDbGFzcyIpLHM9bihhKSx1PXIuTWVzc2FnZT1mdW5jdGlvbigpe2Z1bmN0aW9uIGUodCxyLG4sbyxhKXsoMCxpWyJkZWZhdWx0Il0pKHRoaXMsZSksdGhpcy5pZD10LHRoaXMuZnJvbT1yLHRoaXMudG89bix0aGlzLnR5cGU9byx0aGlzLmJvZHk9YX1yZXR1cm4oMCxzWyJkZWZhdWx0Il0pKGUsW3trZXk6ImFzc2VydElkZW50aXR5Iix2YWx1ZTpmdW5jdGlvbihlLHQpe2lmKCFlfHwhdCl0aHJvdyBuZXcgRXJyb3IoIm1lc3NhZ2UsIHRva2VuIHRvIGJlIHJlbW92ZWQsIGFuZCBhc3NlcnRlZElkZW50aXR5IG11c3QgYmUgcHJvdmlkZWQiKTt2YXIgcj10aGlzLmJvZHk7cmV0dXJuIHIuaWRUb2tlbj1udWxsLHIuYXNzZXJ0ZWRJZGVudGl0eT10LHRoaXMuYm9keT1yLHRoaXN9fSx7a2V5OiJhZGRJZFRva2VuIix2YWx1ZTpmdW5jdGlvbihlKXtpZighZSl0aHJvdyBuZXcgRXJyb3IoIm1lc3NhZ2UsIHRva2VuIHRvIGJlIGFkZGVkLCBtdXN0IGJlIHByb3ZpZGVkIik7dmFyIHQ9dGhpcy5ib2R5O3JldHVybiB0LmlkVG9rZW49ZSx0aGlzLmJvZHk9dCx0aGlzfX0se2tleToiYWRkQWNjZXNzVG9rZW4iLHZhbHVlOmZ1bmN0aW9uKGUpe2lmKCFlKXRocm93IG5ldyBFcnJvcigibWVzc2FnZSwgdG9rZW4gdG8gYmUgYWRkZWQsIG11c3QgYmUgcHJvdmlkZWQiKTt2YXIgdD10aGlzLmJvZHk7cmV0dXJuIHQuYWNjZXNzVG9rZW49ZSx0aGlzLmJvZHk9dCx0aGlzfX1dKSxlfSgpO3IuTWVzc2FnZVR5cGU9e0NSRUFURToiY3JlYXRlIixSRUFEOiJyZWFkIixVUERBVEU6InVwZGF0ZSIsREVMRVRFOiJkZWxldGUiLFNVQlNDUklCRToic3Vic2NyaWJlIiwNClVOU1VCU0NSSUJFOiJ1bnN1YnNjcmliZSIsUkVTUE9OU0U6InJlc3BvbnNlIixGT1JXQVJEOiJmb3J3YXJkIixFWEVDVVRFOiJleGVjdXRlIn07clsiZGVmYXVsdCJdPXV9LHsiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NsYXNzQ2FsbENoZWNrIjoxMCwiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NyZWF0ZUNsYXNzIjoxMX1dLDEwMzpbZnVuY3Rpb24oZSx0LHIpeyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiBuKGUpe3JldHVybiBlJiZlLl9fZXNNb2R1bGU/ZTp7ImRlZmF1bHQiOmV9fWZ1bmN0aW9uIG8oZSl7dmFyIHQ9KDAsdVsiZGVmYXVsdCJdKShlKS5yZWR1Y2UoZnVuY3Rpb24odCxyKXtyZXR1cm4gdFtlW3JdXT1yLHR9LHt9KTtyZXR1cm4oMCxhWyJkZWZhdWx0Il0pKCgwLHVbImRlZmF1bHQiXSkoZSkucmVkdWNlKGZ1bmN0aW9uKHQscil7cmV0dXJuIHRbcl09ZVtyXSx0fSxmdW5jdGlvbihlKXtyZXR1cm4gdFtlXX0pKX1PYmplY3QuZGVmaW5lUHJvcGVydHkociwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSksci5VUERBVEVfT1BFUkFUSU9OPXIuQVRUUklCVVRFX1RZUEU9ci5SRUFTT05fUEhSQVNFPXIuUkVTUE9OU0VfQ09ERT1yLkV4ZWN1dGVNZXNzYWdlQm9keT1yLlJlc3BvbnNlTWVzc2FnZUJvZHk9ci5Gb3J3YXJkTWVzc2FnZUJvZHk9ci5VcGRhdGVNZXNzYWdlQm9keT1yLkRlbGV0ZU1lc3NhZ2VCb2R5PXIuUmVhZE1lc3NhZ2VCb2R5PXIuQ3JlYXRlTWVzc2FnZUJvZHk9ci5NZXNzYWdlQm9keT12b2lkIDA7dmFyIGk9ZSgiYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9mcmVlemUiKSxhPW4oaSkscz1lKCJiYWJlbC1ydW50aW1lL2NvcmUtanMvb2JqZWN0L2tleXMiKSx1PW4ocyksbD1lKCJiYWJlbC1ydW50aW1lL2NvcmUtanMvb2JqZWN0L2dldC1wcm90b3R5cGUtb2YiKSxjPW4obCksZj1lKCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvcG9zc2libGVDb25zdHJ1Y3RvclJldHVybiIpLHA9bihmKSxkPWUoImJhYmVsLXJ1bnRpbWUvaGVscGVycy9pbmhlcml0cyIpLGg9bihkKSx5PWUoImJhYmVsLXJ1bnRpbWUvaGVscGVycy9jbGFzc0NhbGxDaGVjayIpLG09bih5KSx2PWUoImJhYmVsLXJ1bnRpbWUvaGVscGVycy9jcmVhdGVDbGFzcyIpLF89bih2KTtyLkVudW09bzt2YXIgYj1yLk1lc3NhZ2VCb2R5PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSh0LHIsbixvLGkpeygwLG1bImRlZmF1bHQiXSkodGhpcyxlKSx0aGlzLmlkVG9rZW49dCx0aGlzLmFjY2Vzc1Rva2VuPXIsdGhpcy5yZXNvdXJjZT1uLHRoaXMuc2NoZW1hPW8sdGhpcy5hc3NlcnRlZElkZW50aXR5PWl9cmV0dXJuKDAsX1siZGVmYXVsdCJdKShlLFt7a2V5OiJhZGRWaWEiLHZhbHVlOmZ1bmN0aW9uKGUpe2lmKCFlKXRocm93IG5ldyBFcnJvcigidmlhIFVSTCB0byBiZSBhZGRlZCwgbXVzdCBiZSBwcm92aWRlZCIpO3JldHVybiB0aGlzLnZpYT1lLHRoaXN9fV0pLGV9KCksZz0oci5DcmVhdGVNZXNzYWdlQm9keT1mdW5jdGlvbihlKXtmdW5jdGlvbiB0KGUscixuLG8saSxhLHMpe2lmKCgwLG1bImRlZmF1bHQiXSkodGhpcyx0KSwhZSl0aHJvdyBuZXcgRXJyb3IoIlRoZSB2YWx1ZSBwYXJhbWV0ZXIgaXMgbnVsbCIpO3ZhciB1PSgwLHBbImRlZmF1bHQiXSkodGhpcywoMCxjWyJkZWZhdWx0Il0pKHQpLmNhbGwodGhpcyxuLG8saSxhLHMsYSxzKSk7cmV0dXJuIHUudmFsdWU9ZSxyJiYodS5wb2xpY3k9ciksdX1yZXR1cm4oMCxoWyJkZWZhdWx0Il0pKHQsZSksdH0oYiksci5SZWFkTWVzc2FnZUJvZHk9ZnVuY3Rpb24oZSl7ZnVuY3Rpb24gdChlLHIsbixvLGksYSxzLHUpeygwLG1bImRlZmF1bHQiXSkodGhpcyx0KTt2YXIgbD0oMCxwWyJkZWZhdWx0Il0pKHRoaXMsKDAsY1siZGVmYXVsdCJdKSh0KS5jYWxsKHRoaXMsZSxyLG4sbyxpKSk7cmV0dXJuIGEmJihsLmF0dHJpYnV0ZT1hKSxzJiYobC5jcml0ZXJpYVN5bnRheD1zKSx1JiYobC5jcml0ZXJpYT11KSxsfXJldHVybigwLGhbImRlZmF1bHQiXSkodCxlKSx0fShiKSxyLkRlbGV0ZU1lc3NhZ2VCb2R5PWZ1bmN0aW9uKGUpe2Z1bmN0aW9uIHQoZSxyLG4sbyxpLGEpe2lmKCgwLG1bImRlZmF1bHQiXSkodGhpcyx0KSxuIGluc3RhbmNlb2YgQXJyYXkpe3ZhciBzPSgwLHBbImRlZmF1bHQiXSkodGhpcywoMCxjWyJkZWZhdWx0Il0pKHQpLmNhbGwodGhpcyxlLHIsbnVsbCxvLGkpKTtzLmNoaWxkcmVuUmVzb3VyY2VzPW59ZWxzZSB2YXIgcz0oMCxwWyJkZWZhdWx0Il0pKHRoaXMsKDAsY1siZGVmYXVsdCJdKSh0KS5jYWxsKHRoaXMsZSxyLG4sbyxpKSk7cmV0dXJuIGEmJihzLmF0dHJpYnV0ZT1hKSwoMCxwWyJkZWZhdWx0Il0pKHMpfXJldHVybigwLGhbImRlZmF1bHQiXSkodCxlKSx0fShiKSxyLlVwZGF0ZU1lc3NhZ2VCb2R5PWZ1bmN0aW9uKGUpe2Z1bmN0aW9uIHQoZSxyLG4sbyxpLGEscyl7KDAsbVsiZGVmYXVsdCJdKSh0aGlzLHQpO3ZhciB1PSgwLHBbImRlZmF1bHQiXSkodGhpcywoMCxjWyJkZWZhdWx0Il0pKHQpLmNhbGwodGhpcyxlLHIsbixvLGkpKTtyZXR1cm4gdS5hdHRyaWJ1dGU9YSx1LnZhbHVlPXMsdX1yZXR1cm4oMCxoWyJkZWZhdWx0Il0pKHQsZSksKDAsX1siZGVmYXVsdCJdKSh0LFt7a2V5OiJhZGRBdHRyaWJ1dGVUeXBlIix2YWx1ZTpmdW5jdGlvbihlKXtlJiYodGhpcy5hdHRyaWJ1dGVUeXBlPWUpfX0se2tleToiYWRkT3BlcmF0aW9uIix2YWx1ZTpmdW5jdGlvbihlKXtlJiYodGhpcy5vcGVyYXRpb249ZSl9fV0pLHR9KGIpLHIuRm9yd2FyZE1lc3NhZ2VCb2R5PWZ1bmN0aW9uKGUpe2Z1bmN0aW9uIHQoZSxyLG4sbyxpLGEpeygwLG1bImRlZmF1bHQiXSkodGhpcyx0KTt2YXIgcz0oMCxwWyJkZWZhdWx0Il0pKHRoaXMsKDAsY1siZGVmYXVsdCJdKSh0KS5jYWxsKHRoaXMsZSxyLG4sbyxpKSk7cmV0dXJuIHMubWVzc2FnZT1hLHN9cmV0dXJuKDAsaFsiZGVmYXVsdCJdKSh0LGUpLHR9KGIpLHIuUmVzcG9uc2VNZXNzYWdlQm9keT1mdW5jdGlvbihlKXtmdW5jdGlvbiB0KGUscixuLG8saSl7KDAsbVsiZGVmYXVsdCJdKSh0aGlzLHQpO3ZhciBhPSgwLHBbImRlZmF1bHQiXSkodGhpcywoMCxjWyJkZWZhdWx0Il0pKHQpLmNhbGwodGhpcyxlLHIsbikpO3JldHVybiBvJiYoYS5jb2RlPW8sYS5kZXNjcmlwdGlvbj1nW29dKSxpJiYoYS52YWx1ZT1pKSxhfXJldHVybigwLGhbImRlZmF1bHQiXSkodCxlKSx0fShiKSxyLkV4ZWN1dGVNZXNzYWdlQm9keT1mdW5jdGlvbihlKXtmdW5jdGlvbiB0KGUscixuLG8saSxhLHMpeygwLG1bImRlZmF1bHQiXSkodGhpcyx0KTt2YXIgdT0oMCxwWyJkZWZhdWx0Il0pKHRoaXMsKDAsY1siZGVmYXVsdCJdKSh0KS5jYWxsKHRoaXMsZSxyLG4sbyxpKSk7cmV0dXJuIHUubWV0aG9kPWEscyYmKHMgaW5zdGFuY2VvZiBBcnJheT91LnBhcmFtcz1zOnUucGFyYW1zPVtzXSksdX1yZXR1cm4oMCxoWyJkZWZhdWx0Il0pKHQsZSksdH0oYiksci5SRVNQT05TRV9DT0RFPW8oezEwMDoiMTAwIiwxMDE6IjEwMSIsMjAwOiIyMDAiLDIwMToiMjAxIiwyMDI6IjIwMiIsMjAzOiIyMDMiLDIwNDoiMjA0IiwyMDU6IjIwNSIsMjA2OiIyMDYiLDMwMDoiMzAwIiwzMDE6IjMwMSIsMzAyOiIzMDIiLDMwMzoiMzAzIiwzMDQ6IjMwNCIsMzA1OiIzMDUiLDMwNzoiMzA3Iiw0MDA6IjQwMCIsNDAxOiI0MDEiLDQwMjoiNDAyIiw0MDM6IjQwMyIsNDA0OiI0MDQiLDQwNToiNDA1Iiw0MDY6IjQwNiIsNDA3OiI0MDciLDQwODoiNDA4Iiw0MDk6IjQwOSIsNDEwOiI0MTAiLDQxMToiNDExIiw0MTI6IjQxMiIsNDEzOiI0MTMiLDQxNDoiNDE0Iiw0MTU6IjQxNSIsNDE2OiI0MTYiLDQxNzoiNDE3Iiw0MjY6IjQyNiIsNTAwOiI1MDAiLDUwMToiNTAxIiw1MDI6IjUwMiIsNTAzOiI1MDMiLDUwNDoiNTA0Iiw1MDU6IjUwNSJ9KSxyLlJFQVNPTl9QSFJBU0U9byh7MTAwOiJDb250aW51ZSIsMTAxOiJTd2l0Y2hpbmcgUHJvdG9jb2xzIiwyMDA6Ik9LIiwyMDE6IkNyZWF0ZWQiLDIwMjoiQWNjZXB0ZWQiLDIwMzoiTm9uLUF1dGhvcml0YXRpdmUgSW5mb3JtYXRpb24iLDIwNDoiTm8gQ29udGVudCIsMjA1OiJSZXNldCBDb250ZW50IiwyMDY6IlBhcnRpYWwgQ29udGVudCIsMzAwOiJNdWx0aXBsZSBDaG9pY2VzIiwzMDE6Ik1vdmVkIFBlcm1hbmVudGx5IiwzMDI6IkZvdW5kIiwzMDM6IlNlZSBPdGhlciIsMzA0OiJOb3QgTW9kaWZpZWQiLDMwNToiVXNlIFByb3h5IiwzMDc6IlRlbXBvcmFyeSBSZWRpcmVjdCIsNDAwOiJCYWQgUmVxdWVzdCIsNDAxOiJVbmF1dGhvcml6ZWQiLDQwMjoiUGF5bWVudCBSZXF1aXJlZCIsNDAzOiJGb3JiaWRkZW4iLDQwNDoiTm90IEZvdW5kIiw0MDU6Ik1ldGhvZCBOb3QgQWxsb3dlZCIsNDA2OiJOb3QgQWNjZXB0YWJsZSIsNDA3OiJQcm94eSBBdXRoZW50aWNhdGlvbiBSZXF1aXJlZCIsNDA4OiJSZXF1ZXN0IFRpbWVvdXQiLDQwOToiQ29uZmxpY3QiLDQxMDoiR29uZSIsNDExOiJMZW5ndGggUmVxdWlyZWQiLDQxMjoiUHJlY29uZGl0aW9uIEZhaWxlZCIsNDEzOiJQYXlsb2FkIFRvbyBMYXJnZSIsNDE0OiJSZXF1ZXN0LVVSSSBUb28gTG9uZyIsNDE1OiJVbnN1cHBvcnRlZCBNZWRpYSBUeXBlIiw0MTY6IlJhbmdlIE5vdCBTYXRpc2ZpYWJsZSIsNDE3OiJFeHBlY3RhdGlvbiBGYWlsZWQiLDQyNjoiVXBncmFkZSBSZXF1aXJlZCIsNTAwOiJJbnRlcm5hbCBTZXJ2ZXIgRXJyb3IiLDUwMToiTm90IEltcGxlbWVudGVkIiw1MDI6IkJhZCBHYXRld2F5Iiw1MDM6IlNlcnZpY2UgVW5hdmFpbGFibGUiLDUwNDoiR2F0ZXdheSBUaW1lLW91dCIsNTA1OiJIVFRQIFZlcnNpb24gTm90IFN1cHBvcnRlZCJ9KSk7ci5BVFRSSUJVVEVfVFlQRT1vKHtPQkpFQ1Q6Ik9CSkVDVCIsQVJSQVk6IkFSUkFZIn0pLHIuVVBEQVRFX09QRVJBVElPTj1vKHtBREQ6IkFERCIsUkVNT1ZFOiJSRU1PVkUifSk7clsiZGVmYXVsdCJdPWJ9LHsiYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9mcmVlemUiOjMsImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9vYmplY3QvZ2V0LXByb3RvdHlwZS1vZiI6NSwiYmFiZWwtcnVudGltZS9jb3JlLWpzL29iamVjdC9rZXlzIjo2LCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvY2xhc3NDYWxsQ2hlY2siOjEwLCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvY3JlYXRlQ2xhc3MiOjExLCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvaW5oZXJpdHMiOjEzLCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvcG9zc2libGVDb25zdHJ1Y3RvclJldHVybiI6MTR9XSwxMDQ6W2Z1bmN0aW9uKGUsdCxyKXsidXNlIHN0cmljdCI7ZnVuY3Rpb24gbihlKXtyZXR1cm4gZSYmZS5fX2VzTW9kdWxlP2U6eyJkZWZhdWx0IjplfX1PYmplY3QuZGVmaW5lUHJvcGVydHkociwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSksci5JZEdlbmVyYXRvcj12b2lkIDA7dmFyIG89ZSgiYmFiZWwtcnVudGltZS9yZWdlbmVyYXRvciIpLGk9bihvKSxhPWUoImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9vYmplY3QvZ2V0LXByb3RvdHlwZS1vZiIpLHM9bihhKSx1PWUoImJhYmVsLXJ1bnRpbWUvaGVscGVycy9jbGFzc0NhbGxDaGVjayIpLGw9bih1KSxjPWUoImJhYmVsLXJ1bnRpbWUvaGVscGVycy9jcmVhdGVDbGFzcyIpLGY9bihjKSxwPWUoImJhYmVsLXJ1bnRpbWUvaGVscGVycy9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuIiksZD1uKHApLGg9ZSgiYmFiZWwtcnVudGltZS9oZWxwZXJzL2dldCIpLHk9bihoKSxtPWUoImJhYmVsLXJ1bnRpbWUvaGVscGVycy9pbmhlcml0cyIpLHY9bihtKSxfPWUoIi4uL3JlVEhJTktPYmplY3QvUmV0aGlua09iamVjdC5qcyIpLGI9bihfKSxnPWUoIi4vTWVzc2FnZS5qcyIpLEU9bihnKSxqPWUoIi4vTWVzc2FnZUJvZHkuanMiKSx3PWZ1bmN0aW9uKGUpe2Z1bmN0aW9uIHQoZSxyKXsoMCxsWyJkZWZhdWx0Il0pKHRoaXMsdCk7dmFyIG49KDAsZFsiZGVmYXVsdCJdKSh0aGlzLCgwLHNbImRlZmF1bHQiXSkodCkuY2FsbCh0aGlzLGUscikpO3JldHVybiBuLm15R2VuZXJhdG9yPShuZXcgTykuaWRNYWtlcigpLG59cmV0dXJuKDAsdlsiZGVmYXVsdCJdKSh0LGUpLCgwLGZbImRlZmF1bHQiXSkodCxbe2tleToidmFsaWRhdGUiLHZhbHVlOmZ1bmN0aW9uKGUpe3JldHVybigwLHlbImRlZmF1bHQiXSkoKDAsc1siZGVmYXVsdCJdKSh0LnByb3RvdHlwZSksInZhbGlkYXRlIix0aGlzKS5jYWxsKHRoaXMsZSl9fSx7a2V5OiJjcmVhdGVDcmVhdGVNZXNzYWdlUmVxdWVzdCIsdmFsdWU6ZnVuY3Rpb24oZSx0LHIsbil7aWYoIWV8fCF0fHwhcil0aHJvdyBuZXcgRXJyb3IoImZyb20sIHRvLCBhbmQgdmFsdWUgb2Ygb2JqZWN0IHRvIGJlIGNyZWF0ZWQgTVVTVCBiZSBzcGVjaWZpZWQiKTt2YXIgbz10aGlzLm15R2VuZXJhdG9yLm5leHQoKS52YWx1ZSxpPW5ldyBqLkNyZWF0ZU1lc3NhZ2VCb2R5KHIsbixudWxsLG51bGwsbnVsbCxudWxsLG51bGwpLGE9bmV3IEVbImRlZmF1bHQiXShvLGUsdCxnLk1lc3NhZ2VUeXBlLkNSRUFURSxpKTtyZXR1cm4gYX19LHtrZXk6ImNyZWF0ZUZvcndhcmRNZXNzYWdlUmVxdWVzdCIsdmFsdWU6ZnVuY3Rpb24oZSx0LHIpe2lmKCFlfHwhdHx8IXIpdGhyb3cgbmV3IEVycm9yKCJmcm9tLCB0bywgYW5kIG1lc3NhZ2UgdG8gZm9yd2FyZCBNVVNUIGJlIHNwZWNpZmllZCIpO3ZhciBuPXRoaXMubXlHZW5lcmF0b3IubmV4dCgpLnZhbHVlLG89bmV3IGouRm9yd2FyZE1lc3NhZ2VCb2R5KG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxyKSxpPW5ldyBFWyJkZWZhdWx0Il0obixlLHQsZy5NZXNzYWdlVHlwZS5GT1JXQVJELG8pO3JldHVybiBpfX0se2tleToiY3JlYXRlRGVsZXRlTWVzc2FnZVJlcXVlc3QiLHZhbHVlOmZ1bmN0aW9uKGUsdCxyLG4pe2lmKCFlfHwhdCl0aHJvdyBuZXcgRXJyb3IoImZyb20gYW5kIHRvIHBhcmFtZXRlcnMgTVVTVCBiZSBzcGVjaWZpZWQiKTt2YXIgbz10aGlzLm15R2VuZXJhdG9yLm5leHQoKS52YWx1ZSxpPW5ldyBqLkRlbGV0ZU1lc3NhZ2VCb2R5KG51bGwsbnVsbCxyLG4sbnVsbCxudWxsKSxhPW5ldyBFWyJkZWZhdWx0Il0obyxlLHQsZy5NZXNzYWdlVHlwZS5ERUxFVEUsaSk7cmV0dXJuIGF9fSx7a2V5OiJjcmVhdGVVcGRhdGVNZXNzYWdlUmVxdWVzdCIsdmFsdWU6ZnVuY3Rpb24oZSx0LHIsbixvKXtpZighZXx8IXR8fCFyKXRocm93IG5ldyBFcnJvcigiZnJvbSwgYW5kIHRvIGFuZCB2YWx1ZSBNVVNUIGJlIHNwZWNpZmllZCIpO3ZhciBpPXRoaXMubXlHZW5lcmF0b3IubmV4dCgpLnZhbHVlLGE9bmV3IGouVXBkYXRlTWVzc2FnZUJvZHkobnVsbCxudWxsLG4sbnVsbCxudWxsLG8scikscz1uZXcgRVsiZGVmYXVsdCJdKGksZSx0LGcuTWVzc2FnZVR5cGUuVVBEQVRFLGEpO3JldHVybiBzfX0se2tleToiY3JlYXRlUmVhZE1lc3NhZ2VSZXF1ZXN0Iix2YWx1ZTpmdW5jdGlvbihlLHQscixuKXtpZighZXx8IXR8fCFyKXRocm93IG5ldyBFcnJvcigiZnJvbSwgdG8gYW5kIHRoZSByZXNvdXJjZSB0byByZWFkIGZyb20gTVVTVCBiZSBzcGVjaWZpZWQiKTt2YXIgbz10aGlzLm15R2VuZXJhdG9yLm5leHQoKS52YWx1ZSxpPW5ldyBqLlJlYWRNZXNzYWdlQm9keShudWxsLG51bGwscixudWxsLG51bGwsbixudWxsLG51bGwpLGE9bmV3IEVbImRlZmF1bHQiXShvLGUsdCxnLk1lc3NhZ2VUeXBlLlJFQUQsaSk7cmV0dXJuIGF9fSx7a2V5OiJjcmVhdGVTdWJzY3JpYmVNZXNzYWdlUmVxdWVzdCIsdmFsdWU6ZnVuY3Rpb24oZSx0LHIpe2lmKCFlfHwhdHx8IXIpdGhyb3cgbmV3IEVycm9yKCJmcm9tLCB0byBhbmQgdGhlIHJlc291cmNlIHRvIHN1YnNjcmliZSB0byBNVVNUIGJlIHNwZWNpZmllZCIpO3ZhciBuPXRoaXMubXlHZW5lcmF0b3IubmV4dCgpLnZhbHVlLG89bmV3IGouTWVzc2FnZUJvZHkobnVsbCxudWxsLHIsbnVsbCxudWxsKSxpPW5ldyBFWyJkZWZhdWx0Il0obixlLHQsZy5NZXNzYWdlVHlwZS5TVUJTQ1JJQkUsbyk7cmV0dXJuIGl9fSx7a2V5OiJjcmVhdGVVbnN1YnNjcmliZU1lc3NhZ2VSZXF1ZXN0Iix2YWx1ZTpmdW5jdGlvbihlLHQscil7aWYoIWV8fCF0fHwhcil0aHJvdyBuZXcgRXJyb3IoImZyb20sIHRvIGFuZCB0aGUgcmVzb3VyY2UgdG8gc3Vic2NyaWJlIHRvIE1VU1QgYmUgc3BlY2lmaWVkIik7dmFyIG49dGhpcy5teUdlbmVyYXRvci5uZXh0KCkudmFsdWUsbz1uZXcgai5NZXNzYWdlQm9keShudWxsLG51bGwscixudWxsLG51bGwpLGk9bmV3IEVbImRlZmF1bHQiXShuLGUsdCxnLk1lc3NhZ2VUeXBlLlVOU1VCU0NSSUJFLG8pO3JldHVybiBpfX0se2tleToiY3JlYXRlRXhlY3V0ZU1lc3NhZ2VSZXF1ZXN0Iix2YWx1ZTpmdW5jdGlvbihlLHQscixuKXtpZighZXx8IXR8fCFyKXRocm93IG5ldyBFcnJvcigiZnJvbSwgdG8gYW5kIHRoZSBtZXRob2QgdG8gZXhlY3V0ZSBNVVNUIGJlIHNwZWNpZmllZCIpO3ZhciBvPXRoaXMubXlHZW5lcmF0b3IubmV4dCgpLnZhbHVlLGk9bmV3IGouRXhlY3V0ZU1lc3NhZ2VCb2R5KG51bGwsbnVsbCxudWxsLG51bGwsbnVsbCxyLG4pLGE9bmV3IEVbImRlZmF1bHQiXShvLGUsdCxnLk1lc3NhZ2VUeXBlLkVYRUNVVEUsaSk7cmV0dXJuIGF9fSx7a2V5OiJjcmVhdGVNZXNzYWdlUmVzcG9uc2UiLHZhbHVlOmZ1bmN0aW9uKGUsdCxyLG4pe2lmKCF0KXRocm93IG5ldyBFcnJvcigicmVzcG9uc2UgQ29kZSBNVVNUIGJlIHNwZWNpZmllZCIpO3ZhciBvPW5ldyBqLlJlc3BvbnNlTWVzc2FnZUJvZHkobnVsbCxudWxsLG51bGwsdCxyLG4pO3JldHVybiBuZXcgRVsiZGVmYXVsdCJdKGUuaWQsZS50byxlLmZyb20sZy5NZXNzYWdlVHlwZS5SRVNQT05TRSxvKX19LHtrZXk6ImdlbmVyYXRlTWVzc2FnZVJlc3BvbnNlIix2YWx1ZTpmdW5jdGlvbihlLHQscil7aWYoIWV8fCF0KXRocm93IG5ldyBFcnJvcigibWVzc2FnZSBhbmQgcmVzcG9uc2UgY29kZSBNVVNUIGJlIHNwZWNpZmllZCIpO3ZhciBuPWUuYm9keSxvPW4uaWRUb2tlbixpPW4uYWNjZXNzVG9rZW4sYT1uLnJlc291cmNlLHM9bmV3IGouUmVzcG9uc2VNZXNzYWdlQm9keShvLGksYSx0LHIpLHU9dGhpcy5teUdlbmVyYXRvci5uZXh0KCkudmFsdWU7cmV0dXJuIG5ldyBFWyJkZWZhdWx0Il0odSxlLnRvLGUuZnJvbSxnLk1lc3NhZ2VUeXBlLlJFU1BPTlNFLHMpfX1dKSx0fShiWyJkZWZhdWx0Il0pLE89ci5JZEdlbmVyYXRvcj1mdW5jdGlvbigpe2Z1bmN0aW9uIGUoKXsoMCxsWyJkZWZhdWx0Il0pKHRoaXMsZSl9cmV0dXJuKDAsZlsiZGVmYXVsdCJdKShlLFt7a2V5OiJpZE1ha2VyIix2YWx1ZTppWyJkZWZhdWx0Il0ubWFyayhmdW5jdGlvbiB0KCl7dmFyIGU7cmV0dXJuIGlbImRlZmF1bHQiXS53cmFwKGZ1bmN0aW9uKHQpe2Zvcig7Oylzd2l0Y2godC5wcmV2PXQubmV4dCl7Y2FzZSAwOmU9MTtjYXNlIDE6aWYoIShlPDFlNikpe3QubmV4dD02O2JyZWFrfXJldHVybiB0Lm5leHQ9NCxlKys7Y2FzZSA0OnQubmV4dD0xO2JyZWFrO2Nhc2UgNjpjYXNlImVuZCI6cmV0dXJuIHQuc3RvcCgpfX0sdCx0aGlzKX0pfV0pLGV9KCk7clsiZGVmYXVsdCJdPXd9LHsiLi4vcmVUSElOS09iamVjdC9SZXRoaW5rT2JqZWN0LmpzIjoxMDUsIi4vTWVzc2FnZS5qcyI6MTAyLCIuL01lc3NhZ2VCb2R5LmpzIjoxMDMsImJhYmVsLXJ1bnRpbWUvY29yZS1qcy9vYmplY3QvZ2V0LXByb3RvdHlwZS1vZiI6NSwiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NsYXNzQ2FsbENoZWNrIjoxMCwiYmFiZWwtcnVudGltZS9oZWxwZXJzL2NyZWF0ZUNsYXNzIjoxMSwiYmFiZWwtcnVudGltZS9oZWxwZXJzL2dldCI6MTIsImJhYmVsLXJ1bnRpbWUvaGVscGVycy9pbmhlcml0cyI6MTMsImJhYmVsLXJ1bnRpbWUvaGVscGVycy9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuIjoxNCwiYmFiZWwtcnVudGltZS9yZWdlbmVyYXRvciI6MTZ9XSwxMDU6W2Z1bmN0aW9uKGUsdCxyKXsidXNlIHN0cmljdCI7ZnVuY3Rpb24gbihlKXtyZXR1cm4gZSYmZS5fX2VzTW9kdWxlP2U6eyJkZWZhdWx0IjplfX1PYmplY3QuZGVmaW5lUHJvcGVydHkociwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSksci5SZXRoaW5rT2JqZWN0PXZvaWQgMDt2YXIgbz1lKCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvY2xhc3NDYWxsQ2hlY2siKSxpPW4obyksYT1lKCJiYWJlbC1ydW50aW1lL2hlbHBlcnMvY3JlYXRlQ2xhc3MiKSxzPW4oYSksdT1lKCJ0djQiKSxsPW4odSksYz1yLlJldGhpbmtPYmplY3Q9ZnVuY3Rpb24oKXtmdW5jdGlvbiBlKHQscil7KDAsaVsiZGVmYXVsdCJdKSh0aGlzLGUpO3RoaXMudmFsaWRhdGlvbj10LHRoaXMuc2NoZW1hPXJ9cmV0dXJuKDAsc1siZGVmYXVsdCJdKShlLFt7a2V5OiJ2YWxpZGF0ZSIsdmFsdWU6ZnVuY3Rpb24oZSl7cmV0dXJuISF0aGlzLnNjaGVtYSYmbFsiZGVmYXVsdCJdLnZhbGlkYXRlKGUsdGhpcy5zY2hlbWEpfX1dKSxlfSgpO3JbImRlZmF1bHQiXT1jfSx7ImJhYmVsLXJ1bnRpbWUvaGVscGVycy9jbGFzc0NhbGxDaGVjayI6MTAsImJhYmVsLXJ1bnRpbWUvaGVscGVycy9jcmVhdGVDbGFzcyI6MTEsdHY0OjEwMH1dfSx7fSxbMTAxXSkoMTAxKX0pOw0KDQoNCn0se31dLDI5OTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQooZnVuY3Rpb24gKGdsb2JhbCwgZmFjdG9yeSkgew0KICBpZiAodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKSB7DQogICAgZGVmaW5lKFsnZXhwb3J0cycsICdtb2R1bGUnXSwgZmFjdG9yeSk7DQogIH0gZWxzZSBpZiAodHlwZW9mIGV4cG9ydHMgIT09ICd1bmRlZmluZWQnICYmIHR5cGVvZiBtb2R1bGUgIT09ICd1bmRlZmluZWQnKSB7DQogICAgZmFjdG9yeShleHBvcnRzLCBtb2R1bGUpOw0KICB9IGVsc2Ugew0KICAgIHZhciBtb2QgPSB7DQogICAgICBleHBvcnRzOiB7fQ0KICAgIH07DQogICAgZmFjdG9yeShtb2QuZXhwb3J0cywgbW9kKTsNCiAgICBnbG9iYWwuaW5kZXggPSBtb2QuZXhwb3J0czsNCiAgfQ0KfSkodGhpcywgZnVuY3Rpb24gKGV4cG9ydHMsIG1vZHVsZSkgew0KICAndXNlIHN0cmljdCc7DQoNCiAgdmFyIGxvY2FsU3RvcmFnZSA9IHVuZGVmaW5lZDsNCiAgaWYgKHR5cGVvZiB3aW5kb3cgPT09ICd1bmRlZmluZWQnKSB7DQogICAgdmFyIExvY2FsU3RvcmFnZSA9IHJlcXVpcmUoJ25vZGUtbG9jYWxzdG9yYWdlJykuTG9jYWxTdG9yYWdlOw0KICAgIGxvY2FsU3RvcmFnZSA9IG5ldyBMb2NhbFN0b3JhZ2UoJy4vdWxzLXNjcmF0Y2gnKTsNCiAgfSBlbHNlIGlmICh0eXBlb2Ygd2luZG93LmxvY2FsU3RvcmFnZSA9PT0gJ3VuZGVmaW5lZCcgfHwgdHlwZW9mIHdpbmRvdy5zZXNzaW9uU3RvcmFnZSA9PT0gJ3VuZGVmaW5lZCcpIHsNCiAgICBsb2NhbFN0b3JhZ2UgPSByZXF1aXJlKCcuL3JlbS1sb2NhbHN0b3JhZ2UnKTsNCiAgfSBlbHNlIHsNCiAgICBsb2NhbFN0b3JhZ2UgPSB3aW5kb3cubG9jYWxTdG9yYWdlOw0KICB9DQogIG1vZHVsZS5leHBvcnRzID0gbG9jYWxTdG9yYWdlOw0KfSk7DQp9LHsiLi9yZW0tbG9jYWxzdG9yYWdlIjozMDAsIm5vZGUtbG9jYWxzdG9yYWdlIjozMDF9XSwzMDA6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KKGZ1bmN0aW9uIChnbG9iYWwsIGZhY3RvcnkpIHsNCiAgaWYgKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkgew0KICAgIGRlZmluZShbJ2V4cG9ydHMnXSwgZmFjdG9yeSk7DQogIH0gZWxzZSBpZiAodHlwZW9mIGV4cG9ydHMgIT09ICd1bmRlZmluZWQnKSB7DQogICAgZmFjdG9yeShleHBvcnRzKTsNCiAgfSBlbHNlIHsNCiAgICB2YXIgbW9kID0gew0KICAgICAgZXhwb3J0czoge30NCiAgICB9Ow0KICAgIGZhY3RvcnkobW9kLmV4cG9ydHMpOw0KICAgIGdsb2JhbC5yZW1Mb2NhbHN0b3JhZ2UgPSBtb2QuZXhwb3J0czsNCiAgfQ0KfSkodGhpcywgZnVuY3Rpb24gKGV4cG9ydHMpIHsNCiAgLy8gQnkgUmVteSBTaGFycCBodHRwczovL2dpc3QuZ2l0aHViLmNvbS9yZW15LzM1MDQzMw0KICAndXNlIHN0cmljdCc7DQoNCiAgaWYgKHR5cGVvZiB3aW5kb3cubG9jYWxTdG9yYWdlID09ICd1bmRlZmluZWQnIHx8IHR5cGVvZiB3aW5kb3cuc2Vzc2lvblN0b3JhZ2UgPT0gJ3VuZGVmaW5lZCcpIChmdW5jdGlvbiAoKSB7DQoNCiAgICB2YXIgU3RvcmFnZSA9IGZ1bmN0aW9uIFN0b3JhZ2UodHlwZSkgew0KICAgICAgZnVuY3Rpb24gY3JlYXRlQ29va2llKG5hbWUsIHZhbHVlLCBkYXlzKSB7DQogICAgICAgIHZhciBkYXRlLCBleHBpcmVzOw0KDQogICAgICAgIGlmIChkYXlzKSB7DQogICAgICAgICAgZGF0ZSA9IG5ldyBEYXRlKCk7DQogICAgICAgICAgZGF0ZS5zZXRUaW1lKGRhdGUuZ2V0VGltZSgpICsgZGF5cyAqIDI0ICogNjAgKiA2MCAqIDEwMDApOw0KICAgICAgICAgIGV4cGlyZXMgPSAnOyBleHBpcmVzPScgKyBkYXRlLnRvR01UU3RyaW5nKCk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgZXhwaXJlcyA9ICcnOw0KICAgICAgICB9DQogICAgICAgIGRvY3VtZW50LmNvb2tpZSA9IG5hbWUgKyAnPScgKyB2YWx1ZSArIGV4cGlyZXMgKyAnOyBwYXRoPS8nOw0KICAgICAgfQ0KDQogICAgICBmdW5jdGlvbiByZWFkQ29va2llKG5hbWUpIHsNCiAgICAgICAgdmFyIG5hbWVFUSA9IG5hbWUgKyAnPScsDQogICAgICAgICAgICBjYSA9IGRvY3VtZW50LmNvb2tpZS5zcGxpdCgnOycpLA0KICAgICAgICAgICAgaSwNCiAgICAgICAgICAgIGM7DQoNCiAgICAgICAgZm9yIChpID0gMDsgaSA8IGNhLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgYyA9IGNhW2ldOw0KICAgICAgICAgIHdoaWxlIChjLmNoYXJBdCgwKSA9PSAnICcpIHsNCiAgICAgICAgICAgIGMgPSBjLnN1YnN0cmluZygxLCBjLmxlbmd0aCk7DQogICAgICAgICAgfQ0KDQogICAgICAgICAgaWYgKGMuaW5kZXhPZihuYW1lRVEpID09IDApIHsNCiAgICAgICAgICAgIHJldHVybiBjLnN1YnN0cmluZyhuYW1lRVEubGVuZ3RoLCBjLmxlbmd0aCk7DQogICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIHJldHVybiBudWxsOw0KICAgICAgfQ0KDQogICAgICBmdW5jdGlvbiBzZXREYXRhKGRhdGEpIHsNCiAgICAgICAgZGF0YSA9IEpTT04uc3RyaW5naWZ5KGRhdGEpOw0KICAgICAgICBpZiAodHlwZSA9PSAnc2Vzc2lvbicpIHsNCiAgICAgICAgICB3aW5kb3cubmFtZSA9IGRhdGE7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgY3JlYXRlQ29va2llKCdsb2NhbFN0b3JhZ2UnLCBkYXRhLCAzNjUpOw0KICAgICAgICB9DQogICAgICB9DQoNCiAgICAgIGZ1bmN0aW9uIGNsZWFyRGF0YSgpIHsNCiAgICAgICAgaWYgKHR5cGUgPT0gJ3Nlc3Npb24nKSB7DQogICAgICAgICAgd2luZG93Lm5hbWUgPSAnJzsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICBjcmVhdGVDb29raWUoJ2xvY2FsU3RvcmFnZScsICcnLCAzNjUpOw0KICAgICAgICB9DQogICAgICB9DQoNCiAgICAgIGZ1bmN0aW9uIGdldERhdGEoKSB7DQogICAgICAgIHZhciBkYXRhID0gdHlwZSA9PSAnc2Vzc2lvbicgPyB3aW5kb3cubmFtZSA6IHJlYWRDb29raWUoJ2xvY2FsU3RvcmFnZScpOw0KICAgICAgICByZXR1cm4gZGF0YSA/IEpTT04ucGFyc2UoZGF0YSkgOiB7fTsNCiAgICAgIH0NCg0KICAgICAgLy8gaW5pdGlhbGlzZSBpZiB0aGVyZSdzIGFscmVhZHkgZGF0YQ0KICAgICAgdmFyIGRhdGEgPSBnZXREYXRhKCk7DQoNCiAgICAgIHJldHVybiB7DQogICAgICAgIGxlbmd0aDogMCwNCiAgICAgICAgY2xlYXI6IGZ1bmN0aW9uIGNsZWFyKCkgew0KICAgICAgICAgIGRhdGEgPSB7fTsNCiAgICAgICAgICB0aGlzLmxlbmd0aCA9IDA7DQogICAgICAgICAgY2xlYXJEYXRhKCk7DQogICAgICAgIH0sDQogICAgICAgIGdldEl0ZW06IGZ1bmN0aW9uIGdldEl0ZW0oa2V5KSB7DQogICAgICAgICAgcmV0dXJuIGRhdGFba2V5XSA9PT0gdW5kZWZpbmVkID8gbnVsbCA6IGRhdGFba2V5XTsNCiAgICAgICAgfSwNCiAgICAgICAga2V5OiBmdW5jdGlvbiBrZXkoaSkgew0KICAgICAgICAgIC8vIG5vdCBwZXJmZWN0LCBidXQgd29ya3MNCiAgICAgICAgICB2YXIgY3RyID0gMDsNCiAgICAgICAgICBmb3IgKHZhciBrIGluIGRhdGEpIHsNCiAgICAgICAgICAgIGlmIChjdHIgPT0gaSkgcmV0dXJuIGs7ZWxzZSBjdHIrKzsNCiAgICAgICAgICB9DQogICAgICAgICAgcmV0dXJuIG51bGw7DQogICAgICAgIH0sDQogICAgICAgIHJlbW92ZUl0ZW06IGZ1bmN0aW9uIHJlbW92ZUl0ZW0oa2V5KSB7DQogICAgICAgICAgZGVsZXRlIGRhdGFba2V5XTsNCiAgICAgICAgICB0aGlzLmxlbmd0aC0tOw0KICAgICAgICAgIHNldERhdGEoZGF0YSk7DQogICAgICAgIH0sDQogICAgICAgIHNldEl0ZW06IGZ1bmN0aW9uIHNldEl0ZW0oa2V5LCB2YWx1ZSkgew0KICAgICAgICAgIGRhdGFba2V5XSA9IHZhbHVlICsgJyc7IC8vIGZvcmNlcyB0aGUgdmFsdWUgdG8gYSBzdHJpbmcNCiAgICAgICAgICB0aGlzLmxlbmd0aCsrOw0KICAgICAgICAgIHNldERhdGEoZGF0YSk7DQogICAgICAgIH0NCiAgICAgIH07DQogICAgfTsNCg0KICAgIGlmICh0eXBlb2Ygd2luZG93LmxvY2FsU3RvcmFnZSA9PSAndW5kZWZpbmVkJykgd2luZG93LmxvY2FsU3RvcmFnZSA9IG5ldyBTdG9yYWdlKCdsb2NhbCcpOw0KICAgIGlmICh0eXBlb2Ygd2luZG93LnNlc3Npb25TdG9yYWdlID09ICd1bmRlZmluZWQnKSB3aW5kb3cuc2Vzc2lvblN0b3JhZ2UgPSBuZXcgU3RvcmFnZSgnc2Vzc2lvbicpOw0KICB9KSgpOw0KfSk7DQp9LHt9XSwzMDE6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KLy8gR2VuZXJhdGVkIGJ5IENvZmZlZVNjcmlwdCAxLjkuMA0KKGZ1bmN0aW9uKCkgew0KICB2YXIgSlNPTlN0b3JhZ2UsIExvY2FsU3RvcmFnZSwgUVVPVEFfRVhDRUVERURfRVJSLCBTdG9yYWdlRXZlbnQsIGV2ZW50cywgZnMsIHBhdGgsIF9lbXB0eURpcmVjdG9yeSwgX3JtLA0KICAgIF9fZXh0ZW5kcyA9IGZ1bmN0aW9uKGNoaWxkLCBwYXJlbnQpIHsgZm9yICh2YXIga2V5IGluIHBhcmVudCkgeyBpZiAoX19oYXNQcm9wLmNhbGwocGFyZW50LCBrZXkpKSBjaGlsZFtrZXldID0gcGFyZW50W2tleV07IH0gZnVuY3Rpb24gY3RvcigpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGNoaWxkOyB9IGN0b3IucHJvdG90eXBlID0gcGFyZW50LnByb3RvdHlwZTsgY2hpbGQucHJvdG90eXBlID0gbmV3IGN0b3IoKTsgY2hpbGQuX19zdXBlcl9fID0gcGFyZW50LnByb3RvdHlwZTsgcmV0dXJuIGNoaWxkOyB9LA0KICAgIF9faGFzUHJvcCA9IHt9Lmhhc093blByb3BlcnR5Ow0KDQogIHBhdGggPSByZXF1aXJlKCdwYXRoJyk7DQoNCiAgZnMgPSByZXF1aXJlKCdmcycpOw0KDQogIGV2ZW50cyA9IHJlcXVpcmUoJ2V2ZW50cycpOw0KDQogIF9lbXB0eURpcmVjdG9yeSA9IGZ1bmN0aW9uKHRhcmdldCkgew0KICAgIHZhciBwLCBfaSwgX2xlbiwgX3JlZiwgX3Jlc3VsdHM7DQogICAgX3JlZiA9IGZzLnJlYWRkaXJTeW5jKHRhcmdldCk7DQogICAgX3Jlc3VsdHMgPSBbXTsNCiAgICBmb3IgKF9pID0gMCwgX2xlbiA9IF9yZWYubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHsNCiAgICAgIHAgPSBfcmVmW19pXTsNCiAgICAgIF9yZXN1bHRzLnB1c2goX3JtKHBhdGguam9pbih0YXJnZXQsIHApKSk7DQogICAgfQ0KICAgIHJldHVybiBfcmVzdWx0czsNCiAgfTsNCg0KICBfcm0gPSBmdW5jdGlvbih0YXJnZXQpIHsNCiAgICBpZiAoZnMuc3RhdFN5bmModGFyZ2V0KS5pc0RpcmVjdG9yeSgpKSB7DQogICAgICBfZW1wdHlEaXJlY3RvcnkodGFyZ2V0KTsNCiAgICAgIHJldHVybiBmcy5ybWRpclN5bmModGFyZ2V0KTsNCiAgICB9IGVsc2Ugew0KICAgICAgcmV0dXJuIGZzLnVubGlua1N5bmModGFyZ2V0KTsNCiAgICB9DQogIH07DQoNCiAgUVVPVEFfRVhDRUVERURfRVJSID0gKGZ1bmN0aW9uKF9zdXBlcikgew0KICAgIF9fZXh0ZW5kcyhRVU9UQV9FWENFRURFRF9FUlIsIF9zdXBlcik7DQoNCiAgICBmdW5jdGlvbiBRVU9UQV9FWENFRURFRF9FUlIoX2F0X21lc3NhZ2UpIHsNCiAgICAgIHRoaXMubWVzc2FnZSA9IF9hdF9tZXNzYWdlICE9IG51bGwgPyBfYXRfbWVzc2FnZSA6ICdVbmtub3duIGVycm9yLic7DQogICAgICBpZiAoRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UgIT0gbnVsbCkgew0KICAgICAgICBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSh0aGlzLCB0aGlzLmNvbnN0cnVjdG9yKTsNCiAgICAgIH0NCiAgICAgIHRoaXMubmFtZSA9IHRoaXMuY29uc3RydWN0b3IubmFtZTsNCiAgICB9DQoNCiAgICBRVU9UQV9FWENFRURFRF9FUlIucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24oKSB7DQogICAgICByZXR1cm4gdGhpcy5uYW1lICsgIjogIiArIHRoaXMubWVzc2FnZTsNCiAgICB9Ow0KDQogICAgcmV0dXJuIFFVT1RBX0VYQ0VFREVEX0VSUjsNCg0KICB9KShFcnJvcik7DQoNCiAgU3RvcmFnZUV2ZW50ID0gKGZ1bmN0aW9uKCkgew0KICAgIGZ1bmN0aW9uIFN0b3JhZ2VFdmVudChfYXRfa2V5LCBfYXRfb2xkVmFsdWUsIF9hdF9uZXdWYWx1ZSwgX2F0X3VybCwgX2F0X3N0b3JhZ2VBcmVhKSB7DQogICAgICB0aGlzLmtleSA9IF9hdF9rZXk7DQogICAgICB0aGlzLm9sZFZhbHVlID0gX2F0X29sZFZhbHVlOw0KICAgICAgdGhpcy5uZXdWYWx1ZSA9IF9hdF9uZXdWYWx1ZTsNCiAgICAgIHRoaXMudXJsID0gX2F0X3VybDsNCiAgICAgIHRoaXMuc3RvcmFnZUFyZWEgPSBfYXRfc3RvcmFnZUFyZWEgIT0gbnVsbCA/IF9hdF9zdG9yYWdlQXJlYSA6ICdsb2NhbFN0b3JhZ2UnOw0KICAgIH0NCg0KICAgIHJldHVybiBTdG9yYWdlRXZlbnQ7DQoNCiAgfSkoKTsNCg0KICBMb2NhbFN0b3JhZ2UgPSAoZnVuY3Rpb24oX3N1cGVyKSB7DQogICAgdmFyIE1ldGFLZXksIGNyZWF0ZU1hcDsNCg0KICAgIF9fZXh0ZW5kcyhMb2NhbFN0b3JhZ2UsIF9zdXBlcik7DQoNCiAgICBmdW5jdGlvbiBMb2NhbFN0b3JhZ2UoX2F0X2xvY2F0aW9uLCBfYXRfcXVvdGEpIHsNCiAgICAgIHRoaXMubG9jYXRpb24gPSBfYXRfbG9jYXRpb247DQogICAgICB0aGlzLnF1b3RhID0gX2F0X3F1b3RhICE9IG51bGwgPyBfYXRfcXVvdGEgOiA1ICogMTAyNCAqIDEwMjQ7DQogICAgICBpZiAoISh0aGlzIGluc3RhbmNlb2YgTG9jYWxTdG9yYWdlKSkgew0KICAgICAgICByZXR1cm4gbmV3IExvY2FsU3RvcmFnZSh0aGlzLmxvY2F0aW9uLCB0aGlzLnF1b3RhKTsNCiAgICAgIH0NCiAgICAgIHRoaXMubGVuZ3RoID0gMDsNCiAgICAgIHRoaXMuYnl0ZXNJblVzZSA9IDA7DQogICAgICB0aGlzLmtleXMgPSBbXTsNCiAgICAgIHRoaXMubWV0YUtleU1hcCA9IGNyZWF0ZU1hcCgpOw0KICAgICAgdGhpcy5ldmVudFVybCA9ICJwaWQ6IiArIHByb2Nlc3MucGlkOw0KICAgICAgdGhpcy5faW5pdCgpOw0KICAgICAgdGhpcy5RVU9UQV9FWENFRURFRF9FUlIgPSBRVU9UQV9FWENFRURFRF9FUlI7DQogICAgfQ0KDQogICAgTWV0YUtleSA9IChmdW5jdGlvbigpIHsNCiAgICAgIGZ1bmN0aW9uIE1ldGFLZXkoX2F0X2tleSwgX2F0X2luZGV4KSB7DQogICAgICAgIHRoaXMua2V5ID0gX2F0X2tleTsNCiAgICAgICAgdGhpcy5pbmRleCA9IF9hdF9pbmRleDsNCiAgICAgICAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIE1ldGFLZXkpKSB7DQogICAgICAgICAgcmV0dXJuIG5ldyBNZXRhS2V5KHRoaXMua2V5LCB0aGlzLmluZGV4KTsNCiAgICAgICAgfQ0KICAgICAgfQ0KDQogICAgICByZXR1cm4gTWV0YUtleTsNCg0KICAgIH0pKCk7DQoNCiAgICBjcmVhdGVNYXAgPSBmdW5jdGlvbigpIHsNCiAgICAgIHZhciBNYXA7DQogICAgICBNYXAgPSBmdW5jdGlvbigpIHt9Ow0KICAgICAgTWFwLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUobnVsbCk7DQogICAgICByZXR1cm4gbmV3IE1hcCgpOw0KICAgIH07DQoNCiAgICBMb2NhbFN0b3JhZ2UucHJvdG90eXBlLl9pbml0ID0gZnVuY3Rpb24oKSB7DQogICAgICB2YXIgaW5kZXgsIGssIHN0YXQsIF9NZXRhS2V5LCBfZGVjb2RlZEtleSwgX2ksIF9rZXlzLCBfbGVuOw0KICAgICAgaWYgKGZzLmV4aXN0c1N5bmModGhpcy5sb2NhdGlvbikpIHsNCiAgICAgICAgaWYgKCFmcy5zdGF0U3luYyh0aGlzLmxvY2F0aW9uKS5pc0RpcmVjdG9yeSgpKSB7DQogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJBIGZpbGUgZXhpc3RzIGF0IHRoZSBsb2NhdGlvbiAnIiArIHRoaXMubG9jYXRpb24gKyAiJyB3aGVuIHRyeWluZyB0byBjcmVhdGUvb3BlbiBsb2NhbFN0b3JhZ2UiKTsNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgICAgdGhpcy5ieXRlc0luVXNlID0gMDsNCiAgICAgIHRoaXMubGVuZ3RoID0gMDsNCiAgICAgIGlmICghZnMuZXhpc3RzU3luYyh0aGlzLmxvY2F0aW9uKSkgew0KICAgICAgICBmcy5ta2RpclN5bmModGhpcy5sb2NhdGlvbik7DQogICAgICAgIHJldHVybjsNCiAgICAgIH0NCiAgICAgIF9rZXlzID0gZnMucmVhZGRpclN5bmModGhpcy5sb2NhdGlvbik7DQogICAgICBmb3IgKGluZGV4ID0gX2kgPSAwLCBfbGVuID0gX2tleXMubGVuZ3RoOyBfaSA8IF9sZW47IGluZGV4ID0gKytfaSkgew0KICAgICAgICBrID0gX2tleXNbaW5kZXhdOw0KICAgICAgICBfZGVjb2RlZEtleSA9IGRlY29kZVVSSUNvbXBvbmVudChrKTsNCiAgICAgICAgdGhpcy5rZXlzLnB1c2goX2RlY29kZWRLZXkpOw0KICAgICAgICBfTWV0YUtleSA9IG5ldyBNZXRhS2V5KGssIGluZGV4KTsNCiAgICAgICAgdGhpcy5tZXRhS2V5TWFwW19kZWNvZGVkS2V5XSA9IF9NZXRhS2V5Ow0KICAgICAgICBzdGF0ID0gdGhpcy5nZXRTdGF0KGspOw0KICAgICAgICBpZiAoKHN0YXQgIT0gbnVsbCA/IHN0YXQuc2l6ZSA6IHZvaWQgMCkgIT0gbnVsbCkgew0KICAgICAgICAgIF9NZXRhS2V5LnNpemUgPSBzdGF0LnNpemU7DQogICAgICAgICAgdGhpcy5ieXRlc0luVXNlICs9IHN0YXQuc2l6ZTsNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgICAgcmV0dXJuIHRoaXMubGVuZ3RoID0gX2tleXMubGVuZ3RoOw0KICAgIH07DQoNCiAgICBMb2NhbFN0b3JhZ2UucHJvdG90eXBlLnNldEl0ZW0gPSBmdW5jdGlvbihrZXksIHZhbHVlKSB7DQogICAgICB2YXIgZW5jb2RlZEtleSwgZXZudCwgZXhpc3RzQmVmb3JlU2V0LCBmaWxlbmFtZSwgaGFzTGlzdGVuZXJzLCBtZXRhS2V5LCBvbGRMZW5ndGgsIG9sZFZhbHVlLCB2YWx1ZVN0cmluZywgdmFsdWVTdHJpbmdMZW5ndGg7DQogICAgICBoYXNMaXN0ZW5lcnMgPSBldmVudHMuRXZlbnRFbWl0dGVyLmxpc3RlbmVyQ291bnQodGhpcywgJ3N0b3JhZ2UnKTsNCiAgICAgIG9sZFZhbHVlID0gbnVsbDsNCiAgICAgIGlmIChoYXNMaXN0ZW5lcnMpIHsNCiAgICAgICAgb2xkVmFsdWUgPSB0aGlzLmdldEl0ZW0oa2V5KTsNCiAgICAgIH0NCiAgICAgIGtleSA9IGtleS50b1N0cmluZygpOw0KICAgICAgZW5jb2RlZEtleSA9IGVuY29kZVVSSUNvbXBvbmVudChrZXkpOw0KICAgICAgZmlsZW5hbWUgPSBwYXRoLmpvaW4odGhpcy5sb2NhdGlvbiwgZW5jb2RlZEtleSk7DQogICAgICB2YWx1ZVN0cmluZyA9IHZhbHVlLnRvU3RyaW5nKCk7DQogICAgICB2YWx1ZVN0cmluZ0xlbmd0aCA9IHZhbHVlU3RyaW5nLmxlbmd0aDsNCiAgICAgIG1ldGFLZXkgPSB0aGlzLm1ldGFLZXlNYXBba2V5XTsNCiAgICAgIGV4aXN0c0JlZm9yZVNldCA9ICEhbWV0YUtleTsNCiAgICAgIGlmIChleGlzdHNCZWZvcmVTZXQpIHsNCiAgICAgICAgb2xkTGVuZ3RoID0gbWV0YUtleS5zaXplOw0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgb2xkTGVuZ3RoID0gMDsNCiAgICAgIH0NCiAgICAgIGlmICh0aGlzLmJ5dGVzSW5Vc2UgLSBvbGRMZW5ndGggKyB2YWx1ZVN0cmluZ0xlbmd0aCA+IHRoaXMucXVvdGEpIHsNCiAgICAgICAgdGhyb3cgbmV3IFFVT1RBX0VYQ0VFREVEX0VSUigpOw0KICAgICAgfQ0KICAgICAgZnMud3JpdGVGaWxlU3luYyhmaWxlbmFtZSwgdmFsdWVTdHJpbmcsICd1dGY4Jyk7DQogICAgICBpZiAoIWV4aXN0c0JlZm9yZVNldCkgew0KICAgICAgICBtZXRhS2V5ID0gbmV3IE1ldGFLZXkoZW5jb2RlZEtleSwgKHRoaXMua2V5cy5wdXNoKGtleSkpIC0gMSk7DQogICAgICAgIG1ldGFLZXkuc2l6ZSA9IHZhbHVlU3RyaW5nTGVuZ3RoOw0KICAgICAgICB0aGlzLm1ldGFLZXlNYXBba2V5XSA9IG1ldGFLZXk7DQogICAgICAgIHRoaXMubGVuZ3RoICs9IDE7DQogICAgICAgIHRoaXMuYnl0ZXNJblVzZSArPSB2YWx1ZVN0cmluZ0xlbmd0aDsNCiAgICAgIH0NCiAgICAgIGlmIChoYXNMaXN0ZW5lcnMpIHsNCiAgICAgICAgZXZudCA9IG5ldyBTdG9yYWdlRXZlbnQoa2V5LCBvbGRWYWx1ZSwgdmFsdWUsIHRoaXMuZXZlbnRVcmwpOw0KICAgICAgICByZXR1cm4gdGhpcy5lbWl0KCdzdG9yYWdlJywgZXZudCk7DQogICAgICB9DQogICAgfTsNCg0KICAgIExvY2FsU3RvcmFnZS5wcm90b3R5cGUuZ2V0SXRlbSA9IGZ1bmN0aW9uKGtleSkgew0KICAgICAgdmFyIGZpbGVuYW1lLCBtZXRhS2V5Ow0KICAgICAga2V5ID0ga2V5LnRvU3RyaW5nKCk7DQogICAgICBtZXRhS2V5ID0gdGhpcy5tZXRhS2V5TWFwW2tleV07DQogICAgICBpZiAoISFtZXRhS2V5KSB7DQogICAgICAgIGZpbGVuYW1lID0gcGF0aC5qb2luKHRoaXMubG9jYXRpb24sIG1ldGFLZXkua2V5KTsNCiAgICAgICAgcmV0dXJuIGZzLnJlYWRGaWxlU3luYyhmaWxlbmFtZSwgJ3V0ZjgnKTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIHJldHVybiBudWxsOw0KICAgICAgfQ0KICAgIH07DQoNCiAgICBMb2NhbFN0b3JhZ2UucHJvdG90eXBlLmdldFN0YXQgPSBmdW5jdGlvbihrZXkpIHsNCiAgICAgIHZhciBmaWxlbmFtZTsNCiAgICAgIGtleSA9IGtleS50b1N0cmluZygpOw0KICAgICAgZmlsZW5hbWUgPSBwYXRoLmpvaW4odGhpcy5sb2NhdGlvbiwgZW5jb2RlVVJJQ29tcG9uZW50KGtleSkpOw0KICAgICAgaWYgKGZzLmV4aXN0c1N5bmMoZmlsZW5hbWUpKSB7DQogICAgICAgIHJldHVybiBmcy5zdGF0U3luYyhmaWxlbmFtZSk7DQogICAgICB9IGVsc2Ugew0KICAgICAgICByZXR1cm4gbnVsbDsNCiAgICAgIH0NCiAgICB9Ow0KDQogICAgTG9jYWxTdG9yYWdlLnByb3RvdHlwZS5yZW1vdmVJdGVtID0gZnVuY3Rpb24oa2V5KSB7DQogICAgICB2YXIgZXZudCwgZmlsZW5hbWUsIGhhc0xpc3RlbmVycywgaywgbWV0YSwgbWV0YUtleSwgb2xkVmFsdWUsIHYsIF9yZWY7DQogICAgICBrZXkgPSBrZXkudG9TdHJpbmcoKTsNCiAgICAgIG1ldGFLZXkgPSB0aGlzLm1ldGFLZXlNYXBba2V5XTsNCiAgICAgIGlmICghIW1ldGFLZXkpIHsNCiAgICAgICAgaGFzTGlzdGVuZXJzID0gZXZlbnRzLkV2ZW50RW1pdHRlci5saXN0ZW5lckNvdW50KHRoaXMsICdzdG9yYWdlJyk7DQogICAgICAgIG9sZFZhbHVlID0gbnVsbDsNCiAgICAgICAgaWYgKGhhc0xpc3RlbmVycykgew0KICAgICAgICAgIG9sZFZhbHVlID0gdGhpcy5nZXRJdGVtKGtleSk7DQogICAgICAgIH0NCiAgICAgICAgZGVsZXRlIHRoaXMubWV0YUtleU1hcFtrZXldOw0KICAgICAgICB0aGlzLmxlbmd0aCAtPSAxOw0KICAgICAgICB0aGlzLmJ5dGVzSW5Vc2UgLT0gbWV0YUtleS5zaXplOw0KICAgICAgICBmaWxlbmFtZSA9IHBhdGguam9pbih0aGlzLmxvY2F0aW9uLCBtZXRhS2V5LmtleSk7DQogICAgICAgIHRoaXMua2V5cy5zcGxpY2UobWV0YUtleS5pbmRleCwgMSk7DQogICAgICAgIF9yZWYgPSB0aGlzLm1ldGFLZXlNYXA7DQogICAgICAgIGZvciAoayBpbiBfcmVmKSB7DQogICAgICAgICAgdiA9IF9yZWZba107DQogICAgICAgICAgbWV0YSA9IHRoaXMubWV0YUtleU1hcFtrXTsNCiAgICAgICAgICBpZiAobWV0YS5pbmRleCA+IG1ldGFLZXkuaW5kZXgpIHsNCiAgICAgICAgICAgIG1ldGEuaW5kZXggLT0gMTsNCiAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgX3JtKGZpbGVuYW1lKTsNCiAgICAgICAgaWYgKGhhc0xpc3RlbmVycykgew0KICAgICAgICAgIGV2bnQgPSBuZXcgU3RvcmFnZUV2ZW50KGtleSwgb2xkVmFsdWUsIG51bGwsIHRoaXMuZXZlbnRVcmwpOw0KICAgICAgICAgIHJldHVybiB0aGlzLmVtaXQoJ3N0b3JhZ2UnLCBldm50KTsNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgIH07DQoNCiAgICBMb2NhbFN0b3JhZ2UucHJvdG90eXBlLmtleSA9IGZ1bmN0aW9uKG4pIHsNCiAgICAgIHJldHVybiB0aGlzLmtleXNbbl07DQogICAgfTsNCg0KICAgIExvY2FsU3RvcmFnZS5wcm90b3R5cGUuY2xlYXIgPSBmdW5jdGlvbigpIHsNCiAgICAgIHZhciBldm50Ow0KICAgICAgX2VtcHR5RGlyZWN0b3J5KHRoaXMubG9jYXRpb24pOw0KICAgICAgdGhpcy5tZXRhS2V5TWFwID0gY3JlYXRlTWFwKCk7DQogICAgICB0aGlzLmtleXMgPSBbXTsNCiAgICAgIHRoaXMubGVuZ3RoID0gMDsNCiAgICAgIHRoaXMuYnl0ZXNJblVzZSA9IDA7DQogICAgICBpZiAoZXZlbnRzLkV2ZW50RW1pdHRlci5saXN0ZW5lckNvdW50KHRoaXMsICdzdG9yYWdlJykpIHsNCiAgICAgICAgZXZudCA9IG5ldyBTdG9yYWdlRXZlbnQobnVsbCwgbnVsbCwgbnVsbCwgdGhpcy5ldmVudFVybCk7DQogICAgICAgIHJldHVybiB0aGlzLmVtaXQoJ3N0b3JhZ2UnLCBldm50KTsNCiAgICAgIH0NCiAgICB9Ow0KDQogICAgTG9jYWxTdG9yYWdlLnByb3RvdHlwZS5nZXRCeXRlc0luVXNlID0gZnVuY3Rpb24oKSB7DQogICAgICByZXR1cm4gdGhpcy5ieXRlc0luVXNlOw0KICAgIH07DQoNCiAgICBMb2NhbFN0b3JhZ2UucHJvdG90eXBlLl9kZWxldGVMb2NhdGlvbiA9IGZ1bmN0aW9uKCkgew0KICAgICAgX3JtKHRoaXMubG9jYXRpb24pOw0KICAgICAgdGhpcy5tZXRhS2V5TWFwID0ge307DQogICAgICB0aGlzLmtleXMgPSBbXTsNCiAgICAgIHRoaXMubGVuZ3RoID0gMDsNCiAgICAgIHJldHVybiB0aGlzLmJ5dGVzSW5Vc2UgPSAwOw0KICAgIH07DQoNCiAgICByZXR1cm4gTG9jYWxTdG9yYWdlOw0KDQogIH0pKGV2ZW50cy5FdmVudEVtaXR0ZXIpOw0KDQogIEpTT05TdG9yYWdlID0gKGZ1bmN0aW9uKF9zdXBlcikgew0KICAgIF9fZXh0ZW5kcyhKU09OU3RvcmFnZSwgX3N1cGVyKTsNCg0KICAgIGZ1bmN0aW9uIEpTT05TdG9yYWdlKCkgew0KICAgICAgcmV0dXJuIEpTT05TdG9yYWdlLl9fc3VwZXJfXy5jb25zdHJ1Y3Rvci5hcHBseSh0aGlzLCBhcmd1bWVudHMpOw0KICAgIH0NCg0KICAgIEpTT05TdG9yYWdlLnByb3RvdHlwZS5zZXRJdGVtID0gZnVuY3Rpb24oa2V5LCB2YWx1ZSkgew0KICAgICAgdmFyIG5ld1ZhbHVlOw0KICAgICAgbmV3VmFsdWUgPSBKU09OLnN0cmluZ2lmeSh2YWx1ZSk7DQogICAgICByZXR1cm4gSlNPTlN0b3JhZ2UuX19zdXBlcl9fLnNldEl0ZW0uY2FsbCh0aGlzLCBrZXksIG5ld1ZhbHVlKTsNCiAgICB9Ow0KDQogICAgSlNPTlN0b3JhZ2UucHJvdG90eXBlLmdldEl0ZW0gPSBmdW5jdGlvbihrZXkpIHsNCiAgICAgIHJldHVybiBKU09OLnBhcnNlKEpTT05TdG9yYWdlLl9fc3VwZXJfXy5nZXRJdGVtLmNhbGwodGhpcywga2V5KSk7DQogICAgfTsNCg0KICAgIHJldHVybiBKU09OU3RvcmFnZTsNCg0KICB9KShMb2NhbFN0b3JhZ2UpOw0KDQogIGV4cG9ydHMuTG9jYWxTdG9yYWdlID0gTG9jYWxTdG9yYWdlOw0KDQogIGV4cG9ydHMuSlNPTlN0b3JhZ2UgPSBKU09OU3RvcmFnZTsNCg0KICBleHBvcnRzLlFVT1RBX0VYQ0VFREVEX0VSUiA9IFFVT1RBX0VYQ0VFREVEX0VSUjsNCg0KfSkuY2FsbCh0aGlzKTsNCg0KfSx7ImV2ZW50cyI6dW5kZWZpbmVkLCJmcyI6dW5kZWZpbmVkLCJwYXRoIjp1bmRlZmluZWR9XSwzMDI6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KJ3VzZSBzdHJpY3QnOw0KDQpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7DQogIHZhbHVlOiB0cnVlDQp9KTsNCg0KdmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmICgidmFsdWUiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7DQoNCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7IH0gfQ0KDQovKioNCiogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHn428gZSBTaXN0ZW1hcyBTQQ0KKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRA0KKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0wNCiogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYNCiogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBDQoqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUcNCiogQ29weXJpZ2h0IDIwMTYgQXBpemVlDQoqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElODQoqDQoqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOw0KKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuDQoqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdA0KKg0KKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMA0KKg0KKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlDQoqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsDQoqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLg0KKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kDQoqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLg0KKiovDQoNCi8qKg0KKiBAYXV0aG9yIG1pY2FlbHBlZHJvc2FAZ21haWwuY29tDQoqIE1pbmltYWwgaW50ZXJmYWNlIGFuZCBpbXBsZW1lbnRhdGlvbiB0byBzZW5kIGFuZCByZWNlaXZlIG1lc3NhZ2VzLiBJdCBjYW4gYmUgcmV1c2VkIGluIG1hbnkgdHlwZSBvZiBjb21wb25lbnRzLg0KKiBDb21wb25lbnRzIHRoYXQgbmVlZCBhIG1lc3NhZ2Ugc3lzdGVtIHNob3VsZCByZWNlaXZlIHRoaXMgY2xhc3MgYXMgYSBkZXBlbmRlbmN5IG9yIGV4dGVuZCBpdC4NCiogRXh0ZW5zaW9ucyBzaG91bGQgaW1wbGVtZW50IHRoZSBmb2xsb3dpbmcgcHJpdmF0ZSBtZXRob2RzOiBfb25Qb3N0TWVzc2FnZSBhbmQgX3JlZ2lzdGVyRXh0ZXJuYWxMaXN0ZW5lcg0KKi8NCg0KdmFyIEJ1cyA9IGZ1bmN0aW9uICgpIHsNCiAgLyogcHJpdmF0ZQ0KICBfbXNnSWQ6IG51bWJlcjsNCiAgX3N1YnNjcmlwdGlvbnM6IDx1cmw6IE1zZ0xpc3RlbmVyW10+DQogICBfcmVzcG9uc2VUaW1lT3V0OiBudW1iZXINCiAgX3Jlc3BvbnNlQ2FsbGJhY2tzOiA8dXJsK2lkOiAobXNnKSA9PiB2b2lkPg0KICAgKi8NCg0KICBmdW5jdGlvbiBCdXMoKSB7DQogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEJ1cyk7DQoNCiAgICB2YXIgX3RoaXMgPSB0aGlzOw0KICAgIF90aGlzLl9tc2dJZCA9IDA7DQogICAgX3RoaXMuX3N1YnNjcmlwdGlvbnMgPSB7fTsNCg0KICAgIF90aGlzLl9yZXNwb25zZVRpbWVPdXQgPSA1MDAwOyAvL2RlZmF1bHQgdG8gM3MNCiAgICBfdGhpcy5fcmVzcG9uc2VDYWxsYmFja3MgPSB7fTsNCg0KICAgIF90aGlzLl9yZWdpc3RlckV4dGVybmFsTGlzdGVuZXIoKTsNCiAgfQ0KDQogIC8qKg0KICAqIFJlZ2lzdGVyIGxpc3RlbmVyIHRvIHJlY2VpdmUgbWVzc2FnZSB3aGVuICJtc2cudG8gPT09IHVybCIuDQogICogU3BlY2lhbCB1cmwgIioiIGZvciBkZWZhdWx0IGxpc3RlbmVyIGlzIGFjY2VwdGVkIHRvIGludGVyY2VwdCBhbGwgbWVzc2FnZXMuDQogICogQHBhcmFtIHtVUkx9IHVybCBBZGRyZXNzIHRvIGludGVyY2VwdCwgdGhhIGlzIGluIHRoZSBtZXNzYWdlICJ0byINCiAgKiBAcGFyYW0ge0xpc3RlbmVyfSBsaXN0ZW5lciBsaXN0ZW5lcg0KICAqIEByZXR1cm4ge01zZ0xpc3RlbmVyfSBpbnN0YW5jZSBvZiBNc2dMaXN0ZW5lcg0KICAqLw0KDQoNCiAgX2NyZWF0ZUNsYXNzKEJ1cywgW3sNCiAgICBrZXk6ICdhZGRMaXN0ZW5lcicsDQogICAgdmFsdWU6IGZ1bmN0aW9uIGFkZExpc3RlbmVyKHVybCwgbGlzdGVuZXIpIHsNCiAgICAgIHZhciBfdGhpcyA9IHRoaXM7DQoNCiAgICAgIHZhciBpdGVtID0gbmV3IE1zZ0xpc3RlbmVyKF90aGlzLl9zdWJzY3JpcHRpb25zLCB1cmwsIGxpc3RlbmVyKTsNCiAgICAgIHZhciBpdGVtTGlzdCA9IF90aGlzLl9zdWJzY3JpcHRpb25zW3VybF07DQogICAgICBpZiAoIWl0ZW1MaXN0KSB7DQogICAgICAgIGl0ZW1MaXN0ID0gW107DQogICAgICAgIF90aGlzLl9zdWJzY3JpcHRpb25zW3VybF0gPSBpdGVtTGlzdDsNCiAgICAgIH0NCg0KICAgICAgaXRlbUxpc3QucHVzaChpdGVtKTsNCiAgICAgIHJldHVybiBpdGVtOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIE1hbnVhbGx5IGFkZCBhIHJlc3BvbnNlIGxpc3RlbmVyLiBPbmx5IG9uZSBsaXN0ZW5lciBwZXIgbWVzc2FnZSBJRCBzaG91bGQgZXhpc3QuDQogICAgICogQVRFTlRJT04sIHRoZXJlIGlzIG5vIHRpbWVvdXQgZm9yIHRoaXMgbGlzdGVuZXIuDQogICAgICogVGhlIGxpc3RlbmVyIHNob3VsZCBiZSByZW1vdmVkIHdpdGggYSByZW1vdmVSZXNwb25zZUxpc3RlbmVyLCBmYWlsaW5nIHRvIGRvIHRoaXMgd2lsbCByZXN1bHQgaW4gYSB1bnJlbGVhc2VkIG1lbW9yeSBwcm9ibGVtLg0KICAgICAqIEBwYXJhbSB7VVJMfSB1cmwgT3JpZ2luIGFkZHJlc3Mgb2YgdGhlIG1lc3NhZ2Ugc2VudCwgIm1zZy5mcm9tIi4NCiAgICAgKiBAcGFyYW0ge251bWJlcn0gbXNnSWQgTWVzc2FnZSBJRCB0aGF0IGlzIHJldHVybmVkIGZyb20gdGhlIHBvc3RNZXNzYWdlLg0KICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IHJlc3BvbnNlTGlzdGVuZXIgQ2FsbGJhY2sgZnVuY3Rpb24gZm9yIHRoZSByZXNwb25zZQ0KICAgICAqLw0KDQogIH0sIHsNCiAgICBrZXk6ICdhZGRSZXNwb25zZUxpc3RlbmVyJywNCiAgICB2YWx1ZTogZnVuY3Rpb24gYWRkUmVzcG9uc2VMaXN0ZW5lcih1cmwsIG1zZ0lkLCByZXNwb25zZUxpc3RlbmVyKSB7DQogICAgICB0aGlzLl9yZXNwb25zZUNhbGxiYWNrc1t1cmwgKyBtc2dJZF0gPSByZXNwb25zZUxpc3RlbmVyOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIFJlbW92ZSB0aGUgcmVzcG9uc2UgbGlzdGVuZXIuDQogICAgICogQHBhcmFtIHtVUkx9IHVybCBPcmlnaW4gYWRkcmVzcyBvZiB0aGUgbWVzc2FnZSBzZW50LCAibXNnLmZyb20iLg0KICAgICAqIEBwYXJhbSB7bnVtYmVyfSBtc2dJZCAgTWVzc2FnZSBJRCB0aGF0IGlzIHJldHVybmVkIGZyb20gdGhlIHBvc3RNZXNzYWdlDQogICAgICovDQoNCiAgfSwgew0KICAgIGtleTogJ3JlbW92ZVJlc3BvbnNlTGlzdGVuZXInLA0KICAgIHZhbHVlOiBmdW5jdGlvbiByZW1vdmVSZXNwb25zZUxpc3RlbmVyKHVybCwgbXNnSWQpIHsNCiAgICAgIGRlbGV0ZSB0aGlzLl9yZXNwb25zZUNhbGxiYWNrc1t1cmwgKyBtc2dJZF07DQogICAgfQ0KDQogICAgLyoqDQogICAgICogUmVtb3ZlIGFsbCBleGlzdGVudCBsaXN0ZW5lcnMgZm9yIHRoZSBVUkwNCiAgICAgKiBAcGFyYW0gIHtVUkx9IHVybCBBZGRyZXNzIHJlZ2lzdGVyZWQNCiAgICAgKi8NCg0KICB9LCB7DQogICAga2V5OiAncmVtb3ZlQWxsTGlzdGVuZXJzT2YnLA0KICAgIHZhbHVlOiBmdW5jdGlvbiByZW1vdmVBbGxMaXN0ZW5lcnNPZih1cmwpIHsNCiAgICAgIGRlbGV0ZSB0aGlzLl9zdWJzY3JpcHRpb25zW3VybF07DQogICAgfQ0KDQogICAgLyoqDQogICAgICogSGVscGVyIG1ldGhvZCB0byBiaW5kIGxpc3RlbmVycyAoaW4gYm90aCBkaXJlY3Rpb25zKSBpbnRvIG90aGVyIE1pbmlCdXMgdGFyZ2V0Lg0KICAgICAqIEBwYXJhbSAge1VSTH0gb3V0VXJsIE91dGJvdW5kIFVSTCwgcmVnaXN0ZXIgbGlzdGVuZXIgZm9yIHVybCBpbiBkaXJlY3Rpb24gInRoaXMgLT4gdGFyZ2V0Ig0KICAgICAqIEBwYXJhbSAge1VSTH0gaW5VcmwgSW5ib3VuZCBVUkwsIHJlZ2lzdGVyIGxpc3RlbmVyIGZvciB1cmwgaW4gZGlyZWN0aW9uICJ0YXJnZXQgLT4gdGhpcyINCiAgICAgKiBAcGFyYW0gIHtNaW5pQnVzfSB0YXJnZXQgVGhlIG90aGVyIHRhcmdldCBNaW5pQnVzDQogICAgICogQHJldHVybiB7Qm91bmR9IGFuIG9iamVjdCB0aGF0IGNvbnRhaW5zIHRoZSBwcm9wZXJ0aWVzIFt0aGlzTGlzdGVuZXIsIHRhcmdldExpc3RlbmVyXSBhbmQgdGhlIHVuYmluZCBtZXRob2QuDQogICAgICovDQoNCiAgfSwgew0KICAgIGtleTogJ2JpbmQnLA0KICAgIHZhbHVlOiBmdW5jdGlvbiBiaW5kKG91dFVybCwgaW5VcmwsIHRhcmdldCkgew0KICAgICAgdmFyIF90aGlzMiA9IHRoaXM7DQoNCiAgICAgIHZhciBfdGhpcyA9IHRoaXM7DQoNCiAgICAgIHZhciB0aGlzTGlzdG4gPSBfdGhpcy5hZGRMaXN0ZW5lcihvdXRVcmwsIGZ1bmN0aW9uIChtc2cpIHsNCiAgICAgICAgdGFyZ2V0LnBvc3RNZXNzYWdlKG1zZyk7DQogICAgICB9KTsNCg0KICAgICAgdmFyIHRhcmdldExpc3RuID0gdGFyZ2V0LmFkZExpc3RlbmVyKGluVXJsLCBmdW5jdGlvbiAobXNnKSB7DQogICAgICAgIF90aGlzLnBvc3RNZXNzYWdlKG1zZyk7DQogICAgICB9KTsNCg0KICAgICAgcmV0dXJuIHsNCiAgICAgICAgdGhpc0xpc3RlbmVyOiB0aGlzTGlzdG4sDQogICAgICAgIHRhcmdldExpc3RlbmVyOiB0YXJnZXRMaXN0biwNCiAgICAgICAgdW5iaW5kOiBmdW5jdGlvbiB1bmJpbmQoKSB7DQogICAgICAgICAgX3RoaXMyLnRoaXNMaXN0ZW5lci5yZW1vdmUoKTsNCiAgICAgICAgICBfdGhpczIudGFyZ2V0TGlzdGVuZXIucmVtb3ZlKCk7DQogICAgICAgIH0NCiAgICAgIH07DQogICAgfQ0KDQogICAgLy9wdWJsaXNoIG9uIGRlZmF1bHQgbGlzdGVuZXJzDQoNCiAgfSwgew0KICAgIGtleTogJ19wdWJsaXNoT25EZWZhdWx0JywNCiAgICB2YWx1ZTogZnVuY3Rpb24gX3B1Ymxpc2hPbkRlZmF1bHQobXNnKSB7DQogICAgICAvL2lzIHRoZXJlIGFueSAiKiIgKGRlZmF1bHQpIGxpc3RlbmVycz8NCiAgICAgIHZhciBpdGVtTGlzdCA9IHRoaXMuX3N1YnNjcmlwdGlvbnNbJyonXTsNCiAgICAgIGlmIChpdGVtTGlzdCkgew0KICAgICAgICB0aGlzLl9wdWJsaXNoT24oaXRlbUxpc3QsIG1zZyk7DQogICAgICB9DQogICAgfQ0KDQogICAgLy9wdWJsaXNoIG9uIGEgc3Vic2NyaXB0aW9uIGxpc3QuDQoNCiAgfSwgew0KICAgIGtleTogJ19wdWJsaXNoT24nLA0KICAgIHZhbHVlOiBmdW5jdGlvbiBfcHVibGlzaE9uKGl0ZW1MaXN0LCBtc2cpIHsNCiAgICAgIGl0ZW1MaXN0LmZvckVhY2goZnVuY3Rpb24gKHN1Yikgew0KICAgICAgICBzdWIuX2NhbGxiYWNrKG1zZyk7DQogICAgICB9KTsNCiAgICB9DQogIH0sIHsNCiAgICBrZXk6ICdfcmVzcG9uc2VDYWxsYmFjaycsDQogICAgdmFsdWU6IGZ1bmN0aW9uIF9yZXNwb25zZUNhbGxiYWNrKGluTXNnLCByZXNwb25zZUNhbGxiYWNrKSB7DQogICAgICB2YXIgX3RoaXMgPSB0aGlzOw0KDQogICAgICAvL2F1dG9tYXRpYyBtYW5hZ2VtZW50IG9mIHJlc3BvbnNlIGhhbmRsZXJzDQogICAgICBpZiAocmVzcG9uc2VDYWxsYmFjaykgew0KICAgICAgICAoZnVuY3Rpb24gKCkgew0KICAgICAgICAgIHZhciByZXNwb25zZUlkID0gaW5Nc2cuZnJvbSArIGluTXNnLmlkOw0KICAgICAgICAgIF90aGlzLl9yZXNwb25zZUNhbGxiYWNrc1tyZXNwb25zZUlkXSA9IHJlc3BvbnNlQ2FsbGJhY2s7DQoNCiAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHZhciByZXNwb25zZUZ1biA9IF90aGlzLl9yZXNwb25zZUNhbGxiYWNrc1tyZXNwb25zZUlkXTsNCiAgICAgICAgICAgIGRlbGV0ZSBfdGhpcy5fcmVzcG9uc2VDYWxsYmFja3NbcmVzcG9uc2VJZF07DQoNCiAgICAgICAgICAgIGlmIChyZXNwb25zZUZ1bikgew0KICAgICAgICAgICAgICB2YXIgZXJyb3JNc2cgPSB7DQogICAgICAgICAgICAgICAgaWQ6IGluTXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLA0KICAgICAgICAgICAgICAgIGJvZHk6IHsgY29kZTogNDA4LCBkZXNjOiAnUmVzcG9uc2UgdGltZW91dCEnLCB2YWx1ZTogaW5Nc2cgfQ0KICAgICAgICAgICAgICB9Ow0KDQogICAgICAgICAgICAgIHJlc3BvbnNlRnVuKGVycm9yTXNnKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICB9LCBfdGhpcy5fcmVzcG9uc2VUaW1lT3V0KTsNCiAgICAgICAgfSkoKTsNCiAgICAgIH0NCiAgICB9DQogIH0sIHsNCiAgICBrZXk6ICdfb25SZXNwb25zZScsDQogICAgdmFsdWU6IGZ1bmN0aW9uIF9vblJlc3BvbnNlKG1zZykgew0KICAgICAgdmFyIF90aGlzID0gdGhpczsNCg0KICAgICAgaWYgKG1zZy50eXBlID09PSAncmVzcG9uc2UnKSB7DQogICAgICAgIHZhciByZXNwb25zZUlkID0gbXNnLnRvICsgbXNnLmlkOw0KICAgICAgICB2YXIgcmVzcG9uc2VGdW4gPSBfdGhpcy5fcmVzcG9uc2VDYWxsYmFja3NbcmVzcG9uc2VJZF07DQoNCiAgICAgICAgLy9pZiBpdCdzIGEgcHJvdmlzaW9uYWwgcmVzcG9uc2UsIGRvbid0IGRlbGV0ZSByZXNwb25zZSBsaXN0ZW5lcg0KICAgICAgICBpZiAobXNnLmJvZHkuY29kZSA+PSAyMDApIHsNCiAgICAgICAgICBkZWxldGUgX3RoaXMuX3Jlc3BvbnNlQ2FsbGJhY2tzW3Jlc3BvbnNlSWRdOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKHJlc3BvbnNlRnVuKSB7DQogICAgICAgICAgcmVzcG9uc2VGdW4obXNnKTsNCiAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgfQ0KICAgICAgfQ0KDQogICAgICByZXR1cm4gZmFsc2U7DQogICAgfQ0KDQogICAgLy9yZWNlaXZlIG1lc3NhZ2VzIGZyb20gZXh0ZXJuYWwgaW50ZXJmYWNlDQoNCiAgfSwgew0KICAgIGtleTogJ19vbk1lc3NhZ2UnLA0KICAgIHZhbHVlOiBmdW5jdGlvbiBfb25NZXNzYWdlKG1zZykgew0KICAgICAgdmFyIF90aGlzID0gdGhpczsNCg0KICAgICAgaWYgKCFfdGhpcy5fb25SZXNwb25zZShtc2cpKSB7DQogICAgICAgIHZhciBpdGVtTGlzdCA9IF90aGlzLl9zdWJzY3JpcHRpb25zW21zZy50b107DQogICAgICAgIGlmIChpdGVtTGlzdCkgew0KICAgICAgICAgIF90aGlzLl9wdWJsaXNoT24oaXRlbUxpc3QsIG1zZyk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgX3RoaXMuX3B1Ymxpc2hPbkRlZmF1bHQobXNnKTsNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgIH0NCiAgfSwgew0KICAgIGtleTogJ19nZW5JZCcsDQogICAgdmFsdWU6IGZ1bmN0aW9uIF9nZW5JZChpbk1zZykgew0KICAgICAgLy9UT0RPOiBob3cgZG8gd2UgbWFuYWdlIG1lc3NhZ2UgSUQncz8gU2hvdWxkIGl0IGJlIGEgZ2xvYmFsIHJ1bnRpbWUgY291bnRlciwgb3IgcGVyIFVSTCBhZGRyZXNzPw0KICAgICAgLy9HbG9iYWwgY291bnRlciB3aWxsIG5vdCB3b3JrLCBiZWNhdXNlIHRoZXJlIHdpbGwgYmUgbXVsdGlwbGUgTWluaUJ1cyBpbnN0YW5jZXMhDQogICAgICAvL1BlciBVUkwsIGNhbiBiZSBhIGxvdCBvZiBkYXRhIHRvIG1haW50YWluIQ0KICAgICAgLy9NYXliZSBhIGNvdW50ZXIgcGVyIE1pbmlCdXMgaW5zdGFuY2UuIFRoaXMgaXMgdGhlIGFzc3VtZWQgc29sdXRpb24gZm9yIG5vdy4NCiAgICAgIGlmICghaW5Nc2cuaWQgfHwgaW5Nc2cuaWQgPT09IDApIHsNCiAgICAgICAgdGhpcy5fbXNnSWQrKzsNCiAgICAgICAgaW5Nc2cuaWQgPSB0aGlzLl9tc2dJZDsNCiAgICAgIH0NCiAgICB9DQoNCiAgICAvKioNCiAgICAqIFNlbmQgbWVzc2FnZXMgdG8gbG9jYWwgbGlzdGVuZXJzLCBvciBpZiBub3QgZXhpc3RzIHRvIGV4dGVybmFsIGxpc3RlbmVycy4NCiAgICAqIEl0J3MgaGFzIGFuIG9wdGlvbmFsIG1lY2hhbmlzbSBmb3IgYXV0b21hdGljIG1hbmFnZW1lbnQgb2YgcmVzcG9uc2UgaGFuZGxlcnMuDQogICAgKiBUaGUgcmVzcG9uc2UgaGFuZGxlciB3aWxsIGJlIHVucmVnaXN0ZXJlZCBhZnRlciByZWNlaXZpbmcgdGhlIHJlc3BvbnNlLCBvciBhZnRlciByZXNwb25zZSB0aW1lb3V0IChkZWZhdWx0IHRvIDNzKS4NCiAgICAqIEBwYXJhbSAge01lc3NhZ2V9IG1zZyBNZXNzYWdlIHRvIHNlbmQuIE1lc3NhZ2UgSUQgaXMgYXV0b21hdGljYWxseSBhZGRlZCB0byB0aGUgbWVzc2FnZS4NCiAgICAqIEBwYXJhbSAge0Z1bmN0aW9ufSByZXNwb25zZUNhbGxiYWNrIE9wdGlvbmFsIHBhcmFtZXRlciwgaWYgdGhlIGRldmVsb3BlciB3aGF0J3MgYXV0b21hdGljIHJlc3BvbnNlIG1hbmFnZW1lbnQuDQogICAgKiBAcmV0dXJuIHtudW1iZXJ9IFJldHVybnMgdGhlIG1lc3NhZ2UgSUQsIGluIGNhc2UgaXQgc2hvdWxkIGJlIG5lZWRlZCBmb3IgbWFudWFsIG1hbmFnZW1lbnQgb2YgdGhlIHJlc3BvbnNlIGhhbmRsZXIuDQogICAgKi8NCg0KICB9LCB7DQogICAga2V5OiAncG9zdE1lc3NhZ2UnLA0KICAgIHZhbHVlOiBmdW5jdGlvbiBwb3N0TWVzc2FnZShpbk1zZywgcmVzcG9uc2VDYWxsYmFjaykge30NCg0KICAgIC8qKg0KICAgICAqIE5vdCBwdWJsaWMgYXZhaWxhYmxlLCB1c2VkIGJ5IHRoZSBjbGFzcyBleHRlbnNpb24gaW1wbGVtZW50YXRpb24sIHRvIHByb2Nlc3MgbWVzc2FnZXMgZnJvbSB0aGUgcHVibGljICJwb3N0TWVzc2FnZSIgd2l0aG91dCBhIHJlZ2lzdGVyZWQgbGlzdGVuZXIuDQogICAgICogVXNlZCB0byBzZW5kIHRoZSBtZXNzYWdlIHRvIGFuIGV4dGVybmFsIGludGVyZmFjZSwgbGlrZSBhIFdlYldvcmtlciwgSUZyYW1lLCBldGMuDQogICAgICogQHBhcmFtICB7TWVzc2FnZS5NZXNzYWdlfSBtc2cgTWVzc2FnZQ0KICAgICAqLw0KDQogIH0sIHsNCiAgICBrZXk6ICdfb25Qb3N0TWVzc2FnZScsDQogICAgdmFsdWU6IGZ1bmN0aW9uIF9vblBvc3RNZXNzYWdlKG1zZykge30gLyppbXBsZW1lbnRhdGlvbiB3aWxsIHNlbmQgbWVzc2FnZSB0byBleHRlcm5hbCBzeXN0ZW0qLw0KDQogICAgLyoqDQogICAgICogTm90IHB1YmxpYyBhdmFpbGFibGUsIHVzZWQgYnkgdGhlIGNsYXNzIGV4dGVuc2lvbiBpbXBsZW1lbnRhdGlvbiwgdG8gcHJvY2VzcyBhbGwgbWVzc2FnZXMgdGhhdCBlbnRlciB0aGUgTWluaUJ1cyBmcm9tIGFuIGV4dGVybmFsIGludGVyZmFjZSwgbGlrZSBhIFdlYldvcmtlciwgSUZyYW1lLCBldGMuDQogICAgICogVGhpcyBtZXRob2QgaXMgY2FsbGVkIG9uZSB0aW1lIGluIHRoZSBjb25zdHJ1Y3RvciB0byByZWdpc3RlciBleHRlcm5hbCBsaXN0ZW5lcnMuDQogICAgICogVGhlIGltcGxlbWVudGF0aW9uIHdpbGwgcHJvYmFibHkgY2FsbCB0aGUgIl9vbk1lc3NhZ2UiIG1ldGhvZCB0byBwdWJsaXNoIGluIHRoZSBsb2NhbCBsaXN0ZW5lcnMuDQogICAgICogRE8gTk9UIGNhbGwgInBvc3RNZXNzYWdlIiwgdGhlcmUgaXMgYSBkYW5nZXIgdGhhdCB0aGUgbWVzc2FnZSBlbnRlcnMgaW4gYSBjeWNsZSENCiAgICAgKi8NCg0KICB9LCB7DQogICAga2V5OiAnX3JlZ2lzdGVyRXh0ZXJuYWxMaXN0ZW5lcicsDQogICAgdmFsdWU6IGZ1bmN0aW9uIF9yZWdpc3RlckV4dGVybmFsTGlzdGVuZXIoKSB7LyppbXBsZW1lbnRhdGlvbiB3aWxsIHJlZ2lzdGVyIGV4dGVybmFsIGxpc3RlbmVyIGFuZCBjYWxsICJ0aGlzLl9vbk1lc3NhZ2UobXNnKSIgKi99DQogIH1dKTsNCg0KICByZXR1cm4gQnVzOw0KfSgpOw0KDQp2YXIgTXNnTGlzdGVuZXIgPSBmdW5jdGlvbiAoKSB7DQogIC8qIHByaXZhdGUNCiAgX3N1YnNjcmlwdGlvbnM6IDxzdHJpbmc6IE1zZ0xpc3RlbmVyW10+Ow0KICBfdXJsOiBzdHJpbmc7DQogIF9jYWxsYmFjazogKG1zZykgPT4gdm9pZDsNCiAgKi8NCg0KICBmdW5jdGlvbiBNc2dMaXN0ZW5lcihzdWJzY3JpcHRpb25zLCB1cmwsIGNhbGxiYWNrKSB7DQogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIE1zZ0xpc3RlbmVyKTsNCg0KICAgIHZhciBfdGhpcyA9IHRoaXM7DQoNCiAgICBfdGhpcy5fc3Vic2NyaXB0aW9ucyA9IHN1YnNjcmlwdGlvbnM7DQogICAgX3RoaXMuX3VybCA9IHVybDsNCiAgICBfdGhpcy5fY2FsbGJhY2sgPSBjYWxsYmFjazsNCiAgfQ0KDQogIF9jcmVhdGVDbGFzcyhNc2dMaXN0ZW5lciwgW3sNCiAgICBrZXk6ICdyZW1vdmUnLA0KDQoNCiAgICAvKioNCiAgICAgKiBSZW1vdmUgdGhpcyBsaXN0ZW5lciBmcm9tIHRoZSBCdXMNCiAgICAgKi8NCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVtb3ZlKCkgew0KICAgICAgdmFyIF90aGlzID0gdGhpczsNCg0KICAgICAgdmFyIHN1YnMgPSBfdGhpcy5fc3Vic2NyaXB0aW9uc1tfdGhpcy5fdXJsXTsNCiAgICAgIGlmIChzdWJzKSB7DQogICAgICAgIHZhciBpbmRleCA9IHN1YnMuaW5kZXhPZihfdGhpcyk7DQogICAgICAgIHN1YnMuc3BsaWNlKGluZGV4LCAxKTsNCg0KICAgICAgICAvL2lmIHRoZXJlIGFyZSBubyBsaXN0ZW5lcnMsIHJlbW92ZSB0aGUgc3Vic2NyaXB0aW9uIGVudGlyZWx5Lg0KICAgICAgICBpZiAoc3Vicy5sZW5ndGggPT09IDApIHsNCiAgICAgICAgICBkZWxldGUgX3RoaXMuX3N1YnNjcmlwdGlvbnNbX3RoaXMuX3VybF07DQogICAgICAgIH0NCiAgICAgIH0NCiAgICB9DQogIH0sIHsNCiAgICBrZXk6ICd1cmwnLA0KICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgew0KICAgICAgcmV0dXJuIHRoaXMuX3VybDsNCiAgICB9DQogIH1dKTsNCg0KICByZXR1cm4gTXNnTGlzdGVuZXI7DQp9KCk7DQoNCmV4cG9ydHMuZGVmYXVsdCA9IEJ1czsNCn0se31dLDMwMzpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQondXNlIHN0cmljdCc7DQoNCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsNCiAgdmFsdWU6IHRydWUNCn0pOw0KDQp2YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTsNCg0KdmFyIF9CdXMyID0gcmVxdWlyZSgnLi9CdXMnKTsNCg0KdmFyIF9CdXMzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfQnVzMik7DQoNCnZhciBfUGlwZWxpbmUgPSByZXF1aXJlKCcuL1BpcGVsaW5lJyk7DQoNCnZhciBfUGlwZWxpbmUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfUGlwZWxpbmUpOw0KDQpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQ0KDQpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOyB9IH0NCg0KZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoIXNlbGYpIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWQiKTsgfSByZXR1cm4gY2FsbCAmJiAodHlwZW9mIGNhbGwgPT09ICJvYmplY3QiIHx8IHR5cGVvZiBjYWxsID09PSAiZnVuY3Rpb24iKSA/IGNhbGwgOiBzZWxmOyB9DQoNCmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09ICJmdW5jdGlvbiIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90ICIgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9IC8qKg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YefjbyBlIFNpc3RlbWFzIFNBDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IElORVNDLUlEDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0ENCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWUNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqKi8NCg0KDQovKioNCiogQGF1dGhvciBtaWNhZWxwZWRyb3NhQGdtYWlsLmNvbQ0KKiBNZXNzYWdlIEJVUyBJbnRlcmZhY2UgaXMgYW4gZXh0ZW5zaW9uIG9mIHRoZSBCdXMNCiogSXQgZG9lc24ndCBzdXBwb3J0IHRoZSBkZWZhdWx0ICcqJyBsaXN0ZW5lciwgaW5zdGVhZCBpdCB1c2VzIHRoZSByZWdpc3RyeS5yZXNvbHZlKC4uKQ0KKi8NCg0KdmFyIE1lc3NhZ2VCdXMgPSBmdW5jdGlvbiAoX0J1cykgew0KICBfaW5oZXJpdHMoTWVzc2FnZUJ1cywgX0J1cyk7DQoNCiAgLyogcHJpdmF0ZQ0KICBfcmVnaXN0cnk6IFJlZ2lzdHJ5DQogIF9mb3J3YXJkczogeyA8ZnJvbS11cmw+OiB7IGZsOiBNc2dMaXN0ZW5lciwgc2FuZGJveFRvVXJsczogTWFwKFNhbmRib3gsIFt0by11cmxdKSwgdXJsVG9TYW5kYm94OiB7IHRvLXVybDogU2FuZGJveCB9IH0gfQ0KICAgX3BpcGVsaW5lOiBQaXBlbGluZQ0KICAqLw0KDQogIC8vVE9ETzogZnV0dXJlIG9wdGltaXphdGlvbg0KICAvLzEuIG1lc3NhZ2UgYmF0Y2ggcHJvY2Vzc2luZyB3aXRoIHNldEludGVydmFsDQogIC8vMi4gcmVzb2x2ZSBkZWZhdWx0IGdhdGV3YXkvcHJvdG9zdHViIHdpdGggcmVnaXN0ZXIucmVzb2x2ZQ0KDQogIGZ1bmN0aW9uIE1lc3NhZ2VCdXMocmVnaXN0cnkpIHsNCiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgTWVzc2FnZUJ1cyk7DQoNCiAgICB2YXIgX3RoaXMyID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgT2JqZWN0LmdldFByb3RvdHlwZU9mKE1lc3NhZ2VCdXMpLmNhbGwodGhpcykpOw0KDQogICAgX3RoaXMyLl9yZWdpc3RyeSA9IHJlZ2lzdHJ5Ow0KICAgIF90aGlzMi5fZm9yd2FyZHMgPSB7fTsNCg0KICAgIF90aGlzMi5fcGlwZWxpbmUgPSBuZXcgX1BpcGVsaW5lMi5kZWZhdWx0KGZ1bmN0aW9uIChlcnJvcikgew0KICAgICAgY29uc29sZS5sb2coJ1BJUEVMSU5FLUVSUk9SOiAnLCBKU09OLnN0cmluZ2lmeShlcnJvcikpOw0KICAgIH0pOw0KICAgIHJldHVybiBfdGhpczI7DQogIH0NCg0KICBfY3JlYXRlQ2xhc3MoTWVzc2FnZUJ1cywgW3sNCiAgICBrZXk6ICdwb3N0TWVzc2FnZScsDQoNCg0KICAgIC8qKg0KICAgICAqIFBvc3QgYSBtZXNzYWdlIGZvciByb3V0aW5nLiBJdCB3aWxsIGZpcnN0IHNlYXJjaCBmb3IgYSBsaXN0ZW5lciwgaWYgdGhlcmUgaXMgbm8gb25lLCBpdCBzZW5kcyB0byBhIGV4dGVybmFsIHJvdXRpbmcgdXNpbmcgdGhlIF9vblBvc3RNZXNzYWdlLg0KICAgICAqIEV4dGVybmFsIHJvdXRpbmcgdXNlIHRoZSByZWdpc3RyeS5yZXNvbHZlKC4uKSBtZXRob2QgdG8gZGVjaWRlIHRoZSBkZXN0aW5hdGlvbiBzYW5kYm94Lg0KICAgICAqIEBwYXJhbSAge01lc3NhZ2V9IGluTXNnICAgICAgICAgICAgSlNPTiB3aXRoIG1hbmRhdG9yeSBNZXNzYWdlIHN0cnVjdHVyZSB7aWQsIHR5cGUsIGZyb20sIHRvfQ0KICAgICAqIEBwYXJhbSAge0NhbGxiYWNrfSByZXNwb25zZUNhbGxiYWNrIE9wdGlvbmFsIGNhbGxiYWNrIGlmIGEgcmVzcG9uc2UgaXMgZXhwZWN0ZWQgZnJvbSB0aGUgcmVxdWVzdC4gQSByZXNwb25zZSB3aWxsIGJlIGFsd2F5cyBzZW50LCBldmVuIGlmIGl0IGlzIGEgIlRpbWVvdXQiLg0KICAgICAqIEByZXR1cm4ge251bWJlcn0gICAgICAgICAgICAgICAgICB0aGUgTWVzc2FnZSBpZA0KICAgICAqLw0KICAgIHZhbHVlOiBmdW5jdGlvbiBwb3N0TWVzc2FnZShpbk1zZywgcmVzcG9uc2VDYWxsYmFjaykgew0KICAgICAgdmFyIF90aGlzID0gdGhpczsNCg0KICAgICAgX3RoaXMuX2dlbklkKGluTXNnKTsNCg0KICAgICAgX3RoaXMuX3BpcGVsaW5lLnByb2Nlc3MoaW5Nc2csIGZ1bmN0aW9uIChtc2cpIHsNCg0KICAgICAgICBfdGhpcy5fcmVzcG9uc2VDYWxsYmFjayhpbk1zZywgcmVzcG9uc2VDYWxsYmFjayk7DQoNCiAgICAgICAgaWYgKCFfdGhpcy5fb25SZXNwb25zZShtc2cpKSB7DQogICAgICAgICAgdmFyIGl0ZW1MaXN0ID0gX3RoaXMuX3N1YnNjcmlwdGlvbnNbbXNnLnRvXTsNCiAgICAgICAgICBpZiAoaXRlbUxpc3QpIHsNCiAgICAgICAgICAgIC8vZG8gbm90IHB1Ymxpc2ggb24gZGVmYXVsdCBhZGRyZXNzLCBiZWNhdXNlIG9mIGxvb3BiYWNrIGN5Y2xlDQogICAgICAgICAgICBfdGhpcy5fcHVibGlzaE9uKGl0ZW1MaXN0LCBtc2cpOw0KICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAvL2lmIHRoZXJlIGlzIG5vIGxpc3RlbmVyLCBzZW5kIHRvIGV4dGVybmFsIGludGVyZmFjZQ0KICAgICAgICAgICAgX3RoaXMuX29uUG9zdE1lc3NhZ2UobXNnKTsNCiAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgIH0pOw0KDQogICAgICByZXR1cm4gaW5Nc2cuaWQ7DQogICAgfQ0KDQogICAgLyoqDQogICAgICogQWRkcyBhbiBleHRlcm5hbCBwdWJsaXNoIGFkZHJlc3MgbGlzdGVuZXIuIEV2ZXJ5IG1lc3NhZ2UgZm9yIHRoZSBhZGRyZXNzIHdpbGwgYmUgZm9yd2FyZGVkIHRvIHRoZSBleHRlcm5hbCByb3V0aW5nIGJ5IF9vblBvc3RNZXNzYWdlLg0KICAgICAqIFRoaXMgbWVhbnMsIGV2ZW4gaWYgdGhlcmUgaXMgYSBsaXN0ZW5lciBmb3IgdGhlIGFkZHJlc3MsIGl0IHdpbGwgYWxzbyBzZW5kIHRoZSBtZXNzYWdlIHRvIHRoZSBleHRlcm5hbCByb3V0aW5nLg0KICAgICAqIEBwYXJhbSB7VVJMfSBmcm9tIFB1Ymxpc2ggYWRkcmVzcy4NCiAgICAgKi8NCg0KICB9LCB7DQogICAga2V5OiAnYWRkUHVibGlzaCcsDQogICAgdmFsdWU6IGZ1bmN0aW9uIGFkZFB1Ymxpc2goZnJvbSkgew0KICAgICAgdmFyIF90aGlzMyA9IHRoaXM7DQoNCiAgICAgIHZhciBfdGhpcyA9IHRoaXM7DQoNCiAgICAgIC8vdmVyaWZ5IGlmIGZvcndhcmQgZXhpc3QNCiAgICAgIHZhciByZWZDb3VudCA9IF90aGlzLl9mb3J3YXJkc1tmcm9tXTsNCiAgICAgIGlmICghcmVmQ291bnQpIHsNCiAgICAgICAgdmFyIGZvcndhcmRMaXN0ZW5lciA9IF90aGlzLmFkZExpc3RlbmVyKGZyb20sIGZ1bmN0aW9uIChtc2cpIHsNCiAgICAgICAgICBjb25zb2xlLmxvZygnTUItUFVCTElTSDogKCAnICsgZnJvbSArICcgKScpOw0KICAgICAgICAgIF90aGlzLl9vblBvc3RNZXNzYWdlKG1zZyk7DQogICAgICAgIH0pOw0KDQogICAgICAgIHJlZkNvdW50ID0gew0KICAgICAgICAgIGNvdW50ZXI6IDAsDQogICAgICAgICAgZmw6IGZvcndhcmRMaXN0ZW5lciwNCiAgICAgICAgICByZW1vdmU6IGZ1bmN0aW9uIHJlbW92ZSgpIHsNCiAgICAgICAgICAgIF90aGlzMy5jb3VudGVyLS07DQogICAgICAgICAgICBpZiAoX3RoaXMzLmNvdW50ZXIgPT09IDApIHsNCiAgICAgICAgICAgICAgX3RoaXMzLmZsLnJlbW92ZSgpOw0KICAgICAgICAgICAgICBkZWxldGUgX3RoaXMuX2ZvcndhcmRzW2Zyb21dOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgIH0NCiAgICAgICAgfTsNCg0KICAgICAgICBfdGhpcy5fZm9yd2FyZHNbZnJvbV0gPSByZWZDb3VudDsNCiAgICAgIH0NCg0KICAgICAgcmVmQ291bnQuY291bnRlcisrOw0KICAgICAgcmV0dXJuIHJlZkNvdW50Ow0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIEFkZHMgYSBmb3J3YXJkIGxpc3RlbmVyIGZvciBhIG1lc3NhZ2UgZGVzdGluYXRpb24uIEV2ZXJ5IG1lc3NhZ2UgcmVhY2hpbmcgYW4gYWRkcmVzcyB3aWxsIGJlIGFsc28gc2VudCB0byB0aGUgZm9yd2FyZCBhZGRyZXNzLg0KICAgICAqIEBwYXJhbSB7VVJMfSBmcm9tIE1lc3NhZ2UgZGVzdGluYXRpb24sIGl0J3MgYWN0dWFsbHkgdGhlIGZpZWxkICJ0byIgb2YgdGhlIG1lc3NhZ2UuDQogICAgICogQHBhcmFtIHtVUkx9IHRvICAgRm9yd2FyZCBhZGRyZXNzLg0KICAgICAqLw0KDQogIH0sIHsNCiAgICBrZXk6ICdhZGRGb3J3YXJkJywNCiAgICB2YWx1ZTogZnVuY3Rpb24gYWRkRm9yd2FyZChmcm9tLCB0bykgew0KICAgICAgdmFyIF90aGlzID0gdGhpczsNCg0KICAgICAgcmV0dXJuIF90aGlzLmFkZExpc3RlbmVyKGZyb20sIGZ1bmN0aW9uIChtc2cpIHsNCiAgICAgICAgY29uc29sZS5sb2coJ01CLUZPUldBUkQ6ICggJyArIGZyb20gKyAnIHRvICcgKyB0byArICcgKScpOw0KICAgICAgICBfdGhpcy5mb3J3YXJkKHRvLCBtc2cpOw0KICAgICAgfSk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICogSnVzdCBmb3J3YXJkJ3MgYSBtZXNzYWdlIHRvIHRoZSBmb3J3YXJkIGFkZHJlc3MuIExpc3RlbmVycyBzaG91bGQgYmUgYXZhaWxhYmxlIGZvciB0aGUgZm9yd2FyZCBhZGRyZXNzLg0KICAgICAqIEBwYXJhbSAge1VSTH0gdXJsIEZvcndhcmQgYWRkcmVzcy4NCiAgICAgKiBAcGFyYW0gIHtNZXNzYWdlfSBtc2cgTWVzc2FnZSB0byBmb3J3YXJkDQogICAgICovDQoNCiAgfSwgew0KICAgIGtleTogJ2ZvcndhcmQnLA0KICAgIHZhbHVlOiBmdW5jdGlvbiBmb3J3YXJkKHVybCwgbXNnKSB7DQogICAgICB2YXIgX3RoaXMgPSB0aGlzOw0KDQogICAgICB2YXIgaXRlbUxpc3QgPSBfdGhpcy5fc3Vic2NyaXB0aW9uc1t1cmxdOw0KICAgICAgaWYgKGl0ZW1MaXN0KSB7DQogICAgICAgIF90aGlzLl9wdWJsaXNoT24oaXRlbUxpc3QsIG1zZyk7DQogICAgICB9DQogICAgfQ0KDQogICAgLy9kZWZhdWx0IHJvdXRlLCBpZiB0aGVyZSBhcmUgbm8gbGlzdGVuZXJzIGF2YWlsYWJsZSBmb3IgYSBtZXNzYWdlIGRlc3RpbmF0aW9uLg0KDQogIH0sIHsNCiAgICBrZXk6ICdfb25Qb3N0TWVzc2FnZScsDQogICAgdmFsdWU6IGZ1bmN0aW9uIF9vblBvc3RNZXNzYWdlKG1zZykgew0KICAgICAgdmFyIF90aGlzID0gdGhpczsNCg0KICAgICAgLy9yZXNvbHZlIGV4dGVybmFsIHByb3Rvc3R1Yi4uLg0KICAgICAgX3RoaXMuX3JlZ2lzdHJ5LnJlc29sdmUobXNnLnRvKS50aGVuKGZ1bmN0aW9uIChyb3V0ZSkgew0KICAgICAgICBfdGhpcy5mb3J3YXJkKHJvdXRlLCBtc2cpOw0KICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsNCiAgICAgICAgY29uc29sZS5sb2coJ1JFU09MVkUtRVJST1I6ICcsIGUpOw0KICAgICAgfSk7DQogICAgfQ0KICB9LCB7DQogICAga2V5OiAncGlwZWxpbmUnLA0KICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgew0KICAgICAgcmV0dXJuIHRoaXMuX3BpcGVsaW5lOw0KICAgIH0NCiAgfV0pOw0KDQogIHJldHVybiBNZXNzYWdlQnVzOw0KfShfQnVzMy5kZWZhdWx0KTsNCg0KZXhwb3J0cy5kZWZhdWx0ID0gTWVzc2FnZUJ1czsNCn0seyIuL0J1cyI6MzAyLCIuL1BpcGVsaW5lIjozMDR9XSwzMDQ6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KInVzZSBzdHJpY3QiOw0KDQpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7DQogIHZhbHVlOiB0cnVlDQp9KTsNCg0KdmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmICgidmFsdWUiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7DQoNCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7IH0gfQ0KDQovKioNCiogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHn428gZSBTaXN0ZW1hcyBTQQ0KKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRA0KKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0wNCiogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYNCiogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBDQoqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUcNCiogQ29weXJpZ2h0IDIwMTYgQXBpemVlDQoqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElODQoqDQoqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOw0KKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuDQoqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdA0KKg0KKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMA0KKg0KKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlDQoqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsDQoqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLg0KKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kDQoqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLg0KKiovDQoNCi8qKg0KKiBAYXV0aG9yIG1pY2FlbHBlZHJvc2FAZ21haWwuY29tDQoqIFNlcXVlbmNpYWwgcHJvY2Vzc29yIG9mIG1ldGhvZHMuIFNpbWlsYXIgdG8gaG93IFNlcXVlbnRpYWwgUHJvbWlzZSdzIHdvcmssIGJ1dCBiZXR0ZXIgZml0IGZvciBtZXNzYWdlIHByb2Nlc3NpbmcuDQoqIE5vcm1hbCB1c2UgZm9yIHRoaXMsIGlzIHRvIGludGVyY2VwdCBhbGwgbWVzc2FnZXMgd2l0aCBjb25maWd1cmVkIGhhbmRsZXJzLCBhbmQgYWN0IGFjY29yZGluZ2x5Lg0KKi8NCg0KdmFyIFBpcGVsaW5lID0gZnVuY3Rpb24gKCkgew0KICAvKiBwdWJsaWMNCiAgICBoYW5kbGVyczogKChQaXBlQ29udGV4dCkgPT4gdm9pZClbXQ0KICAgIG9uRmFpbDogKGVycm9yKSA9PiB2b2lkDQogICovDQoNCiAgZnVuY3Rpb24gUGlwZWxpbmUoX29uRmFpbCkgew0KICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBQaXBlbGluZSk7DQoNCiAgICB2YXIgX3RoaXMgPSB0aGlzOw0KDQogICAgX3RoaXMuaGFuZGxlcnMgPSBbXTsNCiAgICBfdGhpcy5vbkZhaWwgPSBfb25GYWlsOw0KICB9DQoNCiAgLyoqDQogICAqIEluc2VydCBhIG1lc3NhZ2UgaW4gdGhlIHBpcGVsaW5lIHF1ZXVlLiBBbGwgbWVzc2FnZXMgYXJlIHdyYXBwZWQgd2l0aCBhIFBpcGVDb250ZXh0Lg0KICAgKiBAcGFyYW0gIHtNZXNzYWdlfSBtc2cgICAgICAgTWVzc2FnZSBmb3IgdGhlIHF1ZXVlDQogICAqIEBwYXJhbSAge0NhbGxiYWNrfSBvbkRlbGl2ZXIgV2hlbiBtZXNzYWdlIGlzIGZpbmlzaGVkIHByb2Nlc3NpbmcgZnJvbSBhbGwgaGFuZGxlcnMsIGl0IHdpbGwgYmUgZGVsaXZlcmVkIGluIHRoaXMgY2FsbGJhY2suDQogICAqLw0KDQoNCiAgX2NyZWF0ZUNsYXNzKFBpcGVsaW5lLCBbew0KICAgIGtleTogInByb2Nlc3MiLA0KICAgIHZhbHVlOiBmdW5jdGlvbiBwcm9jZXNzKG1zZywgb25EZWxpdmVyKSB7DQogICAgICB2YXIgX3RoaXMgPSB0aGlzOw0KDQogICAgICBpZiAoX3RoaXMuaGFuZGxlcnMubGVuZ3RoID4gMCkgew0KICAgICAgICB2YXIgaXRlciA9IG5ldyBJdGVyYXRvcihfdGhpcy5oYW5kbGVycyk7DQogICAgICAgIGl0ZXIubmV4dChuZXcgUGlwZUNvbnRleHQoX3RoaXMsIGl0ZXIsIG1zZywgb25EZWxpdmVyKSk7DQogICAgICB9IGVsc2Ugew0KICAgICAgICBvbkRlbGl2ZXIobXNnKTsNCiAgICAgIH0NCiAgICB9DQogIH1dKTsNCg0KICByZXR1cm4gUGlwZWxpbmU7DQp9KCk7DQoNCi8qKg0KKiBAYXV0aG9yIG1pY2FlbHBlZHJvc2FAZ21haWwuY29tDQoqIFdyYXBwZXIgYXJvdW5kIGEgbWVzc2FnZSB0aGF0IGFkZHMgYWN0aW9ucyB0aGF0IGNhbiBiZSBmaXJlZCBieSBhbnkgaW50ZXJjZXB0b3IgaGFuZGxlci4NCiogVGhlIFBpcGVsaW5lIGlzIGFzeW5jaHJvbm91cywgc28gYW4gaGFuZGxlciBzaG91bGQgYWx3YXlzIGNhbGwgYW4gYWN0aW9uLCB0aGUgZGVmYXVsdCBvbmUgaXMgIm5leHQoKSINCiovDQoNCg0KdmFyIFBpcGVDb250ZXh0ID0gZnVuY3Rpb24gKCkgew0KICAvKiBwcml2YXRlDQogICAgX2luU3RvcDogYm9vbGVhbg0KICAgICBfcGlwZWxpbmU6IFBpcGVsaW5lDQogICAgX2l0ZXI6IEl0ZXJhdG9yDQogICAgX21zZzogTWVzc2FnZQ0KICAqLw0KDQogIGZ1bmN0aW9uIFBpcGVDb250ZXh0KHBpcGVsaW5lLCBpdGVyLCBtc2csIG9uRGVsaXZlcikgew0KICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBQaXBlQ29udGV4dCk7DQoNCiAgICB2YXIgX3RoaXMgPSB0aGlzOw0KDQogICAgX3RoaXMuX2luU3RvcCA9IGZhbHNlOw0KDQogICAgX3RoaXMuX3BpcGVsaW5lID0gcGlwZWxpbmU7DQogICAgX3RoaXMuX2l0ZXIgPSBpdGVyOw0KICAgIF90aGlzLl9tc2cgPSBtc2c7DQogICAgX3RoaXMuX29uRGVsaXZlciA9IG9uRGVsaXZlcjsNCiAgfQ0KDQogIF9jcmVhdGVDbGFzcyhQaXBlQ29udGV4dCwgW3sNCiAgICBrZXk6ICJuZXh0IiwNCg0KDQogICAgLyoqDQogICAgICogUHJvY2VlZCB0byB0aGUgbmV4dCBpbnRlcmNlcHRvciBoYW5kbGVyLCB1bmxlc3MgdGhlcmUgd2FzIGFuIGVycm9yLiBJZiBpdCdzIHRoZSBsYXN0IG9uZSwgcHJvY2VlZCB0byBvbkRlbGl2ZXIgaGFuZGxlci4NCiAgICAgKi8NCiAgICB2YWx1ZTogZnVuY3Rpb24gbmV4dCgpIHsNCiAgICAgIHZhciBfdGhpcyA9IHRoaXM7DQoNCiAgICAgIGlmICghX3RoaXMuX2luU3RvcCkgew0KICAgICAgICBpZiAoX3RoaXMuX2l0ZXIuaGFzTmV4dCkgew0KICAgICAgICAgIF90aGlzLl9pdGVyLm5leHQoX3RoaXMpOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgIF90aGlzLl9vbkRlbGl2ZXIoX3RoaXMuX21zZyk7DQogICAgICAgIH0NCiAgICAgIH0NCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBQcm9jZWVkIGRpcmVjdGx5IHRvIHRoZSBvbkRlbGl2ZXIgaGFuZGxlciwgdW5sZXNzIHRoZXJlIHdhcyBhbiBlcnJvci4NCiAgICAgKi8NCg0KICB9LCB7DQogICAga2V5OiAiZGVsaXZlciIsDQogICAgdmFsdWU6IGZ1bmN0aW9uIGRlbGl2ZXIoKSB7DQogICAgICB2YXIgX3RoaXMgPSB0aGlzOw0KICAgICAgaWYgKCFfdGhpcy5faW5TdG9wKSB7DQogICAgICAgIF90aGlzLl9pblN0b3AgPSB0cnVlOw0KICAgICAgICBfdGhpcy5fb25EZWxpdmVyKF90aGlzLl9tc2cpOw0KICAgICAgfQ0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIE1hcmsgdGhlIGNvbnRleHQgd2l0aCBhbiBlcnJvciBhbmQgcHJvY2VlZCB0byB0aGUgb25GYWlsIGhhbmRsZXIuDQogICAgICogQHBhcmFtICB7W3R5cGVdfSBlcnJvciBbZGVzY3JpcHRpb25dDQogICAgICovDQoNCiAgfSwgew0KICAgIGtleTogImZhaWwiLA0KICAgIHZhbHVlOiBmdW5jdGlvbiBmYWlsKGVycm9yKSB7DQogICAgICB2YXIgX3RoaXMgPSB0aGlzOw0KDQogICAgICBpZiAoIV90aGlzLl9pblN0b3ApIHsNCiAgICAgICAgX3RoaXMuX2luU3RvcCA9IHRydWU7DQogICAgICAgIGlmIChfdGhpcy5fcGlwZWxpbmUub25GYWlsKSB7DQogICAgICAgICAgX3RoaXMuX3BpcGVsaW5lLm9uRmFpbChlcnJvcik7DQogICAgICAgIH0NCiAgICAgIH0NCiAgICB9DQogIH0sIHsNCiAgICBrZXk6ICJwaXBlbGluZSIsDQogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7DQogICAgICByZXR1cm4gdGhpcy5fcGlwZWxpbmU7DQogICAgfQ0KICB9LCB7DQogICAga2V5OiAibXNnIiwNCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsNCiAgICAgIHJldHVybiB0aGlzLl9tc2c7DQogICAgfSwNCiAgICBzZXQ6IGZ1bmN0aW9uIHNldChpbk1zZykgew0KICAgICAgdGhpcy5fbXNnID0gaW5Nc2c7DQogICAgfQ0KICB9XSk7DQoNCiAgcmV0dXJuIFBpcGVDb250ZXh0Ow0KfSgpOw0KDQp2YXIgSXRlcmF0b3IgPSBmdW5jdGlvbiAoKSB7DQogIC8qIHByaXZhdGUNCiAgICBfaW5kZXg6IG51bWJlcg0KICAgIF9hcnJheTogW10NCiAgKi8NCg0KICBmdW5jdGlvbiBJdGVyYXRvcihhcnJheSkgew0KICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBJdGVyYXRvcik7DQoNCiAgICB0aGlzLl9pbmRleCA9IC0xOw0KICAgIHRoaXMuX2FycmF5ID0gYXJyYXk7DQogIH0NCg0KICBfY3JlYXRlQ2xhc3MoSXRlcmF0b3IsIFt7DQogICAga2V5OiAiaGFzTmV4dCIsDQogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7DQogICAgICByZXR1cm4gdGhpcy5faW5kZXggPCB0aGlzLl9hcnJheS5sZW5ndGggLSAxOw0KICAgIH0NCiAgfSwgew0KICAgIGtleTogIm5leHQiLA0KICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgew0KICAgICAgdGhpcy5faW5kZXgrKzsNCiAgICAgIHJldHVybiB0aGlzLl9hcnJheVt0aGlzLl9pbmRleF07DQogICAgfQ0KICB9XSk7DQoNCiAgcmV0dXJuIEl0ZXJhdG9yOw0KfSgpOw0KDQpleHBvcnRzLmRlZmF1bHQgPSBQaXBlbGluZTsNCn0se31dLDMwNTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQondXNlIHN0cmljdCc7DQoNCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsNCiAgdmFsdWU6IHRydWUNCn0pOw0KDQp2YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTsNCg0KZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsgfSB9DQoNCi8qKg0KKiBUaGUgSWRlbnRpdHkgRGF0YSBNb2RlbCBpcyB1c2VkIHRvIG1vZGVsIHRoZSByZVRISU5LIFVzZXIgZW50aXR5LiBUaGUgSWRlbnRpdHkgZGF0YSBtb2RlbCBpcyBoYW5kbGVkIGJ5IElkZW50aXR5IE1hbmFnZW1lbnQgZnVuY3Rpb25hbGl0eS4NCioNCiovDQoNCnZhciBJZGVudGl0eSA9IGZ1bmN0aW9uICgpIHsNCiAgZnVuY3Rpb24gSWRlbnRpdHkoZ3VpZCwgdHlwZSkgew0KICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBJZGVudGl0eSk7DQoNCiAgICB2YXIgX3RoaXMgPSB0aGlzOw0KDQogICAgX3RoaXMuZ3VpZCA9IGd1aWQ7DQogICAgX3RoaXMudHlwZSA9IHR5cGU7DQogICAgX3RoaXMuaWRlbnRpZmllcnNMaXN0ID0ge307DQogIH0NCg0KICBfY3JlYXRlQ2xhc3MoSWRlbnRpdHksIFt7DQogICAga2V5OiAnYWRkSWRlbnRpdHknLA0KICAgIHZhbHVlOiBmdW5jdGlvbiBhZGRJZGVudGl0eShpZGVudGlmaWVyKSB7DQogICAgICB2YXIgX3RoaXMgPSB0aGlzOw0KICAgICAgdmFyIGlkZW50aXR5SW5mb3JtYXRpb24gPSB7DQogICAgICAgIGlkQXNzZXJ0aW9uOiAnJywNCiAgICAgICAgc2VydmljZUFkZHJlc3M6ICcnLA0KICAgICAgICBhdXRoZW50aWNhdGlvbkRhdGE6ICcnLA0KICAgICAgICBhdXRob3Jpc2F0aW9uRGF0YTogJycsDQogICAgICAgIHVzZXJQcm9maWxlOiAnJw0KICAgICAgfTsNCiAgICAgIF90aGlzLmlkZW50aWZpZXJzTGlzdFtpZGVudGlmaWVyXSA9IGlkZW50aXR5SW5mb3JtYXRpb247DQogICAgfQ0KICB9LCB7DQogICAga2V5OiAnYWRkSWRBc3NlcnRpb24nLA0KICAgIHZhbHVlOiBmdW5jdGlvbiBhZGRJZEFzc2VydGlvbihpZGVudGlmaWVyLCBhc3NlcnRpb24sIGlkcCwgc2NvcGUpIHsNCiAgICAgIHZhciBfdGhpcyA9IHRoaXM7DQoNCiAgICAgIHZhciBuZXdJZEFzc2VydGlvbiA9IG5ldyBJZEFzc2VydGlvbihhc3NlcnRpb24sIGlkcCwgc2NvcGUpOw0KDQogICAgICBfdGhpcy5pZEFzc2VydGlvbkxpc3QucHVzaChuZXdJZEFzc2VydGlvbik7DQogICAgfQ0KICB9XSk7DQoNCiAgcmV0dXJuIElkZW50aXR5Ow0KfSgpOw0KDQp2YXIgSWRBc3NlcnRpb24gPSBmdW5jdGlvbiBJZEFzc2VydGlvbihhc3NlcnRpb24sIGlkcCwgc2NvcGUpIHsNCiAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIElkQXNzZXJ0aW9uKTsNCg0KICB2YXIgX3RoaXMgPSB0aGlzOw0KDQogIF90aGlzLmFzc2VydGlvbiA9IGFzc2VydGlvbjsNCiAgX3RoaXMuaWRwID0gaWRwOw0KICBfdGhpcy5zY29wZSA9IHNjb3BlOw0KfTsNCg0KdmFyIElkVmFsaWRhdGlvbiA9IGZ1bmN0aW9uICgpIHsNCiAgZnVuY3Rpb24gSWRWYWxpZGF0aW9uKGlkZW50aXR5LCBjb250ZW50cykgew0KICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBJZFZhbGlkYXRpb24pOw0KDQogICAgdmFyIF90aGlzID0gdGhpczsNCiAgICBfdGhpcy5pZGVudGl0eSA9IGlkZW50aXR5Ow0KICAgIF90aGlzLmNvbnRlbnRzID0gY29udGVudHM7DQogIH0NCg0KICBfY3JlYXRlQ2xhc3MoSWRWYWxpZGF0aW9uLCBbew0KICAgIGtleTogJ3ZhbGlkYXRlcycsDQogICAgdmFsdWU6IGZ1bmN0aW9uIHZhbGlkYXRlcyhpZGVudGl0eSwgY29udGVudHMpIHsNCiAgICAgIC8vVE9ETyBpbXBsZW1lbnQgdGhlIGxvZ2ljDQoNCiAgICB9DQogIH1dKTsNCg0KICByZXR1cm4gSWRWYWxpZGF0aW9uOw0KfSgpOw0KDQpleHBvcnRzLmRlZmF1bHQgPSBJZGVudGl0eTsNCn0se31dLDMwNjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQondXNlIHN0cmljdCc7DQoNCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsNCiAgdmFsdWU6IHRydWUNCn0pOw0KDQp2YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTsNCg0KdmFyIF91dGlscyA9IHJlcXVpcmUoJy4uL3V0aWxzL3V0aWxzLmpzJyk7DQoNCnZhciBfSWRlbnRpdHkgPSByZXF1aXJlKCcuL0lkZW50aXR5Jyk7DQoNCnZhciBfSWRlbnRpdHkyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfSWRlbnRpdHkpOw0KDQpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQ0KDQpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOyB9IH0NCg0KLyoqDQoqDQoqIFRoZSBJZGVudGl0eSBNb2R1bGUgKElkIE1vZHVsZSkgaXMgdGhlIGNvbXBvbmVudCByZXNwb25zaWJsZSBmb3IgaGFuZGxpbmcgdGhlDQoqIHVzZXIgaWRlbnRpdHkgYW5kIHRoZSBhc3NvY2lhdGlvbiBvZiB0aGlzIGlkZW50aXR5IHdpdGggdGhlIEh5cGVydHkgaW5zdGFuY2VzLA0KKiBpbiBvcmRlciB0byBtYWtlIEh5cGVydHkgaW5zdGFuY2VzIGlkZW50aWZpYWJsZS4gVGhlIGlkZW50aXR5IGluIHRoZSByZVRISU5LIHByb2plY3QNCiogaXMgbm90IGZpeGVkIHRvIGEgdW5pcXVlIElkZW50aXR5IFNlcnZpY2UgUHJvdmlkZXIsIGJ1dCBvYnRhaW5lZCB0aHJvdWdoIHNldmVyYWwNCiogZGlmZmVyZW50IElkZW50aXR5IHNvdXJjZXMuIFdpdGggdGhpcyBhcHByb2FjaCwgdGhlIElkIE1vZHVsZSBwcm92aWRlcyB0byB0aGUgdXNlciB0aGUNCiogb3B0aW9uIHRvIGNob29zZSB0aGUgcHJlZmVycmVkIG1ldGhvZCBmb3IgYXV0aGVudGljYXRpb24uDQoqIFRoaXMgbW9kdWxlIHdpbGwgdGh1cyBhYmxlIHRvIHN1cHBvcnQgbXVsdGlwbGUgSWRlbnRpdHkgYWNxdWlzaXRpb24gbWV0aG9kcywNCiogc3VjaCBhcyBPcGVuSUQgY29ubmVjdCAxLjAsIEtlcmJlcm9zIFN5c3RlbSwgb3IgYXV0aGVudGljYXRpb24gdGhyb3VnaCBzbWFydCBjYXJkcy4NCiogRm9yIGV4YW1wbGUsIGEgdXNlciB3aXRoIGEgR29vZ2xlIGFjY291bnQgY2FuIHVzZSB0aGUgR29vZ2xlIGFzIGFuIElkZW50aXR5IFByb3ZpZGVyIHRvIHByb3ZpZGUgSWRlbnRpdHkgVG9rZW5zLA0KKiAgd2hpY2ggY2FuIGJlIHVzZWQgYnkgdGhlIElkZW50aXR5IE1vZHVsZSB0byBhc3NvY2lhdGUgaXQgd2l0aCBhIEh5cGVydHkgaW5zdGFuY2UuDQoqDQoqIFRoZSBJZGVudGl0eSBNb2R1bGUgdXNlcyBhIG5vZGUgcGFja2FnZSwgdGhlIEhlbGxvSlMsIHdoaWNoIGlzIGEgY2xpZW50LXNpZGUgSmF2YVNjcmlwdCBBUEkgZm9yIGF1dGhlbnRpY2F0aW9uDQoqIHRoYXQgZmFjaWxpdGF0ZXMgdGhlIHJlcXVlc3RzIGZvciB0aGUgT3BlbklEIGNvbm5lY3QgcHJvdG9jb2wuIFRoaXMgbWV0aG9kIGFsbG93cyBmb3Igc29tZSBhYnN0cmFjdGlvbg0KKiB3aGVuIG1ha2luZyByZXF1ZXN0cyBmb3IgZGlmZmVyZW50IElkZW50aXR5IFByb3ZpZGVycywgc3VjaCBhcyBPcGVuSUQgY29ubmVjdCB1c2VkIGJ5IEdvb2dsZSwgRmFjZWJvb2ssIE1pY3Jvc29mdCwgZm9yIGV4YW1wbGUuDQoqDQoqIFdoZW4gYSByZXF1ZXN0IGZvciBhIHVzZXIgaWRlbnRpdHkgaXMgbWFkZSB1c2luZyB0aGUgbWV0aG9kIGxvZ2luV2l0aFJQKGlkZW50aWZpZXIsIHNjb3BlKSwNCiogdGhpcyBtZXRob2Qgd2lsbCBhbmFseXNlIHRoZSBJZGVudGl0eSBQcm92aWRlciBjaG9zZW4gdG8gb2J0YWluIGFuIGlkZW50aXR5IGFuZCB3aWxsIHVzZSB0aGUgSGVsbG9KUyBub2RlIHBhY2thZ2UNCiogd2l0aCB0aGUgc2VsZWN0ZWQgSWRlbnRpdHkgUHJvdmlkZXIgYW5kIGlkZW50aXR5IHNjb3BlLiBBZnRlciB0aGUgSGVsbG9KUyByZXF1ZXN0IGZvciBhbiBBY2Nlc3MgVG9rZW4NCiogdG8gdGhlIElkZW50aXR5IFByb3ZpZGVycywgdGhlIHVzZXIgd2lsbCBiZSBwcm9tcHRlZCB0byBhdXRoZW50aWNhdGUgdG93YXJkcyB0aGUgSWRlbnRpdHkgUHJvdmlkZXIuDQoqIFVwb24gcmVjZWl2aW5nIHRoZSBBY2Nlc3MgVG9rZW4sIHRoaXMgdG9rZW4gaXMgdmFsaWRhdGVkIHdpdGggYSBSRVNUZnVsIHdlYiBzZXJ2aWNlIHJlcXVlc3QgdG8gYW4gZW5kcG9pbnQNCiogb24gdGhlIElkZW50aXR5IFByb3ZpZGVyIEF1dGhvcml6YXRpb24gU2VydmVyLCBhbmQgYWZ0ZXIgdGhlIHZhbGlkYXRpb24gaXMgZG9uZSwNCiogYW4gSUQgdG9rZW4gaXMgb2J0YWluZWQgd2l0aCB0aGUgaW5mb3JtYXRpb24gYWNjb3JkaW5nIHRvIHRoZSBzY29wZSByZXF1aXJlZC4NCiogVGhpcyBJRCB0b2tlbiBpcyB0aGVuIHByZXNlcnZlZCBpbiB0aGlzIG1vZHVsZSB0aGF0IGNhbiBvYnRhaW5lZCB0aHJvdWdoIHRoZSBnZXRJZGVudGl0aWVzKCkNCiogYW5kIGlzIHBhc3NlZCBhcyByZXR1cm4gdmFsdWUgb2YgdGhlIGxvZ2luV2l0aFJQIGZ1bmN0aW9uLiBUaGUgbWV0aG9kcyBnZW5lcmF0ZUFzc2VydGlvbiBhbmQgdmFsaWRhdGVBc3NlcnRpb24gaGF2ZSBub3QgeWV0IGJlZW4gZGV2ZWxvcGVkLg0KKg0KKi8NCg0KdmFyIElkZW50aXR5TW9kdWxlID0gZnVuY3Rpb24gKCkgew0KDQogIC8qKg0KICAqIFRoaXMgaXMgdGhlIGNvbnN0cnVjdG9yIHRvIGluaXRpYWxpc2UgdGhlIElkZW50aXR5IE1vZHVsZSBpdCBkb2VzIG5vdCByZXF1aXJlIGFueSBpbnB1dC4NCiAgKi8NCg0KICBmdW5jdGlvbiBJZGVudGl0eU1vZHVsZShydW50aW1lVVJMKSB7DQogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIElkZW50aXR5TW9kdWxlKTsNCg0KICAgIHZhciBfdGhpcyA9IHRoaXM7DQoNCiAgICBpZiAoIXJ1bnRpbWVVUkwpIHRocm93IG5ldyBFcnJvcigncnVudGltZVVSTCBpcyBtaXNzaW5nLicpOw0KDQogICAgX3RoaXMuX3J1bnRpbWVVUkwgPSBydW50aW1lVVJMOw0KICAgIF90aGlzLl9pZG1VUkwgPSBydW50aW1lVVJMICsgJy9pZG0nOw0KDQogICAgX3RoaXMuX2RvbWFpbiA9ICgwLCBfdXRpbHMuZGl2aWRlVVJMKShfdGhpcy5fcnVudGltZVVSTCkuZG9tYWluOw0KDQogICAgLy90byBzdG9yZSBpdGVtcyB3aXRoIHRoaXMgZm9ybWF0OiB7aWRlbnRpdHk6IGlkZW50aXR5VVJMLCB0b2tlbjogdG9rZW5JRH0NCiAgICBfdGhpcy5pZGVudGl0aWVzID0gW107DQogICAgdmFyIG5ld0lkZW50aXR5ID0gbmV3IF9JZGVudGl0eTIuZGVmYXVsdCgnZ3VpZCcsICdIVU1BTicpOw0KICAgIF90aGlzLmlkZW50aXR5ID0gbmV3SWRlbnRpdHk7DQogIH0NCg0KICAvKioNCiAgKiByZXR1cm4gdGhlIG1lc3NhZ2VCdXMgaW4gdGhpcyBSZWdpc3RyeQ0KICAqIEBwYXJhbSB7TWVzc2FnZUJ1c30gICAgICAgICAgIG1lc3NhZ2VCdXMNCiAgKi8NCg0KDQogIF9jcmVhdGVDbGFzcyhJZGVudGl0eU1vZHVsZSwgW3sNCiAgICBrZXk6ICdnZXRJZGVudGl0aWVzJywNCg0KDQogICAgLyoqDQogICAgKiBGdW5jdGlvbiB0byByZXR1cm4gYWxsIHRoZSBpZGVudGl0aWVzIHJlZ2lzdGVyZWQgd2l0aGluIGEgc2Vzc2lvbiBieSBhIHVzZXIuDQogICAgKiBUaGVzZSBpZGVudGl0aWVzIGFyZSByZXR1cm5lZCBpbiBhbiBhcnJheSBjb250YWluaW5nIGEgSlNPTiBwYWNrYWdlIGZvciBlYWNoIHVzZXIgaWRlbnRpdHkuDQogICAgKiBAcmV0dXJuIHtBcnJheTxJZGVudGl0aWVzPn0gICAgICAgICBJZGVudGl0aWVzDQogICAgKi8NCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0SWRlbnRpdGllcygpIHsNCiAgICAgIHZhciBfdGhpcyA9IHRoaXM7DQogICAgICByZXR1cm4gX3RoaXMuaWRlbnRpdGllczsNCiAgICB9DQoNCiAgICAvKioNCiAgICAqIEZ1bmN0aW9uIHRvIHJldHVybiB0aGUgc2VsZWN0ZWQgSWRlbnRpdHkgd2l0aGluIGEgc2Vzc2lvbg0KICAgICogQHJldHVybiB7SWRlbnRpdHl9ICAgICAgICBpZGVudGl0eSAgICAgICAgIGlkZW50aXR5DQogICAgKi8NCg0KICB9LCB7DQogICAga2V5OiAnZ2V0Q3VycmVudElkZW50aXR5JywNCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Q3VycmVudElkZW50aXR5KCkgew0KICAgICAgdmFyIF90aGlzID0gdGhpczsNCiAgICAgIHJldHVybiBfdGhpcy5jdXJyZW50SWRlbnRpdHk7DQogICAgfQ0KDQogICAgLyoqDQogICAgKiBGdW5jdGlvbiB0byBzZXQgdGhlIGN1cnJlbnQgSWRlbnRpdHkgd2l0aCBhIGdpdmVuIElkZW50aXR5DQogICAgKiBAcGFyYW0ge0lkZW50aXR5fSAgICAgICAgaWRlbnRpdHkgICAgICAgICBpZGVudGl0eQ0KICAgICovDQoNCiAgfSwgew0KICAgIGtleTogJ3NldEN1cnJlbnRJZGVudGl0eScsDQogICAgdmFsdWU6IGZ1bmN0aW9uIHNldEN1cnJlbnRJZGVudGl0eShpZGVudGl0eSkgew0KICAgICAgdmFyIF90aGlzID0gdGhpczsNCiAgICAgIF90aGlzLmN1cnJlbnRJZGVudGl0eSA9IGlkZW50aXR5Ow0KICAgIH0NCg0KICAgIC8qKg0KICAgICogRnVuY3Rpb24gdG8gcmVtb3ZlIHRoZSBhbiBpZGVudGl0eSBmcm9tIHRoZSBJZGVudGl0aWVzIGFycmF5DQogICAgKiBAcGFyYW0ge1N0cmluZ30gICAgdXNlclVSTCAgICAgIHVzZXJVUkwNCiAgICAqLw0KDQogIH0sIHsNCiAgICBrZXk6ICdkZWxldGVJZGVudGl0eScsDQogICAgdmFsdWU6IGZ1bmN0aW9uIGRlbGV0ZUlkZW50aXR5KHVzZXJVUkwpIHsNCiAgICAgIHZhciBfdGhpcyA9IHRoaXM7DQoNCiAgICAgIGZvciAodmFyIGlkZW50aXR5IGluIF90aGlzLmlkZW50aXRpZXMpIHsNCiAgICAgICAgaWYgKF90aGlzLmlkZW50aXRpZXNbaWRlbnRpdHldLmlkZW50aXR5ID09PSB1c2VyVVJMKSB7DQogICAgICAgICAgX3RoaXMuaWRlbnRpdGllcy5zcGxpY2UoaWRlbnRpdHksIDEpOw0KICAgICAgICB9DQogICAgICB9DQogICAgfQ0KDQogICAgLyoqDQogICAgKiBGdW5jdGlvbiB0aGF0IHJlc29sdmUgYW5kIGNyZWF0ZSB0aGUgZG9tYWluVVJMIGluIGNhc2UgaXQgaXMgcHJvdmlkZWQgb25lLiBJZiBub3QsIHJlc29sdmUgdGhlIGRlZmF1bHQgZG9tYWluVVJMDQogICAgKiBAcGFyYW0ge1N0cmluZ30gICAgIGlkcERvbWFpbiAgICAgaWRwRG9tYWluIChPcHRpb25hbCkNCiAgICAqLw0KDQogIH0sIHsNCiAgICBrZXk6ICdfcmVzb2x2ZURvbWFpbicsDQogICAgdmFsdWU6IGZ1bmN0aW9uIF9yZXNvbHZlRG9tYWluKGlkcERvbWFpbikgew0KICAgICAgaWYgKCFpZHBEb21haW4pIHsNCiAgICAgICAgcmV0dXJuICdkb21haW4taWRwOi8vZ29vZ2xlLmNvbSc7DQogICAgICB9IGVsc2Ugew0KICAgICAgICByZXR1cm4gJ2RvbWFpbi1pZHA6Ly8nICsgaWRwRG9tYWluOw0KICAgICAgfQ0KICAgIH0NCg0KICAgIC8qKg0KICAgICogRnVuY3Rpb24gdG8gbG9naW4gYSB1c2VyIHdpdGhpbiB0aGUgc2Vzc2lvbiwgaXQgd2lsbCBzdGFydCB0aGUgcHJvY2VzcyB0byBvYnRhaW4gYW4gSWRlbnRpdHkgZnJvbSBhIHVzZXIsIGluY2x1ZGluZyB0aGUgcmVxdWVzdCBmb3IgYW4gaWRlbnRpdHkgQXNzZXJ0aW9uLiBUaGUgZnVuY3Rpb24gcmV0dXJucyBhIHByb21pc2Ugd2l0aCB0aGUgdG9rZW4gcmVjZWl2ZWQgYnkgdGhlIGlkcFByb3h5Lg0KICAgICoNCiAgICAqIEBwYXJhbSAge0lkZW50aWZpZXJ9ICAgICAgaWRlbnRpZmllciAgICAgIGlkZW50aWZpZXINCiAgICAqIEBwYXJhbSAge1Njb3BlfSAgICAgICAgICAgc2NvcGUgICAgICAgICAgIHNjb3BlDQogICAgKiBAcmV0dXJuIHtQcm9taXNlfSAgICAgICAgIFByb21pc2UgICAgICAgICBJRFRva2VuIGNvbnRhaW5pbmcgdGhlIHVzZXIgaW5mb3JtYXRpb24NCiAgICAqLw0KDQogIH0sIHsNCiAgICBrZXk6ICdsb2dpbldpdGhSUCcsDQogICAgdmFsdWU6IGZ1bmN0aW9uIGxvZ2luV2l0aFJQKGlkZW50aWZpZXIsIHNjb3BlKSB7DQogICAgICB2YXIgX3RoaXMgPSB0aGlzOw0KDQogICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgew0KDQogICAgICAgIC8vVE9ETyByZW1vdmUgdGhpcyB2ZXJpZmljYXRpb24gYW5kIHJlZmFjdG9yIHRoaXMgcGFydA0KICAgICAgICBfdGhpcy5jdXJyZW50SWRlbnRpdHkgPSB1bmRlZmluZWQ7DQogICAgICAgIF90aGlzLmdldElkZW50aXR5QXNzZXJ0aW9uKCdpZGVudGlmaWVyJywgJ29yaWdpbicsICdoaW50JywgaWRlbnRpZmllcikudGhlbihmdW5jdGlvbiAodmFsdWUpIHsNCiAgICAgICAgICBjb25zb2xlLmxvZygnbG9naW5XaXRoUlAnKTsNCiAgICAgICAgICByZXNvbHZlKHZhbHVlKTsNCiAgICAgICAgfSwgZnVuY3Rpb24gKGVycikgew0KICAgICAgICAgIGNvbnNvbGUubG9nKCdsb2dpbldpdGhSUCBlcnInKTsNCiAgICAgICAgICByZWplY3QoZXJyKTsNCiAgICAgICAgfSk7DQogICAgICB9KTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAqIEZ1bmN0aW9uIHRoYXQgZmV0Y2ggYW4gaWRlbnRpdHlBc3NlcnRpb24gZnJvbSBhIHVzZXIuDQogICAgKg0KICAgICogQHJldHVybiB7SWRBc3NlcnRpb259ICAgICAgICAgICAgICBJZEFzc2VydGlvbg0KICAgICovDQoNCiAgfSwgew0KICAgIGtleTogJ2dldElkZW50aXR5QXNzZXJ0aW9uJywNCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0SWRlbnRpdHlBc3NlcnRpb24oaWRlbnRpZmllciwgb3JpZ2luLCB1c2VybmFtZUhpbnQsIGlkcERvbWFpbikgew0KICAgICAgdmFyIF90aGlzID0gdGhpczsNCg0KICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsNCg0KICAgICAgICBpZiAoX3RoaXMuY3VycmVudElkZW50aXR5ICE9PSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAvL1RPRE8gdmVyaWZ5IHdoZXRoZXIgdGhlIHRva2VuIGlzIHN0aWxsIHZhbGlkIG9yIG5vdC4NCiAgICAgICAgICAvLyBzaG91bGQgYmUgbmVlZGVkIHRvIG1ha2UgZnVydGhlciByZXF1ZXN0cywgdG8gb2J0YWluIGEgdmFsaWQgdG9rZW4NCiAgICAgICAgICByZXR1cm4gcmVzb2x2ZShfdGhpcy5jdXJyZW50SWRlbnRpdHkpOw0KICAgICAgICB9IGVsc2Ugew0KDQogICAgICAgICAgLy9DSEVDSyB3aGV0aGVyIGlzIGJyb3dzZXIgZW52aXJvbm1lbnQgb3Igbm9kZWpzDQogICAgICAgICAgLy9pZiBpdCBpcyBicm93c2VyLCB0aGVuIGNyZWF0ZSBhIGZha2UgaWRlbnRpdHkNCiAgICAgICAgICBpZiAoIXdpbmRvdykgew0KICAgICAgICAgICAgdmFyIHJhbmRvbU51bWJlciA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMDAwICsgMSk7DQogICAgICAgICAgICB2YXIgaWRlbnRpdHlCdW5kbGUgPSB7IGFzc2VydGlvbjogJ2Fzc2VydGlvbicsIGVtYWlsOiAnbm9kZWpzLScgKyByYW5kb21OdW1iZXIgKyAnQG5vZGVqcy5jb20nLCBpZGVudGl0eTogJ3VzZXI6Ly9ub2RlanMtJyArIHJhbmRvbU51bWJlciwgaWRwOiAnbm9kZWpzJywgaW5mb1Rva2VuOiB7DQogICAgICAgICAgICAgICAgZW1haWw6ICdub2RlanMtJyArIHJhbmRvbU51bWJlciArICdAbm9kZWpzLmNvbScNCiAgICAgICAgICAgICAgfSB9Ow0KICAgICAgICAgICAgX3RoaXMuY3VycmVudElkZW50aXR5ID0gaWRlbnRpdHlCdW5kbGU7DQogICAgICAgICAgICBfdGhpcy5pZGVudGl0aWVzLnB1c2goaWRlbnRpdHlCdW5kbGUpOw0KICAgICAgICAgICAgcmV0dXJuIHJlc29sdmUoaWRlbnRpdHlCdW5kbGUpOw0KICAgICAgICAgIH0gZWxzZSB7DQoNCiAgICAgICAgICAgIF90aGlzLmdlbmVyYXRlQXNzZXJ0aW9uKCcnLCBvcmlnaW4sIHVzZXJuYW1lSGludCwgaWRwRG9tYWluKS50aGVuKGZ1bmN0aW9uICh1cmwpIHsNCiAgICAgICAgICAgICAgX3RoaXMuZ2VuZXJhdGVBc3NlcnRpb24odXJsLCBvcmlnaW4sIHVzZXJuYW1lSGludCwgaWRwRG9tYWluKS50aGVuKGZ1bmN0aW9uICh2YWx1ZSkgew0KICAgICAgICAgICAgICAgIGlmICh2YWx1ZSkgew0KICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh2YWx1ZSk7DQogICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgIHJlamVjdCgnRXJyb3Igb24gb2J0YWluaW5nIElkZW50aXR5Jyk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAoZXJyKSB7DQogICAgICAgICAgICAgICAgcmVqZWN0KGVycik7DQogICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgfSwgZnVuY3Rpb24gKGVycm9yKSB7DQogICAgICAgICAgICAgIHJlamVjdChlcnJvcik7DQogICAgICAgICAgICB9KTsNCiAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgIH0pOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICogUmVxdWVzdHMgdGhlIElkcFByb3h5IGZyb20gYSBnaXZlbiBEb21haW4gZm9yIGFuIGlkZW50aXR5QXNzZXJ0aW9uDQogICAgKg0KICAgICogQHBhcmFtICB7RE9NU3RyaW5nfSBjb250ZW50cyAgICAgY29udGVudHMNCiAgICAqIEBwYXJhbSAge0RPTVN0cmluZ30gb3JpZ2luICAgICAgIG9yaWdpbg0KICAgICogQHBhcmFtICB7RE9NU3RyaW5nfSB1c2VybmFtZUhpbnQgdXNlcm5hbWVIaW50DQogICAgKiBAcmV0dXJuIHtJZEFzc2VydGlvbn0gICAgICAgICAgICAgIElkQXNzZXJ0aW9uDQogICAgKi8NCg0KICB9LCB7DQogICAga2V5OiAnZ2VuZXJhdGVBc3NlcnRpb24nLA0KICAgIHZhbHVlOiBmdW5jdGlvbiBnZW5lcmF0ZUFzc2VydGlvbihjb250ZW50cywgb3JpZ2luLCB1c2VybmFtZUhpbnQsIGlkcERvbWFpbikgew0KICAgICAgdmFyIF90aGlzID0gdGhpczsNCiAgICAgIHZhciBkb21haW4gPSBfdGhpcy5fcmVzb2x2ZURvbWFpbihpZHBEb21haW4pOw0KICAgICAgdmFyIG1lc3NhZ2UgPSB2b2lkIDA7DQoNCiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7DQoNCiAgICAgICAgbWVzc2FnZSA9IHsgdHlwZTogJ2V4ZWN1dGUnLCB0bzogZG9tYWluLCBmcm9tOiBfdGhpcy5faWRtVVJMLCBib2R5OiB7IHJlc291cmNlOiAnaWRlbnRpdHknLCBtZXRob2Q6ICdnZW5lcmF0ZUFzc2VydGlvbicsIHBhcmFtczogeyBjb250ZW50czogY29udGVudHMsIG9yaWdpbjogb3JpZ2luLCB1c2VybmFtZUhpbnQ6IHVzZXJuYW1lSGludCB9IH0gfTsNCg0KICAgICAgICBfdGhpcy5fbWVzc2FnZUJ1cy5wb3N0TWVzc2FnZShtZXNzYWdlLCBmdW5jdGlvbiAocmVzKSB7DQogICAgICAgICAgdmFyIHJlc3VsdCA9IHJlcy5ib2R5LnZhbHVlOw0KDQogICAgICAgICAgaWYgKHJlc3VsdC5sb2dpblVybCkgew0KICAgICAgICAgICAgKGZ1bmN0aW9uICgpIHsNCg0KICAgICAgICAgICAgICAvL2xldCBtc2dPcGVuSWZyYW1lID0ge3R5cGU6ICdleGVjdXRlJywgZnJvbTogX3RoaXMuX2lkbVVSTCwgdG86IF90aGlzLl9ydW50aW1lVVJMICsgJy9ndWktbWFuYWdlcicsIGJvZHk6IHttZXRob2Q6ICd1bmhpZGVBZG1pblBhZ2UnfX07DQoNCiAgICAgICAgICAgICAgdmFyIHdpbiA9IHdpbmRvdy5vcGVuKHJlc3VsdC5sb2dpblVybCwgJ29wZW5JRHJlcXVlc3QnLCAnd2lkdGg9ODAwLCBoZWlnaHQ9NjAwJyk7DQogICAgICAgICAgICAgIGlmICh3aW5kb3cuY29yZG92YSkgew0KICAgICAgICAgICAgICAgIHdpbi5hZGRFdmVudExpc3RlbmVyKCdsb2Fkc3RhcnQnLCBmdW5jdGlvbiAoZSkgew0KICAgICAgICAgICAgICAgICAgdmFyIHVybCA9IGUudXJsOw0KICAgICAgICAgICAgICAgICAgdmFyIGNvZGUgPSAvXCZjb2RlPSguKykkLy5leGVjKHVybCk7DQogICAgICAgICAgICAgICAgICB2YXIgZXJyb3IgPSAvXCZlcnJvcj0oLispJC8uZXhlYyh1cmwpOw0KDQogICAgICAgICAgICAgICAgICBpZiAoY29kZSB8fCBlcnJvcikgew0KICAgICAgICAgICAgICAgICAgICB3aW4uY2xvc2UoKTsNCiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh1cmwpOw0KICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIChmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgICB2YXIgcG9sbFRpbWVyID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgICAgICAgIGlmICh3aW4uY2xvc2VkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoJ1NvbWUgZXJyb3Igb2NjdXJlZCB3aGVuIHRyeWluZyB0byBnZXQgaWRlbnRpdHkuJyk7DQogICAgICAgICAgICAgICAgICAgICAgICBjbGVhckludGVydmFsKHBvbGxUaW1lcik7DQogICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgaWYgKHdpbi5kb2N1bWVudC5VUkwuaW5kZXhPZignaWRfdG9rZW4nKSAhPT0gLTEgfHwgd2luLmRvY3VtZW50LlVSTC5pbmRleE9mKGxvY2F0aW9uLm9yaWdpbikgIT09IC0xKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuY2xlYXJJbnRlcnZhbChwb2xsVGltZXIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHVybCA9IHdpbi5kb2N1bWVudC5VUkw7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIHdpbi5jbG9zZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh1cmwpOw0KICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkgew0KICAgICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coZSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgIH0sIDUwMCk7DQogICAgICAgICAgICAgICAgfSkoKTsNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSkoKTsNCiAgICAgICAgICB9IGVsc2UgaWYgKHJlc3VsdCkgew0KDQogICAgICAgICAgICB2YXIgYXNzZXJ0aW9uUGFyc2VkID0gSlNPTi5wYXJzZShhdG9iKHJlc3VsdC5hc3NlcnRpb24pKTsNCiAgICAgICAgICAgIHZhciBpZFRva2VuID0gdm9pZCAwOw0KDQogICAgICAgICAgICAvL1RPRE8gcmVtb3ZlIHRoZSB2ZXJpZmljYXRpb24gYW5kIHJlbW92ZSB0aGUgdG9rZW5JREpTT04gZnJvbSB0aGUgZ29vZ2xlIGlkcFByb3h5Ow0KICAgICAgICAgICAgaWYgKGFzc2VydGlvblBhcnNlZC50b2tlbklESlNPTikgew0KICAgICAgICAgICAgICBpZFRva2VuID0gYXNzZXJ0aW9uUGFyc2VkLnRva2VuSURKU09OOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgaWRUb2tlbiA9IGFzc2VydGlvblBhcnNlZDsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgaWYgKGlkVG9rZW4pIHsNCiAgICAgICAgICAgICAgcmVzdWx0LmlkZW50aXR5ID0gKDAsIF91dGlscy5nZXRVc2VyVVJMRnJvbUVtYWlsKShpZFRva2VuLmVtYWlsKTsNCg0KICAgICAgICAgICAgICBfdGhpcy5pZGVudGl0eS5hZGRJZGVudGl0eShyZXN1bHQpOw0KDQogICAgICAgICAgICAgIC8vIGNoZWNrIGlmIGV4aXN0cyBhbnkgaW5mb1Rva2VuIGluIHRoZSByZXN1bHQgcmVjZWl2ZWQNCiAgICAgICAgICAgICAgdmFyIGluZm9Ub2tlbiA9IHJlc3VsdC5pbmZvVG9rZW4gPyByZXN1bHQuaW5mb1Rva2VuIDoge307DQogICAgICAgICAgICAgIHZhciB1c2VyUHJvZmlsZUJ1bmRsZSA9IHsgdXNlcm5hbWU6IGlkVG9rZW4uZW1haWwsIGNuOiBpZFRva2VuLm5hbWUsIGF2YXRhcjogaW5mb1Rva2VuLnBpY3R1cmUsIGxvY2FsZTogaW5mb1Rva2VuLmxvY2FsZSwgdXNlclVSTDogKDAsIF91dGlscy5nZXRVc2VyVVJMRnJvbUVtYWlsKShpZFRva2VuLmVtYWlsKSB9Ow0KDQogICAgICAgICAgICAgIC8vY3JlYXRpb24gb2YgYSBuZXcgSlNPTiB3aXRoIHRoZSBpZGVudGl0eSB0byBzZW5kIHZpYSBtZXNzYWdlcw0KICAgICAgICAgICAgICB2YXIgbmV3SWRlbnRpdHkgPSB7IHVzZXJQcm9maWxlOiB1c2VyUHJvZmlsZUJ1bmRsZSwgaWRwOiByZXN1bHQuaWRwLmRvbWFpbiwgYXNzZXJ0aW9uOiByZXN1bHQuYXNzZXJ0aW9uLCBlbWFpbDogaWRUb2tlbi5lbWFpbCwgaWRlbnRpdHk6IHJlc3VsdC5pZGVudGl0eSwgaWRUb2tlbjogaWRUb2tlbiwgaW5mb1Rva2VuOiBpbmZvVG9rZW4gfTsNCiAgICAgICAgICAgICAgcmVzdWx0Lm1lc3NhZ2VJbmZvID0gbmV3SWRlbnRpdHk7DQoNCiAgICAgICAgICAgICAgX3RoaXMuY3VycmVudElkZW50aXR5ID0gbmV3SWRlbnRpdHk7DQogICAgICAgICAgICAgIF90aGlzLmlkZW50aXRpZXMucHVzaChyZXN1bHQpOw0KICAgICAgICAgICAgICByZXNvbHZlKG5ld0lkZW50aXR5KTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgcmVqZWN0KCdlcnJvciBvbiBvYnRhaW5pbmcgaWRlbnRpdHkgaW5mb3JtYXRpb24nKTsNCiAgICAgICAgICB9DQogICAgICAgIH0pOw0KICAgICAgfSk7DQogICAgfQ0KDQogICAgLyoqDQogICAgKiBPVEhFUiBVU0VSJ1MgSURFTlRJVFkNCiAgICAqLw0KDQogICAgLyoqDQogICAgKiBSZXF1ZXN0cyB0aGUgSWRwUHJveHkgZnJvbSBhIGdpdmVuIERvbWFpbiB0byB2YWxpZGF0ZSBhbiBJZGVudGl0eUFzc2VydGlvbg0KICAgICogUmV0dXJucyBhIHByb21pc2Ugd2l0aCB0aGUgcmVzdWx0IGZyb20gdGhlIHZhbGlkYXRpb24uDQogICAgKiBAcGFyYW0gIHtET01TdHJpbmd9IGFzc2VydGlvbg0KICAgICogQHBhcmFtICB7RE9NU3RyaW5nfSBvcmlnaW4gICAgICAgb3JpZ2luDQogICAgKiBAcmV0dXJuIHtQcm9taXNlfSAgICAgICAgIFByb21pc2UgICAgICAgICBwcm9taXNlIHdpdGggdGhlIHJlc3VsdCBmcm9tIHRoZSB2YWxpZGF0aW9uDQogICAgKi8NCg0KICB9LCB7DQogICAga2V5OiAndmFsaWRhdGVBc3NlcnRpb24nLA0KICAgIHZhbHVlOiBmdW5jdGlvbiB2YWxpZGF0ZUFzc2VydGlvbihhc3NlcnRpb24sIG9yaWdpbiwgaWRwRG9tYWluKSB7DQogICAgICB2YXIgX3RoaXMgPSB0aGlzOw0KDQogICAgICB2YXIgZG9tYWluID0gX3RoaXMuX3Jlc29sdmVEb21haW4oaWRwRG9tYWluKTsNCg0KICAgICAgdmFyIG1lc3NhZ2UgPSB7IHR5cGU6ICdFWEVDVVRFJywgdG86IGRvbWFpbiwgZnJvbTogX3RoaXMuX2lkbVVSTCwgYm9keTogeyByZXNvdXJjZTogJ2lkZW50aXR5JywgbWV0aG9kOiAndmFsaWRhdGVBc3NlcnRpb24nLA0KICAgICAgICAgIHBhcmFtczogeyBhc3NlcnRpb246IGFzc2VydGlvbiwgb3JpZ2luOiBvcmlnaW4gfSB9IH07DQoNCiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7DQogICAgICAgIF90aGlzLl9tZXNzYWdlQnVzLnBvc3RNZXNzYWdlKG1lc3NhZ2UsIGZ1bmN0aW9uIChyZXN1bHQpIHsNCiAgICAgICAgICBpZiAocmVzdWx0LmJvZHkuY29kZSA9PT0gMjAwKSB7DQogICAgICAgICAgICByZXNvbHZlKHJlc3VsdC5ib2R5LnZhbHVlKTsNCiAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgcmVqZWN0KCdlcnJvcicsIHJlc3VsdC5ib2R5LmNvZGUpOw0KICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgICB9KTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAqIEZ1bmN0aW9uIHRoYXQgZW5jcnlwdHMgdGhlIG1lc3NhZ2VzIHRvIHNlbmQgYW5kIGRlY3J5cHRzIGFuZCB2YWxpZGF0ZSB0aGUgbWVzc2FnZXMgcmVjZWl2ZWQuDQogICAgKiBJbiBjYXNlIHRoZXJlIGlzIG5vIHNlc3Npb24ga2V5IGVzdGFibGlzaGVkIGJldHdlZW4gdGhlIHR3byB1c2VycyBmcm9tIHRoZSBtZXNzYWdlLCB0aGlzIGZ1bmN0aW9uIHdpbGwgc3RhcnQgdGhlIGNvbW11bmljYXRpb24gd2l0aCB0aGUgb3RoZXIgdXNlciBhY3F1aXJlIGEgc2Vzc2lvbiBrZXkuDQogICAgKiovDQoNCiAgfSwgew0KICAgIGtleTogJ3ZhbGlkYXRlTWVzc2FnZScsDQogICAgdmFsdWU6IGZ1bmN0aW9uIHZhbGlkYXRlTWVzc2FnZShtZXNzYWdlKSB7DQogICAgICBjb25zb2xlLmxvZyhtZXNzYWdlKTsNCiAgICB9DQogIH0sIHsNCiAgICBrZXk6ICdtZXNzYWdlQnVzJywNCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsNCiAgICAgIHZhciBfdGhpcyA9IHRoaXM7DQogICAgICByZXR1cm4gX3RoaXMuX21lc3NhZ2VCdXM7DQogICAgfQ0KDQogICAgLyoqDQogICAgKiBTZXQgdGhlIG1lc3NhZ2VCdXMgaW4gdGhpcyBSZWdpc3RyeQ0KICAgICogQHBhcmFtIHtNZXNzYWdlQnVzfSAgICAgICAgICAgbWVzc2FnZUJ1cw0KICAgICovDQogICAgLA0KICAgIHNldDogZnVuY3Rpb24gc2V0KG1lc3NhZ2VCdXMpIHsNCiAgICAgIHZhciBfdGhpcyA9IHRoaXM7DQogICAgICBfdGhpcy5fbWVzc2FnZUJ1cyA9IG1lc3NhZ2VCdXM7DQogICAgfQ0KICB9XSk7DQoNCiAgcmV0dXJuIElkZW50aXR5TW9kdWxlOw0KfSgpOw0KDQpleHBvcnRzLmRlZmF1bHQgPSBJZGVudGl0eU1vZHVsZTsNCn0seyIuLi91dGlscy91dGlscy5qcyI6MzIyLCIuL0lkZW50aXR5IjozMDV9XSwzMDc6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KJ3VzZSBzdHJpY3QnOw0KDQpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7DQogICAgdmFsdWU6IHRydWUNCn0pOw0KDQp2YXIgX3VuaXZlcnNhbExvY2Fsc3RvcmFnZSA9IHJlcXVpcmUoJ3VuaXZlcnNhbC1sb2NhbHN0b3JhZ2UnKTsNCg0KdmFyIF91bml2ZXJzYWxMb2NhbHN0b3JhZ2UyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdW5pdmVyc2FsTG9jYWxzdG9yYWdlKTsNCg0KZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0NCg0KdmFyIHBlcnNpc3RlbmNlTWFuYWdlciA9IHsNCiAgICBzZXQ6IGZ1bmN0aW9uIHNldChrZXksIHZlcnNpb24sIHZhbHVlKSB7DQogICAgICAgIF91bml2ZXJzYWxMb2NhbHN0b3JhZ2UyLmRlZmF1bHQuc2V0SXRlbShrZXksIEpTT04uc3RyaW5naWZ5KHsgJ3ZlcnNpb24nOiB2ZXJzaW9uLCAndmFsdWUnOiB2YWx1ZSB9KSk7DQogICAgfSwNCg0KICAgIGdldDogZnVuY3Rpb24gZ2V0KGtleSkgew0KICAgICAgICB0cnkgew0KICAgICAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UoX3VuaXZlcnNhbExvY2Fsc3RvcmFnZTIuZGVmYXVsdC5nZXRJdGVtKGtleSkpLnZhbHVlOw0KICAgICAgICB9IGNhdGNoIChlKSB7DQogICAgICAgICAgICAvLyByZXR1cm4gdW5kZWZpbmVkDQogICAgICAgIH0NCiAgICB9LA0KDQogICAgZ2V0VmVyc2lvbjogZnVuY3Rpb24gZ2V0VmVyc2lvbihrZXkpIHsNCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgIHJldHVybiBKU09OLnBhcnNlKF91bml2ZXJzYWxMb2NhbHN0b3JhZ2UyLmRlZmF1bHQuZ2V0SXRlbShrZXkpKS52ZXJzaW9uOw0KICAgICAgICB9IGNhdGNoIChlKSB7DQogICAgICAgICAgICAvLyByZXR1cm4gdW5kZWZpbmVkDQogICAgICAgIH0NCiAgICB9LA0KDQogICAgZGVsZXRlOiBmdW5jdGlvbiBfZGVsZXRlKGtleSkgew0KICAgICAgICBfdW5pdmVyc2FsTG9jYWxzdG9yYWdlMi5kZWZhdWx0LnJlbW92ZUl0ZW0oa2V5KTsNCiAgICB9DQp9OyAvKioNCiAgICogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHn428gZSBTaXN0ZW1hcyBTQQ0KICAgKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRA0KICAgKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0wNCiAgICogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYNCiAgICogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBDQogICAqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUcNCiAgICogQ29weXJpZ2h0IDIwMTYgQXBpemVlDQogICAqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElODQogICAqDQogICAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOw0KICAgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuDQogICAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdA0KICAgKg0KICAgKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMA0KICAgKg0KICAgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlDQogICAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsDQogICAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLg0KICAgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kDQogICAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLg0KICAgKiovDQoNCg0KZXhwb3J0cy5kZWZhdWx0ID0gcGVyc2lzdGVuY2VNYW5hZ2VyOw0KfSx7InVuaXZlcnNhbC1sb2NhbHN0b3JhZ2UiOjI5OX1dLDMwODpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQondXNlIHN0cmljdCc7DQoNCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsNCiAgdmFsdWU6IHRydWUNCn0pOw0KDQp2YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTsNCg0KdmFyIF9QZXJzaXN0ZW5jZU1hbmFnZXIgPSByZXF1aXJlKCcuLi9wZXJzaXN0ZW5jZS9QZXJzaXN0ZW5jZU1hbmFnZXInKTsNCg0KdmFyIF9QZXJzaXN0ZW5jZU1hbmFnZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfUGVyc2lzdGVuY2VNYW5hZ2VyKTsNCg0KdmFyIF91dGlscyA9IHJlcXVpcmUoJy4uL3V0aWxzL3V0aWxzJyk7DQoNCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9DQoNCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7IH0gfQ0KDQovKioNCiogVGhlIFBvbGljeSBEZWNpc2lvbiBQb2ludCAoUERQKSBkZWNpZGVzIGlmIGEgbWVzc2FnZSBpcyB0byBiZSBhdXRob3Jpc2VkIGJ5IGNoZWNraW5nIGEgc2V0IG9mDQoqIHBvbGljaWVzLiBUaGUgcmVzb3VyY2UgdG8gYmUgdmVyaWZpZWQgaXMgc3BlY2lmaWVkIGluIHRoZSBmaXJzdCB3b3JkIG9mIHRoZSAnY29uZGl0aW9uJyBmaWVsZCBvZg0KKiBhIFBvbGljeSBvYmplY3QuIFRoZSBpbXBsZW1lbnRhdGlvbiB0aGF0IHZlcmlmaWVzIGlmIHRoZSBtZXNzYWdlIGlzIGNvbXBsaWFudCB3aXRoIGEgcG9saWN5IGlzDQoqIHNwZWNpZmllZCBpbiBhIGhhc2h0YWJsZSB0byBhbGxvdyBkeW5hbWljIGRlZmluaXRpb24gb2YgdGhlIGltcGxlbWVudGF0aW9uLCBwcm92aWRpbmcNCiogZXh0ZW5zaWJpbGl0eSB0byB0aGUgUG9saWN5IEVuZ2luZSBmdW5jdGlvbmFsaXRpZXMuDQoqLw0KDQp2YXIgUERQID0gZnVuY3Rpb24gKCkgew0KDQogIC8qKg0KICAqIFRoaXMgbWV0aG9kIGlzIGludm9rZWQgYnkgdGhlIFBvbGljeSBFbmdpbmUgYW5kIGluc3RhbnRpYXRlcyB0aGUgUG9saWN5IERlY2lzaW9uIFBvaW50LiBJdA0KICAqIGluaXRpYWxpc2VzIG9yIGxvYWRzIGZyb20gdGhlIFBlcnNpc3RlbmNlIE1hbmFnZXIgdGhlIG9iamVjdCAnbXlHcm91cHMnIHRvIHN0b3JlIHRoZSB1c2VyJ3MNCiAgKiBncm91cHMuDQogICogQHBhcmFtICB7UmVnaXN0cnl9ICAgIG11Y2hydW50aW1lUmVnaXN0cnkNCiAgKi8NCg0KICBmdW5jdGlvbiBQRFAocnVudGltZVJlZ2lzdHJ5KSB7DQogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFBEUCk7DQoNCiAgICB2YXIgX3RoaXMgPSB0aGlzOw0KICAgIF90aGlzLnJ1bnRpbWVSZWdpc3RyeSA9IHJ1bnRpbWVSZWdpc3RyeTsNCiAgICBfdGhpcy5zeXN0ZW1WYXJpYWJsZXMgPSBfdGhpcy5zZXRTeXN0ZW1WYXJpYWJsZXMoKTsNCiAgICBfdGhpcy5vcGVyYXRpb25zID0gX3RoaXMuc2V0T3BlcmF0aW9ucygpOw0KICB9DQoNCiAgLyogU3lzdGVtIHZhcmlhYmxlJ3Mgb2J0ZW50aW9uLCBuZWVkZWQgdG8gdmVyaWZ5IGEgY29uZGl0aW9uLiAqLw0KDQoNCiAgX2NyZWF0ZUNsYXNzKFBEUCwgW3sNCiAgICBrZXk6ICdzZXRTeXN0ZW1WYXJpYWJsZXMnLA0KICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRTeXN0ZW1WYXJpYWJsZXMoKSB7DQogICAgICB2YXIgX3RoaXMgPSB0aGlzOw0KICAgICAgdmFyIHN5c3RlbVZhcmlhYmxlcyA9IHsNCiAgICAgICAgc291cmNlOiBmdW5jdGlvbiBzb3VyY2UobWVzc2FnZSkgew0KICAgICAgICAgIHJldHVybiBtZXNzYWdlLmJvZHkuaWRlbnRpdHkuZW1haWw7DQogICAgICAgIH0sDQogICAgICAgIGRvbWFpbjogZnVuY3Rpb24gZG9tYWluKG1lc3NhZ2UpIHsNCiAgICAgICAgICByZXR1cm4gKDAsIF91dGlscy5kaXZpZGVFbWFpbCkobWVzc2FnZS5ib2R5LmlkZW50aXR5LmVtYWlsKS5kb21haW47DQogICAgICAgIH0sDQogICAgICAgIHRpbWU6IGZ1bmN0aW9uIHRpbWUoKSB7DQogICAgICAgICAgcmV0dXJuIF90aGlzLmdldEN1cnJlbnRUaW1lKCk7DQogICAgICAgIH0sDQogICAgICAgIHdlZWtkYXk6IGZ1bmN0aW9uIHdlZWtkYXkoKSB7DQogICAgICAgICAgcmV0dXJuIFN0cmluZyhuZXcgRGF0ZSgpLmdldERheSgpKTsNCiAgICAgICAgfSwNCiAgICAgICAgZGF0ZTogZnVuY3Rpb24gZGF0ZSgpIHsNCiAgICAgICAgICByZXR1cm4gX3RoaXMuZ2V0RGF0ZSgpOw0KICAgICAgICB9DQogICAgICB9Ow0KICAgICAgcmV0dXJuIHN5c3RlbVZhcmlhYmxlczsNCiAgICB9DQogIH0sIHsNCiAgICBrZXk6ICdzZXRPcGVyYXRpb25zJywNCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0T3BlcmF0aW9ucygpIHsNCiAgICAgIHZhciBvcGVyYXRpb25zID0ge307DQoNCiAgICAgIG9wZXJhdGlvbnMuYmV0d2Vlbk1pbnV0ZXMgPSAnX3RoaXMuaXNUaW1lQmV0d2Vlbih2YWx1ZSwgcGFyc2VJbnQocGFyYW1zWzBdKSwgcGFyc2VJbnQocGFyYW1zWzFdKSknOw0KICAgICAgb3BlcmF0aW9ucy5pbiA9ICdfdGhpcy5nZXRMaXN0KHBhcmFtc1swXSkuaW5kZXhPZih2YWx1ZSkgIT0gLTEnOw0KICAgICAgb3BlcmF0aW9ucy5iZXR3ZWVuID0gJ3ZhbHVlID4gcGFyYW1zWzBdICYmIHZhbHVlIDwgcGFyYW1zWzFdJzsNCiAgICAgIG9wZXJhdGlvbnMuZXF1YWxzID0gJyhwYXJhbXNbMF0gPT09IFwnKlwnKSB8fCB2YWx1ZSA9PT0gcGFyYW1zWzBdJzsNCg0KICAgICAgcmV0dXJuIG9wZXJhdGlvbnM7DQogICAgfQ0KDQogICAgLyoqDQogICAgKiBWZXJpZmllcyBpZiB0aGUgZ2l2ZW4gbWVzc2FnZSBpcyBjb21wbGlhbnQgd2l0aCB0aGUgZ2l2ZW4gcG9saWNpZXMuIElmIG9uZSBvZiB0aGUgcG9saWNpZXMNCiAgICAqIGV2YWx1YXRlcyB0byAnZmFsc2UnLCB0aGVuIHRoZSBtZXNzYWdlIGlzIG5vdCBhdXRob3Jpc2VkLiBSZXR1cm5zIHRoZSBmaW5hbCBhdXRob3Jpc2F0aW9uDQogICAgKiBkZWNpc2lvbiBhbmQgYSBzZXQgb2YgYWN0aW9ucyB0aGF0IHBvbGljaWVzIG1heSByZXF1aXJlLg0KICAgICogQHBhcmFtIHtNZXNzYWdlfSAgbWVzc2FnZQ0KICAgICogQHBhcmFtIHtVUkx9ICAgICAgaHlwZXJ0eVRvVmVyaWZ5DQogICAgKiBAcGFyYW0ge0FycmF5fSAgICBwb2xpY2llcw0KICAgICogQHJldHVybiB7QXJyYXl9ICAgW2F1dGhEZWNpc2lvbiwgYWN0aW9uc10NCiAgICAqLw0KDQogIH0sIHsNCiAgICBrZXk6ICdldmFsdWF0ZScsDQogICAgdmFsdWU6IGZ1bmN0aW9uIGV2YWx1YXRlKG1lc3NhZ2UsIHBvbGljaWVzKSB7DQogICAgICB2YXIgX3RoaXMgPSB0aGlzOw0KICAgICAgdmFyIHJlc3VsdHMgPSBbdHJ1ZV07DQogICAgICB2YXIgYWN0aW9ucyA9IFtdOw0KICAgICAgZm9yICh2YXIgaSBpbiBwb2xpY2llcykgew0KICAgICAgICB2YXIgcG9saWN5ID0gcG9saWNpZXNbaV07DQogICAgICAgIHZhciBjb25kaXRpb24gPSBwb2xpY3kuY29uZGl0aW9uLnNwbGl0KCcgJyk7DQoNCiAgICAgICAgdmFyIHZhcmlhYmxlID0gY29uZGl0aW9uWzBdOw0KICAgICAgICB2YXIgb3BlcmF0aW9uID0gY29uZGl0aW9uWzFdOw0KICAgICAgICB2YXIgcGFyYW1zID0gY29uZGl0aW9uLnNsaWNlKDIpOw0KICAgICAgICB2YXIgdmFsdWUgPSBfdGhpcy5zeXN0ZW1WYXJpYWJsZXNbdmFyaWFibGVdKG1lc3NhZ2UpOw0KICAgICAgICB2YXIgdmVyaWZpZXNDb25kaXRpb24gPSBldmFsKF90aGlzLm9wZXJhdGlvbnNbb3BlcmF0aW9uXSk7DQogICAgICAgIGlmICh2ZXJpZmllc0NvbmRpdGlvbikgew0KICAgICAgICAgIHJlc3VsdHMucHVzaChwb2xpY3kuYXV0aG9yaXNlKTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vYWN0aW9ucy5wdXNoKHJlc3VsdFsxXSk7DQogICAgICB9DQoNCiAgICAgIHZhciBhdXRoRGVjaXNpb24gPSByZXN1bHRzLmluZGV4T2YoZmFsc2UpID09PSAtMTsNCiAgICAgIHJldHVybiBbYXV0aERlY2lzaW9uLCBhY3Rpb25zXTsNCiAgICB9DQogIH0sIHsNCiAgICBrZXk6ICdnZXRDdXJyZW50VGltZScsDQogICAgdmFsdWU6IGZ1bmN0aW9uIGdldEN1cnJlbnRUaW1lKCkgew0KICAgICAgdmFyIG5vdyA9IG5ldyBEYXRlKCk7DQogICAgICByZXR1cm4gcGFyc2VJbnQoU3RyaW5nKG5vdy5nZXRIb3VycygpKSArIG5vdy5nZXRNaW51dGVzKCkpOw0KICAgIH0NCiAgfSwgew0KICAgIGtleTogJ2dldERhdGUnLA0KICAgIHZhbHVlOiBmdW5jdGlvbiBnZXREYXRlKCkgew0KICAgICAgdmFyIGRhdGUgPSBuZXcgRGF0ZSgpOw0KICAgICAgcmV0dXJuIGRhdGUuZ2V0RGF0ZSgpICsgJy8nICsgKGRhdGUuZ2V0TW9udGgoKSArIDEpICsgJy8nICsgZGF0ZS5nZXRGdWxsWWVhcigpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICogVmVyaWZpZXMgaWYgdGhlIGN1cnJlbnQgdGltZSBpcyBiZXR3ZWVuIHRoZSBnaXZlbiBzdGFydCBhbmQgZW5kIHRpbWVzLg0KICAgICogQHBhcmFtIHtOdW1iZXJ9ICAgICBzdGFydA0KICAgICogQHBhcmFtIHtOdW1iZXJ9ICAgICBlbmQNCiAgICAqIEByZXR1cm4ge0Jvb2xlYW59ICAgYm9vbGVhbg0KICAgICovDQoNCiAgfSwgew0KICAgIGtleTogJ2lzVGltZUJldHdlZW4nLA0KICAgIHZhbHVlOiBmdW5jdGlvbiBpc1RpbWVCZXR3ZWVuKG5vdywgc3RhcnQsIGVuZCkgew0KICAgICAgaWYgKGVuZCA8IHN0YXJ0KSB7DQogICAgICAgIG5vdyA9IG5vdyA8IHN0YXJ0ID8gbm93ICs9IDI0MDAgOiBub3c7DQogICAgICAgIGVuZCArPSAyNDAwOw0KICAgICAgfQ0KICAgICAgcmV0dXJuIG5vdyA+IHN0YXJ0ICYmIG5vdyA8IGVuZDsNCiAgICB9DQogIH0sIHsNCiAgICBrZXk6ICdnZXRHcm91cHNOYW1lcycsDQogICAgdmFsdWU6IGZ1bmN0aW9uIGdldEdyb3Vwc05hbWVzKCkgew0KICAgICAgdmFyIG15R3JvdXBzID0gX1BlcnNpc3RlbmNlTWFuYWdlcjIuZGVmYXVsdC5nZXQoJ2dyb3VwcycpIHx8IHt9Ow0KICAgICAgdmFyIGdyb3Vwc05hbWVzID0gW107DQoNCiAgICAgIGlmIChteUdyb3VwcyAhPT0ge30pIHsNCiAgICAgICAgZm9yICh2YXIgZ3JvdXBOYW1lIGluIG15R3JvdXBzKSB7DQogICAgICAgICAgZ3JvdXBzTmFtZXMucHVzaChncm91cE5hbWUpOw0KICAgICAgICB9DQogICAgICB9DQoNCiAgICAgIHJldHVybiBncm91cHNOYW1lczsNCiAgICB9DQoNCiAgICAvKioNCiAgICAqIFJldHVybnMgdGhlIGdyb3VwIHdpdGggdGhlIGdpdmVuIGdyb3VwIG5hbWUuDQogICAgKiBAcGFyYW0gIHtTdHJpbmd9ICBncm91cE5hbWUNCiAgICAqIEByZXR1cm4ge0FycmF5fSAgIGdyb3VwDQogICAgKi8NCg0KICB9LCB7DQogICAga2V5OiAnZ2V0TGlzdCcsDQogICAgdmFsdWU6IGZ1bmN0aW9uIGdldExpc3QoZ3JvdXBOYW1lKSB7DQogICAgICB2YXIgbXlHcm91cHMgPSBfUGVyc2lzdGVuY2VNYW5hZ2VyMi5kZWZhdWx0LmdldCgnZ3JvdXBzJykgfHwge307DQogICAgICByZXR1cm4gZ3JvdXBOYW1lIGluIG15R3JvdXBzID8gbXlHcm91cHNbZ3JvdXBOYW1lXSA6IFtdOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICogQ3JlYXRlcyBhIGdyb3VwIHdpdGggdGhlIGdpdmVuIG5hbWUuDQogICAgKiBAcGFyYW0gIHtTdHJpbmd9ICBncm91cE5hbWUNCiAgICAqLw0KDQogIH0sIHsNCiAgICBrZXk6ICdjcmVhdGVHcm91cCcsDQogICAgdmFsdWU6IGZ1bmN0aW9uIGNyZWF0ZUdyb3VwKGdyb3VwTmFtZSkgew0KICAgICAgdmFyIG15R3JvdXBzID0gX1BlcnNpc3RlbmNlTWFuYWdlcjIuZGVmYXVsdC5nZXQoJ2dyb3VwcycpIHx8IHt9Ow0KICAgICAgbXlHcm91cHNbZ3JvdXBOYW1lXSA9IFtdOw0KICAgICAgX1BlcnNpc3RlbmNlTWFuYWdlcjIuZGVmYXVsdC5zZXQoJ2dyb3VwcycsIDAsIG15R3JvdXBzKTsNCiAgICAgIHJldHVybiBteUdyb3VwczsNCiAgICB9DQoNCiAgICAvKioNCiAgICAqIFJlbW92ZXMgdGhlIGdyb3VwIHdpdGggdGhlIGdpdmVuIG5hbWUuDQogICAgKiBAcGFyYW0gIHtTdHJpbmd9ICBncm91cE5hbWUNCiAgICAqLw0KDQogIH0sIHsNCiAgICBrZXk6ICdkZWxldGVHcm91cCcsDQogICAgdmFsdWU6IGZ1bmN0aW9uIGRlbGV0ZUdyb3VwKGdyb3VwTmFtZSkgew0KICAgICAgdmFyIG15R3JvdXBzID0gX1BlcnNpc3RlbmNlTWFuYWdlcjIuZGVmYXVsdC5nZXQoJ2dyb3VwcycpIHx8IHt9Ow0KDQogICAgICBkZWxldGUgbXlHcm91cHNbZ3JvdXBOYW1lXTsNCiAgICAgIF9QZXJzaXN0ZW5jZU1hbmFnZXIyLmRlZmF1bHQuc2V0KCdncm91cHMnLCAwLCBteUdyb3Vwcyk7DQogICAgfQ0KDQogICAgLyoqDQogICAgKiBBZGRzIHRoZSBnaXZlbiB1c2VyIGVtYWlsIHRvIHRoZSBncm91cCB3aXRoIHRoZSBnaXZlbiBuYW1lLg0KICAgICogQHBhcmFtICB7U3RyaW5nfSAgdXNlckVtYWlsDQogICAgKiBAcGFyYW0gIHtTdHJpbmd9ICBncm91cE5hbWUNCiAgICAqLw0KDQogIH0sIHsNCiAgICBrZXk6ICdhZGRUb0dyb3VwJywNCiAgICB2YWx1ZTogZnVuY3Rpb24gYWRkVG9Hcm91cCh1c2VyRW1haWwsIGdyb3VwTmFtZSkgew0KICAgICAgdmFyIF90aGlzID0gdGhpczsNCiAgICAgIHZhciBteUdyb3VwcyA9IF9QZXJzaXN0ZW5jZU1hbmFnZXIyLmRlZmF1bHQuZ2V0KCdncm91cHMnKSB8fCB7fTsNCiAgICAgIGlmIChteUdyb3Vwc1tncm91cE5hbWVdID09PSB1bmRlZmluZWQpIHsNCiAgICAgICAgbXlHcm91cHMgPSBfdGhpcy5jcmVhdGVHcm91cChncm91cE5hbWUpOw0KICAgICAgICBteUdyb3Vwc1tncm91cE5hbWVdID0gW107DQogICAgICB9DQogICAgICBteUdyb3Vwc1tncm91cE5hbWVdLnB1c2godXNlckVtYWlsKTsNCiAgICAgIF9QZXJzaXN0ZW5jZU1hbmFnZXIyLmRlZmF1bHQuc2V0KCdncm91cHMnLCAwLCBteUdyb3Vwcyk7DQogICAgfQ0KDQogICAgLyoqDQogICAgKiBSZW1vdmVzIHRoZSBnaXZlbiB1c2VyIGVtYWlsIGZyb20gdGhlIGdyb3VwIHdpdGggdGhlIGdpdmVuIG5hbWUuDQogICAgKiBAcGFyYW0gIHtTdHJpbmd9ICB1c2VyRW1haWwNCiAgICAqIEBwYXJhbSAge1N0cmluZ30gIGdyb3VwTmFtZQ0KICAgICovDQoNCiAgfSwgew0KICAgIGtleTogJ3JlbW92ZUZyb21Hcm91cCcsDQogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZUZyb21Hcm91cCh1c2VyRW1haWwsIGdyb3VwTmFtZSkgew0KICAgICAgdmFyIG15R3JvdXBzID0gX1BlcnNpc3RlbmNlTWFuYWdlcjIuZGVmYXVsdC5nZXQoJ2dyb3VwcycpIHx8IHt9Ow0KICAgICAgdmFyIGdyb3VwID0gbXlHcm91cHNbZ3JvdXBOYW1lXTsNCg0KICAgICAgZm9yICh2YXIgaSBpbiBncm91cCkgew0KICAgICAgICBpZiAoZ3JvdXBbaV0gPT09IHVzZXJFbWFpbCkgew0KICAgICAgICAgIGdyb3VwLnNwbGljZShpLCAxKTsNCiAgICAgICAgICBfUGVyc2lzdGVuY2VNYW5hZ2VyMi5kZWZhdWx0LnNldCgnZ3JvdXBzJywgMCwgbXlHcm91cHMpOw0KICAgICAgICAgIGJyZWFrOw0KICAgICAgICB9DQogICAgICB9DQogICAgfQ0KICB9XSk7DQoNCiAgcmV0dXJuIFBEUDsNCn0oKTsNCg0KZXhwb3J0cy5kZWZhdWx0ID0gUERQOw0KfSx7Ii4uL3BlcnNpc3RlbmNlL1BlcnNpc3RlbmNlTWFuYWdlciI6MzA3LCIuLi91dGlscy91dGlscyI6MzIyfV0sMzA5OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCiJ1c2Ugc3RyaWN0IjsNCg0KT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgew0KICB2YWx1ZTogdHJ1ZQ0KfSk7DQoNCnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpOw0KDQpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOyB9IH0NCg0KdmFyIFBFUCA9IGZ1bmN0aW9uICgpIHsNCiAgZnVuY3Rpb24gUEVQKCkgew0KICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBQRVApOw0KICB9DQoNCiAgX2NyZWF0ZUNsYXNzKFBFUCwgW3sNCiAgICBrZXk6ICJlbmZvcmNlIiwNCiAgICB2YWx1ZTogZnVuY3Rpb24gZW5mb3JjZSgpIHt9DQogIH0sIHsNCiAgICBrZXk6ICJzZW5kQXV0b21hdGljTWVzc2FnZSIsDQogICAgdmFsdWU6IGZ1bmN0aW9uIHNlbmRBdXRvbWF0aWNNZXNzYWdlKCkge30NCiAgfSwgew0KICAgIGtleTogImZvcndhcmRUb0lEIiwNCiAgICB2YWx1ZTogZnVuY3Rpb24gZm9yd2FyZFRvSUQoKSB7fQ0KICB9LCB7DQogICAga2V5OiAiZm9yd2FyZFRvSHlwZXJ0eSIsDQogICAgdmFsdWU6IGZ1bmN0aW9uIGZvcndhcmRUb0h5cGVydHkoKSB7fQ0KICB9XSk7DQoNCiAgcmV0dXJuIFBFUDsNCn0oKTsNCg0KZXhwb3J0cy5kZWZhdWx0ID0gUEVQOw0KfSx7fV0sMzEwOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCid1c2Ugc3RyaWN0JzsNCg0KT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgew0KICB2YWx1ZTogdHJ1ZQ0KfSk7DQoNCnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpOyAvL2pzaGludCBicm93c2VyOnRydWUsIGpxdWVyeTogdHJ1ZQ0KDQp2YXIgX1BlcnNpc3RlbmNlTWFuYWdlciA9IHJlcXVpcmUoJy4uL3BlcnNpc3RlbmNlL1BlcnNpc3RlbmNlTWFuYWdlcicpOw0KDQp2YXIgX1BlcnNpc3RlbmNlTWFuYWdlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9QZXJzaXN0ZW5jZU1hbmFnZXIpOw0KDQp2YXIgX3V0aWxzID0gcmVxdWlyZSgnLi4vdXRpbHMvdXRpbHMnKTsNCg0KdmFyIF9QRVAgPSByZXF1aXJlKCcuL1BFUCcpOw0KDQp2YXIgX1BFUDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9QRVApOw0KDQp2YXIgX1BEUCA9IHJlcXVpcmUoJy4vUERQJyk7DQoNCnZhciBfUERQMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX1BEUCk7DQoNCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9DQoNCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7IH0gfQ0KDQovKioNCiogVGhlIFBvbGljeSBFbmdpbmUgaW50ZXJjZXB0cyBhbGwgdGhlIG1lc3NhZ2VzIHNlbnQgdGhyb3VnaCB0aGUgTWVzc2FnZSBCdXMgYW5kIGFwcGxpZXMgdGhlDQoqIHBvbGljaWVzIGRlZmluZWQgYnkgdGhlIHNlcnZpY2UgcHJvdmlkZXIgYW5kIHRoZSB1c2VyLg0KKi8NCg0KdmFyIFBvbGljeUVuZ2luZSA9IGZ1bmN0aW9uICgpIHsNCg0KICAvKioNCiAgKiBUaGlzIG1ldGhvZCBpcyBpbnZva2VkIGJ5IHRoZSBSdW50aW1lVUEgYW5kIGluc3RhbnRpYXRlcyB0aGUgUG9saWN5IEVuZ2luZS4gQSBQb2xpY3kgRGVjaXNpb24NCiAgKiBQb2ludCAoUERQKSBhbmQgYSBQb2xpY3kgRW5mb3JjZW1lbnQgUG9pbnQgKFBFUCkgYXJlIGluaXRpYWxpc2VkIGZvciB0aGUgZXZhbHVhdGlvbiBvZiBwb2xpY2llcw0KICAqIGFuZCB0aGUgZW5mb3JjZW1lbnQgb2YgYWRkaXRpb25hbCBhY3Rpb25zLCByZXNwZWN0aXZlbHkuIEFkZHMgYSBsaXN0ZW5lciBkbyB0aGUgTWVzc2FnZSBCdXMgdG8NCiAgKiBhbGxvdyBtZXRob2QgaW52b2thdGlvbi4NCiAgKiBAcGFyYW0gIHtJZGVudGl0eU1vZHVsZX0gICAgaWRlbnRpdHlNb2R1bGUNCiAgKiBAcGFyYW0gIHtSZWdpc3RyeX0gICAgICAgICAgcnVudGltZVJlZ2lzdHJ5DQogICovDQoNCiAgZnVuY3Rpb24gUG9saWN5RW5naW5lKGlkZW50aXR5TW9kdWxlLCBydW50aW1lUmVnaXN0cnkpIHsNCiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgUG9saWN5RW5naW5lKTsNCg0KICAgIHZhciBfdGhpcyA9IHRoaXM7DQogICAgX3RoaXMuaXNSdW50aW1lQ29yZSA9IChpZGVudGl0eU1vZHVsZSAmIHJ1bnRpbWVSZWdpc3RyeSkgPT09IDA7DQogICAgX3RoaXMucGRwID0gbmV3IF9QRFAyLmRlZmF1bHQocnVudGltZVJlZ2lzdHJ5KTsNCiAgICBfdGhpcy5wZXAgPSBuZXcgX1BFUDIuZGVmYXVsdCgpOw0KICAgIF90aGlzLmlkTW9kdWxlID0gaWRlbnRpdHlNb2R1bGU7DQogICAgX3RoaXMucG9saWNpZXMgPSBfdGhpcy5sb2FkUG9saWNpZXMoKTsNCiAgfQ0KDQogIF9jcmVhdGVDbGFzcyhQb2xpY3lFbmdpbmUsIFt7DQogICAga2V5OiAnbG9hZFBvbGljaWVzJywNCiAgICB2YWx1ZTogZnVuY3Rpb24gbG9hZFBvbGljaWVzKCkgew0KICAgICAgLy9sZXQgX3RoaXMgPSB0aGlzOw0KICAgICAgX1BlcnNpc3RlbmNlTWFuYWdlcjIuZGVmYXVsdC5kZWxldGUoJ3BvbGljaWVzJyk7DQogICAgICB2YXIgbXlQb2xpY2llcyA9IF9QZXJzaXN0ZW5jZU1hbmFnZXIyLmRlZmF1bHQuZ2V0KCdwb2xpY2llcycpOw0KDQogICAgICAvKmlmIChteVBvbGljaWVzID09PSB1bmRlZmluZWQpIHsNCiAgICAgICAgbGV0IHN1YnNjcmlwdGlvblBvbGljeSA9IHsNCiAgICAgICAgICBzY29wZTogJ2FwcGxpY2F0aW9uJywNCiAgICAgICAgICBjb25kaXRpb246ICdzdWJzY3JpcHRpb24gZXF1YWxzIConLA0KICAgICAgICAgIGF1dGhvcmlzZTogdHJ1ZSwNCiAgICAgICAgICBhY3Rpb25zOiBbXQ0KICAgICAgICB9Ow0KICAgICAgICBfdGhpcy5hZGRQb2xpY2llcyhbc3Vic2NyaXB0aW9uUG9saWN5XSk7DQogICAgICAgIG15UG9saWNpZXMgPSBwZXJzaXN0ZW5jZU1hbmFnZXIuZ2V0KCdwb2xpY2llcycpOw0KICAgICAgfSovDQogICAgICByZXR1cm4gbXlQb2xpY2llczsNCiAgICB9DQoNCiAgICAvKioNCiAgICAqIEFzc29jaWF0ZXMgdGhlIGdpdmVuIHBvbGljaWVzIHdpdGggYSBzY29wZS4gVGhlIHBvc3NpYmxlIHNjb3BlcyBhcmUgJ2FwcGxpY2F0aW9uJywgJ2h5cGVydHknIGFuZA0KICAgICogJ3VzZXInLg0KICAgICogQHBhcmFtICB7UG9saWN5W119ICBwb2xpY2llcw0KICAgICogQHBhcmFtICB7U3RyaW5nfSAgICBzY29wZQ0KICAgICovDQoNCiAgfSwgew0KICAgIGtleTogJ2FkZFBvbGljaWVzJywNCiAgICB2YWx1ZTogZnVuY3Rpb24gYWRkUG9saWNpZXMobmV3UG9saWNpZXMpIHsNCiAgICAgIHZhciBfdGhpcyA9IHRoaXM7DQogICAgICB2YXIgbXlQb2xpY2llcyA9IF9QZXJzaXN0ZW5jZU1hbmFnZXIyLmRlZmF1bHQuZ2V0KCdwb2xpY2llcycpOw0KICAgICAgaWYgKG15UG9saWNpZXMgPT09IHVuZGVmaW5lZCkgew0KICAgICAgICBteVBvbGljaWVzID0ge307DQogICAgICB9DQoNCiAgICAgIGZvciAodmFyIGkgaW4gbmV3UG9saWNpZXMpIHsNCiAgICAgICAgdmFyIG5ld1BvbGljeSA9IG5ld1BvbGljaWVzW2ldOw0KICAgICAgICB2YXIgc2NvcGUgPSBuZXdQb2xpY3kuc2NvcGU7DQogICAgICAgIGlmIChteVBvbGljaWVzW3Njb3BlXSA9PT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgbXlQb2xpY2llc1tzY29wZV0gPSBbXTsNCiAgICAgICAgfQ0KICAgICAgICBmb3IgKHZhciBqIGluIG15UG9saWNpZXNbc2NvcGVdKSB7DQogICAgICAgICAgdmFyIGV4aXN0aW5nUG9saWN5ID0gbXlQb2xpY2llc1tzY29wZV1bal07DQogICAgICAgICAgaWYgKGV4aXN0aW5nUG9saWN5LmNvbmRpdGlvbiA9PT0gbmV3UG9saWN5LmNvbmRpdGlvbikgew0KICAgICAgICAgICAgX3RoaXMucmVtb3ZlUG9saWNpZXMobmV3UG9saWNpZXNbaV0uY29uZGl0aW9uKTsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICBteVBvbGljaWVzW3Njb3BlXS5wdXNoKG5ld1BvbGljaWVzW2ldKTsNCiAgICAgIH0NCiAgICAgIF9QZXJzaXN0ZW5jZU1hbmFnZXIyLmRlZmF1bHQuc2V0KCdwb2xpY2llcycsIDAsIG15UG9saWNpZXMpOw0KICAgICAgX3RoaXMucG9saWNpZXMgPSBteVBvbGljaWVzOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICogUmVtb3ZlcyB0aGUgcG9saWN5IHdpdGggdGhlIGdpdmVuIElEIGZyb20gdGhlIGdpdmVuIHNjb3BlLiBJZiBwb2xpY3lJRCBpcyAnKicsIHJlbW92ZXMgYWxsIHBvbGljaWVzIGFzc29jaWF0ZWQgd2l0aCB0aGUgZ2l2ZW4gc2NvcGUuDQogICAgKiBAcGFyYW0gIHtTdHJpbmd9ICBwb2xpY3lJRA0KICAgICogQHBhcmFtICB7U3RyaW5nfSAgc2NvcGUNCiAgICAqLw0KDQogIH0sIHsNCiAgICBrZXk6ICdyZW1vdmVQb2xpY2llcycsDQogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZVBvbGljaWVzKGNvbmRpdGlvbiwgc2NvcGUpIHsNCiAgICAgIHZhciBfdGhpcyA9IHRoaXM7DQogICAgICB2YXIgbXlQb2xpY2llcyA9IF9QZXJzaXN0ZW5jZU1hbmFnZXIyLmRlZmF1bHQuZ2V0KCdwb2xpY2llcycpOw0KDQogICAgICBpZiAoc2NvcGUgIT09ICcqJykgew0KDQogICAgICAgIGlmIChzY29wZSBpbiBteVBvbGljaWVzKSB7DQogICAgICAgICAgaWYgKGNvbmRpdGlvbiAhPT0gJyonKSB7DQogICAgICAgICAgICB2YXIgcG9saWNpZXMgPSBteVBvbGljaWVzW3Njb3BlXTsNCiAgICAgICAgICAgIGZvciAodmFyIGkgaW4gcG9saWNpZXMpIHsNCiAgICAgICAgICAgICAgaWYgKHBvbGljaWVzW2ldLmNvbmRpdGlvbiA9PT0gY29uZGl0aW9uKSB7DQogICAgICAgICAgICAgICAgcG9saWNpZXMuc3BsaWNlKGNvbmRpdGlvbiwgMSk7DQoNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBkZWxldGUgbXlQb2xpY2llc1tzY29wZV07DQogICAgICAgICAgfQ0KICAgICAgICAgIF9QZXJzaXN0ZW5jZU1hbmFnZXIyLmRlZmF1bHQuc2V0KCdwb2xpY2llcycsIDAsIG15UG9saWNpZXMpOw0KICAgICAgICAgIF90aGlzLnBvbGljaWVzID0gbXlQb2xpY2llczsNCiAgICAgICAgfQ0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgX1BlcnNpc3RlbmNlTWFuYWdlcjIuZGVmYXVsdC5kZWxldGUoJ3BvbGljaWVzJyk7DQogICAgICAgIF90aGlzLnBvbGljaWVzID0ge307DQogICAgICB9DQogICAgfQ0KDQogICAgLyoqDQogICAgKiBUaGlzIG1ldGhvZCBpcyBleGVjdXRlZCB3aGVuIGEgbWVzc2FnZSBpcyBpbnRlcmNlcHRlZCBpbiB0aGUgTWVzc2FnZSBCdXMuIFRoZSBmaXJzdCBzdGVwIGlzIHRoZQ0KICAgICogYXNzaWdubWVudCBvZiB0aGUgaWRlbnRpdHkgYXNzb2NpYXRlZCB3aXRoIHRoZSBtZXNzYWdlLiBUaGUgc2Vjb25kIHN0ZXAgaXMgdGhlIGV2YWx1YXRpb24gb2YgdGhlDQogICAgKiBhcHBsaWNhYmxlIHBvbGljaWVzIGluIG9yZGVyIHRvIG9idGFpbiBhbiBhdXRob3Jpc2F0aW9uIGRlY2lzaW9uOiBpZiBhIHBvbGljeSBldmFsdWF0ZXMgdG8NCiAgICAqIGZhbHNlLCB0aGVuIHRoZSBtZXNzYWdlIGlzIHVuYXV0aG9yaXNlZC4gVGhlIHRoaXJkIHN0ZXAgaXMgdGhlIGVuZm9yY2VtZW50IG9mIHRoZSBhY3Rpb25zIHRoYXQNCiAgICAqIHBvbGljaWVzIG1heSByZXF1aXJlLiBGaW5hbGx5LCB0aGUgbWVzc2FnZSBpcyBzdGFtcGVkIGFzIGF1dGhvcmlzZWQgb3Igbm90IGFuZCBpcyByZXR1cm5lZCB0bw0KICAgICogdGhlIE1lc3NhZ2UgQnVzLCB3aGVyZSBpdCB3aWxsIGJlIGZvcndhcmRlZCBvciBibG9ja2VkLg0KICAgICogQHBhcmFtICB7TWVzc2FnZX0gIG1lc3NhZ2UNCiAgICAqLw0KDQogIH0sIHsNCiAgICBrZXk6ICdhdXRob3Jpc2UnLA0KICAgIHZhbHVlOiBmdW5jdGlvbiBhdXRob3Jpc2UobWVzc2FnZSkgew0KICAgICAgdmFyIF90aGlzID0gdGhpczsNCg0KICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsNCiAgICAgICAgY29uc29sZS5sb2coJy0tLSBQb2xpY3kgRW5naW5lIC0tLScpOw0KICAgICAgICBjb25zb2xlLmxvZyhtZXNzYWdlKTsNCiAgICAgICAgbWVzc2FnZS5ib2R5ID0gbWVzc2FnZS5ib2R5IHx8IHt9Ow0KDQogICAgICAgIHZhciBpbml0aWFsUmVzdWx0T2sgPSBfdGhpcy5mb2xsb3dzRXhwZWN0ZWRCZWhhdmlvdXIobWVzc2FnZSk7DQogICAgICAgIGlmIChpbml0aWFsUmVzdWx0T2sgPT09IHVuZGVmaW5lZCkgew0KICAgICAgICAgIGlmIChfdGhpcy5pc1J1bnRpbWVDb3JlKSB7DQogICAgICAgICAgICBfdGhpcy5pZE1vZHVsZS5nZXRJZGVudGl0eUFzc2VydGlvbigpLnRoZW4oZnVuY3Rpb24gKGlkZW50aXR5KSB7DQogICAgICAgICAgICAgIG1lc3NhZ2UuYm9keS5pZGVudGl0eSA9IG1lc3NhZ2UuYm9keS5pZGVudGl0eSB8fCBpZGVudGl0eTsNCiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChlcnJvcikgew0KICAgICAgICAgICAgICByZWplY3QoZXJyb3IpOw0KICAgICAgICAgICAgfSk7DQogICAgICAgICAgfSBlbHNlIHsNCg0KICAgICAgICAgICAgLy9UT0RPOiBvYnRhaW4gdGhlIGlkZW50aXR5IGZyb20gRG9tYWluIFJlZ2lzdHJ5DQogICAgICAgICAgICBjb25zb2xlLmxvZygnb2J0YWluIHRoZSBpZGVudGl0eSBmcm9tIERvbWFpbiBSZWdpc3RyeScpOw0KICAgICAgICAgIH0NCg0KICAgICAgICAgIC8vbGV0IHNjb3BlID0gX3RoaXMuZ2V0U2NvcGUobWVzc2FnZSk7DQogICAgICAgICAgdmFyIGFwcGxpY2FibGVQb2xpY2llcyA9IF90aGlzLmdldEFwcGxpY2FibGVQb2xpY2llcygnKicpOw0KICAgICAgICAgIHZhciBwb2xpY2llc1Jlc3VsdCA9IF90aGlzLnBkcC5ldmFsdWF0ZShtZXNzYWdlLCBhcHBsaWNhYmxlUG9saWNpZXMpOw0KICAgICAgICAgIF90aGlzLnBlcC5lbmZvcmNlKHBvbGljaWVzUmVzdWx0WzFdKTsNCg0KICAgICAgICAgIGlmIChwb2xpY2llc1Jlc3VsdFswXSkgew0KICAgICAgICAgICAgbWVzc2FnZS5ib2R5LmF1dGggPSBhcHBsaWNhYmxlUG9saWNpZXMubGVuZ3RoICE9PSAwOw0KICAgICAgICAgICAgcmVzb2x2ZShtZXNzYWdlKTsNCiAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgcmVqZWN0KCdVbmF1dGhvcmlzZWQgbWVzc2FnZScpOw0KICAgICAgICAgIH0NCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICBpZiAoaW5pdGlhbFJlc3VsdE9rKSB7DQogICAgICAgICAgICByZXNvbHZlKG1lc3NhZ2UpOw0KICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICByZWplY3QoJ0ludHJpbnNpYyBiZWhhdmlvdXIgd2FzIG5vdCByZXNwZWN0ZWQnKTsNCiAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgIH0pOw0KICAgIH0NCg0KICAgIC8qDQogICAgKiBJZFByb3h5IC8gSWRNb2R1bGUNCiAgICAqICAgKDEpIE1lc3NhZ2VzIGZyb20gdGhlIElEUCBQcm94eSBtdXN0IGdvIHRvIHRoZSBJRCBNb2R1bGUuDQogICAgKiAgICgyKSBNZXNzYWdlcyB0byB0aGUgSURQIFByb3h5IG11c3QgY29tZSBmcm9tIHRoZSBJRCBNb2R1bGUuDQogICAgKiAgICgzKSBNZXNzYWdlcyBmcm9tIHRoZSBHVUkgbXVzdCBnbyB0byB0aGUgSUQgTW9kdWxlLg0KICAgICogICAoNCkgTWVzc2FnZXMgdG8gdGhlIEdVSSBtdXN0IGNvbWUgZnJvbSB0aGUgSUQgTW9kdWxlLg0KICAgICoNCiAgICAqIERhdGFPYmplY3RzDQogICAgKiAgICg1KSBVcGRhdGVzIG11c3QgY29tZSBmcm9tIHJlcG9ydGVycw0KICAgICovDQoNCiAgfSwgew0KICAgIGtleTogJ2ZvbGxvd3NFeHBlY3RlZEJlaGF2aW91cicsDQogICAgdmFsdWU6IGZ1bmN0aW9uIGZvbGxvd3NFeHBlY3RlZEJlaGF2aW91cihtZXNzYWdlKSB7DQogICAgICB2YXIgX3RoaXMgPSB0aGlzOw0KDQogICAgICB2YXIgaWRwU2NoZW1lID0gJ2RvbWFpbi1pZHAnOw0KICAgICAgdmFyIGlkbVVSTCA9IF90aGlzLnBkcC5ydW50aW1lUmVnaXN0cnkucnVudGltZVVSTCArICcvaWRtJzsNCg0KICAgICAgLyogKDEpICovDQogICAgICBpZiAoKDAsIF91dGlscy5kaXZpZGVVUkwpKG1lc3NhZ2UuZnJvbSkudHlwZSA9PT0gaWRwU2NoZW1lKSB7DQogICAgICAgIHJldHVybiBtZXNzYWdlLnRvID09PSBpZG1VUkw7DQogICAgICB9DQoNCiAgICAgIC8qICgyKSAqLw0KICAgICAgaWYgKCgwLCBfdXRpbHMuZGl2aWRlVVJMKShtZXNzYWdlLnRvKS50eXBlID09PSBpZHBTY2hlbWUpIHsNCiAgICAgICAgcmV0dXJuIG1lc3NhZ2UuZnJvbSA9PT0gaWRtVVJMOw0KICAgICAgfQ0KICAgIH0NCiAgfSwgew0KICAgIGtleTogJ2dldEdyb3Vwc05hbWVzJywNCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0R3JvdXBzTmFtZXMoKSB7DQogICAgICB2YXIgX3RoaXMgPSB0aGlzOw0KICAgICAgcmV0dXJuIF90aGlzLnBkcC5nZXRHcm91cHNOYW1lcygpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICogUmV0cmlldmVzIHRoZSBncm91cCB3aXRoIHRoZSBnaXZlbiBncm91cCBuYW1lIGZyb20gdGhlIFBEUC4NCiAgICAqIEBwYXJhbSAge1N0cmluZ30gIGdyb3VwTmFtZQ0KICAgICogQHJldHVybiB7QXJyYXl9ICAgZ3JvdXANCiAgICAqLw0KDQogIH0sIHsNCiAgICBrZXk6ICdnZXRMaXN0JywNCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0TGlzdChncm91cE5hbWUpIHsNCiAgICAgIHZhciBfdGhpcyA9IHRoaXM7DQogICAgICByZXR1cm4gX3RoaXMucGRwLmdldExpc3QoZ3JvdXBOYW1lKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAqIEZvcndhcmRzIGEgcmVxdWVzdCBmb3IgdGhlIGNyZWF0aW9uIG9mIGEgZ3JvdXAgd2l0aCB0aGUgZ2l2ZW4gbmFtZSB0byB0aGUgUERQLg0KICAgICogQHBhcmFtICB7U3RyaW5nfSAgZ3JvdXBOYW1lDQogICAgKi8NCg0KICB9LCB7DQogICAga2V5OiAnY3JlYXRlR3JvdXAnLA0KICAgIHZhbHVlOiBmdW5jdGlvbiBjcmVhdGVHcm91cChncm91cE5hbWUpIHsNCiAgICAgIHZhciBfdGhpcyA9IHRoaXM7DQogICAgICBfdGhpcy5wZHAuY3JlYXRlR3JvdXAoZ3JvdXBOYW1lKTsNCiAgICB9DQogIH0sIHsNCiAgICBrZXk6ICdkZWxldGVHcm91cCcsDQogICAgdmFsdWU6IGZ1bmN0aW9uIGRlbGV0ZUdyb3VwKGdyb3VwTmFtZSkgew0KICAgICAgdmFyIF90aGlzID0gdGhpczsNCiAgICAgIF90aGlzLnBkcC5kZWxldGVHcm91cChncm91cE5hbWUpOw0KDQogICAgICB2YXIgcG9saWNpZXMgPSBfdGhpcy5wb2xpY2llcy51c2VyOw0KICAgICAgZm9yICh2YXIgaSBpbiBwb2xpY2llcykgew0KICAgICAgICB2YXIgY29uZGl0aW9uID0gcG9saWNpZXNbaV0uY29uZGl0aW9uLnNwbGl0KCcgJyk7DQogICAgICAgIGNvbmRpdGlvbi5zaGlmdCgpOw0KICAgICAgICB2YXIgZ3JvdXBJblBvbGljeSA9IGNvbmRpdGlvbi5qb2luKCcgJyk7DQogICAgICAgIGlmIChncm91cEluUG9saWN5ID09PSBncm91cE5hbWUpIHsNCiAgICAgICAgICBkZWxldGUgcG9saWNpZXNbaV07DQogICAgICAgICAgYnJlYWs7DQogICAgICAgIH0NCiAgICAgIH0NCiAgICB9DQoNCiAgICAvKioNCiAgICAqIEZvcndhcmRzIGEgcmVxdWVzdCB0byBhZGQgYSB1c2VyIHRvIHRoZSBncm91cCB3aXRoIHRoZSBnaXZlbiBuYW1lIHRvIHRoZSBQRFAuDQogICAgKiBAcGFyYW0gIHtTdHJpbmd9ICB1c2VyRW1haWwNCiAgICAqIEBwYXJhbSAge1N0cmluZ30gIGdyb3VwTmFtZQ0KICAgICovDQoNCiAgfSwgew0KICAgIGtleTogJ2FkZFRvR3JvdXAnLA0KICAgIHZhbHVlOiBmdW5jdGlvbiBhZGRUb0dyb3VwKHVzZXJFbWFpbCwgZ3JvdXBOYW1lKSB7DQogICAgICB2YXIgX3RoaXMgPSB0aGlzOw0KICAgICAgX3RoaXMucGRwLmFkZFRvR3JvdXAodXNlckVtYWlsLCBncm91cE5hbWUpOw0KICAgIH0NCiAgfSwgew0KICAgIGtleTogJ2dldEdyb3VwUmVhY2hhYmlsaXR5JywNCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0R3JvdXBSZWFjaGFiaWxpdHkoZ3JvdXBOYW1lKSB7DQogICAgICB2YXIgX3RoaXMgPSB0aGlzOw0KICAgICAgdmFyIHBvbGljaWVzID0gX3RoaXMucG9saWNpZXMudXNlcjsNCiAgICAgIGZvciAodmFyIGkgaW4gcG9saWNpZXMpIHsNCiAgICAgICAgaWYgKHBvbGljaWVzW2ldLmNvbmRpdGlvbiA9PT0gJ2dyb3VwICcgKyBncm91cE5hbWUpIHsNCiAgICAgICAgICByZXR1cm4gcG9saWNpZXNbaV0uYXV0aG9yaXNlOw0KICAgICAgICB9DQogICAgICB9DQogICAgfQ0KICB9LCB7DQogICAga2V5OiAnY2hhbmdlUG9saWN5JywNCiAgICB2YWx1ZTogZnVuY3Rpb24gY2hhbmdlUG9saWN5KGNvbmRpdGlvbiwgYXV0aG9yaXNlKSB7DQogICAgICB2YXIgX3RoaXMgPSB0aGlzOw0KDQogICAgICB2YXIgcG9saWNpZXMgPSBfdGhpcy5wb2xpY2llcy51c2VyOw0KICAgICAgcG9saWNpZXMgPSBwb2xpY2llcyB8fCBbXTsNCiAgICAgIGZvciAodmFyIGkgaW4gcG9saWNpZXMpIHsNCiAgICAgICAgaWYgKHBvbGljaWVzW2ldLmNvbmRpdGlvbiA9PT0gY29uZGl0aW9uKSB7DQogICAgICAgICAgcG9saWNpZXNbaV0uYXV0aG9yaXNlID0gYXV0aG9yaXNlOw0KICAgICAgICAgIHJldHVybjsNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgICAgdmFyIG5ld1BvbGljeSA9IHsNCiAgICAgICAgc2NvcGU6ICd1c2VyJywNCiAgICAgICAgY29uZGl0aW9uOiBjb25kaXRpb24sDQogICAgICAgIGF1dGhvcmlzZTogYXV0aG9yaXNlLA0KICAgICAgICBhY3Rpb25zOiBbXQ0KICAgICAgfTsNCg0KICAgICAgX3RoaXMuYWRkUG9saWNpZXMoW25ld1BvbGljeV0pOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICogRm9yd2FyZHMgYSByZXF1ZXN0IHRvIHJlbW92ZSBhIHVzZXIgZnJvbSB0aGUgZ3JvdXAgd2l0aCB0aGUgZ2l2ZW4gbmFtZSB0byB0aGUgUERQLg0KICAgICogQHBhcmFtICB7U3RyaW5nfSAgdXNlckVtYWlsDQogICAgKiBAcGFyYW0gIHtTdHJpbmd9ICBncm91cE5hbWUNCiAgICAqLw0KDQogIH0sIHsNCiAgICBrZXk6ICdyZW1vdmVGcm9tR3JvdXAnLA0KICAgIHZhbHVlOiBmdW5jdGlvbiByZW1vdmVGcm9tR3JvdXAodXNlckVtYWlsLCBncm91cE5hbWUpIHsNCiAgICAgIHZhciBfdGhpcyA9IHRoaXM7DQogICAgICBfdGhpcy5wZHAucmVtb3ZlRnJvbUdyb3VwKHVzZXJFbWFpbCwgZ3JvdXBOYW1lKTsNCiAgICB9DQogIH0sIHsNCiAgICBrZXk6ICdnZXRUaW1lc2xvdHMnLA0KICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRUaW1lc2xvdHMoKSB7DQogICAgICB2YXIgX3RoaXMgPSB0aGlzOw0KICAgICAgdmFyIHBvbGljaWVzID0gX3RoaXMucG9saWNpZXMudXNlcjsNCiAgICAgIHZhciB0aW1lUmVzdHJpY3Rpb25zID0gW107DQogICAgICBmb3IgKHZhciBpIGluIHBvbGljaWVzKSB7DQogICAgICAgIGlmIChwb2xpY2llc1tpXS5jb25kaXRpb24uc3BsaXQoJyAnKVswXSA9PT0gJ3RpbWUnKSB7DQogICAgICAgICAgdGltZVJlc3RyaWN0aW9ucy5wdXNoKHBvbGljaWVzW2ldLmNvbmRpdGlvbik7DQogICAgICAgIH0NCiAgICAgIH0NCiAgICAgIHJldHVybiB0aW1lUmVzdHJpY3Rpb25zOw0KICAgIH0NCiAgfSwgew0KICAgIGtleTogJ2dldFRpbWVzbG90QnlJZCcsDQogICAgdmFsdWU6IGZ1bmN0aW9uIGdldFRpbWVzbG90QnlJZChjb25kaXRpb24pIHsNCiAgICAgIHZhciBfdGhpcyA9IHRoaXM7DQogICAgICB2YXIgcG9saWNpZXMgPSBfdGhpcy5wb2xpY2llcy51c2VyOw0KICAgICAgZm9yICh2YXIgaSBpbiBwb2xpY2llcykgew0KICAgICAgICBpZiAocG9saWNpZXNbaV0uY29uZGl0aW9uID09PSBjb25kaXRpb24pIHsNCiAgICAgICAgICByZXR1cm4gcG9saWNpZXNbaV07DQogICAgICAgIH0NCiAgICAgIH0NCiAgICB9DQoNCiAgICAvKioNCiAgICAqIFJldHVybnMgdGhlIHNjb3BlIG9mIHRoZSBnaXZlbiBtZXNzYWdlIHRvIHJlc3RyaWN0IHBvbGljeSBhcHBsaWNhYmlsaXR5Lg0KICAgICogQHJldHVybiB7U3RyaW5nfSBzY29wZQ0KICAgICovDQogICAgLypnZXRTY29wZShtZXNzYWdlKSB7DQogICAgICBsZXQgX3RoaXMgPSB0aGlzOw0KICAgICAgbGV0IHNjb3BlID0gJ3VzZXInOw0KICAgICAgaWYgKG1lc3NhZ2UudHlwZSA9PT0gJ3N1YnNjcmliZScpIHsNCiAgICAgICAgbGV0IHJ1bnRpbWVVUkwgPSBfdGhpcy5wZHAucnVudGltZVJlZ2lzdHJ5LnJ1bnRpbWVVUkw7DQogICAgICAgIGlmIChydW50aW1lVVJMICsgJy9zbScgIT09IG1lc3NhZ2UuZnJvbSkgeyAvLyBuZWVkZWQgZm9yIHRoZSB2ZXJpZmljYXRpb24gdG8gYmUgZG9uZSBpbiB0aGUgcmVwb3J0ZXIncyBwb2xpY3kgZW5naW5lIGFuZCBub3QgaW4gdGhlIHN1YnNjcmliZXIncw0KICAgICAgICAgIGxldCBpc0Zyb21TTSA9IFN0cmluZyhtZXNzYWdlLmZyb20uc3BsaXQoJy8nKS5zbGljZSgtMSlbMF0pID09PSAnc20nOw0KICAgICAgICAgIGxldCBvcmlnaW5SdW50aW1lVVJMU3BsaXQgPSBtZXNzYWdlLmZyb20uc3BsaXQoJy8nKTsNCiAgICAgICAgICBvcmlnaW5SdW50aW1lVVJMU3BsaXQuc3BsaWNlKC0xKTsNCiAgICAgICAgICBsZXQgb3JpZ2luUnVudGltZVVSTCA9IG9yaWdpblJ1bnRpbWVVUkxTcGxpdC5qb2luKG9yaWdpblJ1bnRpbWVVUkxTcGxpdCk7DQogICAgICAgICAgbGV0IGlzVGhpc1J1bnRpbWUgPSBvcmlnaW5SdW50aW1lVVJMID09PSBydW50aW1lVVJMOw0KICAgICAgICAgIGxldCBpc1RvU3Vic2NyaXB0aW9uID0gU3RyaW5nKG1lc3NhZ2UudG8uc3BsaXQoJy8nKS5zbGljZSgtMSlbMF0pID09PSAnc3Vic2NyaXB0aW9uJzsNCiAgICAgICAgICBpZiAoaXNGcm9tU00gJiYgIWlzVGhpc1J1bnRpbWUgJiYgaXNUb1N1YnNjcmlwdGlvbikgew0KICAgICAgICAgICAgc2NvcGUgPSAnc3Vic2NyaWJlJzsNCiAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgIH0NCiAgICAgICByZXR1cm4gc2NvcGU7DQogICAgfSovDQoNCiAgICAvKioNCiAgICAqIFJldHVybnMgdGhlIHBvbGljaWVzIGFzc29jaWF0ZWQgd2l0aCBhIHNjb3BlLg0KICAgICogQHBhcmFtICAge1N0cmluZ30gc2NvcGUNCiAgICAqIEByZXR1cm4gIHtBcnJheX0gIHBvbGljaWVzDQogICAgKi8NCg0KICB9LCB7DQogICAga2V5OiAnZ2V0QXBwbGljYWJsZVBvbGljaWVzJywNCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0QXBwbGljYWJsZVBvbGljaWVzKHNjb3BlKSB7DQogICAgICB2YXIgX3RoaXMgPSB0aGlzOw0KICAgICAgdmFyIHBvbGljaWVzVGFibGUgPSBfdGhpcy5wb2xpY2llczsNCiAgICAgIHZhciBwb2xpY2llcyA9IFtdOw0KICAgICAgaWYgKHNjb3BlICE9PSAnKicpIHsNCiAgICAgICAgaWYgKHBvbGljaWVzVGFibGVbc2NvcGVdICE9PSB1bmRlZmluZWQpIHsNCiAgICAgICAgICBwb2xpY2llcyA9IHBvbGljaWVzVGFibGVbc2NvcGVdOw0KICAgICAgICB9DQogICAgICB9IGVsc2Ugew0KICAgICAgICBmb3IgKHZhciBpIGluIHBvbGljaWVzVGFibGUpIHsNCiAgICAgICAgICBwb2xpY2llcy5wdXNoLmFwcGx5KHBvbGljaWVzLCBwb2xpY2llc1RhYmxlW2ldKTsNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgICAgcmV0dXJuIHBvbGljaWVzOw0KICAgIH0NCiAgfV0pOw0KDQogIHJldHVybiBQb2xpY3lFbmdpbmU7DQp9KCk7DQoNCmV4cG9ydHMuZGVmYXVsdCA9IFBvbGljeUVuZ2luZTsNCn0seyIuLi9wZXJzaXN0ZW5jZS9QZXJzaXN0ZW5jZU1hbmFnZXIiOjMwNywiLi4vdXRpbHMvdXRpbHMiOjMyMiwiLi9QRFAiOjMwOCwiLi9QRVAiOjMwOX1dLDMxMTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQondXNlIHN0cmljdCc7DQoNCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsNCiAgdmFsdWU6IHRydWUNCn0pOw0KDQp2YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTsNCg0KZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsgfSB9DQoNCi8qKg0KKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YefjbyBlIFNpc3RlbWFzIFNBDQoqIENvcHlyaWdodCAyMDE2IElORVNDLUlEDQoqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTA0KKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVg0KKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0ENCiogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRw0KKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWUNCiogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU4NCioNCiogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7DQoqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4NCiogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0DQoqDQoqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wDQoqDQoqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUNCiogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywNCiogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuDQoqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQNCiogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuDQoqKi8NCi8vIGltcG9ydCBNZXNzYWdlRmFjdG9yeSBmcm9tICcuLi8uLi9yZXNvdXJjZXMvTWVzc2FnZUZhY3RvcnknOw0KDQovKioNCiAqIENsYXNzIHdpbGwgYXNrIHRvIHRoZSBtZXNzYWdlIG5vZGUgZm9yIGFkZHJlc3Nlcw0KICovDQoNCnZhciBBZGRyZXNzQWxsb2NhdGlvbiA9IGZ1bmN0aW9uICgpIHsNCiAgLyogcHJpdmF0ZQ0KICBfdXJsOiBVUkwNCiAgX2J1czogTWluaUJ1cw0KICAqLw0KDQogIC8qKg0KICAgKiBDcmVhdGUgYW4gQWRkcmVzcyBBbGxvY2F0aW9uDQogICAqIEBwYXJhbSAge1VSTC5VUkx9ICAgICAgdXJsIC0gdXJsIGZyb20gd2hvIGlzIHNlbmRpbmcgdGhlIG1lc3NhZ2UNCiAgICogQHBhcmFtICB7TWluaUJ1c30gICAgICBidXMgLSBNaW5pQnVzIHVzZWQgZm9yIGFkZHJlc3MgYWxsb2NhdGlvbg0KICAgKi8NCg0KICBmdW5jdGlvbiBBZGRyZXNzQWxsb2NhdGlvbih1cmwsIGJ1cykgew0KICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBBZGRyZXNzQWxsb2NhdGlvbik7DQoNCiAgICB2YXIgX3RoaXMgPSB0aGlzOw0KDQogICAgLy8gbGV0IG1lc3NhZ2VGYWN0b3J5ID0gbmV3IE1lc3NhZ2VGYWN0b3J5KCk7DQogICAgLy8NCiAgICAvLyBfdGhpcy5fbWVzc2FnZUZhY3RvcnkgPSBtZXNzYWdlRmFjdG9yeTsNCiAgICBfdGhpcy5fdXJsID0gdXJsOw0KICAgIF90aGlzLl9idXMgPSBidXM7DQogIH0NCg0KICAvKioNCiAgICogZ2V0IHRoZSBVUkwgdmFsdWUNCiAgICogQHJldHVybiB7c3RyaW5nfSBUaGUgdXJsIHZhbHVlOw0KICAgKi8NCg0KDQogIF9jcmVhdGVDbGFzcyhBZGRyZXNzQWxsb2NhdGlvbiwgW3sNCiAgICBrZXk6ICdjcmVhdGUnLA0KDQoNCiAgICAvKioNCiAgICAgKiBBc2sgZm9yIGNyZWF0aW9uIG9mIGEgbnVtYmVyIG9mIEh5cGVydHkgYWRkcmVzc2VzLCB0byB0aGUgZG9tYWluIG1lc3NhZ2Ugbm9kZS4NCiAgICAgKiBAcGFyYW0gIHtEb21haW59IGRvbWFpbiAtIERvbWFpbiBvZiB0aGUgbWVzc2FnZSBub2RlLg0KICAgICAqIEBwYXJhbSAge251bWJlcn0gbnVtYmVyIC0gTnVtYmVyIG9mIGFkZHJlc3NlcyB0byByZXF1ZXN0DQogICAgICogQHJldHVybnMge1Byb21pc2U8SHlwZXJ0eVVSTD59ICBBIGxpc3Qgb2YgSHlwZXJ0eVVSTCdzDQogICAgICovDQogICAgdmFsdWU6IGZ1bmN0aW9uIGNyZWF0ZShkb21haW4sIG51bWJlcikgew0KICAgICAgdmFyIF90aGlzID0gdGhpczsNCg0KICAgICAgLy8gbGV0IG1lc3NhZ2VGYWN0b3J5ID0gX3RoaXMuX21lc3NhZ2VGYWN0b3J5Ow0KDQogICAgICB2YXIgbXNnID0gew0KICAgICAgICB0eXBlOiAnY3JlYXRlJywgZnJvbTogX3RoaXMuX3VybCwgdG86ICdkb21haW46Ly9tc2ctbm9kZS4nICsgZG9tYWluICsgJy9oeXBlcnR5LWFkZHJlc3MtYWxsb2NhdGlvbicsDQogICAgICAgIGJvZHk6IHsgdmFsdWU6IHsgbnVtYmVyOiBudW1iZXIgfSB9DQogICAgICB9Ow0KDQogICAgICAvLyBUT0RPOiBBcHBseSB0aGUgbWVzc2FnZSBmYWN0b3J5DQogICAgICAvLyBUaGUgbXNnLW5vZGUtdmVydHggc2hvdWxkIGJlIGNoYW5nZWQgdGhlIGJvZHkgZmllbGQgdG8gcmVjZWl2ZQ0KICAgICAgLy8gdGhlIGZvbGxvd2luZyBmb3JtYXQgYm9keToge3ZhbHVlOiB7bnVtYmVyOiBudW1iZXJ9fSBiZWNhdXNlDQogICAgICAvLyB0aGUgbWVzc2FnZSBpcyBnZW5lcmF0ZWQgaW4gdGhhdCB3YXkgYnkgdGhlIG1lc3NhZ2UgZmFjdG9yeTsNCiAgICAgIC8vIGxldCBtc2cgPSBtZXNzYWdlRmFjdG9yeS5jcmVhdGVNZXNzYWdlUmVxdWVzdChfdGhpcy5fdXJsLCAnZG9tYWluOi8vbXNnLW5vZGUuJyArIGRvbWFpbiArICcvaHlwZXJ0eS1hZGRyZXNzLWFsbG9jYXRpb24nLCAnJywge251bWJlcjogbnVtYmVyfSk7DQoNCiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7DQoNCiAgICAgICAgLy8gVE9ETzogY2hhbmdlIHRoaXMgcmVzcG9uc2UgTWVzc2FnZSB1c2luZyB0aGUgTWVzc2FnZUZhY3RvcnkNCiAgICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZShtc2csIGZ1bmN0aW9uIChyZXBseSkgew0KICAgICAgICAgIGlmIChyZXBseS5ib2R5LmNvZGUgPT09IDIwMCkgew0KICAgICAgICAgICAgcmVzb2x2ZShyZXBseS5ib2R5LnZhbHVlLmFsbG9jYXRlZCk7DQogICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHJlamVjdChyZXBseS5ib2R5LmRlc2MpOw0KICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgICB9KTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAqIFNlbmQgYSByZXF1ZXN0IHRvIHRoZSBkb21haW4gbWVzc2FnZSBub2RlLCB0byBkZWFsbG9jYXRlIG9uZSBvciBtb3JlIGFkZHJlc3Nlcw0KICAgICogQHBhcmFtICB7RG9tYWlufSBkb21haW4gLSBEb21haW4gb2YgdGhlIG1lc3NhZ2Ugbm9kZS4NCiAgICAqIEBwYXJhbSAge2FkZHJlc3Nlc30gYWRkcmVzc2VzIHRvIHJlcXVlc3QgdGhlIGRlYWxsb2NhdGlvbg0KICAgICogQHJldHVybnMge1Byb21pc2V9ICB0aGUgcmVzcG9uc2UgYnkgdGhlIG1lc3NhZ2Ugbm9kZQ0KICAgICovDQoNCiAgfSwgew0KICAgIGtleTogJ2RlbGV0ZScsDQogICAgdmFsdWU6IGZ1bmN0aW9uIF9kZWxldGUoZG9tYWluLCBhZGRyZXNzZXMpIHsNCiAgICAgIHZhciBfdGhpcyA9IHRoaXM7DQoNCiAgICAgIHZhciBtZXNzYWdlID0gew0KICAgICAgICB0eXBlOiAnZGVsZXRlJywgZnJvbTogX3RoaXMuX3VybCwgdG86ICdkb21haW46Ly9tc2ctbm9kZS4nICsgZG9tYWluICsgJy9oeXBlcnR5LWFkZHJlc3MtYWxsb2NhdGlvbicsDQogICAgICAgIGJvZHk6IHsgY2hpbGRyZW5SZXNvdXJjZXM6IGFkZHJlc3NlcyB9DQogICAgICB9Ow0KDQogICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgew0KDQogICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UobWVzc2FnZSwgZnVuY3Rpb24gKHJlcGx5KSB7DQogICAgICAgICAgY29uc29sZS5sb2coJ3JlcGx5JywgcmVwbHkpOw0KICAgICAgICAgIGlmIChyZXBseS5ib2R5LmNvZGUgPT09IDIwMCkgew0KICAgICAgICAgICAgcmVzb2x2ZShyZXBseS5ib2R5LmNvZGUpOw0KICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICByZWplY3QocmVwbHkuYm9keS5kZXNjKTsNCiAgICAgICAgICB9DQogICAgICAgIH0pOw0KICAgICAgfSk7DQogICAgfQ0KICB9LCB7DQogICAga2V5OiAndXJsJywNCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsNCiAgICAgIHJldHVybiB0aGlzLl91cmw7DQogICAgfQ0KICB9XSk7DQoNCiAgcmV0dXJuIEFkZHJlc3NBbGxvY2F0aW9uOw0KfSgpOw0KDQpleHBvcnRzLmRlZmF1bHQgPSBBZGRyZXNzQWxsb2NhdGlvbjsNCn0se31dLDMxMjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQondXNlIHN0cmljdCc7DQoNCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsNCiAgdmFsdWU6IHRydWUNCn0pOw0KDQp2YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTsNCg0KdmFyIF9SZWdpc3RyeURhdGFNb2RlbDIgPSByZXF1aXJlKCcuL1JlZ2lzdHJ5RGF0YU1vZGVsJyk7DQoNCnZhciBfUmVnaXN0cnlEYXRhTW9kZWwzID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfUmVnaXN0cnlEYXRhTW9kZWwyKTsNCg0KZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0NCg0KZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsgfSB9DQoNCmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKCFzZWxmKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcigidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkIik7IH0gcmV0dXJuIGNhbGwgJiYgKHR5cGVvZiBjYWxsID09PSAib2JqZWN0IiB8fCB0eXBlb2YgY2FsbCA9PT0gImZ1bmN0aW9uIikgPyBjYWxsIDogc2VsZjsgfQ0KDQpmdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSAiZnVuY3Rpb24iICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCAiICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfSAvKioNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHn428gZSBTaXN0ZW1hcyBTQQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0wNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUcNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgQXBpemVlDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElODQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiovDQoNCg0KLyoqDQoqICAgQGF1dGhvcjogR2lsIERpYXMgKGdpbC5kaWFzQHRlY25pY28udWxpc2JvYS5wdCkNCiogICBIeXBlcnR5SW5zdGFuY2UgRGF0YSBNb2RlbCB1c2VkIHRvIG1vZGVsIGluc3RhbmNlcyBvZiBIeXBlcnRpZXMgcnVubmluZyBpbiBkZXZpY2VzIGFuZCBzZXJ2ZXJzLg0KKi8NCg0KdmFyIEh5cGVydHlJbnN0YW5jZSA9IGZ1bmN0aW9uIChfUmVnaXN0cnlEYXRhTW9kZWwpIHsNCiAgX2luaGVyaXRzKEh5cGVydHlJbnN0YW5jZSwgX1JlZ2lzdHJ5RGF0YU1vZGVsKTsNCg0KICBmdW5jdGlvbiBIeXBlcnR5SW5zdGFuY2UoaWQsIHVybCwgZGVzY3JpcHRvclVSTCwgZGVzY3JpcHRvciwgaHlwZXJ0eVVSTCwgdXNlciwgZ3VpZCwgcnVudGltZSwgY29udGV4dCkgew0KICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBIeXBlcnR5SW5zdGFuY2UpOw0KDQogICAgdmFyIF90aGlzMiA9IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIE9iamVjdC5nZXRQcm90b3R5cGVPZihIeXBlcnR5SW5zdGFuY2UpLmNhbGwodGhpcywgaWQsIHVybCwgZGVzY3JpcHRvclVSTCkpOw0KDQogICAgdmFyIF90aGlzID0gX3RoaXMyOw0KICAgIF90aGlzLl9kZXNjcmlwdG9yID0gZGVzY3JpcHRvcjsNCiAgICBfdGhpcy5faHlwZXJ0eVVSTCA9IGh5cGVydHlVUkw7DQogICAgX3RoaXMuX3VzZXIgPSB1c2VyOw0KICAgIF90aGlzLl9ndWlkID0gZ3VpZDsNCiAgICBfdGhpcy5fcnVudGltZSA9IHJ1bnRpbWU7DQogICAgX3RoaXMuX2NvbnRleHQgPSBjb250ZXh0Ow0KICAgIHJldHVybiBfdGhpczI7DQogIH0NCg0KICBfY3JlYXRlQ2xhc3MoSHlwZXJ0eUluc3RhbmNlLCBbew0KICAgIGtleTogJ3VzZXInLA0KICAgIHNldDogZnVuY3Rpb24gc2V0KGlkZW50aXR5KSB7DQogICAgICB2YXIgX3RoaXMgPSB0aGlzOw0KICAgICAgX3RoaXMudXNlciA9IGlkZW50aXR5Ow0KICAgIH0sDQogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7DQogICAgICB2YXIgX3RoaXMgPSB0aGlzOw0KICAgICAgcmV0dXJuIF90aGlzLl91c2VyOw0KICAgIH0NCiAgfSwgew0KICAgIGtleTogJ2h5cGVydHlVUkwnLA0KICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgew0KICAgICAgdmFyIF90aGlzID0gdGhpczsNCiAgICAgIHJldHVybiBfdGhpcy5faHlwZXJ0eVVSTDsNCiAgICB9DQogIH0sIHsNCiAgICBrZXk6ICdkZXNjcmlwdG9yJywNCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsNCiAgICAgIHZhciBfdGhpcyA9IHRoaXM7DQogICAgICByZXR1cm4gX3RoaXMuX2Rlc2NyaXB0b3I7DQogICAgfQ0KICB9XSk7DQoNCiAgcmV0dXJuIEh5cGVydHlJbnN0YW5jZTsNCn0oX1JlZ2lzdHJ5RGF0YU1vZGVsMy5kZWZhdWx0KTsNCg0KZXhwb3J0cy5kZWZhdWx0ID0gSHlwZXJ0eUluc3RhbmNlOw0KfSx7Ii4vUmVnaXN0cnlEYXRhTW9kZWwiOjMxNH1dLDMxMzpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQondXNlIHN0cmljdCc7DQoNCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsNCiAgdmFsdWU6IHRydWUNCn0pOw0KDQp2YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTsNCg0KdmFyIF9FdmVudEVtaXR0ZXIyID0gcmVxdWlyZSgnLi4vdXRpbHMvRXZlbnRFbWl0dGVyJyk7DQoNCnZhciBfRXZlbnRFbWl0dGVyMyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0V2ZW50RW1pdHRlcjIpOw0KDQp2YXIgX0FkZHJlc3NBbGxvY2F0aW9uID0gcmVxdWlyZSgnLi9BZGRyZXNzQWxsb2NhdGlvbicpOw0KDQp2YXIgX0FkZHJlc3NBbGxvY2F0aW9uMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0FkZHJlc3NBbGxvY2F0aW9uKTsNCg0KdmFyIF9PYmplY3RBbGxvY2F0aW9uID0gcmVxdWlyZSgnLi4vc3luY2hlci9PYmplY3RBbGxvY2F0aW9uJyk7DQoNCnZhciBfT2JqZWN0QWxsb2NhdGlvbjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9PYmplY3RBbGxvY2F0aW9uKTsNCg0KdmFyIF9IeXBlcnR5SW5zdGFuY2UgPSByZXF1aXJlKCcuL0h5cGVydHlJbnN0YW5jZScpOw0KDQp2YXIgX0h5cGVydHlJbnN0YW5jZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9IeXBlcnR5SW5zdGFuY2UpOw0KDQp2YXIgX01lc3NhZ2VGYWN0b3J5ID0gcmVxdWlyZSgnc2VydmljZS1mcmFtZXdvcmsvZGlzdC9NZXNzYWdlRmFjdG9yeScpOw0KDQp2YXIgX3V0aWxzID0gcmVxdWlyZSgnLi4vdXRpbHMvdXRpbHMuanMnKTsNCg0KZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0NCg0KZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsgfSB9DQoNCmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKCFzZWxmKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcigidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkIik7IH0gcmV0dXJuIGNhbGwgJiYgKHR5cGVvZiBjYWxsID09PSAib2JqZWN0IiB8fCB0eXBlb2YgY2FsbCA9PT0gImZ1bmN0aW9uIikgPyBjYWxsIDogc2VsZjsgfQ0KDQpmdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSAiZnVuY3Rpb24iICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCAiICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfSAvKioNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHn428gZSBTaXN0ZW1hcyBTQQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBJTkVTQy1JRA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBRVU9CSVMgTkVUV09SS1MgU0wNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgT1JBTkdFIFNBDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IERldXRzY2hlIFRlbGVrb20gQUcNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgQXBpemVlDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IFRFQ0hOSVNDSEUgVU5JVkVSU0lUQVQgQkVSTElODQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiovDQoNCg0KLyppbXBvcnQgSWRlbnRpdHlNYW5hZ2VyIGZyb20gJy4vSWRlbnRpdHlNYW5hZ2VyJzsNCmltcG9ydCBEaXNjb3ZlcnkgZnJvbSAnLi9EaXNjb3ZlcnknOyovDQoNCi8qKg0KKiBSdW50aW1lIFJlZ2lzdHJ5IEludGVyZmFjZQ0KKi8NCg0KdmFyIFJlZ2lzdHJ5ID0gZnVuY3Rpb24gKF9FdmVudEVtaXR0ZXIpIHsNCiAgX2luaGVyaXRzKFJlZ2lzdHJ5LCBfRXZlbnRFbWl0dGVyKTsNCg0KICAvKioNCiAgKiBUbyBpbml0aWFsaXNlIHRoZSBSdW50aW1lIFJlZ2lzdHJ5IHdpdGggdGhlIFJ1bnRpbWVVUkwgdGhhdCB3aWxsIGJlIHRoZSBiYXNpcyB0byBkZXJpdmUgdGhlIGludGVybmFsIHJ1bnRpbWUgYWRkcmVzc2VzIHdoZW4gYWxsb2NhdGluZyBhZGRyZXNzZXMgdG8gaW50ZXJuYWwgcnVudGltZSBjb21wb25lbnQuIEluIGFkZGl0aW9uLCB0aGUgUmVnaXN0cnkgZG9tYWluIGJhY2stZW5kIHRvIGJlIHVzZWQgdG8gcmVtb3RlbHkgcmVnaXN0ZXIgUnVudGltZSBjb21wb25lbnRzLCBpcyBhbHNvIHBhc3NlZCBhcyBpbnB1dCBwYXJhbWV0ZXIuDQogICogQHBhcmFtICB7TWVzc2FnZUJ1c30gICAgICAgICAgbXNnYnVzICAgICAgICAgICAgICAgIG1zZ2J1cw0KICAqIEBwYXJhbSAge0h5cGVydHlSdW50aW1lVVJMfSAgIHJ1bnRpbWVVUkwgICAgICAgICAgICBydW50aW1lVVJMDQogICogQHBhcmFtICB7QXBwU2FuZGJveH0gICAgICAgICAgYXBwU2FuZGJveCAgICAgICAgICAgIGFwcFNhbmRib3gNCiAgKiBAcGFyYW0gIHtydW50aW1lQ2F0YWxvZ3VlfSAgICBydW50aW1lQ2F0YWxvZ3VlICAgICAgcnVudGltZUNhdGFsb2d1ZQ0KICAqIEBwYXJhbSAge0RvbWFpblVSTH0gICAgICAgICAgIHJlbW90ZVJlZ2lzdHJ5ICAgICAgICByZW1vdGVSZWdpc3RyeQ0KICAqLw0KDQogIGZ1bmN0aW9uIFJlZ2lzdHJ5KHJ1bnRpbWVVUkwsIGFwcFNhbmRib3gsIGlkZW50aXR5TW9kdWxlLCBydW50aW1lQ2F0YWxvZ3VlLCByZW1vdGVSZWdpc3RyeSkgew0KICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBSZWdpc3RyeSk7DQoNCiAgICAvLyBob3cgc29tZSBmdW5jdGlvbnMgcmVjZWl2ZSB0aGUgcGFyYW1ldGVycyBmb3IgZXhhbXBsZToNCiAgICAvLyBuZXcgUmVnaXN0cnkoJ2h5cGVydHktcnVudGltZTovL3NwMS8xMjMnLCBhcHBTYW5kYm94LCBpZE1vZHVsZSwgcmVtb3RlUmVnaXN0cnkpOw0KICAgIC8vIHJlZ2lzdHJ5LnJlZ2lzdGVyU3R1YihzYW5kYm94LCAnc3AxJyk7DQogICAgLy8gcmVnaXN0cnkucmVnaXN0ZXJIeXBlcnR5KHNhbmRCb3gsICdoeXBlcnR5LXJ1bnRpbWU6Ly9zcDEvMTIzJyk7DQogICAgLy8gcmVnaXN0cnkucmVzb2x2ZSgnaHlwZXJ0eS1ydW50aW1lOi8vc3AxLzEyMycpOw0KDQogICAgdmFyIF90aGlzMiA9IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIE9iamVjdC5nZXRQcm90b3R5cGVPZihSZWdpc3RyeSkuY2FsbCh0aGlzKSk7DQoNCiAgICBpZiAoIXJ1bnRpbWVVUkwpIHRocm93IG5ldyBFcnJvcigncnVudGltZVVSTCBpcyBtaXNzaW5nLicpOw0KICAgIC8qaWYgKCFyZW1vdGVSZWdpc3RyeSkgdGhyb3cgbmV3IEVycm9yKCdyZW1vdGVSZWdpc3RyeSBpcyBtaXNzaW5nJyk7Ki8NCg0KICAgIHZhciBfdGhpcyA9IF90aGlzMjsNCg0KICAgIF90aGlzLnJlZ2lzdHJ5VVJMID0gcnVudGltZVVSTCArICcvcmVnaXN0cnkvJzsNCiAgICBfdGhpcy5hcHBTYW5kYm94ID0gYXBwU2FuZGJveDsNCiAgICBfdGhpcy5ydW50aW1lVVJMID0gcnVudGltZVVSTDsNCiAgICBfdGhpcy5ydW50aW1lQ2F0YWxvZ3VlID0gcnVudGltZUNhdGFsb2d1ZTsNCiAgICBfdGhpcy5yZW1vdGVSZWdpc3RyeSA9IHJlbW90ZVJlZ2lzdHJ5Ow0KICAgIF90aGlzLmlkTW9kdWxlID0gaWRlbnRpdHlNb2R1bGU7DQogICAgX3RoaXMuaWRlbnRpZmllciA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMDAwICsgMSk7DQoNCiAgICAvLyB0aGUgZXhwaXJlcyBpbiAyMTYwMHMsIHJlcHJlc2VudHMgNiBob3Vycw0KICAgIC8vdGhlIGV4cGlyZXMgaXMgaW4gc2Vjb25kcywgdW5pdCBvZiBtZWFzdXJlIHJlY2VpdmVkIGJ5IHRoZSBkb21haW4gcmVnaXN0cnkNCiAgICBfdGhpcy5leHBpcmVzVGltZSA9IDIxNjAwOw0KDQogICAgX3RoaXMuaHlwZXJ0aWVzTGlzdFRvUmVtb3ZlID0ge307DQogICAgX3RoaXMuaHlwZXJ0aWVzTGlzdCA9IFtdOw0KICAgIF90aGlzLnByb3Rvc3R1YnNMaXN0ID0ge307DQogICAgX3RoaXMuaWRwUHJveHlMaXN0ID0ge307DQogICAgX3RoaXMuZGF0YU9iamVjdExpc3QgPSB7fTsNCiAgICBfdGhpcy5zYW5kYm94ZXNMaXN0ID0geyBzYW5kYm94OiB7fSwgYXBwU2FuZGJveDoge30gfTsNCiAgICBfdGhpcy5wZXBMaXN0ID0ge307DQoNCiAgICBfdGhpcy5fZG9tYWluID0gKDAsIF91dGlscy5kaXZpZGVVUkwpKF90aGlzLnJlZ2lzdHJ5VVJMKS5kb21haW47DQogICAgX3RoaXMuc2FuZGJveGVzTGlzdC5hcHBTYW5kYm94W3J1bnRpbWVVUkxdID0gYXBwU2FuZGJveDsNCiAgICB2YXIgbXNnRmFjdG9yeSA9IG5ldyBfTWVzc2FnZUZhY3RvcnkuTWVzc2FnZUZhY3RvcnkoJ2ZhbHNlJywgJ3t9Jyk7DQogICAgX3RoaXMubWVzc2FnZUZhY3RvcnkgPSBtc2dGYWN0b3J5Ow0KICAgIHJldHVybiBfdGhpczI7DQogIH0NCg0KICAvKioNCiAgKiByZXR1cm4gdGhlIG1lc3NhZ2VCdXMgaW4gdGhpcyBSZWdpc3RyeQ0KICAqIEBwYXJhbSB7TWVzc2FnZUJ1c30gICAgICAgICAgIG1lc3NhZ2VCdXMNCiAgKi8NCg0KDQogIF9jcmVhdGVDbGFzcyhSZWdpc3RyeSwgW3sNCiAgICBrZXk6ICdfZ2V0SWRlbnRpdHlBc3NvY2lhdGVkJywNCg0KDQogICAgLypsZXQgZGlzY292ZXJ5ID0gbmV3IERpc2NvdmVyeShfdGhpcy5yZWdpc3RyeVVSTCwgbWVzc2FnZUJ1cyk7DQogICAgX3RoaXMuZGlzY292ZXJ5ID0gZGlzY292ZXJ5Ow0KICAgICBsZXQgaWRlbnRpdHlNYW5hZ2VyID0gbmV3IElkZW50aXR5TWFuYWdlcignaHlwZXJ0eTovL2xvY2FsaG9zdC84MzNhNmU1Mi01MTViLTQ5OGItYTU3Yi1lM2RhZWVjZTQ4ZDInLCBfdGhpcy5ydW50aW1lVVJMLCBtZXNzYWdlQnVzKTsNCiAgICBfdGhpcy5pZGVudGl0eU1hbmFnZXIgPSBpZGVudGl0eU1hbmFnZXI7Ki8NCiAgICB2YWx1ZTogZnVuY3Rpb24gX2dldElkZW50aXR5QXNzb2NpYXRlZCh0eXBlLCBoeXBlcnR5VVJMKSB7DQogICAgICB2YXIgX3RoaXMgPSB0aGlzOw0KDQogICAgICBmb3IgKHZhciBoeXBlcnR5IGluIF90aGlzLmh5cGVydGllc0xpc3QpIHsNCiAgICAgICAgdmFyIHZhbHVlID0gX3RoaXMuaHlwZXJ0aWVzTGlzdFtoeXBlcnR5XTsNCiAgICAgICAgaWYgKHZhbHVlLl9oeXBlcnR5VVJMID09PSBoeXBlcnR5VVJMKSB7DQogICAgICAgICAgc3dpdGNoICh0eXBlKSB7DQogICAgICAgICAgICBjYXNlICd1c2VybmFtZSc6DQogICAgICAgICAgICAgIHJldHVybiB2YWx1ZS5fdXNlci51c2VybmFtZTsNCiAgICAgICAgICAgIGNhc2UgJ2NuJzoNCiAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlLl91c2VyLmNuOw0KICAgICAgICAgICAgY2FzZSAnbG9jYWxlJzoNCiAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlLl91c2VyLmxvY2FsZTsNCiAgICAgICAgICAgIGNhc2UgJ2F2YXRhcic6DQogICAgICAgICAgICAgIHJldHVybiB2YWx1ZS5fdXNlci5hdmF0YXI7DQogICAgICAgICAgICBjYXNlICd1c2VyVVJMJzoNCiAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlLl91c2VyLnVzZXJVUkw7DQogICAgICAgICAgICBjYXNlICcuJzoNCiAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlLl91c2VyOw0KICAgICAgICAgICAgZGVmYXVsdDoNCiAgICAgICAgICAgICAgcmV0dXJuICdObyBpbmZvcm1hdGlvbiBjb3VsZCBiZSBmb3VuZCc7DQogICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICB9DQogICAgICByZXR1cm4gJ25vIGlkZW50aXR5IGZvdW5kJzsNCiAgICB9DQoNCiAgICAvKioNCiAgICAqIFRoaXMgZnVuY3Rpb24gaXMgdXNlZCB0byByZXR1cm4gdGhlIHNhbmRib3ggaW5zdGFuY2Ugd2hlcmUgdGhlIEFwcGxpY2F0aW9uIGlzIGV4ZWN1dGluZy4gSXQgaXMgYXNzdW1lZCB0aGVyZSBpcyBqdXN0IG9uZSBBcHAgcGVyIFJ1bnRpbWUgaW5zdGFuY2UuDQogICAgKi8NCg0KICB9LCB7DQogICAga2V5OiAnZ2V0QXBwU2FuZGJveCcsDQogICAgdmFsdWU6IGZ1bmN0aW9uIGdldEFwcFNhbmRib3goKSB7DQogICAgICB2YXIgX3RoaXMgPSB0aGlzOw0KICAgICAgcmV0dXJuIF90aGlzLmFwcFNhbmRib3g7DQogICAgfQ0KDQogICAgLyoqDQogICAgKiBmdW5jdGlvbiB0byByZXR1cm4gdGhlIHJlcG9ydGVyVVJMIGFzc29jaWF0ZWQgd2l0aCB0aGUgZGF0YW9iamVjdCBVUkwNCiAgICAqIEBwYXJhbSAgICB7U3RyaW5nfSAgICAgZGF0YU9iamVjdFVSTCAgICBkYXRhT2JqZWN0VVJMDQogICAgKiBAcmV0dXJuICAge1N0cmluZ30gICAgIHJlcG9ydGVyVVJMICAgICAgcmVwb3J0ZXJVUkwNCiAgICAqLw0KDQogIH0sIHsNCiAgICBrZXk6ICdnZXRSZXBvcnRlclVSTCcsDQogICAgdmFsdWU6IGZ1bmN0aW9uIGdldFJlcG9ydGVyVVJMKGRhdGFPYmplY3RVUkwpIHsNCiAgICAgIHZhciBfdGhpcyA9IHRoaXM7DQoNCiAgICAgIHZhciBkYXRhT2JqZWN0ID0gX3RoaXMuZGF0YU9iamVjdExpc3RbZGF0YU9iamVjdFVSTF07DQoNCiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7DQogICAgICAgIGlmIChkYXRhT2JqZWN0KSB7DQogICAgICAgICAgcmVzb2x2ZShkYXRhT2JqZWN0LnJlcG9ydGVyKTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICByZWplY3QoJ05vIHJlcG9ydGVyIHdhcyBmb3VuZCcpOw0KICAgICAgICB9DQogICAgICB9KTsNCiAgICB9DQogIH0sIHsNCiAgICBrZXk6ICdnZXRQcmVBdXRoU3Vic2NyaWJlcnMnLA0KICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRQcmVBdXRoU3Vic2NyaWJlcnMoZGF0YU9iamVjdFVSTCkgew0KICAgICAgdmFyIF90aGlzID0gdGhpczsNCg0KICAgICAgdmFyIGRhdGFPYmplY3QgPSBfdGhpcy5kYXRhT2JqZWN0TGlzdFtkYXRhT2JqZWN0VVJMXTsNCg0KICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsNCiAgICAgICAgaWYgKGRhdGFPYmplY3QpIHsNCiAgICAgICAgICByZXNvbHZlKGRhdGFPYmplY3QucHJlQXV0aCk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgcmVqZWN0KCdObyByZXBvcnRlciB3YXMgZm91bmQnKTsNCiAgICAgICAgfQ0KICAgICAgfSk7DQogICAgfQ0KDQogICAgLyoqDQogICAgKiAgZnVuY3Rpb24gdG8gZGVsZXRlIGFuIGh5cGVydHlJbnN0YW5jZSBpbiB0aGUgRG9tYWluIFJlZ2lzdHJ5DQogICAgKiAgQHBhcmFtICAge1N0cmluZ30gICAgICB1c2VyICAgICAgICB1c2VyIHVybA0KICAgICogIEBwYXJhbSAgIHtTdHJpbmd9ICAgICAgaHlwZXJ0eUluc3RhbmNlICAgSHlwZXJ0eUluc250YW5jZSB1cmwNCiAgICAqDQogICAgKi8NCg0KICB9LCB7DQogICAga2V5OiAnZGVsZXRlSHlwZXJ0eUluc3RhbmNlJywNCiAgICB2YWx1ZTogZnVuY3Rpb24gZGVsZXRlSHlwZXJ0eUluc3RhbmNlKHVzZXIsIGh5cGVydHlJbnN0YW5jZSkgew0KICAgICAgLy9UT0RPIHdvcmtpbmcgYnV0IHRoZSB1c2VyDQogICAgICB2YXIgX3RoaXMgPSB0aGlzOw0KDQogICAgICB2YXIgbWVzc2FnZSA9IHsgdHlwZTogJ2RlbGV0ZScsIGZyb206IF90aGlzLnJlZ2lzdHJ5VVJMLA0KICAgICAgICB0bzogJ2RvbWFpbjovL3JlZ2lzdHJ5LicgKyBfdGhpcy5fZG9tYWluICsgJy8nLA0KICAgICAgICBib2R5OiB7IHZhbHVlOiB7IHVzZXI6IHVzZXIsIGh5cGVydHlVUkw6IGh5cGVydHlJbnN0YW5jZSB9IH0gfTsNCg0KICAgICAgX3RoaXMuX21lc3NhZ2VCdXMucG9zdE1lc3NhZ2UobWVzc2FnZSwgZnVuY3Rpb24gKHJlcGx5KSB7DQogICAgICAgIGNvbnNvbGUubG9nKCdkZWxldGUgaHlwZXJ0eSBSZXBseScsIHJlcGx5KTsNCiAgICAgIH0pOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICogIGZ1bmN0aW9uIHRvIGRlbGV0ZSBhbiBkYXRhT2JqZWN0SW5zdGFuY2UgaW4gdGhlIERvbWFpbiBSZWdpc3RyeQ0KICAgICogIEBwYXJhbSAgIHtTdHJpbmd9ICAgIG5hbWUgICAgICBEYXRhT2JqZWN0TmFtZQ0KICAgICovDQoNCiAgfSwgew0KICAgIGtleTogJ2RlbGV0ZURhdGFPYmplY3RJbnN0YW5jZScsDQogICAgdmFsdWU6IGZ1bmN0aW9uIGRlbGV0ZURhdGFPYmplY3RJbnN0YW5jZShuYW1lKSB7DQogICAgICB2YXIgX3RoaXMgPSB0aGlzOw0KDQogICAgICB2YXIgbWVzc2FnZSA9IHsgdHlwZTogJ2RlbGV0ZScsIGZyb206IF90aGlzLnJlZ2lzdHJ5VVJMLA0KICAgICAgICB0bzogJ2RvbWFpbjovL3JlZ2lzdHJ5LicgKyBfdGhpcy5fZG9tYWluICsgJy8nLA0KICAgICAgICBib2R5OiB7IHZhbHVlOiB7IG5hbWU6IG5hbWUgfSB9IH07DQoNCiAgICAgIF90aGlzLl9tZXNzYWdlQnVzLnBvc3RNZXNzYWdlKG1lc3NhZ2UsIGZ1bmN0aW9uIChyZXBseSkgew0KICAgICAgICBjb25zb2xlLmxvZygnZGVsZXRlIGh5cGVydHkgUmVwbHknLCByZXBseSk7DQogICAgICB9KTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAqIEZ1bmN0aW9uIHRvIHVwZGF0ZSBhbiBIeXBlcnR5DQogICAgKi8NCg0KICB9LCB7DQogICAga2V5OiAndXBkYXRlSHlwZXJ0eUluc3RhbmNlJywNCiAgICB2YWx1ZTogZnVuY3Rpb24gdXBkYXRlSHlwZXJ0eUluc3RhbmNlKHJlc291cmNlLCB2YWx1ZSkgew0KICAgICAgdmFyIF90aGlzID0gdGhpczsNCg0KICAgICAgdmFyIG1lc3NhZ2UgPSB7IHR5cGU6ICdVUERBVEUnLCBmcm9tOiBfdGhpcy5yZWdpc3RyeVVSTCwNCiAgICAgICAgdG86ICdkb21haW46Ly9yZWdpc3RyeS4nICsgX3RoaXMuX2RvbWFpbiArICcvJywNCiAgICAgICAgYm9keTogeyByZXNvdXJjZTogcmVzb3VyY2UsIHZhbHVlOiB2YWx1ZSB9IH07DQoNCiAgICAgIF90aGlzLl9tZXNzYWdlQnVzLnBvc3QucG9zdE1lc3NhZ2UobWVzc2FnZSwgZnVuY3Rpb24gKHJlcGx5KSB7DQogICAgICAgIGNvbnNvbGUubG9nKCdVcGRhdGVkIGh5cGVydHkgcmVwbHknLCByZXBseSk7DQogICAgICB9KTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAqIFRvIHJlZ2lzdGVyIGEgbmV3IERhdGEgT2JqZWN0IGluIHRoZSBydW50aW1lIHdoaWNoIHJldHVybnMgdGhlIGRhdGFPYmplY3RVUkwgYWxsb2NhdGVkIHRvIHRoZSBuZXcgRGF0YSBPYmplY3QuDQogICAgKiBAcGFyYW0gIHtTdHJpbmd9ICAgICAgaWRlbnRpZmllciAgICAgICAgICAgIGlkZW50aWZpZXINCiAgICAqIEBwYXJhbSAge1N0cmluZ30gICAgICBkYXRhT2JqZWN0c2NoZW1hICAgICAgICAgICAgZGF0YU9iamVjdHNjaGVtYQ0KICAgICogQHBhcmFtICB7U3RyaW5nfSAgICAgIGRhdGFPYmplY3RVcmwgICAgICAgIGRhdGFPYmplY3RVcmwNCiAgICAqIEByZXR1cm4ge1N0cmluZ30gICAgICBkYXRhT2JqZWN0UmVwb3J0ZXIgICAgICAgICBkYXRhT2JqZWN0UmVwb3J0ZXINCiAgICAqLw0KDQogIH0sIHsNCiAgICBrZXk6ICdyZWdpc3RlckRhdGFPYmplY3QnLA0KICAgIHZhbHVlOiBmdW5jdGlvbiByZWdpc3RlckRhdGFPYmplY3QoaWRlbnRpZmllciwgZGF0YU9iamVjdHNjaGVtYSwgZGF0YU9iamVjdFVybCwgZGF0YU9iamVjdFJlcG9ydGVyLCBhdXRob3Jpc2UpIHsNCiAgICAgIHZhciBfdGhpcyA9IHRoaXM7DQoNCiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7DQoNCiAgICAgICAgLy9tZXNzYWdlIHRvIHJlZ2lzdGVyIHRoZSBuZXcgaHlwZXJ0eSwgd2l0aGluIHRoZSBkb21haW4gcmVnaXN0cnkNCiAgICAgICAgdmFyIG1lc3NhZ2VWYWx1ZSA9IHsgbmFtZTogaWRlbnRpZmllciwgc2NoZW1hOiBkYXRhT2JqZWN0c2NoZW1hLCB1cmw6IGRhdGFPYmplY3RVcmwsIGV4cGlyZXM6IF90aGlzLmV4cGlyZXNUaW1lLCByZXBvcnRlcjogZGF0YU9iamVjdFJlcG9ydGVyLCBwcmVBdXRoOiBhdXRob3Jpc2UgfTsNCg0KICAgICAgICBfdGhpcy5kYXRhT2JqZWN0TGlzdFtkYXRhT2JqZWN0VXJsXSA9IG1lc3NhZ2VWYWx1ZTsNCg0KICAgICAgICB2YXIgbWVzc2FnZSA9IF90aGlzLm1lc3NhZ2VGYWN0b3J5LmNyZWF0ZUNyZWF0ZU1lc3NhZ2VSZXF1ZXN0KF90aGlzLnJlZ2lzdHJ5VVJMLCAnZG9tYWluOi8vcmVnaXN0cnkuJyArIF90aGlzLnJlZ2lzdHJ5RG9tYWluICsgJy8nLCBtZXNzYWdlVmFsdWUsICdwb2xpY3knKTsNCg0KICAgICAgICBfdGhpcy5fbWVzc2FnZUJ1cy5wb3N0TWVzc2FnZShtZXNzYWdlLCBmdW5jdGlvbiAocmVwbHkpIHsNCiAgICAgICAgICBjb25zb2xlLmxvZygnPT09PiByZWdpc3RlckRhdGFPYmplY3QgUmVwbHk6ICcsIHJlcGx5KTsNCiAgICAgICAgICBpZiAocmVwbHkuYm9keS5jb2RlID09PSAyMDApIHsNCiAgICAgICAgICAgIHJlc29sdmUoJ29rJyk7DQogICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHJlamVjdCgnZXJyb3Igb24gcmVnaXN0ZXIgRGF0YU9iamVjdCcpOw0KICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgICB9KTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAqIFRvIHJlZ2lzdGVyIGEgbmV3IEh5cGVydHkgaW4gdGhlIHJ1bnRpbWUgd2hpY2ggcmV0dXJucyB0aGUgSHlwZXJ0eVVSTCBhbGxvY2F0ZWQgdG8gdGhlIG5ldyBIeXBlcnR5Lg0KICAgICogQHBhcmFtICB7U2FuZGJveH0gICAgICAgICAgICAgc2FuZGJveCAgICAgICAgICAgICAgIHNhbmRib3gNCiAgICAqIEBwYXJhbSAge0h5cGVydHlDYXRhbG9ndWVVUkx9IEh5cGVydHlDYXRhbG9ndWVVUkwgICBkZXNjcmlwdG9yDQogICAgKiBAcmV0dXJuIHtIeXBlcnR5VVJMfSAgICAgICAgICBIeXBlcnR5VVJMDQogICAgKi8NCg0KICB9LCB7DQogICAga2V5OiAncmVnaXN0ZXJIeXBlcnR5JywNCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVnaXN0ZXJIeXBlcnR5KHNhbmRib3gsIGRlc2NyaXB0b3JVUkwsIGRlc2NyaXB0b3IpIHsNCiAgICAgIHZhciBfdGhpcyA9IHRoaXM7DQoNCiAgICAgIC8vYXNzdW1pbmcgZGVzY3JpcHRvciBjb21lIGluIHRoaXMgZm9ybWF0LCB0aGUgc2VydmljZS1wcm92aWRlci1kb21haW4gdXJsIGlzIHJldHJpZXZlZCBieSBhIHNwbGl0IGluc3RydWN0aW9uDQogICAgICAvL2h5cGVydHktY2F0YWxvZ3VlOi8vPHNlcnZpY2UtcHJvdmlkZXItZG9tYWluPi88Y2F0YWxvZ3VlLW9iamVjdC1pZGVudGlmaWVyPg0KICAgICAgdmFyIGRvbWFpblVybCA9ICgwLCBfdXRpbHMuZGl2aWRlVVJMKShkZXNjcmlwdG9yVVJMKS5kb21haW47DQoNCiAgICAgIGlmIChkb21haW5VcmwuaW5jbHVkZXMoJ2NhdGFsb2d1ZScpKSB7DQogICAgICAgIGRvbWFpblVybCA9IGRvbWFpblVybC5yZXBsYWNlKCdjYXRhbG9ndWUuJywgJycpOw0KICAgICAgfQ0KDQogICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgew0KDQogICAgICAgIF90aGlzLmlkTW9kdWxlLmdldElkZW50aXR5QXNzZXJ0aW9uKCkudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7DQogICAgICAgICAgdmFyIHVzZXJQcm9maWxlID0gcmVzdWx0LnVzZXJQcm9maWxlOw0KICAgICAgICAgIHZhciBpZGVudGl0eVVSTCA9IHVzZXJQcm9maWxlLnVzZXJVUkw7DQoNCiAgICAgICAgICBpZiAoX3RoaXMuX21lc3NhZ2VCdXMgPT09IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgcmVqZWN0KCdNZXNzYWdlQnVzIG5vdCBmb3VuZCBvbiByZWdpc3RlclN0dWInKTsNCiAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgLy9jYWxsIGNoZWNrIGlmIHRoZSBwcm90b3N0dWIgZXhpc3QNCiAgICAgICAgICAgIF90aGlzLnJlc29sdmUoJ2h5cGVydHktcnVudGltZTovLycgKyBkb21haW5VcmwpLnRoZW4oZnVuY3Rpb24gKCkgew0KDQogICAgICAgICAgICAgIF90aGlzLnJlZ2lzdHJ5RG9tYWluID0gZG9tYWluVXJsOw0KDQogICAgICAgICAgICAgIC8vIFRPRE86IHNob3VsZCBiZSBpbXBsZW1lbnRlZCB3aXRoIGFkZHJlc3NlcyBwb2xsDQogICAgICAgICAgICAgIC8vIEluIHRoaXMgY2FzZSB3ZSB3aWxsIHJlcXVlc3QgYW5kIHJldHVybiBvbmx5IG9uZQ0KICAgICAgICAgICAgICAvLyBhZGRyZXNzDQogICAgICAgICAgICAgIHZhciBudW1iZXJPZkFkZHJlc3NlcyA9IDE7DQogICAgICAgICAgICAgIF90aGlzLmFkZHJlc3NBbGxvY2F0aW9uLmNyZWF0ZShkb21haW5VcmwsIG51bWJlck9mQWRkcmVzc2VzKS50aGVuKGZ1bmN0aW9uIChhZGRlcmVzc0xpc3QpIHsNCg0KICAgICAgICAgICAgICAgIGFkZGVyZXNzTGlzdC5mb3JFYWNoKGZ1bmN0aW9uIChhZGRyZXNzKSB7DQoNCiAgICAgICAgICAgICAgICAgIF90aGlzLl9tZXNzYWdlQnVzLmFkZExpc3RlbmVyKGFkZHJlc3MgKyAnL3N0YXR1cycsIGZ1bmN0aW9uIChtc2cpIHsNCiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ01lc3NhZ2UgYWRkTGlzdGVuZXIgZm9yIDogJywgYWRkcmVzcyArICcvc3RhdHVzIC0+ICcgKyBtc2cpOw0KICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgICAgICB2YXIgaHlwZXJ0eSA9IG5ldyBfSHlwZXJ0eUluc3RhbmNlMi5kZWZhdWx0KF90aGlzLmlkZW50aWZpZXIsIF90aGlzLnJlZ2lzdHJ5VVJMLCBkZXNjcmlwdG9yVVJMLCBkZXNjcmlwdG9yLCBhZGRlcmVzc0xpc3RbMF0sIHVzZXJQcm9maWxlKTsNCg0KICAgICAgICAgICAgICAgIF90aGlzLmh5cGVydGllc0xpc3QucHVzaChoeXBlcnR5KTsNCg0KICAgICAgICAgICAgICAgIC8vY2hlY2sgd2hldGhlciB0aGUgcmVjZWl2ZWQgc2FuYm94IGUgQXBwbGljYXRpb25TYW5kYm94IG9yIGEgbm9ybWFsIHNhbmRib3gNCiAgICAgICAgICAgICAgICBpZiAoc2FuZGJveC50eXBlID09PSAnYXBwJykgew0KICAgICAgICAgICAgICAgICAgX3RoaXMuc2FuZGJveGVzTGlzdC5hcHBTYW5kYm94W2FkZGVyZXNzTGlzdFswXV0gPSBzYW5kYm94Ow0KICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoc2FuZGJveC50eXBlID09PSAnbm9ybWFsJykgew0KICAgICAgICAgICAgICAgICAgX3RoaXMuc2FuZGJveGVzTGlzdC5zYW5kYm94W2FkZGVyZXNzTGlzdFswXV0gPSBzYW5kYm94Ow0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICByZWplY3QoJ1dyb25nIFNhbmRib3hUeXBlJyk7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgdmFyIHJlc291cmNlcyA9IHZvaWQgMDsNCg0KICAgICAgICAgICAgICAgIC8vIGNoZWNrIGlmIHRoZSBoeXBlcnR5IHJlc291cmNlcyBpcyBhIHZlY3RvciBvciBhIHN0cmluZw0KICAgICAgICAgICAgICAgIC8vIFRPRE8gZGVsZXRlIGxhdGVyIHdoZW4gY2F0YWxvZ3VlIGlzIGZpeGVkDQogICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBkZXNjcmlwdG9yLmh5cGVydHlUeXBlID09PSAnc3RyaW5nJykgew0KICAgICAgICAgICAgICAgICAgcmVzb3VyY2VzID0gW107DQogICAgICAgICAgICAgICAgICByZXNvdXJjZXMucHVzaChkZXNjcmlwdG9yLmh5cGVydHlUeXBlKTsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgcmVzb3VyY2VzID0gZGVzY3JpcHRvci5oeXBlcnR5VHlwZTsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICB2YXIgZGVzY3JpcHRvckRhdGFTY2hlbWEgPSBkZXNjcmlwdG9yLmRhdGFPYmplY3RzOw0KICAgICAgICAgICAgICAgIHZhciBkYXRhU2NoZW1hc0FycmF5ID0gW107DQoNCiAgICAgICAgICAgICAgICAvL3RoaXMgd2lsbCBjcmVhdGUgYSBhcnJheSB3aXRoIGEgUHJvbWlzZSBpbiBlYWNoIHBvc2l0aW9uDQogICAgICAgICAgICAgICAgZm9yICh2YXIgaW5kZXggaW4gZGVzY3JpcHRvckRhdGFTY2hlbWEpIHsNCiAgICAgICAgICAgICAgICAgIGRhdGFTY2hlbWFzQXJyYXkucHVzaChfdGhpcy5ydW50aW1lQ2F0YWxvZ3VlLmdldERhdGFTY2hlbWFEZXNjcmlwdG9yKGRlc2NyaXB0b3JEYXRhU2NoZW1hW2luZGV4XSkpOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIC8vIGFzIHNvb24gYXMgdGhlIHByZXZpb3VzIGFycmF5IGlzIGNvbXBsZXRlZCwgdGhpcyB3aWxsIHdhaXQgZm9yIHRoZSByZXNvbHZlIG9mIGFsbCBwcm9taXNlcyBpbiB0aGUgYXJyYXkNCiAgICAgICAgICAgICAgICBQcm9taXNlLmFsbChkYXRhU2NoZW1hc0FycmF5KS50aGVuKGZ1bmN0aW9uIChkYXRhU2NoZW1hcykgew0KDQogICAgICAgICAgICAgICAgICB2YXIgZmlsdGVyZWREYXRhU2NoZW1hcyA9IFtdOw0KICAgICAgICAgICAgICAgICAgZm9yICh2YXIgX2luZGV4IGluIGRhdGFTY2hlbWFzKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBkYXRhU2NoZW1hID0gZGF0YVNjaGVtYXNbX2luZGV4XTsNCiAgICAgICAgICAgICAgICAgICAgZmlsdGVyZWREYXRhU2NoZW1hcy5wdXNoKGRhdGFTY2hlbWEuc291cmNlUGFja2FnZS5zb3VyY2VDb2RlLnByb3BlcnRpZXMuc2NoZW1lLmNvbnN0YW50KTsNCiAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgLy9tZXNzYWdlIHRvIHJlZ2lzdGVyIHRoZSBuZXcgaHlwZXJ0eSwgd2l0aGluIHRoZSBkb21haW4gcmVnaXN0cnkNCiAgICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlVmFsdWUgPSB7IHVzZXI6IGlkZW50aXR5VVJMLCBoeXBlcnR5RGVzY3JpcHRvclVSTDogZGVzY3JpcHRvclVSTCwgaHlwZXJ0eVVSTDogYWRkZXJlc3NMaXN0WzBdLCBleHBpcmVzOiBfdGhpcy5leHBpcmVzVGltZSwgcmVzb3VyY2VzOiByZXNvdXJjZXMsIGRhdGFTY2hlbWVzOiBmaWx0ZXJlZERhdGFTY2hlbWFzIH07DQoNCiAgICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlID0gX3RoaXMubWVzc2FnZUZhY3RvcnkuY3JlYXRlQ3JlYXRlTWVzc2FnZVJlcXVlc3QoX3RoaXMucmVnaXN0cnlVUkwsICdkb21haW46Ly9yZWdpc3RyeS4nICsgX3RoaXMucmVnaXN0cnlEb21haW4gKyAnLycsIG1lc3NhZ2VWYWx1ZSwgJ3BvbGljeScpOw0KDQogICAgICAgICAgICAgICAgICBfdGhpcy5fbWVzc2FnZUJ1cy5wb3N0TWVzc2FnZShtZXNzYWdlLCBmdW5jdGlvbiAocmVwbHkpIHsNCiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJz09PT4gUmVnaXN0ZXJIeXBlcnR5IFJlcGx5OiAnLCByZXBseSk7DQogICAgICAgICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgICAgICAgLy90aW1lciB0byBrZWVwIHRoZSByZWdpc3RyYXRpb24gYWxpdmUNCiAgICAgICAgICAgICAgICAgIC8vIHRoZSB0aW1lIGlzIGRlZmluZWQgYnkgYSBsaXR0bGUgbGVzcyB0aGFuIGhhbGYgb2YgdGhlIGV4cGlyZXMgdGltZSBkZWZpbmVkDQogICAgICAgICAgICAgICAgICB2YXIga2VlcEFsaXZlVGltZXIgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7DQoNCiAgICAgICAgICAgICAgICAgICAgdmFyIG1lc3NhZ2UgPSBfdGhpcy5tZXNzYWdlRmFjdG9yeS5jcmVhdGVDcmVhdGVNZXNzYWdlUmVxdWVzdChfdGhpcy5yZWdpc3RyeVVSTCwgJ2RvbWFpbjovL3JlZ2lzdHJ5LicgKyBfdGhpcy5yZWdpc3RyeURvbWFpbiArICcvJywgbWVzc2FnZVZhbHVlLCAncG9saWN5Jyk7DQoNCiAgICAgICAgICAgICAgICAgICAgX3RoaXMuX21lc3NhZ2VCdXMucG9zdE1lc3NhZ2UobWVzc2FnZSwgZnVuY3Rpb24gKHJlcGx5KSB7DQogICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJz09PT4gS2VlcEFsaXZlIFJlcGx5OiAnLCByZXBseSk7DQogICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgfSwgX3RoaXMuZXhwaXJlc1RpbWUgLyAxLjEgLyAyICogMTAwMCk7DQoNCiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdIeXBlcnR5IFNjaGVtYXMnLCBmaWx0ZXJlZERhdGFTY2hlbWFzKTsNCiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdIeXBlcnR5IHJlc291cmNlcycsIHJlc291cmNlcyk7DQoNCiAgICAgICAgICAgICAgICAgIHJlc29sdmUoYWRkZXJlc3NMaXN0WzBdKTsNCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKHJlYXNvbikgew0KICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdBZGRyZXNzIFJlYXNvbjogJywgcmVhc29uKTsNCiAgICAgICAgICAgICAgICByZWplY3QocmVhc29uKTsNCiAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICB9KTsNCiAgICAgICAgICB9DQogICAgICAgIH0sIGZ1bmN0aW9uIChlcnIpIHsNCiAgICAgICAgICByZWplY3QoJ0ZhaWxlZCB0byBvYnRhaW4gYW4gaWRlbnRpdHknKTsNCiAgICAgICAgfSk7DQogICAgICB9KTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAqIFRvIHVucmVnaXN0ZXIgYSBwcmV2aW91c2x5IHJlZ2lzdGVyZWQgSHlwZXJ0eQ0KICAgICogQHBhcmFtICB7SHlwZXJ0eVVSTH0gICAgICAgICAgSHlwZXJ0eVVSTCB1cmwgICAgICAgIHVybA0KICAgICovDQoNCiAgfSwgew0KICAgIGtleTogJ3VucmVnaXN0ZXJIeXBlcnR5JywNCiAgICB2YWx1ZTogZnVuY3Rpb24gdW5yZWdpc3Rlckh5cGVydHkodXJsKSB7DQogICAgICB2YXIgX3RoaXMgPSB0aGlzOw0KDQogICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgew0KDQogICAgICAgIHZhciBmb3VuZCA9IGZhbHNlOw0KICAgICAgICB2YXIgaW5kZXggPSAwOw0KDQogICAgICAgIGZvciAoaW5kZXggPSAwOyBpbmRleCA8IF90aGlzLmh5cGVydGllc0xpc3QubGVuZ3RoOyBpbmRleCsrKSB7DQogICAgICAgICAgdmFyIGh5cGVydHkgPSBfdGhpcy5oeXBlcnRpZXNMaXN0W2luZGV4XTsNCiAgICAgICAgICBpZiAoaHlwZXJ0eSAhPT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICBpZiAoaHlwZXJ0eS5oeXBlcnR5VVJMID09PSB1cmwpIHsNCiAgICAgICAgICAgICAgZm91bmQgPSB0cnVlOw0KICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoZm91bmQgPT09IGZhbHNlKSB7DQogICAgICAgICAgcmVqZWN0KCdIeXBlcnR5IG5vdCBmb3VuZCcpOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgIGRlbGV0ZSBfdGhpcy5oeXBlcnRpZXNMaXN0W2luZGV4XTsNCiAgICAgICAgICByZXNvbHZlKCdIeXBlcnR5IHN1Y2Nlc3NmdWxseSBkZWxldGVkJyk7DQogICAgICAgIH0NCiAgICAgIH0pOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICogVG8gZGlzY292ZXIgcHJvdG9jb2wgc3R1YnMgYXZhaWxhYmxlIGluIHRoZSBydW50aW1lIGZvciBhIGNlcnRhaW4gZG9tYWluLiBJZiBhdmFpbGFibGUsIGl0IHJldHVybnMgdGhlIHJ1bnRpbWUgdXJsIGZvciB0aGUgcHJvdG9jb2wgc3R1YiB0aGF0IGNvbm5lY3RzIHRvIHRoZSByZXF1ZXN0ZWQgZG9tYWluLiBSZXF1aXJlZCBieSB0aGUgcnVudGltZSBCVVMgdG8gcm91dGUgbWVzc2FnZXMgdG8gcmVtb3RlIHNlcnZlcnMgb3IgcGVlcnMgKGRvIHdlIG5lZWQgc29tZXRoaW5nIHNpbWlsYXIgZm9yIEh5cGVydGllcz8pLg0KICAgICogQHBhcmFtICB7RG9tYWluVVJMfSAgICAgICAgICAgRG9tYWluVVJMICAgICAgICAgICAgdXJsDQogICAgKiBAcmV0dXJuIHtSdW50aW1lVVJMfSAgICAgICAgICAgUnVudGltZVVSTA0KICAgICovDQoNCiAgfSwgew0KICAgIGtleTogJ2Rpc2NvdmVyUHJvdG9zdHViJywNCiAgICB2YWx1ZTogZnVuY3Rpb24gZGlzY292ZXJQcm90b3N0dWIodXJsKSB7DQogICAgICBpZiAoIXVybCkgdGhyb3cgbmV3IEVycm9yKCdQYXJhbWV0ZXIgdXJsIG5lZWRlZCcpOw0KICAgICAgdmFyIF90aGlzID0gdGhpczsNCg0KICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsNCg0KICAgICAgICB2YXIgcmVxdWVzdCA9IF90aGlzLnByb3Rvc3R1YnNMaXN0W3VybF07DQoNCiAgICAgICAgaWYgKHJlcXVlc3QgPT09IHVuZGVmaW5lZCkgew0KICAgICAgICAgIHJlamVjdCgncmVxdWVzdFVwZGF0ZSBjb3VsZG5cJ3QgZ2V0IHRoZSBQcm90b3N0dWJVUkwnKTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICByZXNvbHZlKHJlcXVlc3QpOw0KICAgICAgICB9DQogICAgICB9KTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBUbyByZWdpc3RlciBhIG5ldyBQcm90b2NvbCBTdHViIGluIHRoZSBydW50aW1lIGluY2x1ZGluZyBhcyBpbnB1dCBwYXJhbWV0ZXJzIHRoZSBmdW5jdGlvbiB0byBwb3N0TWVzc2FnZSwgdGhlIERvbWFpblVSTCB0aGF0IGlzIGNvbm5lY3RlZCB3aXRoIHRoZSBzdHViLCB3aGljaCByZXR1cm5zIHRoZSBSdW50aW1lVVJMIGFsbG9jYXRlZCB0byB0aGUgbmV3IFByb3RvY29sU3R1Yi4NCiAgICAgKiBAcGFyYW0ge1NhbmRib3h9ICAgICAgICBTYW5kYm94DQogICAgICogQHBhcmFtICB7RG9tYWluVVJMfSAgICAgRG9tYWluVVJMIHNlcnZpY2UgcHJvdmlkZXIgZG9tYWluDQogICAgICogQHJldHVybiB7UnVudGltZVByb3RvU3R1YlVSTH0NCiAgICAgKi8NCg0KICB9LCB7DQogICAga2V5OiAncmVnaXN0ZXJTdHViJywNCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVnaXN0ZXJTdHViKHNhbmRib3gsIGRvbWFpblVSTCkgew0KICAgICAgdmFyIF90aGlzID0gdGhpczsNCiAgICAgIHZhciBydW50aW1lUHJvdG9TdHViVVJMID0gdm9pZCAwOw0KDQogICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgew0KDQogICAgICAgIC8vY2hlY2sgaWYgbWVzc2FnZUJ1cyBpcyByZWdpc3RlcmVkIGluIHJlZ2lzdHJ5IG9yIG5vdA0KICAgICAgICBpZiAoX3RoaXMuX21lc3NhZ2VCdXMgPT09IHVuZGVmaW5lZCkgew0KICAgICAgICAgIHJlamVjdCgnTWVzc2FnZUJ1cyBub3QgZm91bmQgb24gcmVnaXN0ZXJTdHViJyk7DQogICAgICAgIH0NCg0KICAgICAgICAvL1RPRE8gaW1wbGVtZW50IGEgdW5pcXVlIG51bWJlciBmb3IgdGhlIHByb3Rvc3R1YlVSTA0KICAgICAgICBpZiAoIWRvbWFpblVSTC5pbmRleE9mKCdtc2ctbm9kZS4nKSkgew0KICAgICAgICAgIGRvbWFpblVSTCA9IGRvbWFpblVSTC5zdWJzdHJpbmcoZG9tYWluVVJMLmluZGV4T2YoJy4nKSArIDEpOw0KICAgICAgICB9DQoNCiAgICAgICAgcnVudGltZVByb3RvU3R1YlVSTCA9ICdtc2ctbm9kZS4nICsgZG9tYWluVVJMICsgJy9wcm90b3N0dWIvJyArIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMDAwICsgMSk7DQoNCiAgICAgICAgLy8gVE9ETzogT3B0aW1pemUgdGhpcw0KICAgICAgICBfdGhpcy5wcm90b3N0dWJzTGlzdFtkb21haW5VUkxdID0gcnVudGltZVByb3RvU3R1YlVSTDsNCiAgICAgICAgX3RoaXMuc2FuZGJveGVzTGlzdC5zYW5kYm94W3J1bnRpbWVQcm90b1N0dWJVUkxdID0gc2FuZGJveDsNCg0KICAgICAgICAvLyBzYW5kYm94LmFkZExpc3RlbmVyKCcqJywgZnVuY3Rpb24obXNnKSB7DQogICAgICAgIC8vICAgX3RoaXMuX21lc3NhZ2VCdXMucG9zdE1lc3NhZ2UobXNnKTsNCiAgICAgICAgLy8gfSk7DQoNCiAgICAgICAgcmVzb2x2ZShydW50aW1lUHJvdG9TdHViVVJMKTsNCg0KICAgICAgICBfdGhpcy5fbWVzc2FnZUJ1cy5hZGRMaXN0ZW5lcihydW50aW1lUHJvdG9TdHViVVJMICsgJy9zdGF0dXMnLCBmdW5jdGlvbiAobXNnKSB7DQogICAgICAgICAgaWYgKG1zZy5yZXNvdXJjZSA9PT0gbXNnLnRvICsgJy9zdGF0dXMnKSB7DQogICAgICAgICAgICBjb25zb2xlLmxvZygnUnVudGltZVByb3Rvc3R1YlVSTC9zdGF0dXMgbWVzc2FnZTogJywgbXNnLmJvZHkudmFsdWUpOw0KICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgICB9KTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAqIFRvIHVucmVnaXN0ZXIgYSBwcmV2aW91c2x5IHJlZ2lzdGVyZWQgcHJvdG9jb2wgc3R1Yg0KICAgICogQHBhcmFtICB7SHlwZXJ0eVJ1bnRpbWVVUkx9ICAgSHlwZXJ0eVJ1bnRpbWVVUkwgICAgIGh5cGVydHlSdW50aW1lVVJMDQogICAgKi8NCg0KICB9LCB7DQogICAga2V5OiAndW5yZWdpc3RlclN0dWInLA0KICAgIHZhbHVlOiBmdW5jdGlvbiB1bnJlZ2lzdGVyU3R1YihoeXBlcnR5UnVudGltZVVSTCkgew0KICAgICAgdmFyIF90aGlzID0gdGhpczsNCiAgICAgIHZhciBydW50aW1lUHJvdG9TdHViVVJMID0gdm9pZCAwOw0KDQogICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgew0KDQogICAgICAgIHZhciBkYXRhID0gX3RoaXMucHJvdG9zdHVic0xpc3RbaHlwZXJ0eVJ1bnRpbWVVUkxdOw0KDQogICAgICAgIGlmIChkYXRhID09PSB1bmRlZmluZWQpIHsNCiAgICAgICAgICByZWplY3QoJ0Vycm9yIG9uIHVucmVnaXN0ZXJTdHViOiBIeXBlcnR5IG5vdCBmb3VuZCcpOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgIGRlbGV0ZSBfdGhpcy5wcm90b3N0dWJzTGlzdFtoeXBlcnR5UnVudGltZVVSTF07DQogICAgICAgICAgcmVzb2x2ZSgnUHJvdG9zdHViVVJMIHJlbW92ZWQnKTsNCiAgICAgICAgfQ0KICAgICAgfSk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICogVG8gcmVnaXN0ZXIgYSBuZXcgSWRlbnRpdHkgUHJvdmlkZXIgcHJveHkgaW4gdGhlIHJ1bnRpbWUgaW5jbHVkaW5nIGFzIGlucHV0IHBhcmFtZXRlcnMgdGhlIGZ1bmN0aW9uIHRvIHBvc3RNZXNzYWdlLCB0aGUgRG9tYWluVVJMIHRoYXQgaXMgY29ubmVjdGVkIHdpdGggdGhlIHN0dWIsIHdoaWNoIHJldHVybnMgdGhlIFJ1bnRpbWVVUkwgYWxsb2NhdGVkIHRvIHRoZSBuZXcgUHJvdG9jb2xTdHViLg0KICAgICAqIEBwYXJhbSB7U2FuZGJveH0gICAgICAgIFNhbmRib3gNCiAgICAgKiBAcGFyYW0gIHtEb21haW5VUkx9ICAgICBEb21haW5VUkwgc2VydmljZSBwcm92aWRlciBkb21haW4NCiAgICAgKiBAcmV0dXJuIHtSdW50aW1lSWRwUHJveHlVUkx9DQogICAgICovDQoNCiAgfSwgew0KICAgIGtleTogJ3JlZ2lzdGVySWRwUHJveHknLA0KICAgIHZhbHVlOiBmdW5jdGlvbiByZWdpc3RlcklkcFByb3h5KHNhbmRib3gsIGRvbWFpblVSTCkgew0KICAgICAgdmFyIF90aGlzID0gdGhpczsNCiAgICAgIHZhciBpZHBQcm94eVN0dWJVUkwgPSB2b2lkIDA7DQoNCiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7DQoNCiAgICAgICAgLy9jaGVjayBpZiBtZXNzYWdlQnVzIGlzIHJlZ2lzdGVyZWQgaW4gcmVnaXN0cnkgb3Igbm90DQogICAgICAgIGlmIChfdGhpcy5fbWVzc2FnZUJ1cyA9PT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgcmVqZWN0KCdNZXNzYWdlQnVzIG5vdCBmb3VuZCBvbiByZWdpc3RlclN0dWInKTsNCiAgICAgICAgfQ0KDQogICAgICAgIGlkcFByb3h5U3R1YlVSTCA9ICdkb21haW4taWRwOi8vJyArIGRvbWFpblVSTCArICcvc3R1Yi8nICsgTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwMDAgKyAxKTsNCg0KICAgICAgICAvLyBUT0RPOiBPcHRpbWl6ZSB0aGlzDQogICAgICAgIF90aGlzLmlkcFByb3h5TGlzdFtkb21haW5VUkxdID0gaWRwUHJveHlTdHViVVJMOw0KICAgICAgICBfdGhpcy5zYW5kYm94ZXNMaXN0LnNhbmRib3hbaWRwUHJveHlTdHViVVJMXSA9IHNhbmRib3g7DQoNCiAgICAgICAgLy8gc2FuZGJveC5hZGRMaXN0ZW5lcignKicsIGZ1bmN0aW9uKG1zZykgew0KICAgICAgICAvLyAgIF90aGlzLl9tZXNzYWdlQnVzLnBvc3RNZXNzYWdlKG1zZyk7DQogICAgICAgIC8vIH0pOw0KDQogICAgICAgIHJlc29sdmUoaWRwUHJveHlTdHViVVJMKTsNCg0KICAgICAgICBfdGhpcy5fbWVzc2FnZUJ1cy5hZGRMaXN0ZW5lcihpZHBQcm94eVN0dWJVUkwgKyAnL3N0YXR1cycsIGZ1bmN0aW9uIChtc2cpIHsNCiAgICAgICAgICBpZiAobXNnLnJlc291cmNlID09PSBtc2cudG8gKyAnL3N0YXR1cycpIHsNCiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdpZHBQcm94eVN0dWJVUkwvc3RhdHVzIG1lc3NhZ2U6ICcsIG1zZy5ib2R5LnZhbHVlKTsNCiAgICAgICAgICB9DQogICAgICAgIH0pOw0KICAgICAgfSk7DQogICAgfQ0KDQogICAgLyoqDQogICAgKiBUbyBkaXNjb3ZlciBpZHBQcm94eSBzdHVicyBhdmFpbGFibGUgaW4gdGhlIHJ1bnRpbWUgZm9yIGEgY2VydGFpbiBkb21haW4uIElmIGF2YWlsYWJsZSwgaXQgcmV0dXJucyB0aGUgcnVudGltZSB1cmwgZm9yIHRoZSBpZHBQcm94eSBzdHViIHRoYXQgY29ubmVjdHMgdG8gdGhlIHJlcXVlc3RlZCBkb21haW4uIFJlcXVpcmVkIGJ5IHRoZSBydW50aW1lIEJVUyB0byByb3V0ZSBtZXNzYWdlcyB0byByZW1vdGUgc2VydmVycyBvciBwZWVycw0KICAgICogQHBhcmFtICB7RG9tYWluVVJMfSAgICAgICAgICAgRG9tYWluVVJMICAgICAgICAgICAgdXJsDQogICAgKiBAcmV0dXJuIHtSdW50aW1lVVJMfSAgICAgICAgICAgUnVudGltZVVSTCAgICAgICAgIGlkcFByb3h5VXJsDQogICAgKi8NCg0KICB9LCB7DQogICAga2V5OiAnZGlzY292ZXJJZHBQcm94eScsDQogICAgdmFsdWU6IGZ1bmN0aW9uIGRpc2NvdmVySWRwUHJveHkodXJsKSB7DQogICAgICBpZiAoIXVybCkgdGhyb3cgbmV3IEVycm9yKCdQYXJhbWV0ZXIgdXJsIG5lZWRlZCcpOw0KICAgICAgdmFyIF90aGlzID0gdGhpczsNCg0KICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsNCg0KICAgICAgICB2YXIgcmVxdWVzdCA9IF90aGlzLmlkcFByb3h5TGlzdFt1cmxdOw0KDQogICAgICAgIGlmIChyZXF1ZXN0ID09PSB1bmRlZmluZWQpIHsNCiAgICAgICAgICByZWplY3QoJ3JlcXVlc3RVcGRhdGUgY291bGRuXCd0IGdldCB0aGUgaWRwUHJveHlVUkwnKTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICByZXNvbHZlKHJlcXVlc3QpOw0KICAgICAgICB9DQogICAgICB9KTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAqIFRvIHJlZ2lzdGVyIGEgbmV3IFBvbGljeSBFbmZvcmNlciBpbiB0aGUgcnVudGltZSBpbmNsdWRpbmcgYXMgaW5wdXQgcGFyYW1ldGVycyB0aGUgZnVuY3Rpb24gdG8gcG9zdE1lc3NhZ2UsIHRoZSBIeXBlcnR5VVJMIGFzc29jaWF0ZWQgd2l0aCB0aGUgUEVQLCB3aGljaCByZXR1cm5zIHRoZSBSdW50aW1lVVJMIGFsbG9jYXRlZCB0byB0aGUgbmV3IFBvbGljeSBFbmZvcmNlciBjb21wb25lbnQuDQogICAgKiBAcGFyYW0gIHtNZXNzYWdlLk1lc3NhZ2V9IHBvc3RNZXNzYWdlIHBvc3RNZXNzYWdlDQogICAgKiBAcGFyYW0gIHtIeXBlcnR5VVJMfSAgICAgICAgICBIeXBlcnR5VVJMICAgICAgICAgICAgaHlwZXJ0eQ0KICAgICogQHJldHVybiB7SHlwZXJ0eVJ1bnRpbWVVUkx9ICAgSHlwZXJ0eVJ1bnRpbWVVUkwNCiAgICAqLw0KDQogIH0sIHsNCiAgICBrZXk6ICdyZWdpc3RlclBFUCcsDQogICAgdmFsdWU6IGZ1bmN0aW9uIHJlZ2lzdGVyUEVQKHBvc3RNZXNzYWdlLCBoeXBlcnR5KSB7DQogICAgICB2YXIgX3RoaXMgPSB0aGlzOw0KDQogICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgew0KICAgICAgICAvL1RPRE8gY2hlY2sgd2hhdCBwYXJhbWV0ZXIgaW4gdGhlIHBvc3RNZXNzYWdlIHRoZSBwZXAgaXMuDQogICAgICAgIF90aGlzLnBlcExpc3RbaHlwZXJ0eV0gPSBwb3N0TWVzc2FnZTsNCiAgICAgICAgcmVzb2x2ZSgnUEVQIHJlZ2lzdGVyZWQgd2l0aCBzdWNjZXNzJyk7DQogICAgICB9KTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAqIFRvIHVucmVnaXN0ZXIgYSBwcmV2aW91c2x5IHJlZ2lzdGVyZWQgcHJvdG9jb2wgc3R1Yg0KICAgICogQHBhcmFtICB7SHlwZXJ0eVJ1bnRpbWVVUkx9ICAgSHlwZXJ0eVJ1bnRpbWVVUkwgICAgIEh5cGVydHlSdW50aW1lVVJMDQogICAgKi8NCg0KICB9LCB7DQogICAga2V5OiAndW5yZWdpc3RlclBFUCcsDQogICAgdmFsdWU6IGZ1bmN0aW9uIHVucmVnaXN0ZXJQRVAoSHlwZXJ0eVJ1bnRpbWVVUkwpIHsNCiAgICAgIHZhciBfdGhpcyA9IHRoaXM7DQoNCiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7DQoNCiAgICAgICAgdmFyIHJlc3VsdCA9IF90aGlzLnBlcExpc3RbSHlwZXJ0eVJ1bnRpbWVVUkxdOw0KDQogICAgICAgIGlmIChyZXN1bHQgPT09IHVuZGVmaW5lZCkgew0KICAgICAgICAgIHJlamVjdCgnUGVwIE5vdCBmb3VuZC4nKTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICByZXNvbHZlKCdQRVAgc3VjY2Vzc2Z1bGx5IHJlbW92ZWQuJyk7DQogICAgICAgIH0NCiAgICAgIH0pOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICogVG8gcmVjZWl2ZSBzdGF0dXMgZXZlbnRzIGZyb20gY29tcG9uZW50cyByZWdpc3RlcmVkIGluIHRoZSBSZWdpc3RyeS4NCiAgICAqIEBwYXJhbSAge01lc3NhZ2UuTWVzc2FnZX0gICAgIE1lc3NhZ2UuTWVzc2FnZSAgICAgICBldmVudA0KICAgICovDQoNCiAgfSwgew0KICAgIGtleTogJ29uRXZlbnQnLA0KICAgIHZhbHVlOiBmdW5jdGlvbiBvbkV2ZW50KGV2ZW50KSB7fQ0KICAgIC8vIFRPRE8gYm9keS4uLg0KDQoNCiAgICAvKioNCiAgICAqIFRvIGRpc2NvdmVyIHNhbmRib3hlcyBhdmFpbGFibGUgaW4gdGhlIHJ1bnRpbWUgZm9yIGEgY2VydGFpbiBkb21haW4uIFJlcXVpcmVkIGJ5IHRoZSBydW50aW1lIFVBIHRvIGF2b2lkIG1vcmUgdGhhbiBvbmUgc2FuZGJveCBmb3IgdGhlIHNhbWUgZG9tYWluLg0KICAgICogQHBhcmFtICB7RG9tYWluVVJMfSBEb21haW5VUkwgdXJsDQogICAgKiBAcmV0dXJuIHtSdW50aW1lU2FuZGJveH0gICAgICAgICAgIFJ1bnRpbWVTYW5kYm94DQogICAgKi8NCg0KICB9LCB7DQogICAga2V5OiAnZ2V0U2FuZGJveCcsDQogICAgdmFsdWU6IGZ1bmN0aW9uIGdldFNhbmRib3godXJsKSB7DQogICAgICBpZiAoIXVybCkgdGhyb3cgbmV3IEVycm9yKCdQYXJhbWV0ZXIgdXJsIG5lZWRlZCcpOw0KICAgICAgY29uc29sZS5sb2coJ2dldFNhbmRib3g6ICcsIHVybCk7DQoNCiAgICAgIHZhciBfdGhpcyA9IHRoaXM7DQogICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgew0KDQogICAgICAgIHZhciByZXF1ZXN0ID0gdm9pZCAwOw0KDQogICAgICAgIC8vZmlyc3QgdHJ5IHRvIGZpbmQgdGhlIHVybCBpbiB0aGUgYXBwU2FuZGJveCBsaXN0DQogICAgICAgIHJlcXVlc3QgPSBfdGhpcy5zYW5kYm94ZXNMaXN0LmFwcFNhbmRib3hbdXJsXTsNCg0KICAgICAgICAvL2lmIG5vIGFwcFNhbmRib3ggd2FzIGZvdW5kLCB0cnkgdG8gc2VhcmNoIGluIHRoZSBub3JtYWwgc2FuZGJveGVzIGxpc3QNCiAgICAgICAgaWYgKCFyZXF1ZXN0KSB7DQogICAgICAgICAgcmVxdWVzdCA9IF90aGlzLnNhbmRib3hlc0xpc3Quc2FuZGJveFt1cmxdOw0KDQogICAgICAgICAgaWYgKCFyZXF1ZXN0KSB7DQoNCiAgICAgICAgICAgIHZhciBkb21haW4gPSAoMCwgX3V0aWxzLmRpdmlkZVVSTCkodXJsKS5kb21haW47DQoNCiAgICAgICAgICAgIC8vIHNlYXJjaCBpbiB0aGUgc2FuZGJveGVzIGxpc3QgZm9yIGEgZW50cnkgY29udGFpbmluZyB0aGUgZG9tYWluIGdpdmVuDQogICAgICAgICAgICBmb3IgKHZhciBzYW5kYm94IGluIF90aGlzLnNhbmRib3hlc0xpc3Quc2FuZGJveCkgew0KICAgICAgICAgICAgICBpZiAoc2FuZGJveC5pbmNsdWRlcyhkb21haW4pKSB7DQogICAgICAgICAgICAgICAgcmVxdWVzdCA9IF90aGlzLnNhbmRib3hlc0xpc3Quc2FuZGJveFtzYW5kYm94XTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIGlmICghcmVxdWVzdCkgew0KICAgICAgICAgIHJlamVjdCgnbm8gc2FuZGJveCBmb3VuZCBmb3I6ICcgKyB1cmwpOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgIHJlc29sdmUocmVxdWVzdCk7DQogICAgICAgIH0NCiAgICAgIH0pOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICogVG8gdmVyaWZ5IGlmIHNvdXJjZSBpcyB2YWxpZCBhbmQgdG8gcmVzb2x2ZSB0YXJnZXQgcnVudGltZSB1cmwgYWRkcmVzcyBpZiBuZWVkZWQgKGVnIHByb3Rvc3R1YiBydW50aW1lIHVybCBpbiBjYXNlIHRoZSBtZXNzYWdlIGlzIHRvIGJlIGRpc3BhdGNoZWQgdG8gYSByZW1vdGUgZW5kcG9pbnQpLg0KICAgICogQHBhcmFtICB7VVJMLlVSTH0gIHVybCAgICAgICB1cmwNCiAgICAqIEByZXR1cm4ge1Byb21pc2U8VVJMLlVSTD59ICAgICAgICAgICAgICAgICBQcm9taXNlIDxVUkwuVVJMPg0KICAgICovDQoNCiAgfSwgew0KICAgIGtleTogJ3Jlc29sdmUnLA0KICAgIHZhbHVlOiBmdW5jdGlvbiByZXNvbHZlKHVybCkgew0KICAgICAgY29uc29sZS5sb2coJ3Jlc29sdmUgJyArIHVybCk7DQogICAgICB2YXIgX3RoaXMgPSB0aGlzOw0KDQogICAgICAvL3NwbGl0IHRoZSB1cmwgdG8gZmluZCB0aGUgZG9tYWluVVJMLiBkZWFscyB3aXRoIHRoZSB1cmwgZm9yIGV4YW1wbGUgYXM6DQogICAgICAvLyJoeXBlcnR5LXJ1bnRpbWU6Ly9zcDEvcHJvdG9zdHViLzEyMyIsDQogICAgICB2YXIgZGl2aWRlZFVSTCA9ICgwLCBfdXRpbHMuZGl2aWRlVVJMKSh1cmwpOw0KICAgICAgdmFyIGRvbWFpblVybCA9IGRpdmlkZWRVUkwuZG9tYWluOw0KICAgICAgdmFyIHR5cGUgPSBkaXZpZGVkVVJMLnR5cGU7DQoNCiAgICAgIC8vIHJlc29sdmUgdGhlIGRvbWFpbiBwcm90b3N0dWIgaW4gY2FzZSBvZiBhIG1lc3NhZ2UgdG8gZ2xvYmFsIHJlZ2lzdHJ5DQogICAgICBpZiAodXJsLmluY2x1ZGVzKCdnbG9iYWw6Ly9yZWdpc3RyeScpKSB7DQogICAgICAgIGRvbWFpblVybCA9IF90aGlzLl9kb21haW47DQogICAgICB9DQoNCiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7DQoNCiAgICAgICAgaWYgKCFkb21haW5VcmwuaW5kZXhPZignbXNnLW5vZGUuJykgfHwgIWRvbWFpblVybC5pbmRleE9mKCdyZWdpc3RyeS4nKSkgew0KICAgICAgICAgIGRvbWFpblVybCA9IGRvbWFpblVybC5zdWJzdHJpbmcoZG9tYWluVXJsLmluZGV4T2YoJy4nKSArIDEpOw0KICAgICAgICB9DQoNCiAgICAgICAgdmFyIHJlcXVlc3QgPSB2b2lkIDA7DQogICAgICAgIGlmICh0eXBlID09PSAnZG9tYWluLWlkcCcpIHsNCiAgICAgICAgICByZXF1ZXN0ID0gX3RoaXMuaWRwUHJveHlMaXN0W2RvbWFpblVybF07DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgcmVxdWVzdCA9IF90aGlzLnByb3Rvc3R1YnNMaXN0W2RvbWFpblVybF07DQogICAgICAgIH0NCg0KICAgICAgICBfdGhpcy5hZGRFdmVudExpc3RlbmVyKCdydW50aW1lOnN0dWJMb2FkZWQnLCBmdW5jdGlvbiAoZG9tYWluVXJsKSB7DQogICAgICAgICAgcmVxdWVzdCA9IF90aGlzLnByb3Rvc3R1YnNMaXN0W2RvbWFpblVybF07DQogICAgICAgICAgY29uc29sZS5pbmZvKCdSZXNvbHZlZCBQcm90b3N0dWI6ICcsIHJlcXVlc3QpOw0KICAgICAgICAgIHJlc29sdmUocmVxdWVzdCk7DQogICAgICAgIH0pOw0KDQogICAgICAgIF90aGlzLmFkZEV2ZW50TGlzdGVuZXIoJ3J1bnRpbWU6aWRwUHJveHlMb2FkZWQnLCBmdW5jdGlvbiAoZG9tYWluVXJsKSB7DQogICAgICAgICAgcmVxdWVzdCA9IF90aGlzLmlkcFByb3h5TGlzdFtkb21haW5VcmxdOw0KICAgICAgICAgIGNvbnNvbGUuaW5mbygnUmVzb2x2ZWQgSURQUHJveHk6ICcsIHJlcXVlc3QpOw0KICAgICAgICAgIHJlc29sdmUocmVxdWVzdCk7DQogICAgICAgIH0pOw0KDQogICAgICAgIGlmIChyZXF1ZXN0ICE9PSB1bmRlZmluZWQpIHsNCiAgICAgICAgICBjb25zb2xlLmluZm8oJ1Jlc29sdmVkOiAnLCByZXF1ZXN0KTsNCiAgICAgICAgICByZXNvbHZlKHJlcXVlc3QpOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgIGlmICh0eXBlID09PSAnZG9tYWluLWlkcCcpIHsNCiAgICAgICAgICAgIF90aGlzLnRyaWdnZXIoJ3J1bnRpbWU6bG9hZElkcFByb3h5JywgZG9tYWluVXJsKTsNCiAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgX3RoaXMudHJpZ2dlcigncnVudGltZTpsb2FkU3R1YicsIGRvbWFpblVybCk7DQogICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICB9KTsNCiAgICB9DQogIH0sIHsNCiAgICBrZXk6ICdtZXNzYWdlQnVzJywNCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsNCiAgICAgIHZhciBfdGhpcyA9IHRoaXM7DQogICAgICByZXR1cm4gX3RoaXMuX21lc3NhZ2VCdXM7DQogICAgfQ0KDQogICAgLyoqDQogICAgKiBTZXQgdGhlIG1lc3NhZ2VCdXMgaW4gdGhpcyBSZWdpc3RyeQ0KICAgICogQHBhcmFtIHtNZXNzYWdlQnVzfSAgICAgICAgICAgbWVzc2FnZUJ1cw0KICAgICovDQogICAgLA0KICAgIHNldDogZnVuY3Rpb24gc2V0KG1lc3NhZ2VCdXMpIHsNCiAgICAgIHZhciBfdGhpcyA9IHRoaXM7DQogICAgICBfdGhpcy5fbWVzc2FnZUJ1cyA9IG1lc3NhZ2VCdXM7DQoNCiAgICAgIF90aGlzLl9tZXNzYWdlQnVzLmFkZExpc3RlbmVyKF90aGlzLnJlZ2lzdHJ5VVJMLCBmdW5jdGlvbiAobXNnKSB7DQoNCiAgICAgICAgdmFyIHVzZXJVcmwgPSBfdGhpcy5fZ2V0SWRlbnRpdHlBc3NvY2lhdGVkKG1zZy5ib2R5LnJlc291cmNlLCBtc2cuZnJvbSk7DQoNCiAgICAgICAgdmFyIHJlcGx5ID0geyBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCB0bzogbXNnLmZyb20sIGZyb206IG1zZy50bywgYm9keTogeyByZXNvdXJjZTogdXNlclVybCB9IH07DQoNCiAgICAgICAgX3RoaXMuX21lc3NhZ2VCdXMucG9zdE1lc3NhZ2UocmVwbHkpOw0KICAgICAgfSk7DQoNCiAgICAgIC8vIGFsc28gc2V0IHVwIG1lc3NhZ2VCdXMgaW4gdGhlIElkZW50aXR5TW9kdWxlIGNvbXBvbmVudA0KICAgICAgLy8gVE9ETyByZWRlZmluZSBhIGJldHRlciB3YXkgdG8gYWRkIHRoZSBtZXNzYWdlQnVzIGluIHRoZSBJZE1vZHVsZQ0KICAgICAgX3RoaXMuaWRNb2R1bGUubWVzc2FnZUJ1cyA9IG1lc3NhZ2VCdXM7DQoNCiAgICAgIC8vIEluc3RhbGwgQWRkcmVzc0FsbG9jYXRpb24NCiAgICAgIHZhciBhZGRyZXNzQWxsb2NhdGlvbiA9IG5ldyBfQWRkcmVzc0FsbG9jYXRpb24yLmRlZmF1bHQoX3RoaXMucmVnaXN0cnlVUkwsIG1lc3NhZ2VCdXMpOw0KICAgICAgX3RoaXMuYWRkcmVzc0FsbG9jYXRpb24gPSBhZGRyZXNzQWxsb2NhdGlvbjsNCg0KICAgICAgLy9JbnN0YWxsIE9iamVjdEFsbG9jYXRpb24NCiAgICAgIHZhciBvYmplY3RBbGxvY2F0aW9uID0gbmV3IF9PYmplY3RBbGxvY2F0aW9uMi5kZWZhdWx0KF90aGlzLnJlZ2lzdHJ5VVJMICsgJy9vYmplY3QtYWxsb2NhdGlvbicsIG1lc3NhZ2VCdXMpOw0KICAgICAgX3RoaXMub2JqZWN0QWxsb2NhdGlvbiA9IG9iamVjdEFsbG9jYXRpb247DQogICAgfQ0KICB9XSk7DQoNCiAgcmV0dXJuIFJlZ2lzdHJ5Ow0KfShfRXZlbnRFbWl0dGVyMy5kZWZhdWx0KTsNCg0KZXhwb3J0cy5kZWZhdWx0ID0gUmVnaXN0cnk7DQp9LHsiLi4vc3luY2hlci9PYmplY3RBbGxvY2F0aW9uIjozMTYsIi4uL3V0aWxzL0V2ZW50RW1pdHRlciI6MzIxLCIuLi91dGlscy91dGlscy5qcyI6MzIyLCIuL0FkZHJlc3NBbGxvY2F0aW9uIjozMTEsIi4vSHlwZXJ0eUluc3RhbmNlIjozMTIsInNlcnZpY2UtZnJhbWV3b3JrL2Rpc3QvTWVzc2FnZUZhY3RvcnkiOjI5OH1dLDMxNDpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQoidXNlIHN0cmljdCI7DQoNCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsNCiAgdmFsdWU6IHRydWUNCn0pOw0KDQp2YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTsNCg0KZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsgfSB9DQoNCi8qKg0KKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YefjbyBlIFNpc3RlbWFzIFNBDQoqIENvcHlyaWdodCAyMDE2IElORVNDLUlEDQoqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTA0KKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVg0KKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0ENCiogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRw0KKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWUNCiogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU4NCioNCiogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7DQoqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4NCiogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0DQoqDQoqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wDQoqDQoqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUNCiogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywNCiogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuDQoqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQNCiogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuDQoqKi8NCi8qKg0KKiAgIEBhdXRob3I6IEdpbCBEaWFzIChnaWwuZGlhc0B0ZWNuaWNvLnVsaXNib2EucHQpDQoqICAgUmVnaXN0cnkgRGF0YSBNb2RlbCBpbmNsdWRlcyBhbGwgT2JqZWN0cyB0byBiZSBoYW5kbGVkIGJ5IHRoZSBSZWdpc3RyeSBmdW5jdGlvbmFsaXR5IGluY2x1ZGluZw0KKi8NCg0KdmFyIFJlZ2lzdHJ5RGF0YU1vZGVsID0gZnVuY3Rpb24gKCkgew0KICBmdW5jdGlvbiBSZWdpc3RyeURhdGFNb2RlbChpZCwgdXJsLCBkZXNjcmlwdG9yVVJMLCBzdGFydGluZ1RpbWUsIGxhc3RNb2RpZmllZCwgc3RhdHVzLCBzdHVicywgc3R1YnNDb25maWd1cmF0aW9uKSB7DQogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFJlZ2lzdHJ5RGF0YU1vZGVsKTsNCg0KICAgIHZhciBfdGhpcyA9IHRoaXM7DQoNCiAgICBfdGhpcy5faWQgPSBpZDsNCiAgICBfdGhpcy5fdXJsID0gdXJsOw0KICAgIF90aGlzLl9kZXNjcmlwdG9yVVJMID0gZGVzY3JpcHRvclVSTDsNCiAgICBfdGhpcy5fc3RhcnRpbmdUaW1lID0gc3RhcnRpbmdUaW1lOw0KICAgIF90aGlzLl9sYXN0TW9kaWZpZWQgPSBsYXN0TW9kaWZpZWQ7DQogICAgX3RoaXMuX3N0YXR1cyA9IHN0YXR1czsNCiAgICBfdGhpcy5fc3R1YnMgPSBzdHViczsNCiAgICBfdGhpcy5fc3R1YnNDb25maWd1cmF0aW9uID0gc3R1YnNDb25maWd1cmF0aW9uOw0KICB9DQoNCiAgX2NyZWF0ZUNsYXNzKFJlZ2lzdHJ5RGF0YU1vZGVsLCBbew0KICAgIGtleTogImlkIiwNCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsNCiAgICAgIHZhciBfdGhpcyA9IHRoaXM7DQogICAgICByZXR1cm4gX3RoaXMuX2lkOw0KICAgIH0NCiAgfSwgew0KICAgIGtleTogInVybCIsDQogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7DQogICAgICB2YXIgX3RoaXMgPSB0aGlzOw0KICAgICAgcmV0dXJuIF90aGlzLl91cmw7DQogICAgfQ0KICB9LCB7DQogICAga2V5OiAiZGVzY3JpcHRvciIsDQogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7DQogICAgICB2YXIgX3RoaXMgPSB0aGlzOw0KICAgICAgcmV0dXJuIF90aGlzLl9kZXNjcmlwdG9yVVJMOw0KICAgIH0NCiAgfV0pOw0KDQogIHJldHVybiBSZWdpc3RyeURhdGFNb2RlbDsNCn0oKTsNCg0KZXhwb3J0cy5kZWZhdWx0ID0gUmVnaXN0cnlEYXRhTW9kZWw7DQp9LHt9XSwzMTU6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KJ3VzZSBzdHJpY3QnOw0KDQpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7DQogIHZhbHVlOiB0cnVlDQp9KTsNCg0KdmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmICgidmFsdWUiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7IC8qKg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHn428gZSBTaXN0ZW1hcyBTQQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSUQNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgQXBpemVlDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqKi8NCg0KLy9NYWluIGRlcGVuZGVjaWVzDQoNCi8vIGltcG9ydCBHcmFwaENvbm5lY3RvciBmcm9tICcuLi9ncmFwaGNvbm5lY3Rvci9HcmFwaENvbm5lY3Rvcic7DQoNCnJlcXVpcmUoJ2JhYmVsLXBvbHlmaWxsJyk7DQoNCnZhciBfUmVnaXN0cnkgPSByZXF1aXJlKCcuLi9yZWdpc3RyeS9SZWdpc3RyeScpOw0KDQp2YXIgX1JlZ2lzdHJ5MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX1JlZ2lzdHJ5KTsNCg0KdmFyIF9JZGVudGl0eU1vZHVsZSA9IHJlcXVpcmUoJy4uL2lkZW50aXR5L0lkZW50aXR5TW9kdWxlJyk7DQoNCnZhciBfSWRlbnRpdHlNb2R1bGUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfSWRlbnRpdHlNb2R1bGUpOw0KDQp2YXIgX1BvbGljeUVuZ2luZSA9IHJlcXVpcmUoJy4uL3BvbGljeS9Qb2xpY3lFbmdpbmUnKTsNCg0KdmFyIF9Qb2xpY3lFbmdpbmUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfUG9saWN5RW5naW5lKTsNCg0KdmFyIF9NZXNzYWdlQnVzID0gcmVxdWlyZSgnLi4vYnVzL01lc3NhZ2VCdXMnKTsNCg0KdmFyIF9NZXNzYWdlQnVzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX01lc3NhZ2VCdXMpOw0KDQp2YXIgX1N5bmNoZXJNYW5hZ2VyID0gcmVxdWlyZSgnLi4vc3luY2hlci9TeW5jaGVyTWFuYWdlcicpOw0KDQp2YXIgX1N5bmNoZXJNYW5hZ2VyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX1N5bmNoZXJNYW5hZ2VyKTsNCg0KdmFyIF91dGlscyA9IHJlcXVpcmUoJy4uL3V0aWxzL3V0aWxzJyk7DQoNCmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9DQoNCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7IH0gfQ0KDQovKioNCiAqIFJ1bnRpbWUgVXNlciBBZ2VudCBJbnRlcmZhY2Ugd2lsbCBwcm9jZXNzIGFsbCB0aGUgZGVwZW5kZWNpZXMgb2YgdGhlIGNvcmUgcnVudGltZTsNCiAqIEBhdXRob3IgVml0b3IgU2lsdmEgW3ZpdG9yLXQtc2lsdmFAdGVsZWNvbS5wdF0NCiAqIEB2ZXJzaW9uIDAuNC4wDQogKg0KICogQHByb3BlcnR5IHtydW50aW1lRmFjdG9yeX0gcnVudGltZUZhY3RvcnkgLSBTcGVjaWZpYyBpbXBsZW1lbnRhdGlvbiBmb3IgYWxsIGVudmlyb25tZW50czsNCiAqIEBwcm9wZXJ0eSB7UnVudGltZUNhdGFsb2d1ZX0gcnVudGltZUNhdGFsb2d1ZSAtIENhdGFsb2d1ZSBvZiBjb21wb25lbnRzIGNhbiBiZSBpbnN0YWxsZWQ7DQogKiBAcHJvcGVydHkge3J1bnRpbWVVUkx9IHJ1bnRpbWVVUkwgLSBUaGlzIGlkZW50aWZ5IHRoZSBjb3JlIHJ1bnRpbWUsIHNob3VsZCBiZSB1bmlxdWU7DQogKiBAcHJvcGVydHkge0lkZW50aXR5TW9kdWxlfSBpZGVudGl0eU1vZHVsZSAtIElkZW50aXR5IE1vZHVsZTsNCiAqIEBwcm9wZXJ0eSB7UG9saWN5RW5naW5lfSBwb2xpY3lFbmdpbmUgLSBQb2xpY3kgRW5naW5lIE1vZHVsZTsNCiAqIEBwcm9wZXJ0eSB7UmVnaXN0cnl9IHJlZ2lzdHJ5IC0gUmVnaXN0cnkgTW9kdWxlOw0KICogQHByb3BlcnR5IHtNZXNzYWdlQnVzfSBtZXNzYWdlQnVzIC0gTWVzc2FnZSBCdXMgaXMgdXNlZCBsaWtlIGEgcm91dGVyIHRvIHJlZGlyZWN0IHRoZSBtZXNzYWdlcyBmcm9tIG9uZSBjb21wb25lbnQgdG8gb3RoZXIocykNCiAqIEBwcm9wZXJ0eSB7R3JhcGhDb25uZWN0b3J9IGdyYXBoQ29ubmVjdG9yIC0gR3JhcGggQ29ubmVjdG9yIGhhbmRsaW5nIEdVSUQgYW5kIGNvbnRhY3RzDQogKi8NCg0KdmFyIFJ1bnRpbWVVQSA9IGZ1bmN0aW9uICgpIHsNCg0KICAvKioNCiAgICogQ3JlYXRlIGEgbmV3IGluc3RhbmNlIG9mIFJ1bnRpbWUgVXNlciBBZ2VudA0KICAgKiBAcGFyYW0ge3J1bnRpbWVGYWN0b3J5fSBydW50aW1lRmFjdG9yeSAtIFNwZWNpZmljIGltcGxlbWVudGF0aW9uIGZvciB0aGUgZW52aXJvbm1lbnQgd2hlcmUgdGhlIGNvcmUgcnVudGltZSB3aWxsIHJ1bjsNCiAgICogQHBhcmFtIHtkb21haW59IGRvbWFpblVSTCAtIHNwZWNpZnkgdGhlIGRvbWFpbiBiYXNlIGZvciB0aGUgcnVudGltZTsNCiAgICovDQoNCiAgZnVuY3Rpb24gUnVudGltZVVBKHJ1bnRpbWVGYWN0b3J5LCBkb21haW4pIHsNCiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgUnVudGltZVVBKTsNCg0KICAgIGlmICghcnVudGltZUZhY3RvcnkpIHRocm93IG5ldyBFcnJvcignVGhlIHNhbmRib3ggZmFjdG9yeSBpcyBhIG5lZWRlZCBwYXJhbWV0ZXInKTsNCiAgICBpZiAoIWRvbWFpbikgdGhyb3cgbmV3IEVycm9yKCdZb3UgbmVlZCB0aGUgZG9tYWluIG9mIHJ1bnRpbWUnKTsNCg0KICAgIHZhciBfdGhpcyA9IHRoaXM7DQoNCiAgICBfdGhpcy5ydW50aW1lRmFjdG9yeSA9IHJ1bnRpbWVGYWN0b3J5Ow0KICAgIF90aGlzLnJ1bnRpbWVDYXRhbG9ndWUgPSBydW50aW1lRmFjdG9yeS5jcmVhdGVSdW50aW1lQ2F0YWxvZ3VlKCk7DQoNCiAgICAvLyBUT0RPOiBwb3N0IGFuZCByZXR1cm4gcmVnaXN0cnkvaHlwZXJ0eVJ1bnRpbWVJbnN0YW5jZSB0byBhbmQgZnJvbSBCYWNrLWVuZCBTZXJ2aWNlDQogICAgLy8gdGhlIHJlc3BvbnNlIGlzIGxpa2U6IHJ1bnRpbWU6Ly9zcDEvMTIzDQoNCiAgICB2YXIgcnVudGltZVVSTCA9ICdydW50aW1lOi8vJyArIGRvbWFpbiArICcvJyArIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMDAwICsgMSk7DQogICAgX3RoaXMucnVudGltZVVSTCA9IHJ1bnRpbWVVUkw7DQogICAgX3RoaXMuZG9tYWluID0gZG9tYWluOw0KDQogICAgLy8gVE9ETzogY2hlY2sgaWYgcnVudGltZSBjYXRhbG9ndWUgbmVlZCB0aGUgcnVudGltZVVSTDsNCiAgICBfdGhpcy5ydW50aW1lQ2F0YWxvZ3VlLnJ1bnRpbWVVUkwgPSBydW50aW1lVVJMOw0KDQogICAgLy8gSW5zdGFudGlhdGUgdGhlIGlkZW50aXR5IE1vZHVsZQ0KICAgIF90aGlzLmlkZW50aXR5TW9kdWxlID0gbmV3IF9JZGVudGl0eU1vZHVsZTIuZGVmYXVsdChydW50aW1lVVJMKTsNCg0KICAgIC8vIFVzZSB0aGUgc2FuZGJveCBmYWN0b3J5IHRvIGNyZWF0ZSBhbiBBcHBTYW5kYm94Ow0KICAgIC8vIEluIHRoZSBmdXR1cmUgY2FuIGJlIGRlY2lkZWQgYnkgcG9saWN5RW5naW5lIGlmIHdlIG5lZWQNCiAgICAvLyBjcmVhdGUgYSBBcHBTYW5kYm94IG9yIG5vdDsNCiAgICB2YXIgYXBwU2FuZGJveCA9IHJ1bnRpbWVGYWN0b3J5LmNyZWF0ZUFwcFNhbmRib3goKTsNCg0KICAgIC8vIEluc3RhbnRpYXRlIHRoZSBSZWdpc3RyeSBNb2R1bGUNCiAgICBfdGhpcy5yZWdpc3RyeSA9IG5ldyBfUmVnaXN0cnkyLmRlZmF1bHQocnVudGltZVVSTCwgYXBwU2FuZGJveCwgX3RoaXMuaWRlbnRpdHlNb2R1bGUsIF90aGlzLnJ1bnRpbWVDYXRhbG9ndWUpOw0KDQogICAgLy8gSW5zdGFudGlhdGUgdGhlIE1lc3NhZ2UgQnVzDQogICAgX3RoaXMubWVzc2FnZUJ1cyA9IG5ldyBfTWVzc2FnZUJ1czIuZGVmYXVsdChfdGhpcy5yZWdpc3RyeSk7DQoNCiAgICAvLyBJbnN0YW50aWF0ZSB0aGUgUG9saWN5IEVuZ2luZQ0KICAgIF90aGlzLnBvbGljeUVuZ2luZSA9IG5ldyBfUG9saWN5RW5naW5lMi5kZWZhdWx0KF90aGlzLmlkZW50aXR5TW9kdWxlLCBfdGhpcy5yZWdpc3RyeSk7DQoNCiAgICBfdGhpcy5tZXNzYWdlQnVzLnBpcGVsaW5lLmhhbmRsZXJzID0gWw0KDQogICAgLy8gUG9saWN5IG1lc3NhZ2UgYXV0aG9yaXNlDQogICAgZnVuY3Rpb24gKGN0eCkgew0KICAgICAgX3RoaXMucG9saWN5RW5naW5lLmF1dGhvcmlzZShjdHgubXNnKS50aGVuKGZ1bmN0aW9uIChjaGFuZ2VkTWdzKSB7DQogICAgICAgIGN0eC5tc2cgPSBjaGFuZ2VkTWdzOw0KICAgICAgICBjdHgubmV4dCgpOw0KICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKHJlYXNvbikgew0KICAgICAgICBjb25zb2xlLmVycm9yKHJlYXNvbik7DQogICAgICAgIGN0eC5mYWlsKHJlYXNvbik7DQogICAgICB9KTsNCiAgICB9XTsNCg0KICAgIC8vIEFkZCB0byBBcHAgU2FuZGJveCB0aGUgbGlzdGVuZXI7DQogICAgYXBwU2FuZGJveC5hZGRMaXN0ZW5lcignKicsIGZ1bmN0aW9uIChtc2cpIHsNCiAgICAgIF90aGlzLm1lc3NhZ2VCdXMucG9zdE1lc3NhZ2UobXNnKTsNCiAgICB9KTsNCg0KICAgIC8vIFJlZ2lzdGVyIG1lc3NhZ2VCdXMgb24gUmVnaXN0cnkNCiAgICBfdGhpcy5yZWdpc3RyeS5tZXNzYWdlQnVzID0gX3RoaXMubWVzc2FnZUJ1czsNCg0KICAgIF90aGlzLnJlZ2lzdHJ5LmFkZEV2ZW50TGlzdGVuZXIoJ3J1bnRpbWU6bG9hZFN0dWInLCBmdW5jdGlvbiAoZG9tYWluVVJMKSB7DQogICAgICBfdGhpcy5sb2FkU3R1Yihkb21haW5VUkwpLnRoZW4oZnVuY3Rpb24gKCkgew0KICAgICAgICBfdGhpcy5yZWdpc3RyeS50cmlnZ2VyKCdydW50aW1lOnN0dWJMb2FkZWQnLCBkb21haW5VUkwpOw0KICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKHJlYXNvbikgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gZGVwbG95IHRoZSBQcm90b2NvbFN0dWIgY29tcG9uZW50ICcsIHJlYXNvbik7DQogICAgICB9KTsNCiAgICB9KTsNCg0KICAgIF90aGlzLnJlZ2lzdHJ5LmFkZEV2ZW50TGlzdGVuZXIoJ3J1bnRpbWU6bG9hZElkcFByb3h5JywgZnVuY3Rpb24gKGRvbWFpblVSTCkgew0KICAgICAgX3RoaXMubG9hZElkcFByb3h5KGRvbWFpblVSTCkudGhlbihmdW5jdGlvbiAoKSB7DQogICAgICAgIF90aGlzLnJlZ2lzdHJ5LnRyaWdnZXIoJ3J1bnRpbWU6aWRwUHJveHlMb2FkZWQnLCBkb21haW5VUkwpOw0KICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKHJlYXNvbikgew0KICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gZGVwbG95IHRoZSBJRFAgUHJveHkgY29tcG9uZW50ICcsIHJlYXNvbik7DQogICAgICB9KTsNCiAgICB9KTsNCg0KICAgIC8vIFVzZSBzYW5kYm94IGZhY3RvcnkgdG8gdXNlIHNwZWNpZmljIG1ldGhvZHMNCiAgICAvLyBhbmQgc2V0IHRoZSBtZXNzYWdlIGJ1cyB0byB0aGUgZmFjdG9yeQ0KICAgIHJ1bnRpbWVGYWN0b3J5Lm1lc3NhZ2VCdXMgPSBfdGhpcy5tZXNzYWdlQnVzOw0KDQogICAgLy8gSW5zdGFuY2lhdGUgdGhlIFN5bmNoZXJNYW5hZ2VyOw0KICAgIF90aGlzLnN5bmNoZXJNYW5hZ2VyID0gbmV3IF9TeW5jaGVyTWFuYWdlcjIuZGVmYXVsdChfdGhpcy5ydW50aW1lVVJMLCBfdGhpcy5tZXNzYWdlQnVzLCBfdGhpcy5yZWdpc3RyeSwgX3RoaXMucnVudGltZUNhdGFsb2d1ZSk7DQoNCiAgICAvLyBJbnN0YW50aWF0ZSB0aGUgR3JhcGggQ29ubmVjdG9yDQogICAgLy9fdGhpcy5ncmFwaENvbm5lY3RvciA9IG5ldyBHcmFwaENvbm5lY3RvcihfdGhpcy5ydW50aW1lVVJMLCBfdGhpcy5tZXNzYWdlQnVzKTsNCiAgfQ0KDQogIC8qKg0KICAqIEFjY29tb2RhdGUgaW50ZXJvcGVyYWJpbGl0eSBpbiBIMkggYW5kIHByb3RvIG9uIHRoZSBmbHkgZm9yIG5ld2x5IGRpc2NvdmVyZWQgZGV2aWNlcyBpbiBNMk0NCiAgKiBAcGFyYW0gIHtDYXRhbG9ndWVEYXRhT2JqZWN0Lkh5cGVydHlEZXNjcmlwdG9yfSAgIGRlc2NyaXB0b3IgICAgZGVzY3JpcHRvcg0KICAqLw0KDQoNCiAgX2NyZWF0ZUNsYXNzKFJ1bnRpbWVVQSwgW3sNCiAgICBrZXk6ICdkaXNjb3ZlckhpcGVydHknLA0KICAgIHZhbHVlOiBmdW5jdGlvbiBkaXNjb3ZlckhpcGVydHkoZGVzY3JpcHRvcikge30NCiAgICAvLyBCb2R5Li4uDQoNCg0KICAgIC8qKg0KICAgICogUmVnaXN0ZXIgSHlwZXJ0eSBkZXBsb3llZCBieSB0aGUgQXBwIHRoYXQgaXMgcGFzc2VkIGFzIGlucHV0IHBhcmFtZXRlci4gVG8gYmUgdXNlZCB3aGVuIEFwcCBhbmQgSHlwZXJ0aWVzIGFyZSBmcm9tIHRoZSBzYW1lIGRvbWFpbiBvdGhlcndpc2UgdGhlIFJ1bnRpbWVVQSB3aWxsIHJhaXNlIGFuIGV4Y2VwdGlvbiBhbmQgdGhlIEFwcCBoYXMgdG8gdXNlIHRoZSBsb2FkSHlwZXJ0eSguLikgZnVuY3Rpb24uDQogICAgKiBAcGFyYW0gIHtPYmplY3R9IE9iamVjdCAgICAgICAgICAgICAgICAgICBoeXBlcnR5SW5zdGFuY2UNCiAgICAqIEBwYXJhbSAge1VSTC5IeXBlcnR5Q2F0YWxvZ3VlVVJMfSAgICAgICAgIGRlc2NyaXB0b3IgICAgICBkZXNjcmlwdG9yDQogICAgKi8NCg0KICB9LCB7DQogICAga2V5OiAncmVnaXN0ZXJIeXBlcnR5JywNCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVnaXN0ZXJIeXBlcnR5KGh5cGVydHlJbnN0YW5jZSwgZGVzY3JpcHRvcikge30NCiAgICAvLyBCb2R5Li4uDQoNCg0KICAgIC8qKg0KICAgICogRGVwbG95IEh5cGVydHkgZnJvbSBDYXRhbG9ndWUgVVJMDQogICAgKiBAcGFyYW0gIHtVUkwuSHlwZXJ0eUNhdGFsb2d1ZVVSTH0gICAgaHlwZXJ0eSBoeXBlcnR5RGVzY3JpcHRvciB1cmw7DQogICAgKi8NCg0KICB9LCB7DQogICAga2V5OiAnbG9hZEh5cGVydHknLA0KICAgIHZhbHVlOiBmdW5jdGlvbiBsb2FkSHlwZXJ0eShoeXBlcnR5RGVzY3JpcHRvclVSTCkgew0KDQogICAgICB2YXIgX3RoaXMgPSB0aGlzOw0KDQogICAgICBpZiAoIWh5cGVydHlEZXNjcmlwdG9yVVJMKSB0aHJvdyBuZXcgRXJyb3IoJ0h5cGVydHkgZGVzY3JpcHRvciB1cmwgcGFyYW1ldGVyIGlzIG5lZWRlZCcpOw0KDQogICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgew0KDQogICAgICAgIHZhciBfaHlwZXJ0eVVSTCA9IHZvaWQgMDsNCiAgICAgICAgdmFyIF9oeXBlcnR5U2FuZGJveCA9IHZvaWQgMDsNCiAgICAgICAgdmFyIF9oeXBlcnR5RGVzY3JpcHRvciA9IHZvaWQgMDsNCiAgICAgICAgdmFyIF9oeXBlcnR5U291cmNlUGFja2FnZSA9IHZvaWQgMDsNCg0KICAgICAgICB2YXIgZXJyb3JSZWFzb24gPSBmdW5jdGlvbiBlcnJvclJlYXNvbihyZWFzb24pIHsNCiAgICAgICAgICBjb25zb2xlLmVycm9yKCdTb21ldGhpbmcgZmFpbGVkIG9uIHRoZSBkZXBsb3kgaHlwZXJ0eTogJywgcmVhc29uKTsNCiAgICAgICAgICByZWplY3QocmVhc29uKTsNCiAgICAgICAgfTsNCg0KICAgICAgICAvLyBHZXQgSHlwZXJ0eSBkZXNjcmlwdG9yDQogICAgICAgIC8vIFRPRE86IHRoZSByZXF1ZXN0IE1vZHVsZSBzaG91bGQgYmUgY2hhbmdlZCwNCiAgICAgICAgLy8gYmVjYXVzZSBhdCB0aGlzIG1vbWVudCBpdCBpcyBpbmNvbXBhdGlibGUgd2l0aCBub2RlanM7DQogICAgICAgIC8vIFByb2JhYmx5IHdlIG5lZWQgdG8gcGFzcyBhIGZhY3RvcnkgbGlrZSB3ZSBkbyBmb3Igc2FuZGJveGVzOw0KICAgICAgICBjb25zb2xlLmluZm8oJy0tLS0tLS0tLS0tLS0tLS0tLSBIeXBlcnR5IC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLScpOw0KICAgICAgICBjb25zb2xlLmluZm8oJ0dldCBoeXBlcnR5IGRlc2NyaXB0b3IgZm9yIDonLCBoeXBlcnR5RGVzY3JpcHRvclVSTCk7DQogICAgICAgIHJldHVybiBfdGhpcy5ydW50aW1lQ2F0YWxvZ3VlLmdldEh5cGVydHlEZXNjcmlwdG9yKGh5cGVydHlEZXNjcmlwdG9yVVJMKS50aGVuKGZ1bmN0aW9uIChoeXBlcnR5RGVzY3JpcHRvcikgew0KICAgICAgICAgIC8vIGF0IHRoaXMgcG9pbnQsIHdlIGhhdmUgY29tcGxldGVkICJzdGVwIDIgYW5kIDMiIGFzIHNob3duIGluIGh0dHBzOi8vZ2l0aHViLmNvbS9yZVRISU5LLXByb2plY3QvY29yZS1mcmFtZXdvcmsvYmxvYi9tYXN0ZXIvZG9jcy9zcGVjcy9ydW50aW1lL2R5bmFtaWMtdmlldy9iYXNpY3MvZGVwbG95LWh5cGVydHkubWQNCiAgICAgICAgICBjb25zb2xlLmluZm8oJzE6IHJldHVybiBoeXBlcnR5IGRlc2NyaXB0b3InLCBoeXBlcnR5RGVzY3JpcHRvcik7DQoNCiAgICAgICAgICAvLyBoeXBlcnR5IGNvbnRhaW5zIHRoZSBmdWxsIHBhdGggb2YgdGhlIGNhdGFsb2d1ZSBVUkwsIGUuZy4NCiAgICAgICAgICAvLyBjYXRhbG9ndWUucmV0aGluay5ldS8ud2VsbC1rbm93bi8uLi4uLi4uLi4uDQogICAgICAgICAgX2h5cGVydHlEZXNjcmlwdG9yID0gaHlwZXJ0eURlc2NyaXB0b3I7DQoNCiAgICAgICAgICB2YXIgc291cmNlUGFja2FnZVVSTCA9IGh5cGVydHlEZXNjcmlwdG9yLnNvdXJjZVBhY2thZ2VVUkw7DQoNCiAgICAgICAgICBpZiAoc291cmNlUGFja2FnZVVSTCA9PT0gJy9zb3VyY2VQYWNrYWdlJykgew0KICAgICAgICAgICAgcmV0dXJuIGh5cGVydHlEZXNjcmlwdG9yLnNvdXJjZVBhY2thZ2U7DQogICAgICAgICAgfQ0KDQogICAgICAgICAgLy8gR2V0IHRoZSBoeXBlcnR5IHNvdXJjZSBjb2RlDQogICAgICAgICAgcmV0dXJuIF90aGlzLnJ1bnRpbWVDYXRhbG9ndWUuZ2V0U291cmNlUGFja2FnZUZyb21VUkwoc291cmNlUGFja2FnZVVSTCk7DQogICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHNvdXJjZVBhY2thZ2UpIHsNCiAgICAgICAgICBjb25zb2xlLmluZm8oJzI6IHJldHVybiBoeXBlcnR5IHNvdXJjZSBjb2RlJyk7DQoNCiAgICAgICAgICAvLyBhdCB0aGlzIHBvaW50LCB3ZSBoYXZlIGNvbXBsZXRlZCAic3RlcCA0IGFuZCA1IiBhcyBzaG93biBpbiBodHRwczovL2dpdGh1Yi5jb20vcmVUSElOSy1wcm9qZWN0L2NvcmUtZnJhbWV3b3JrL2Jsb2IvbWFzdGVyL2RvY3Mvc3BlY3MvcnVudGltZS9keW5hbWljLXZpZXcvYmFzaWNzL2RlcGxveS1oeXBlcnR5Lm1kDQoNCiAgICAgICAgICBfaHlwZXJ0eVNvdXJjZVBhY2thZ2UgPSBzb3VyY2VQYWNrYWdlOw0KDQogICAgICAgICAgLy8NCiAgICAgICAgICAvLyBzdGVwcyA2IC0tIDkgYXJlIHNraXBwZWQuDQogICAgICAgICAgLy8gVE9ETzogb24gcmVsZWFzZSBvZiBjb3JlIDAuMjsNCiAgICAgICAgICAvLyBUT0RPOiBQcm9taXNlIHRvIGNoZWNrIHRoZSBwb2xpY3kgZW5naW5lDQoNCiAgICAgICAgICAvLyBtb2NrLXVwIGNvZGU7DQogICAgICAgICAgLy8gdGVtcG9yYXJ5IGNvZGUsIG9ubHkNCiAgICAgICAgICB2YXIgcG9saWN5ID0gdHJ1ZTsNCg0KICAgICAgICAgIHJldHVybiBwb2xpY3k7DQogICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHBvbGljeVJlc3VsdCkgew0KICAgICAgICAgIGNvbnNvbGUuaW5mbygnMzogcmV0dXJuIHBvbGljeSBlbmdpbmUgcmVzdWx0OiAnLCBwb2xpY3lSZXN1bHQpOw0KDQogICAgICAgICAgLy8gd2UgaGF2ZSBjb21wbGV0ZWQgc3RlcCA2IHRvIDkgb2YgaHR0cHM6Ly9naXRodWIuY29tL3JlVEhJTkstcHJvamVjdC9jb3JlLWZyYW1ld29yay9ibG9iL21hc3Rlci9kb2NzL3NwZWNzL3J1bnRpbWUvZHluYW1pYy12aWV3L2Jhc2ljcy9kZXBsb3ktaHlwZXJ0eS5tZCByaWdodCBub3cuDQogICAgICAgICAgLy8NCiAgICAgICAgICAvLyBTdGVwcyA2IC0tIDkNCiAgICAgICAgICAvLyBBcyBhIHJlc3VsdCBvZiB0aGUgc2lwcGVkIHN0ZXBzLCB3ZSBrbm93IGF0IHRoaXMgcG9pbnQgaWYgd2UgZXhlY3V0ZQ0KICAgICAgICAgIC8vIGluU2FtZVNhbmRib3ggb3Igbm90Lg0KICAgICAgICAgIC8vDQoNCiAgICAgICAgICAvLyBGb3IgdGVzdGluZywganVzdCBhc3N1bWUgd2UgZXhlY3V0ZSBpbiBzYW1lIFNhbmRib3guDQogICAgICAgICAgdmFyIGluU2FtZVNhbmRib3ggPSB0cnVlOw0KICAgICAgICAgIHZhciBzYW5kYm94ID0gdm9pZCAwOw0KDQogICAgICAgICAgaWYgKGluU2FtZVNhbmRib3gpIHsNCg0KICAgICAgICAgICAgLy8gdGhpcyBkb24ndCBuZWVkIGJlIGEgUHJvbWlzZTsNCiAgICAgICAgICAgIHNhbmRib3ggPSBfdGhpcy5yZWdpc3RyeS5nZXRBcHBTYW5kYm94KCk7DQoNCiAgICAgICAgICAgIC8vIHdlIGhhdmUgY29tcGxldGVkIHN0ZXAgMTEgaGVyZS4NCiAgICAgICAgICB9IGVsc2Ugew0KDQogICAgICAgICAgICAgIHZhciBkb21haW4gPSAoMCwgX3V0aWxzLmRpdmlkZVVSTCkoaHlwZXJ0eURlc2NyaXB0b3JVUkwpLmRvbWFpbjsNCg0KICAgICAgICAgICAgICAvLyBnZXRTYW5kYm94LCB0aGlzIHdpbGwgcmV0dXJuIGEgcHJvbWlzZTsNCiAgICAgICAgICAgICAgc2FuZGJveCA9IF90aGlzLnJlZ2lzdHJ5LmdldFNhbmRib3goZG9tYWluKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgIC8vIHRoaXMgd2lsbCByZXR1cm4gdGhlIHNhbmRib3ggb3Igb25lIHByb21pc2UgdG8gZ2V0U2FuZGJveDsNCiAgICAgICAgICByZXR1cm4gc2FuZGJveDsNCiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAoc2FuZGJveCkgew0KICAgICAgICAgIGNvbnNvbGUuaW5mbygnNDogcmV0dXJuIHRoZSBzYW5kYm94Jywgc2FuZGJveCk7DQoNCiAgICAgICAgICAvLyBSZXR1cm4gdGhlIHNhbmRib3ggaW5kZXBlbnRlbHkgaWYgaXQgcnVubmluZyBpbiB0aGUgc2FtZSBzYW5kYm94IG9yIG5vdA0KICAgICAgICAgIC8vIHdlIGhhdmUgY29tcGxldGVkIHN0ZXAgMTQgaGVyZS4NCiAgICAgICAgICByZXR1cm4gc2FuZGJveDsNCiAgICAgICAgfSwgZnVuY3Rpb24gKHJlYXNvbikgew0KICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJzQuMTogVHJ5IHRvIHJlZ2lzdGVyIGEgbmV3IHNhbmRib3ggJywgcmVhc29uKTsNCg0KICAgICAgICAgIC8vIGNoZWNrIGlmIHRoZSBzYW5kYm94IGlzIHJlZ2lzdGVkIGZvciB0aGlzIGh5cGVydHkgZGVzY3JpcHRvciB1cmw7DQogICAgICAgICAgLy8gTWFrZSBTdGVwcyB4eHggLS0tIHh4eA0KICAgICAgICAgIC8vIEluc3RhbnRpYXRlIHRoZSBTYW5kYm94DQogICAgICAgICAgdmFyIHNhbmRib3ggPSBfdGhpcy5ydW50aW1lRmFjdG9yeS5jcmVhdGVTYW5kYm94KCk7DQoNCiAgICAgICAgICBzYW5kYm94LmFkZExpc3RlbmVyKCcqJywgZnVuY3Rpb24gKG1zZykgew0KICAgICAgICAgICAgX3RoaXMubWVzc2FnZUJ1cy5wb3N0TWVzc2FnZShtc2cpOw0KICAgICAgICAgIH0pOw0KDQogICAgICAgICAgcmV0dXJuIHNhbmRib3g7DQogICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHNhbmRib3gpIHsNCiAgICAgICAgICBjb25zb2xlLmluZm8oJzU6IHJldHVybiBzYW5kYm94IGFuZCByZWdpc3RlcicpOw0KDQogICAgICAgICAgX2h5cGVydHlTYW5kYm94ID0gc2FuZGJveDsNCg0KICAgICAgICAgIC8vIFJlZ2lzdGVyIGh5cGVydHkNCiAgICAgICAgICByZXR1cm4gX3RoaXMucmVnaXN0cnkucmVnaXN0ZXJIeXBlcnR5KHNhbmRib3gsIGh5cGVydHlEZXNjcmlwdG9yVVJMLCBfaHlwZXJ0eURlc2NyaXB0b3IpOw0KICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChoeXBlcnR5VVJMKSB7DQogICAgICAgICAgY29uc29sZS5pbmZvKCc2OiBIeXBlcnR5IHVybCwgYWZ0ZXIgcmVnaXN0ZXIgaHlwZXJ0eScsIGh5cGVydHlVUkwpOw0KDQogICAgICAgICAgLy8gd2UgaGF2ZSBjb21wbGV0ZWQgc3RlcCAxNiBvZiBodHRwczovL2dpdGh1Yi5jb20vcmVUSElOSy1wcm9qZWN0L2NvcmUtZnJhbWV3b3JrL2Jsb2IvbWFzdGVyL2RvY3Mvc3BlY3MvcnVudGltZS9keW5hbWljLXZpZXcvYmFzaWNzL2RlcGxveS1oeXBlcnR5Lm1kIHJpZ2h0IG5vdy4NCiAgICAgICAgICBfaHlwZXJ0eVVSTCA9IGh5cGVydHlVUkw7DQoNCiAgICAgICAgICAvLyBFeHRlbmQgb3JpZ2luYWwgaHlwZXJ0eSBjb25maWd1cmF0aW9uOw0KICAgICAgICAgIHZhciBjb25maWd1cmF0aW9uID0ge307DQogICAgICAgICAgaWYgKCEoMCwgX3V0aWxzLmVtcHR5T2JqZWN0KShfaHlwZXJ0eURlc2NyaXB0b3IuY29uZmlndXJhdGlvbikpIHsNCiAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgIGNvbmZpZ3VyYXRpb24gPSBPYmplY3QuYXNzaWduKHt9LCBKU09OLnBhcnNlKF9oeXBlcnR5RGVzY3JpcHRvci5jb25maWd1cmF0aW9uKSk7DQogICAgICAgICAgICB9IGNhdGNoIChlKSB7DQogICAgICAgICAgICAgIGNvbmZpZ3VyYXRpb24gPSBfaHlwZXJ0eURlc2NyaXB0b3IuY29uZmlndXJhdGlvbjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICB9DQogICAgICAgICAgY29uZmlndXJhdGlvbi5ydW50aW1lVVJMID0gX3RoaXMucnVudGltZVVSTDsNCg0KICAgICAgICAgIC8vIFdlIHdpbGwgZGVwbG95IHRoZSBjb21wb25lbnQgLSBzdGVwIDE3IG9mIGh0dHBzOi8vZ2l0aHViLmNvbS9yZVRISU5LLXByb2plY3QvY29yZS1mcmFtZXdvcmsvYmxvYi9tYXN0ZXIvZG9jcy9zcGVjcy9ydW50aW1lL2R5bmFtaWMtdmlldy9iYXNpY3MvZGVwbG95LWh5cGVydHkubWQgcmlnaHQgbm93Lg0KICAgICAgICAgIHJldHVybiBfaHlwZXJ0eVNhbmRib3guZGVwbG95Q29tcG9uZW50KF9oeXBlcnR5U291cmNlUGFja2FnZS5zb3VyY2VDb2RlLCBfaHlwZXJ0eVVSTCwgY29uZmlndXJhdGlvbik7DQogICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKGRlcGxveUNvbXBvbmVudFN0YXR1cykgew0KICAgICAgICAgIGNvbnNvbGUuaW5mbygnNzogRGVwbG95IGNvbXBvbmVudCBzdGF0dXMgZm9yIGh5cGVydHk6ICcsIGRlcGxveUNvbXBvbmVudFN0YXR1cyk7DQoNCiAgICAgICAgICAvLyB3ZSBoYXZlIGNvbXBsZXRlZCBzdGVwIDE5IGh0dHBzOi8vZ2l0aHViLmNvbS9yZVRISU5LLXByb2plY3QvY29yZS1mcmFtZXdvcmsvYmxvYi9tYXN0ZXIvZG9jcy9zcGVjcy9ydW50aW1lL2R5bmFtaWMtdmlldy9iYXNpY3MvZGVwbG95LWh5cGVydHkubWQgcmlnaHQgbm93Lg0KDQogICAgICAgICAgLy8gQWRkIHRoZSBtZXNzYWdlIGJ1cyBsaXN0ZW5lciB0byB0aGUgYXBwU2FuZGJveCBvciBoeXBlcnRTYW5kYm94Ow0KICAgICAgICAgIF90aGlzLm1lc3NhZ2VCdXMuYWRkTGlzdGVuZXIoX2h5cGVydHlVUkwsIGZ1bmN0aW9uIChtc2cpIHsNCiAgICAgICAgICAgIF9oeXBlcnR5U2FuZGJveC5wb3N0TWVzc2FnZShtc2cpOw0KICAgICAgICAgIH0pOw0KDQogICAgICAgICAgLy8gd2UgaGF2ZSBjb21wbGV0ZWQgc3RlcCAyMCBvZiBodHRwczovL2dpdGh1Yi5jb20vcmVUSElOSy1wcm9qZWN0L2NvcmUtZnJhbWV3b3JrL2Jsb2IvbWFzdGVyL2RvY3Mvc3BlY3MvcnVudGltZS9keW5hbWljLXZpZXcvYmFzaWNzL2RlcGxveS1oeXBlcnR5Lm1kIHJpZ2h0IG5vdy4NCiAgICAgICAgICB2YXIgaHlwZXJ0eSA9IHsNCiAgICAgICAgICAgIHJ1bnRpbWVIeXBlcnR5VVJMOiBfaHlwZXJ0eVVSTCwNCiAgICAgICAgICAgIHN0YXR1czogZGVwbG95Q29tcG9uZW50U3RhdHVzDQogICAgICAgICAgfTsNCg0KICAgICAgICAgIHJlc29sdmUoaHlwZXJ0eSk7DQoNCiAgICAgICAgICAvLyB3ZSBoYXZlIGNvbXBsZXRlZCBzdGVwIDIxIGh0dHBzOi8vZ2l0aHViLmNvbS9yZVRISU5LLXByb2plY3QvY29yZS1mcmFtZXdvcmsvYmxvYi9tYXN0ZXIvZG9jcy9zcGVjcy9ydW50aW1lL2R5bmFtaWMtdmlldy9iYXNpY3MvZGVwbG95LWh5cGVydHkubWQgcmlnaHQgbm93Lg0KICAgICAgICAgIGNvbnNvbGUubG9nKCctLS0tLS0tLS0tLS0tLS0tLS0gRU5EIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLScpOw0KICAgICAgICB9KS5jYXRjaChlcnJvclJlYXNvbik7DQogICAgICB9KTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAqIERlcGxveSBTdHViIGZyb20gQ2F0YWxvZ3VlIFVSTCBvciBkb21haW4gdXJsDQogICAgKiBAcGFyYW0gIHtVUkwuVVJMfSAgICAgZG9tYWluICAgICAgICAgIGRvbWFpbg0KICAgICovDQoNCiAgfSwgew0KICAgIGtleTogJ2xvYWRTdHViJywNCiAgICB2YWx1ZTogZnVuY3Rpb24gbG9hZFN0dWIocHJvdG9zdHViVVJMKSB7DQoNCiAgICAgIHZhciBfdGhpcyA9IHRoaXM7DQoNCiAgICAgIGlmICghcHJvdG9zdHViVVJMKSB0aHJvdyBuZXcgRXJyb3IoJ2RvbWFpbiBwYXJhbWV0ZXIgaXMgbmVlZGVkJyk7DQoNCiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7DQoNCiAgICAgICAgdmFyIGRvbWFpbiA9ICgwLCBfdXRpbHMuZGl2aWRlVVJMKShwcm90b3N0dWJVUkwpLmRvbWFpbjsNCg0KICAgICAgICBpZiAoIWRvbWFpbikgew0KICAgICAgICAgIGRvbWFpbiA9IHByb3Rvc3R1YlVSTDsNCiAgICAgICAgfQ0KDQogICAgICAgIHZhciBfc3R1YlNhbmRib3ggPSB2b2lkIDA7DQogICAgICAgIHZhciBfc3R1YkRlc2NyaXB0b3IgPSB2b2lkIDA7DQogICAgICAgIHZhciBfcnVudGltZVByb3RvU3R1YlVSTCA9IHZvaWQgMDsNCiAgICAgICAgdmFyIF9zdHViU291cmNlUGFja2FnZSA9IHZvaWQgMDsNCg0KICAgICAgICB2YXIgZXJyb3JSZWFzb24gPSBmdW5jdGlvbiBlcnJvclJlYXNvbihyZWFzb24pIHsNCiAgICAgICAgICBjb25zb2xlLmVycm9yKCdTb21ldGhpbmcgZmFpbGVkIG9uIHRoZSBkZXBsb3kgb2YgcHJvdG9jb2xzdHViOiAnLCByZWFzb24pOw0KICAgICAgICAgIHJlamVjdChyZWFzb24pOw0KICAgICAgICB9Ow0KDQogICAgICAgIC8vIERpc2NvdmVyIFByb3RvY29sIFN0dWINCiAgICAgICAgY29uc29sZS5pbmZvKCctLS0tLS0tLS0tLS0tLS0tLS0tIFByb3RvU3R1YiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbicpOw0KICAgICAgICBjb25zb2xlLmluZm8oJ0Rpc2NvdmVyIG9yIENyZWF0ZSBhIG5ldyBQcm90b1N0dWIgZm9yIGRvbWFpbjogJywgZG9tYWluKTsNCiAgICAgICAgX3RoaXMucmVnaXN0cnkuZGlzY292ZXJQcm90b3N0dWIoZG9tYWluKS50aGVuKGZ1bmN0aW9uIChydW50aW1lUHJvdG9TdHViVVJMKSB7DQogICAgICAgICAgLy8gSXMgcmVnaXN0ZWQ/DQogICAgICAgICAgY29uc29sZS5pbmZvKCcxLiBQcm90byBTdHViIERpc2NvdmVyZWQ6ICcsIHJ1bnRpbWVQcm90b1N0dWJVUkwpOw0KDQogICAgICAgICAgLy8gd2UgaGF2ZSBjb21wbGV0ZWQgc3RlcCAyIGh0dHBzOi8vZ2l0aHViLmNvbS9yZVRISU5LLXByb2plY3QvY29yZS1mcmFtZXdvcmsvYmxvYi9tYXN0ZXIvZG9jcy9zcGVjcy9ydW50aW1lL2R5bmFtaWMtdmlldy9iYXNpY3MvZGVwbG95LXByb3Rvc3R1Yi5tZA0KDQogICAgICAgICAgLy8gVE9ETzogQ2hlY2sgaWYgdGhlIHN0YXR1cyBpcyBzYXZlZCBpbiB0aGUgc3RhdHVzIG9mIHNhbmRib3g7DQogICAgICAgICAgdmFyIHN0dWIgPSB7DQogICAgICAgICAgICBydW50aW1lUHJvdG9TdHViVVJMOiBydW50aW1lUHJvdG9TdHViVVJMLA0KICAgICAgICAgICAgc3RhdHVzOiAnZGVwbG95ZWQnDQogICAgICAgICAgfTsNCg0KICAgICAgICAgIHJlc29sdmUoc3R1Yik7DQogICAgICAgICAgY29uc29sZS5pbmZvKCctLS0tLS0tLS0tLS0tLS0tLS0tIEVORCAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbicpOw0KICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAocmVhc29uKSB7DQoNCiAgICAgICAgICAvLyBpcyBub3QgcmVnaXN0ZWQ/DQogICAgICAgICAgY29uc29sZS5pbmZvKCcxLiBQcm90byBTdHViIG5vdCBmb3VuZDonLCByZWFzb24pOw0KDQogICAgICAgICAgLy8gd2UgaGF2ZSBjb21wbGV0ZWQgc3RlcCAzIGh0dHBzOi8vZ2l0aHViLmNvbS9yZVRISU5LLXByb2plY3QvY29yZS1mcmFtZXdvcmsvYmxvYi9tYXN0ZXIvZG9jcy9zcGVjcy9ydW50aW1lL2R5bmFtaWMtdmlldy9iYXNpY3MvZGVwbG95LXByb3Rvc3R1Yi5tZA0KDQogICAgICAgICAgLy8gd2UgbmVlZCB0byBnZXQgUHJvdG9TdHViIGRlc2NyaXB0b3Igc3RlcCA0IGh0dHBzOi8vZ2l0aHViLmNvbS9yZVRISU5LLXByb2plY3QvY29yZS1mcmFtZXdvcmsvYmxvYi9tYXN0ZXIvZG9jcy9zcGVjcy9ydW50aW1lL2R5bmFtaWMtdmlldy9iYXNpY3MvZGVwbG95LXByb3Rvc3R1Yi5tZA0KICAgICAgICAgIF90aGlzLnJ1bnRpbWVDYXRhbG9ndWUuZ2V0U3R1YkRlc2NyaXB0b3IocHJvdG9zdHViVVJMKS50aGVuKGZ1bmN0aW9uIChzdHViRGVzY3JpcHRvcikgew0KDQogICAgICAgICAgICBjb25zb2xlLmluZm8oJzIuIHJldHVybiB0aGUgUHJvdG9TdHViIGRlc2NyaXB0b3I6Jywgc3R1YkRlc2NyaXB0b3IpOw0KDQogICAgICAgICAgICAvLyB3ZSBoYXZlIGNvbXBsZXRlZCBzdGVwIDUgaHR0cHM6Ly9naXRodWIuY29tL3JlVEhJTkstcHJvamVjdC9jb3JlLWZyYW1ld29yay9ibG9iL21hc3Rlci9kb2NzL3NwZWNzL3J1bnRpbWUvZHluYW1pYy12aWV3L2Jhc2ljcy9kZXBsb3ktcHJvdG9zdHViLm1kDQogICAgICAgICAgICBfc3R1YkRlc2NyaXB0b3IgPSBzdHViRGVzY3JpcHRvcjsNCg0KICAgICAgICAgICAgdmFyIHNvdXJjZVBhY2thZ2VVUkwgPSBzdHViRGVzY3JpcHRvci5zb3VyY2VQYWNrYWdlVVJMOw0KDQogICAgICAgICAgICBpZiAoc291cmNlUGFja2FnZVVSTCA9PT0gJy9zb3VyY2VQYWNrYWdlJykgew0KICAgICAgICAgICAgICByZXR1cm4gc3R1YkRlc2NyaXB0b3Iuc291cmNlUGFja2FnZTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgLy8gd2UgbmVlZCB0byBnZXQgUHJvdG9TdHViIFNvdXJjZSBjb2RlIGZyb20gZGVzY3JpcHRvciAtIHN0ZXAgNiBodHRwczovL2dpdGh1Yi5jb20vcmVUSElOSy1wcm9qZWN0L2NvcmUtZnJhbWV3b3JrL2Jsb2IvbWFzdGVyL2RvY3Mvc3BlY3MvcnVudGltZS9keW5hbWljLXZpZXcvYmFzaWNzL2RlcGxveS1wcm90b3N0dWIubWQNCiAgICAgICAgICAgIHJldHVybiBfdGhpcy5ydW50aW1lQ2F0YWxvZ3VlLmdldFNvdXJjZVBhY2thZ2VGcm9tVVJMKHNvdXJjZVBhY2thZ2VVUkwpOw0KICAgICAgICAgIH0pLmNhdGNoKGVycm9yUmVhc29uKS50aGVuKGZ1bmN0aW9uIChzdHViU291cmNlUGFja2FnZSkgew0KICAgICAgICAgICAgY29uc29sZS5pbmZvKCczLiByZXR1cm4gdGhlIFByb3RvU3R1YiBTb3VyY2UgQ29kZTogJywgc3R1YlNvdXJjZVBhY2thZ2UpOw0KDQogICAgICAgICAgICAvLyB3ZSBoYXZlIGNvbXBsZXRlZCBzdGVwIDcgaHR0cHM6Ly9naXRodWIuY29tL3JlVEhJTkstcHJvamVjdC9jb3JlLWZyYW1ld29yay9ibG9iL21hc3Rlci9kb2NzL3NwZWNzL3J1bnRpbWUvZHluYW1pYy12aWV3L2Jhc2ljcy9kZXBsb3ktcHJvdG9zdHViLm1kDQoNCiAgICAgICAgICAgIF9zdHViU291cmNlUGFja2FnZSA9IHN0dWJTb3VyY2VQYWNrYWdlOw0KDQogICAgICAgICAgICAvLyBUT0RPOiBDaGVjayBvbiBQRVAgKHBvbGljeSBFbmdpbmUpIGlmIHdlIG5lZWQgdGhlIHNhbmRib3ggYW5kIGNoZWNrIGlmIHRoZSBTYW5kYm94IEZhY3RvcnkgaGF2ZSB0aGUgY29udGV4dCBzYW5kYm94Ow0KICAgICAgICAgICAgdmFyIHBvbGljeSA9IHRydWU7DQogICAgICAgICAgICByZXR1cm4gcG9saWN5Ow0KICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHBvbGljeSkgew0KICAgICAgICAgICAgLy8gdGhpcyB3aWxsIHJldHVybiB0aGUgc2FuZGJveCBvciBvbmUgcHJvbWlzZSB0byBnZXRTYW5kYm94Ow0KICAgICAgICAgICAgcmV0dXJuIF90aGlzLnJlZ2lzdHJ5LmdldFNhbmRib3goZG9tYWluKTsNCiAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChzdHViU2FuZGJveCkgew0KDQogICAgICAgICAgICBjb25zb2xlLmluZm8oJzQuIGlmIHRoZSBzYW5kYm94IGlzIHJlZ2lzdGVyZWQgdGhlbiByZXR1cm4gdGhlIHNhbmRib3ggJywgc3R1YlNhbmRib3gpOw0KDQogICAgICAgICAgICAvLyB3ZSBoYXZlIGNvbXBsZXRlZCBzdGVwIHh4eCBodHRwczovL2dpdGh1Yi5jb20vcmVUSElOSy1wcm9qZWN0L2NvcmUtZnJhbWV3b3JrL2Jsb2IvbWFzdGVyL2RvY3Mvc3BlY3MvcnVudGltZS9keW5hbWljLXZpZXcvYmFzaWNzL2RlcGxveS1wcm90b3N0dWIubWQNCg0KICAgICAgICAgICAgX3N0dWJTYW5kYm94ID0gc3R1YlNhbmRib3g7DQogICAgICAgICAgICByZXR1cm4gc3R1YlNhbmRib3g7DQogICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKHJlYXNvbikgew0KICAgICAgICAgICAgY29uc29sZS5pbmZvKCc1LiBTYW5kYm94IHdhcyBub3QgZm91bmQsIGNyZWF0aW5nIGEgbmV3IG9uZSAnLCByZWFzb24pOw0KDQogICAgICAgICAgICAvLyBjaGVjayBpZiB0aGUgc2FuZGJveCBpcyByZWdpc3RlZCBmb3IgdGhpcyBzdHViIGRlc2NyaXB0b3IgdXJsOw0KICAgICAgICAgICAgLy8gTWFrZSBTdGVwcyB4eHggLS0tIHh4eA0KICAgICAgICAgICAgLy8gSW5zdGFudGlhdGUgdGhlIFNhbmRib3gNCiAgICAgICAgICAgIHZhciBzYW5kYm94ID0gX3RoaXMucnVudGltZUZhY3RvcnkuY3JlYXRlU2FuZGJveCgpOw0KICAgICAgICAgICAgc2FuZGJveC5hZGRMaXN0ZW5lcignKicsIGZ1bmN0aW9uIChtc2cpIHsNCiAgICAgICAgICAgICAgX3RoaXMubWVzc2FnZUJ1cy5wb3N0TWVzc2FnZShtc2cpOw0KICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgIHJldHVybiBzYW5kYm94Ow0KICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHNhbmRib3gpIHsNCiAgICAgICAgICAgIGNvbnNvbGUuaW5mbygnNi4gcmV0dXJuIHRoZSBzYW5kYm94IGluc3RhbmNlIGFuZCByZWdpc3RlcicsIHNhbmRib3gsICd0byBkb21haW4gJywgZG9tYWluKTsNCg0KICAgICAgICAgICAgX3N0dWJTYW5kYm94ID0gc2FuZGJveDsNCg0KICAgICAgICAgICAgLy8gd2UgbmVlZCByZWdpc3RlciBzdHViIG9uIHJlZ2lzdHJ5IC0gc3RlcCB4eHggaHR0cHM6Ly9naXRodWIuY29tL3JlVEhJTkstcHJvamVjdC9jb3JlLWZyYW1ld29yay9ibG9iL21hc3Rlci9kb2NzL3NwZWNzL3J1bnRpbWUvZHluYW1pYy12aWV3L2Jhc2ljcy9kZXBsb3ktcHJvdG9zdHViLm1kDQogICAgICAgICAgICByZXR1cm4gX3RoaXMucmVnaXN0cnkucmVnaXN0ZXJTdHViKF9zdHViU2FuZGJveCwgZG9tYWluKTsNCiAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChydW50aW1lUHJvdG9TdHViVVJMKSB7DQoNCiAgICAgICAgICAgIGNvbnNvbGUuaW5mbygnNy4gcmV0dXJuIHRoZSBydW50aW1lIHByb3Rvc3R1YiB1cmw6ICcsIHJ1bnRpbWVQcm90b1N0dWJVUkwpOw0KDQogICAgICAgICAgICAvLyB3ZSBoYXZlIGNvbXBsZXRlZCBzdGVwIHh4eCBodHRwczovL2dpdGh1Yi5jb20vcmVUSElOSy1wcm9qZWN0L2NvcmUtZnJhbWV3b3JrL2Jsb2IvbWFzdGVyL2RvY3Mvc3BlY3MvcnVudGltZS9keW5hbWljLXZpZXcvYmFzaWNzL2RlcGxveS1wcm90b3N0dWIubWQNCg0KICAgICAgICAgICAgX3J1bnRpbWVQcm90b1N0dWJVUkwgPSBydW50aW1lUHJvdG9TdHViVVJMOw0KDQogICAgICAgICAgICAvLyBFeHRlbmQgb3JpZ2luYWwgaHlwZXJ0eSBjb25maWd1cmF0aW9uOw0KICAgICAgICAgICAgdmFyIGNvbmZpZ3VyYXRpb24gPSB7fTsNCiAgICAgICAgICAgIGlmICghKDAsIF91dGlscy5lbXB0eU9iamVjdCkoX3N0dWJEZXNjcmlwdG9yLmNvbmZpZ3VyYXRpb24pKSB7DQogICAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgY29uZmlndXJhdGlvbiA9IE9iamVjdC5hc3NpZ24oe30sIEpTT04ucGFyc2UoX3N0dWJEZXNjcmlwdG9yLmNvbmZpZ3VyYXRpb24pKTsNCiAgICAgICAgICAgICAgfSBjYXRjaCAoZSkgew0KICAgICAgICAgICAgICAgIGNvbmZpZ3VyYXRpb24gPSBfc3R1YkRlc2NyaXB0b3IuY29uZmlndXJhdGlvbjsNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBjb25maWd1cmF0aW9uLnJ1bnRpbWVVUkwgPSBfdGhpcy5ydW50aW1lVVJMOw0KDQogICAgICAgICAgICAvLyBEZXBsb3kgQ29tcG9uZW50IHN0ZXAgeHh4DQogICAgICAgICAgICByZXR1cm4gX3N0dWJTYW5kYm94LmRlcGxveUNvbXBvbmVudChfc3R1YlNvdXJjZVBhY2thZ2Uuc291cmNlQ29kZSwgcnVudGltZVByb3RvU3R1YlVSTCwgY29uZmlndXJhdGlvbik7DQogICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAoZGVwbG95Q29tcG9uZW50U3RhdHVzKSB7DQogICAgICAgICAgICBjb25zb2xlLmluZm8oJzg6IHJldHVybiBkZXBsb3kgY29tcG9uZW50IGZvciBzYW5kYm94IHN0YXR1czogJywgZGVwbG95Q29tcG9uZW50U3RhdHVzKTsNCg0KICAgICAgICAgICAgLy8gd2UgaGF2ZSBjb21wbGV0ZWQgc3RlcCB4eHggaHR0cHM6Ly9naXRodWIuY29tL3JlVEhJTkstcHJvamVjdC9jb3JlLWZyYW1ld29yay9ibG9iL21hc3Rlci9kb2NzL3NwZWNzL3J1bnRpbWUvZHluYW1pYy12aWV3L2Jhc2ljcy9kZXBsb3ktcHJvdG9zdHViLm1kDQoNCiAgICAgICAgICAgIC8vIEFkZCB0aGUgbWVzc2FnZSBidXMgbGlzdGVuZXINCiAgICAgICAgICAgIF90aGlzLm1lc3NhZ2VCdXMuYWRkTGlzdGVuZXIoX3J1bnRpbWVQcm90b1N0dWJVUkwsIGZ1bmN0aW9uIChtc2cpIHsNCiAgICAgICAgICAgICAgX3N0dWJTYW5kYm94LnBvc3RNZXNzYWdlKG1zZyk7DQogICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgLy8gd2UgaGF2ZSBjb21wbGV0ZWQgc3RlcCB4eHggaHR0cHM6Ly9naXRodWIuY29tL3JlVEhJTkstcHJvamVjdC9jb3JlLWZyYW1ld29yay9ibG9iL21hc3Rlci9kb2NzL3NwZWNzL3J1bnRpbWUvZHluYW1pYy12aWV3L2Jhc2ljcy9kZXBsb3ktcHJvdG9zdHViLm1kDQoNCiAgICAgICAgICAgIC8vIExvYWQgU3R1YiBmdW5jdGlvbiByZXNvbHZlZCB3aXRoIHN1Y2Nlc3M7DQogICAgICAgICAgICB2YXIgc3R1YiA9IHsNCiAgICAgICAgICAgICAgcnVudGltZVByb3RvU3R1YlVSTDogX3J1bnRpbWVQcm90b1N0dWJVUkwsDQogICAgICAgICAgICAgIHN0YXR1czogZGVwbG95Q29tcG9uZW50U3RhdHVzDQogICAgICAgICAgICB9Ow0KDQogICAgICAgICAgICByZXNvbHZlKHN0dWIpOw0KICAgICAgICAgICAgY29uc29sZS5pbmZvKCctLS0tLS0tLS0tLS0tLS0tLS0tIEVORCAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbicpOw0KICAgICAgICAgIH0pLmNhdGNoKGVycm9yUmVhc29uKTsNCiAgICAgICAgfSk7DQogICAgICB9KTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAqIERlcGxveSBTdHViIGZyb20gQ2F0YWxvZ3VlIFVSTCBvciBkb21haW4gdXJsDQogICAgKiBAcGFyYW0gIHtVUkwuVVJMfSAgICAgZG9tYWluICAgICAgICAgIGRvbWFpbg0KICAgICovDQoNCiAgfSwgew0KICAgIGtleTogJ2xvYWRJZHBQcm94eScsDQogICAgdmFsdWU6IGZ1bmN0aW9uIGxvYWRJZHBQcm94eShpZHBQcm94eVVSTCkgew0KDQogICAgICB2YXIgX3RoaXMgPSB0aGlzOw0KDQogICAgICBpZiAoIWlkcFByb3h5VVJMKSB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBJRFAgUHJveHkgVVJMIGlzIGEgbmVlZGVkIHBhcmFtZXRlciwgY291bGQgYmUgYSBET01BSU4gb3IgYSBVUkwnKTsNCg0KICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsNCg0KICAgICAgICB2YXIgZG9tYWluID0gKDAsIF91dGlscy5kaXZpZGVVUkwpKGlkcFByb3h5VVJMKS5kb21haW47DQoNCiAgICAgICAgaWYgKCFkb21haW4pIHsNCiAgICAgICAgICBkb21haW4gPSBpZHBQcm94eVVSTDsNCiAgICAgICAgfQ0KDQogICAgICAgIHZhciBfcHJveHlTYW5kYm94ID0gdm9pZCAwOw0KICAgICAgICB2YXIgX3Byb3h5RGVzY3JpcHRvciA9IHZvaWQgMDsNCiAgICAgICAgdmFyIF9ydW50aW1lSWRwUHJveHlVUkwgPSB2b2lkIDA7DQogICAgICAgIHZhciBfcHJveHlTb3VyY2VQYWNrYWdlID0gdm9pZCAwOw0KDQogICAgICAgIHZhciBlcnJvclJlYXNvbiA9IGZ1bmN0aW9uIGVycm9yUmVhc29uKHJlYXNvbikgew0KICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1NvbWV0aGluZyBmYWlsZWQgb24gdGhlIGRlcGxveSBvZiBJZHBQcm94eTogJywgcmVhc29uKTsNCiAgICAgICAgICByZWplY3QocmVhc29uKTsNCiAgICAgICAgfTsNCg0KICAgICAgICAvLyBEaXNjb3ZlciBJRFBQcm94eQ0KICAgICAgICBjb25zb2xlLmluZm8oJy0tLS0tLS0tLS0tLS0tLS0tLS0gSURQIFByb3h5IERlcGxveSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbicpOw0KICAgICAgICBjb25zb2xlLmluZm8oJ0Rpc2NvdmVyIG9yIENyZWF0ZSBhIG5ldyBJZHBQcm94eSBmb3IgZG9tYWluL1VSTDogJywgZG9tYWluKTsNCiAgICAgICAgcmV0dXJuIF90aGlzLnJlZ2lzdHJ5LmRpc2NvdmVySWRwUHJveHkoZG9tYWluKS50aGVuKGZ1bmN0aW9uIChydW50aW1lSWRwUHJveHlVUkwpIHsNCiAgICAgICAgICAvLyBJcyByZWdpc3RlZD8NCiAgICAgICAgICBjb25zb2xlLmluZm8oJzEuIElEUFByb3h5IERpc2NvdmVyZWQ6ICcsIHJ1bnRpbWVJZHBQcm94eVVSTCk7DQoNCiAgICAgICAgICAvLyB3ZSBoYXZlIGNvbXBsZXRlZCBzdGVwIDIgaHR0cHM6Ly9naXRodWIuY29tL3JlVEhJTkstcHJvamVjdC9jb3JlLWZyYW1ld29yay9ibG9iL21hc3Rlci9kb2NzL3NwZWNzL3J1bnRpbWUvZHluYW1pYy12aWV3L2Jhc2ljcy9kZXBsb3ktcHJvdG9zdHViLm1kDQoNCiAgICAgICAgICAvLyBUT0RPOiBDaGVjayBpZiB0aGUgc3RhdHVzIGlzIHNhdmVkIGluIHRoZSBzdGF0dXMgb2Ygc2FuZGJveDsNCiAgICAgICAgICB2YXIgaWRwUHJveHkgPSB7DQogICAgICAgICAgICBydW50aW1lSWRwUHJveHlVUkw6IHJ1bnRpbWVJZHBQcm94eVVSTCwNCiAgICAgICAgICAgIHN0YXR1czogJ2RlcGxveWVkJw0KICAgICAgICAgIH07DQoNCiAgICAgICAgICByZXNvbHZlKGlkcFByb3h5KTsNCiAgICAgICAgICBjb25zb2xlLmluZm8oJy0tLS0tLS0tLS0tLS0tLS0tLS0gRU5EIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuJyk7DQogICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChyZWFzb24pIHsNCg0KICAgICAgICAgIC8vIGlzIG5vdCByZWdpc3RlZD8NCiAgICAgICAgICBjb25zb2xlLmluZm8oJzEuIElkcFByb3h5IG5vdCBmb3VuZDonLCByZWFzb24pOw0KDQogICAgICAgICAgLy8gd2UgaGF2ZSBjb21wbGV0ZWQgc3RlcCAzIGh0dHBzOi8vZ2l0aHViLmNvbS9yZVRISU5LLXByb2plY3QvY29yZS1mcmFtZXdvcmsvYmxvYi9tYXN0ZXIvZG9jcy9zcGVjcy9ydW50aW1lL2R5bmFtaWMtdmlldy9iYXNpY3MvZGVwbG95LXByb3Rvc3R1Yi5tZA0KDQogICAgICAgICAgLy8gd2UgbmVlZCB0byBnZXQgUHJvdG9TdHViIGRlc2NyaXB0b3Igc3RlcCA0IGh0dHBzOi8vZ2l0aHViLmNvbS9yZVRISU5LLXByb2plY3QvY29yZS1mcmFtZXdvcmsvYmxvYi9tYXN0ZXIvZG9jcy9zcGVjcy9ydW50aW1lL2R5bmFtaWMtdmlldy9iYXNpY3MvZGVwbG95LXByb3Rvc3R1Yi5tZA0KICAgICAgICAgIF90aGlzLnJ1bnRpbWVDYXRhbG9ndWUuZ2V0SWRwUHJveHlEZXNjcmlwdG9yKGlkcFByb3h5VVJMKS50aGVuKGZ1bmN0aW9uIChwcm94eURlc2NyaXB0b3IpIHsNCg0KICAgICAgICAgICAgY29uc29sZS5pbmZvKCcyLiBSZXR1cm4gdGhlIElEUFByb3h5IGRlc2NyaXB0b3I6JywgcHJveHlEZXNjcmlwdG9yKTsNCg0KICAgICAgICAgICAgLy8gd2UgaGF2ZSBjb21wbGV0ZWQgc3RlcCA1IGh0dHBzOi8vZ2l0aHViLmNvbS9yZVRISU5LLXByb2plY3QvY29yZS1mcmFtZXdvcmsvYmxvYi9tYXN0ZXIvZG9jcy9zcGVjcy9ydW50aW1lL2R5bmFtaWMtdmlldy9iYXNpY3MvZGVwbG95LXByb3Rvc3R1Yi5tZA0KICAgICAgICAgICAgX3Byb3h5RGVzY3JpcHRvciA9IHByb3h5RGVzY3JpcHRvcjsNCg0KICAgICAgICAgICAgdmFyIHNvdXJjZVBhY2thZ2VVUkwgPSBwcm94eURlc2NyaXB0b3Iuc291cmNlUGFja2FnZVVSTDsNCg0KICAgICAgICAgICAgaWYgKHNvdXJjZVBhY2thZ2VVUkwgPT09ICcvc291cmNlUGFja2FnZScpIHsNCiAgICAgICAgICAgICAgcmV0dXJuIHByb3h5RGVzY3JpcHRvci5zb3VyY2VQYWNrYWdlOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvLyB3ZSBuZWVkIHRvIGdldCBQcm90b1N0dWIgU291cmNlIGNvZGUgZnJvbSBkZXNjcmlwdG9yIC0gc3RlcCA2IGh0dHBzOi8vZ2l0aHViLmNvbS9yZVRISU5LLXByb2plY3QvY29yZS1mcmFtZXdvcmsvYmxvYi9tYXN0ZXIvZG9jcy9zcGVjcy9ydW50aW1lL2R5bmFtaWMtdmlldy9iYXNpY3MvZGVwbG95LXByb3Rvc3R1Yi5tZA0KICAgICAgICAgICAgcmV0dXJuIF90aGlzLnJ1bnRpbWVDYXRhbG9ndWUuZ2V0U291cmNlUGFja2FnZUZyb21VUkwoc291cmNlUGFja2FnZVVSTCk7DQogICAgICAgICAgfSkuY2F0Y2goZXJyb3JSZWFzb24pLnRoZW4oZnVuY3Rpb24gKHNvdXJjZVBhY2thZ2UpIHsNCiAgICAgICAgICAgIGNvbnNvbGUuaW5mbygnMy4gcmV0dXJuIHRoZSBJRFBQcm94eSBzb3VyY2UgcGFja2FnZTogJywgc291cmNlUGFja2FnZSk7DQoNCiAgICAgICAgICAgIC8vIHdlIGhhdmUgY29tcGxldGVkIHN0ZXAgNyBodHRwczovL2dpdGh1Yi5jb20vcmVUSElOSy1wcm9qZWN0L2NvcmUtZnJhbWV3b3JrL2Jsb2IvbWFzdGVyL2RvY3Mvc3BlY3MvcnVudGltZS9keW5hbWljLXZpZXcvYmFzaWNzL2RlcGxveS1wcm90b3N0dWIubWQNCg0KICAgICAgICAgICAgX3Byb3h5U291cmNlUGFja2FnZSA9IHNvdXJjZVBhY2thZ2U7DQoNCiAgICAgICAgICAgIC8vIFRPRE86IENoZWNrIG9uIFBFUCAocG9saWN5IEVuZ2luZSkgaWYgd2UgbmVlZCB0aGUgc2FuZGJveCBhbmQgY2hlY2sgaWYgdGhlIFNhbmRib3ggRmFjdG9yeSBoYXZlIHRoZSBjb250ZXh0IHNhbmRib3g7DQogICAgICAgICAgICB2YXIgcG9saWN5ID0gdHJ1ZTsNCiAgICAgICAgICAgIHJldHVybiBwb2xpY3k7DQogICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocG9saWN5KSB7DQogICAgICAgICAgICAvLyB0aGlzIHdpbGwgcmV0dXJuIHRoZSBzYW5kYm94IG9yIG9uZSBwcm9taXNlIHRvIGdldFNhbmRib3g7DQogICAgICAgICAgICByZXR1cm4gX3RoaXMucmVnaXN0cnkuZ2V0U2FuZGJveChkb21haW4pOw0KICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHByb3h5U2FuZGJveCkgew0KDQogICAgICAgICAgICBjb25zb2xlLmluZm8oJzQuIGlmIHRoZSBzYW5kYm94IGlzIHJlZ2lzdGVyZWQgdGhlbiByZXR1cm4gdGhlIHNhbmRib3gnLCBwcm94eVNhbmRib3gpOw0KDQogICAgICAgICAgICBfcHJveHlTYW5kYm94ID0gcHJveHlTYW5kYm94Ow0KICAgICAgICAgICAgcmV0dXJuIHByb3h5U2FuZGJveDsNCiAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAocmVhc29uKSB7DQogICAgICAgICAgICBjb25zb2xlLmluZm8oJzUuIFNhbmRib3ggd2FzIG5vdCBmb3VuZCwgY3JlYXRpbmcgYSBuZXcgb25lJywgcmVhc29uKTsNCg0KICAgICAgICAgICAgLy8gY2hlY2sgaWYgdGhlIHNhbmRib3ggaXMgcmVnaXN0ZWQgZm9yIHRoaXMgcHJveHkgZGVzY3JpcHRvciB1cmw7DQogICAgICAgICAgICAvLyBNYWtlIFN0ZXBzIHh4eCAtLS0geHh4DQogICAgICAgICAgICAvLyBJbnN0YW50aWF0ZSB0aGUgU2FuZGJveA0KICAgICAgICAgICAgdmFyIHNhbmRib3ggPSBfdGhpcy5ydW50aW1lRmFjdG9yeS5jcmVhdGVTYW5kYm94KCk7DQogICAgICAgICAgICBzYW5kYm94LmFkZExpc3RlbmVyKCcqJywgZnVuY3Rpb24gKG1zZykgew0KICAgICAgICAgICAgICBfdGhpcy5tZXNzYWdlQnVzLnBvc3RNZXNzYWdlKG1zZyk7DQogICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgcmV0dXJuIHNhbmRib3g7DQogICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAoc2FuZGJveCkgew0KICAgICAgICAgICAgY29uc29sZS5pbmZvKCc2LiByZXR1cm4gdGhlIHNhbmRib3ggaW5zdGFuY2UgYW5kIHJlZ2lzdGVyJywgc2FuZGJveCwgJ3RvIGRvbWFpbiAnLCBkb21haW4pOw0KDQogICAgICAgICAgICBfcHJveHlTYW5kYm94ID0gc2FuZGJveDsNCg0KICAgICAgICAgICAgLy8gd2UgbmVlZCByZWdpc3RlciBzdHViIG9uIHJlZ2lzdHJ5IC0gc3RlcCB4eHggaHR0cHM6Ly9naXRodWIuY29tL3JlVEhJTkstcHJvamVjdC9jb3JlLWZyYW1ld29yay9ibG9iL21hc3Rlci9kb2NzL3NwZWNzL3J1bnRpbWUvZHluYW1pYy12aWV3L2Jhc2ljcy9kZXBsb3ktcHJvdG9zdHViLm1kDQogICAgICAgICAgICByZXR1cm4gX3RoaXMucmVnaXN0cnkucmVnaXN0ZXJJZHBQcm94eShzYW5kYm94LCBkb21haW4pOw0KICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJ1bnRpbWVJZHBQcm94eVVSTCkgew0KDQogICAgICAgICAgICBjb25zb2xlLmluZm8oJzcuIFJldHVybiB0aGUgcnVudGltZSBJZHAgUHJveHkgVVJMOiAnLCBydW50aW1lSWRwUHJveHlVUkwpOw0KDQogICAgICAgICAgICAvLyB3ZSBoYXZlIGNvbXBsZXRlZCBzdGVwIHh4eCBodHRwczovL2dpdGh1Yi5jb20vcmVUSElOSy1wcm9qZWN0L2NvcmUtZnJhbWV3b3JrL2Jsb2IvbWFzdGVyL2RvY3Mvc3BlY3MvcnVudGltZS9keW5hbWljLXZpZXcvYmFzaWNzL2RlcGxveS1wcm90b3N0dWIubWQNCg0KICAgICAgICAgICAgX3J1bnRpbWVJZHBQcm94eVVSTCA9IHJ1bnRpbWVJZHBQcm94eVVSTDsNCg0KICAgICAgICAgICAgLy8gRXh0ZW5kIG9yaWdpbmFsIGh5cGVydHkgY29uZmlndXJhdGlvbjsNCiAgICAgICAgICAgIHZhciBjb25maWd1cmF0aW9uID0ge307DQogICAgICAgICAgICBpZiAoISgwLCBfdXRpbHMuZW1wdHlPYmplY3QpKF9wcm94eURlc2NyaXB0b3IuY29uZmlndXJhdGlvbikpIHsNCiAgICAgICAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICAgICBjb25maWd1cmF0aW9uID0gT2JqZWN0LmFzc2lnbih7fSwgSlNPTi5wYXJzZShfcHJveHlEZXNjcmlwdG9yLmNvbmZpZ3VyYXRpb24pKTsNCiAgICAgICAgICAgICAgfSBjYXRjaCAoZSkgew0KICAgICAgICAgICAgICAgIGNvbmZpZ3VyYXRpb24gPSBfcHJveHlEZXNjcmlwdG9yLmNvbmZpZ3VyYXRpb247DQogICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGNvbmZpZ3VyYXRpb24ucnVudGltZVVSTCA9IF90aGlzLnJ1bnRpbWVVUkw7DQoNCiAgICAgICAgICAgIC8vIERlcGxveSBDb21wb25lbnQgc3RlcCB4eHgNCiAgICAgICAgICAgIHJldHVybiBfcHJveHlTYW5kYm94LmRlcGxveUNvbXBvbmVudChfcHJveHlTb3VyY2VQYWNrYWdlLnNvdXJjZUNvZGUsIHJ1bnRpbWVJZHBQcm94eVVSTCwgY29uZmlndXJhdGlvbik7DQogICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAoZGVwbG95Q29tcG9uZW50U3RhdHVzKSB7DQogICAgICAgICAgICBjb25zb2xlLmluZm8oJzg6IHJldHVybiBkZXBsb3kgY29tcG9uZW50IGZvciBzYW5kYm94IHN0YXR1czogJywgZGVwbG95Q29tcG9uZW50U3RhdHVzKTsNCg0KICAgICAgICAgICAgLy8gd2UgaGF2ZSBjb21wbGV0ZWQgc3RlcCB4eHggaHR0cHM6Ly9naXRodWIuY29tL3JlVEhJTkstcHJvamVjdC9jb3JlLWZyYW1ld29yay9ibG9iL21hc3Rlci9kb2NzL3NwZWNzL3J1bnRpbWUvZHluYW1pYy12aWV3L2Jhc2ljcy9kZXBsb3ktcHJvdG9zdHViLm1kDQoNCiAgICAgICAgICAgIC8vIEFkZCB0aGUgbWVzc2FnZSBidXMgbGlzdGVuZXINCiAgICAgICAgICAgIF90aGlzLm1lc3NhZ2VCdXMuYWRkTGlzdGVuZXIoX3J1bnRpbWVJZHBQcm94eVVSTCwgZnVuY3Rpb24gKG1zZykgew0KICAgICAgICAgICAgICBfcHJveHlTYW5kYm94LnBvc3RNZXNzYWdlKG1zZyk7DQogICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgLy8gd2UgaGF2ZSBjb21wbGV0ZWQgc3RlcCB4eHggaHR0cHM6Ly9naXRodWIuY29tL3JlVEhJTkstcHJvamVjdC9jb3JlLWZyYW1ld29yay9ibG9iL21hc3Rlci9kb2NzL3NwZWNzL3J1bnRpbWUvZHluYW1pYy12aWV3L2Jhc2ljcy9kZXBsb3ktcHJvdG9zdHViLm1kDQoNCiAgICAgICAgICAgIC8vIExvYWQgU3R1YiBmdW5jdGlvbiByZXNvbHZlZCB3aXRoIHN1Y2Nlc3M7DQogICAgICAgICAgICB2YXIgaWRwUHJveHkgPSB7DQogICAgICAgICAgICAgIHJ1bnRpbWVJZHBQcm94eVVSTDogX3J1bnRpbWVJZHBQcm94eVVSTCwNCiAgICAgICAgICAgICAgc3RhdHVzOiBkZXBsb3lDb21wb25lbnRTdGF0dXMNCiAgICAgICAgICAgIH07DQoNCiAgICAgICAgICAgIHJlc29sdmUoaWRwUHJveHkpOw0KICAgICAgICAgICAgY29uc29sZS5pbmZvKCctLS0tLS0tLS0tLS0tLS0tLS0tIEVORCAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbicpOw0KICAgICAgICAgIH0pLmNhdGNoKGVycm9yUmVhc29uKTsNCiAgICAgICAgfSk7DQogICAgICB9KTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAqIFVzZWQgdG8gY2hlY2sgZm9yIHVwZGF0ZXMgYWJvdXQgY29tcG9uZW50cyBoYW5kbGVkIGluIHRoZSBDYXRhbG9ndWUgaW5jbHVkaW5nIHByb3RvY29sIHN0dWJzIGFuZCBIeXBlcnRpZXMuIGNoZWNrIHJlbGF0aW9uc2hpcCB3aXRoIGxpZmVjeWNsZSBtYW5hZ2VtZW50IHByb3ZpZGVkIGJ5IFNlcnZpY2UgV29ya2Vycw0KICAgICogQHBhcmFtICB7Q2F0YWxvZ3VlVVJMfSAgICAgICB1cmwgdXJsDQogICAgKi8NCg0KICB9LCB7DQogICAga2V5OiAnY2hlY2tGb3JVcGRhdGUnLA0KICAgIHZhbHVlOiBmdW5jdGlvbiBjaGVja0ZvclVwZGF0ZSh1cmwpIHsNCiAgICAgIC8vIEJvZHkuLi4NCiAgICB9DQogIH1dKTsNCg0KICByZXR1cm4gUnVudGltZVVBOw0KfSgpOw0KDQpleHBvcnRzLmRlZmF1bHQgPSBSdW50aW1lVUE7DQp9LHsiLi4vYnVzL01lc3NhZ2VCdXMiOjMwMywiLi4vaWRlbnRpdHkvSWRlbnRpdHlNb2R1bGUiOjMwNiwiLi4vcG9saWN5L1BvbGljeUVuZ2luZSI6MzEwLCIuLi9yZWdpc3RyeS9SZWdpc3RyeSI6MzEzLCIuLi9zeW5jaGVyL1N5bmNoZXJNYW5hZ2VyIjozMjAsIi4uL3V0aWxzL3V0aWxzIjozMjIsImJhYmVsLXBvbHlmaWxsIjoxfV0sMzE2OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCid1c2Ugc3RyaWN0JzsNCg0KT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgew0KICB2YWx1ZTogdHJ1ZQ0KfSk7DQoNCnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpOw0KDQpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOyB9IH0NCg0KLyoqDQoqIENvcHlyaWdodCAyMDE2IFBUIElub3Zh5+NvIGUgU2lzdGVtYXMgU0ENCiogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSUQNCiogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMDQoqIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WDQoqIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQQ0KKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHDQoqIENvcHlyaWdodCAyMDE2IEFwaXplZQ0KKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTg0KKg0KKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsNCiogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLg0KKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQNCioNCiogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjANCioNCiogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQ0KKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLA0KKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4NCiogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZA0KKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4NCioqLw0KDQp2YXIgT2JqZWN0QWxsb2NhdGlvbiA9IGZ1bmN0aW9uICgpIHsNCiAgLyogcHJpdmF0ZQ0KICBfdXJsOiBVUkwNCiAgX2J1czogTWluaUJ1cw0KICAqLw0KDQogIC8qKg0KICAgKiBDcmVhdGUgYW4gT2JqZWN0IEFsbG9jYXRpb24NCiAgICogQHBhcmFtICB7VVJMLlVSTH0gICAgICB1cmwgLSB1cmwgZnJvbSB3aG8gaXMgc2VuZGluZyB0aGUgbWVzc2FnZQ0KICAgKiBAcGFyYW0gIHtNaW5pQnVzfSAgICAgIGJ1cyAtIE1pbmlCdXMgdXNlZCBmb3IgYWRkcmVzcyBhbGxvY2F0aW9uDQogICAqLw0KDQogIGZ1bmN0aW9uIE9iamVjdEFsbG9jYXRpb24odXJsLCBidXMpIHsNCiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgT2JqZWN0QWxsb2NhdGlvbik7DQoNCiAgICB2YXIgX3RoaXMgPSB0aGlzOw0KDQogICAgX3RoaXMuX3VybCA9IHVybDsNCiAgICBfdGhpcy5fYnVzID0gYnVzOw0KICB9DQoNCiAgLyoqDQogICAqIGdldCB0aGUgVVJMIHZhbHVlDQogICAqIEByZXR1cm4ge3N0cmluZ30gVGhlIHVybCB2YWx1ZTsNCiAgICovDQoNCg0KICBfY3JlYXRlQ2xhc3MoT2JqZWN0QWxsb2NhdGlvbiwgW3sNCiAgICBrZXk6ICdjcmVhdGUnLA0KDQoNCiAgICAvKioNCiAgICAgKiBBc2sgZm9yIGNyZWF0aW9uIG9mIGEgbnVtYmVyIG9mIE9iamVjdCBhZGRyZXNzZXMsIHRvIHRoZSBkb21haW4gbWVzc2FnZSBub2RlLg0KICAgICAqIEBwYXJhbSAge0RvbWFpbn0gZG9tYWluIC0gRG9tYWluIG9mIHRoZSBtZXNzYWdlIG5vZGUuDQogICAgICogQHBhcmFtICB7bnVtYmVyfSBudW1iZXIgLSBOdW1iZXIgb2YgYWRkcmVzc2VzIHRvIHJlcXVlc3QNCiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTxPYmplY3RVUkw+fSAgQSBsaXN0IG9mIE9iamVjdFVSTCdzDQogICAgICovDQogICAgdmFsdWU6IGZ1bmN0aW9uIGNyZWF0ZShkb21haW4sIHNjaGVtZSwgbnVtYmVyKSB7DQogICAgICB2YXIgX3RoaXMgPSB0aGlzOw0KDQogICAgICAvL0ZMT1ctT1VUOiBtZXNzYWdlIHNlbnQgdG8gbXNnLW5vZGUgT2JqZWN0QWxsb2NhdGlvbk1hbmFnZXIgY29tcG9uZW50DQogICAgICB2YXIgbXNnID0gew0KICAgICAgICB0eXBlOiAnY3JlYXRlJywgZnJvbTogX3RoaXMuX3VybCwgdG86ICdkb21haW46Ly9tc2ctbm9kZS4nICsgZG9tYWluICsgJy9vYmplY3QtYWRkcmVzcy1hbGxvY2F0aW9uJywNCiAgICAgICAgYm9keTogeyBzY2hlbWU6IHNjaGVtZSwgdmFsdWU6IHsgbnVtYmVyOiBudW1iZXIgfSB9DQogICAgICB9Ow0KDQogICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgew0KICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKG1zZywgZnVuY3Rpb24gKHJlcGx5KSB7DQogICAgICAgICAgaWYgKHJlcGx5LmJvZHkuY29kZSA9PT0gMjAwKSB7DQogICAgICAgICAgICByZXNvbHZlKHJlcGx5LmJvZHkudmFsdWUuYWxsb2NhdGVkKTsNCiAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgcmVqZWN0KHJlcGx5LmJvZHkuZGVzYyk7DQogICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICAgIH0pOw0KICAgIH0NCiAgfSwgew0KICAgIGtleTogJ3VybCcsDQogICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7DQogICAgICByZXR1cm4gdGhpcy5fdXJsOw0KICAgIH0NCiAgfV0pOw0KDQogIHJldHVybiBPYmplY3RBbGxvY2F0aW9uOw0KfSgpOw0KDQpleHBvcnRzLmRlZmF1bHQgPSBPYmplY3RBbGxvY2F0aW9uOw0KfSx7fV0sMzE3OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCid1c2Ugc3RyaWN0JzsNCg0KT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgew0KICB2YWx1ZTogdHJ1ZQ0KfSk7DQoNCnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpOw0KDQp2YXIgX3V0aWxzID0gcmVxdWlyZSgnLi4vdXRpbHMvdXRpbHMnKTsNCg0KdmFyIF9TdWJzY3JpcHRpb24gPSByZXF1aXJlKCcuL1N1YnNjcmlwdGlvbicpOw0KDQp2YXIgX1N1YnNjcmlwdGlvbjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9TdWJzY3JpcHRpb24pOw0KDQpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQ0KDQpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOyB9IH0NCg0KdmFyIE9ic2VydmVyT2JqZWN0ID0gZnVuY3Rpb24gKCkgew0KICBmdW5jdGlvbiBPYnNlcnZlck9iamVjdChwYXJlbnQsIHVybCwgY2hpbGRyZW5zKSB7DQogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIE9ic2VydmVyT2JqZWN0KTsNCg0KICAgIHZhciBfdGhpcyA9IHRoaXM7DQoNCiAgICBfdGhpcy5fcGFyZW50ID0gcGFyZW50Ow0KICAgIF90aGlzLl91cmwgPSB1cmw7DQogICAgX3RoaXMuX2NoaWxkcmVucyA9IGNoaWxkcmVuczsNCg0KICAgIF90aGlzLl9idXMgPSBwYXJlbnQuX2J1czsNCiAgICBfdGhpcy5fc3Vic2NyaXB0aW9ucyA9IHt9Ow0KICB9DQoNCiAgX2NyZWF0ZUNsYXNzKE9ic2VydmVyT2JqZWN0LCBbew0KICAgIGtleTogJ2FkZFN1YnNjcmlwdGlvbicsDQogICAgdmFsdWU6IGZ1bmN0aW9uIGFkZFN1YnNjcmlwdGlvbihoeXBlcnR5KSB7DQogICAgICB2YXIgX3RoaXMgPSB0aGlzOw0KDQogICAgICBfdGhpcy5fc3Vic2NyaXB0aW9uc1toeXBlcnR5XSA9IG5ldyBfU3Vic2NyaXB0aW9uMi5kZWZhdWx0KF90aGlzLl9idXMsIGh5cGVydHksIF90aGlzLl91cmwsIF90aGlzLl9jaGlsZHJlbnMsIGZhbHNlKTsNCiAgICB9DQogIH0sIHsNCiAgICBrZXk6ICdyZW1vdmVTdWJzY3JpcHRpb24nLA0KICAgIHZhbHVlOiBmdW5jdGlvbiByZW1vdmVTdWJzY3JpcHRpb24oaHlwZXJ0eSkgew0KICAgICAgdmFyIF90aGlzID0gdGhpczsNCg0KICAgICAgdmFyIGRvbWFpbiA9ICgwLCBfdXRpbHMuZGl2aWRlVVJMKShoeXBlcnR5KS5kb21haW47DQogICAgICB2YXIgb2JqVVJMU3Vic2NyaXB0aW9uID0gX3RoaXMuX3VybCArICcvc3Vic2NyaXB0aW9uJzsNCg0KICAgICAgdmFyIHN1YnNjcmlwdGlvbiA9IF90aGlzLl9zdWJzY3JpcHRpb25zW2h5cGVydHldOw0KICAgICAgaWYgKHN1YnNjcmlwdGlvbikgew0KICAgICAgICAvL0ZMT1ctT1VUOiBtZXNzYWdlIHNlbnQgdG8gcmVtb3RlIFJlcG9ydGVyT2JqZWN0IC0+IF9vblJlbW90ZVVuU3Vic2NyaWJlDQogICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2Uoew0KICAgICAgICAgIHR5cGU6ICd1bnN1YnNjcmliZScsIGZyb206IF90aGlzLl9wYXJlbnQuX3VybCwgdG86IG9ialVSTFN1YnNjcmlwdGlvbiwNCiAgICAgICAgICBib2R5OiB7IHJlc291cmNlOiBfdGhpcy5fdXJsIH0NCiAgICAgICAgfSk7DQoNCiAgICAgICAgLy9UT0RPOiBzaG91bGQgSSB3YWl0IGZvciByZXNwb25zZSBiZWZvcmUgdW5zdWJzY3JpYmUgb24gbXNnLW5vZGUNCiAgICAgICAgLy9GTE9XLU9VVDogbWVzc2FnZSBzZW50IHRvIG1zZy1ub2RlIFN1YnNjcmlwdGlvbk1hbmFnZXIgY29tcG9uZW50DQogICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2Uoew0KICAgICAgICAgIHR5cGU6ICd1bnN1YnNjcmliZScsIGZyb206IF90aGlzLl9wYXJlbnQuX3VybCwgdG86ICdkb21haW46Ly9tc2ctbm9kZS4nICsgZG9tYWluICsgJy9zbScsDQogICAgICAgICAgYm9keTogeyByZXNvdXJjZTogX3RoaXMuX3VybCwgY2hpbGRyZW5SZXNvdXJjZXM6IF90aGlzLl9jaGlsZHJlbnMgfQ0KICAgICAgICB9KTsNCg0KICAgICAgICBzdWJzY3JpcHRpb24uX3JlbGVhc2VMaXN0ZW5lcnMoKTsNCiAgICAgICAgZGVsZXRlIF90aGlzLl9zdWJzY3JpcHRpb25zW2h5cGVydHldOw0KICAgICAgfQ0KICAgIH0NCiAgfV0pOw0KDQogIHJldHVybiBPYnNlcnZlck9iamVjdDsNCn0oKTsNCg0KZXhwb3J0cy5kZWZhdWx0ID0gT2JzZXJ2ZXJPYmplY3Q7DQp9LHsiLi4vdXRpbHMvdXRpbHMiOjMyMiwiLi9TdWJzY3JpcHRpb24iOjMxOX1dLDMxODpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQondXNlIHN0cmljdCc7DQoNCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsNCiAgdmFsdWU6IHRydWUNCn0pOw0KDQp2YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTsNCg0KdmFyIF91dGlscyA9IHJlcXVpcmUoJy4uL3V0aWxzL3V0aWxzJyk7DQoNCnZhciBfU3Vic2NyaXB0aW9uID0gcmVxdWlyZSgnLi9TdWJzY3JpcHRpb24nKTsNCg0KdmFyIF9TdWJzY3JpcHRpb24yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfU3Vic2NyaXB0aW9uKTsNCg0KZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH0NCg0KZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsgfSB9DQoNCnZhciBSZXBvcnRlck9iamVjdCA9IGZ1bmN0aW9uICgpIHsNCiAgZnVuY3Rpb24gUmVwb3J0ZXJPYmplY3QocGFyZW50LCBvd25lciwgdXJsKSB7DQogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFJlcG9ydGVyT2JqZWN0KTsNCg0KICAgIHZhciBfdGhpcyA9IHRoaXM7DQoNCiAgICBfdGhpcy5fcGFyZW50ID0gcGFyZW50Ow0KICAgIF90aGlzLl9vd25lciA9IG93bmVyOw0KICAgIF90aGlzLl91cmwgPSB1cmw7DQoNCiAgICBfdGhpcy5fYnVzID0gcGFyZW50Ll9idXM7DQoNCiAgICBfdGhpcy5fZG9tYWluID0gKDAsIF91dGlscy5kaXZpZGVVUkwpKG93bmVyKS5kb21haW47DQogICAgX3RoaXMuX29ialN1YnNjcmlwdG9yVVJMID0gX3RoaXMuX3VybCArICcvc3Vic2NyaXB0aW9uJzsNCg0KICAgIF90aGlzLl9zdWJzY3JpcHRpb25zID0ge307DQogICAgX3RoaXMuX2NoaWxkcmVucyA9IFtdOw0KICAgIF90aGlzLl9jaGlsZHJlbkxpc3RlbmVycyA9IFtdOw0KDQogICAgX3RoaXMuX2ZvcndhcmRzID0ge307DQoNCiAgICBfdGhpcy5fYWxsb2NhdGVMaXN0ZW5lcnMoKTsNCiAgfQ0KDQogIF9jcmVhdGVDbGFzcyhSZXBvcnRlck9iamVjdCwgW3sNCiAgICBrZXk6ICdfYWxsb2NhdGVMaXN0ZW5lcnMnLA0KICAgIHZhbHVlOiBmdW5jdGlvbiBfYWxsb2NhdGVMaXN0ZW5lcnMoKSB7DQogICAgICB2YXIgX3RoaXMgPSB0aGlzOw0KDQogICAgICAvL2FkZCBzdWJzY3JpcHRpb24gbGlzdGVuZXIuLi4NCiAgICAgIF90aGlzLl9zdWJzY3JpcHRpb25MaXN0ZW5lciA9IF90aGlzLl9idXMuYWRkTGlzdGVuZXIoX3RoaXMuX29ialN1YnNjcmlwdG9yVVJMLCBmdW5jdGlvbiAobXNnKSB7DQogICAgICAgIGNvbnNvbGUubG9nKF90aGlzLl9vYmpTdWJzY3JpcHRvclVSTCArICctUkNWOiAnLCBtc2cpOw0KICAgICAgICBzd2l0Y2ggKG1zZy50eXBlKSB7DQogICAgICAgICAgY2FzZSAnc3Vic2NyaWJlJzoNCiAgICAgICAgICAgIF90aGlzLl9vblJlbW90ZVN1YnNjcmliZShtc2cpO2JyZWFrOw0KICAgICAgICAgIGNhc2UgJ3Vuc3Vic2NyaWJlJzoNCiAgICAgICAgICAgIF90aGlzLl9vblJlbW90ZVVuU3Vic2NyaWJlKG1zZyk7YnJlYWs7DQogICAgICAgICAgY2FzZSAncmVzcG9uc2UnOg0KICAgICAgICAgICAgX3RoaXMuX29uUmVtb3RlUmVzcG9uc2UobXNnKTticmVhazsNCiAgICAgICAgfQ0KICAgICAgfSk7DQoNCiAgICAgIHZhciBjaGFuZ2VVUkwgPSBfdGhpcy5fdXJsICsgJy9jaGFuZ2VzJzsNCiAgICAgIF90aGlzLl9jaGFuZ2VMaXN0ZW5lciA9IF90aGlzLl9idXMuYWRkTGlzdGVuZXIoY2hhbmdlVVJMLCBmdW5jdGlvbiAobXNnKSB7DQogICAgICAgIC8vVE9ETzogd2hhdCB0b2RvIGhlcmU/IFNhdmUgY2hhbmdlcz8NCiAgICAgICAgY29uc29sZS5sb2coJ1N5bmNoZXJNYW5hZ2VyLScgKyBjaGFuZ2VVUkwgKyAnLVJDVjogJywgbXNnKTsNCiAgICAgIH0pOw0KICAgIH0NCiAgfSwgew0KICAgIGtleTogJ19yZWxlYXNlTGlzdGVuZXJzJywNCiAgICB2YWx1ZTogZnVuY3Rpb24gX3JlbGVhc2VMaXN0ZW5lcnMoKSB7DQogICAgICB2YXIgX3RoaXMgPSB0aGlzOw0KDQogICAgICBfdGhpcy5fc3Vic2NyaXB0aW9uTGlzdGVuZXIucmVtb3ZlKCk7DQoNCiAgICAgIF90aGlzLl9jaGFuZ2VMaXN0ZW5lci5yZW1vdmUoKTsNCg0KICAgICAgX3RoaXMuX2NoaWxkcmVuTGlzdGVuZXJzLmZvckVhY2goZnVuY3Rpb24gKGNsKSB7DQogICAgICAgIGNsLnJlbW92ZSgpOw0KICAgICAgfSk7DQoNCiAgICAgIE9iamVjdC5rZXlzKF90aGlzLl9mb3J3YXJkcykuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7DQogICAgICAgIF90aGlzLmZvcndhcmRVblN1YnNjcmliZShrZXkpOw0KICAgICAgfSk7DQoNCiAgICAgIC8vcmVtb3ZlIGFsbCBzdWJzY3JpcHRpb25zDQogICAgICBPYmplY3Qua2V5cyhfdGhpcy5fc3Vic2NyaXB0aW9ucykuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7DQogICAgICAgIF90aGlzLl9zdWJzY3JpcHRpb25zW2tleV0uX3JlbGVhc2VMaXN0ZW5lcnMoKTsNCiAgICAgIH0pOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIFJlZ2lzdGVyIGEgbGlzdGVuZXIgaW4gdGhlIG1zZy1ub2RlIGFuZCBpbiB0aGUgbG9jYWwgTWVzc2FnZUJ1cywgc28gdGhhdCBtZXNzYWdlcyBvbiB0aGlzIGFkZHJlc3MgYXJlIGZvcndhcmRlZCB0byB0aGUgcmVwb3J0ZXIgb2JqZWN0DQogICAgICogQHBhcmFtICB7c3RyaW5nfSBhZGRyZXNzIC0gVVJMIHRvIHJlZ2lzdGVyIHRoZSBsaXN0ZW5lcnMNCiAgICAgKiBAcmV0dXJuIHtQcm9taXNlfSBSZXR1cm4gUHJvbWlzZSBPSyBvciBlcnJvcg0KICAgICAqLw0KDQogIH0sIHsNCiAgICBrZXk6ICdmb3J3YXJkU3Vic2NyaWJlJywNCiAgICB2YWx1ZTogZnVuY3Rpb24gZm9yd2FyZFN1YnNjcmliZShhZGRyZXNzKSB7DQogICAgICB2YXIgX3RoaXMgPSB0aGlzOw0KDQogICAgICAvL0ZMT1ctT1VUOiBtZXNzYWdlIHNlbnQgdG8gdGhlIG1zZy1ub2RlIFN1YnNjcmlwdGlvbk1hbmFnZXIgY29tcG9uZW50DQogICAgICB2YXIgbm9kZVN1YnNjcmliZU1zZyA9IHsNCiAgICAgICAgdHlwZTogJ3N1YnNjcmliZScsIGZyb206IF90aGlzLl9wYXJlbnQuX3VybCwgdG86ICdkb21haW46Ly9tc2ctbm9kZS4nICsgX3RoaXMuX2RvbWFpbiArICcvc20nLA0KICAgICAgICBib2R5OiB7IHN1YnNjcmliZTogW2FkZHJlc3NdLCBzb3VyY2U6IF90aGlzLl9vd25lciB9DQogICAgICB9Ow0KDQogICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgew0KICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKG5vZGVTdWJzY3JpYmVNc2csIGZ1bmN0aW9uIChyZXBseSkgew0KICAgICAgICAgIGNvbnNvbGUubG9nKCdmb3J3YXJkLXN1YnNjcmliZS1yZXNwb25zZShyZXBvcnRlcik6ICcsIHJlcGx5KTsNCiAgICAgICAgICBpZiAocmVwbHkuYm9keS5jb2RlID09PSAyMDApIHsNCiAgICAgICAgICAgIHZhciBuZXdGb3J3YXJkID0gX3RoaXMuX2J1cy5hZGRGb3J3YXJkKF90aGlzLl91cmwsIF90aGlzLl9vd25lcik7DQogICAgICAgICAgICBfdGhpcy5fZm9yd2FyZHNbYWRkcmVzc10gPSBuZXdGb3J3YXJkOw0KICAgICAgICAgICAgcmVzb2x2ZSgpOw0KICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICByZWplY3QoJ0Vycm9yIG9uIG1zZy1ub2RlIHN1YnNjcmlwdGlvbjogJyArIHJlcGx5LmJvZHkuZGVzYyk7DQogICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICAgIH0pOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIFVuUmVnaXN0ZXIgYSBsaXN0ZW5lciBpbiB0aGUgbXNnLW5vZGUgYW5kIGluIHRoZSBsb2NhbCBNZXNzYWdlQnVzLCBzbyB0aGF0IG1lc3NhZ2VzIG9uIHRoaXMgYWRkcmVzcyBhcmUgcmVtb3ZlZCBmcm9tIGZvcndhcmQNCiAgICAgKiBAcGFyYW0gIHtzdHJpbmd9IGFkZHJlc3MgLSBVUkwgdG8gdW4tcmVnaXN0ZXIgdGhlIGxpc3RlbmVycw0KICAgICAqLw0KDQogIH0sIHsNCiAgICBrZXk6ICdmb3J3YXJkVW5TdWJzY3JpYmUnLA0KICAgIHZhbHVlOiBmdW5jdGlvbiBmb3J3YXJkVW5TdWJzY3JpYmUoYWRkcmVzcykgew0KICAgICAgdmFyIF90aGlzID0gdGhpczsNCg0KICAgICAgX3RoaXMuX2ZvcndhcmRzW2FkZHJlc3NdLnJlbW92ZSgpOw0KICAgICAgZGVsZXRlIF90aGlzLl9mb3J3YXJkc1thZGRyZXNzXTsNCg0KICAgICAgLy9GTE9XLU9VVDogbWVzc2FnZSBzZW50IHRvIHRoZSBtc2ctbm9kZSBTdWJzY3JpcHRpb25NYW5hZ2VyIGNvbXBvbmVudA0KICAgICAgdmFyIG5vZGVVblN1YnNjcmliZU1zZyA9IHsNCiAgICAgICAgdHlwZTogJ3Vuc3Vic2NyaWJlJywgZnJvbTogX3RoaXMuX3BhcmVudC5fdXJsLCB0bzogJ2RvbWFpbjovL21zZy1ub2RlLicgKyBfdGhpcy5fZG9tYWluICsgJy9zbScsDQogICAgICAgIGJvZHk6IHsgc3Vic2NyaWJlOiBbYWRkcmVzc10sIHNvdXJjZTogX3RoaXMuX293bmVyIH0NCiAgICAgIH07DQoNCiAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2Uobm9kZVVuU3Vic2NyaWJlTXNnKTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBSZWdpc3RlciBsaXN0ZW5lcnMgZm9yIGEgbGlzdCBvZiBjaGlsZHJlbnMuIFB1YmxpYyBjaGFubmVscyB1c2VkIHRvIHRyYW5zbWl0IG1lc3NhZ2VzLg0KICAgICAqIEBwYXJhbSAge3N0cmluZ1tdfSBjaGlsZHJlbnMgLSBjaGFubmVscyB0byByZWdpc3Rlcg0KICAgICAqIEByZXR1cm4ge1Byb21pc2V9IFJldHVybiBQcm9taXNlIE9LIG9yIGVycm9yDQogICAgICovDQoNCiAgfSwgew0KICAgIGtleTogJ2FkZENoaWxkcmVucycsDQogICAgdmFsdWU6IGZ1bmN0aW9uIGFkZENoaWxkcmVucyhjaGlsZHJlbnMpIHsNCiAgICAgIHZhciBfdGhpcyA9IHRoaXM7DQoNCiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7DQogICAgICAgIGlmIChjaGlsZHJlbnMubGVuZ3RoID09PSAwKSB7DQogICAgICAgICAgcmVzb2x2ZSgpOw0KICAgICAgICAgIHJldHVybjsNCiAgICAgICAgfQ0KDQogICAgICAgIHZhciBjaGlsZEJhc2VVUkwgPSBfdGhpcy5fdXJsICsgJy9jaGlsZHJlbi8nOw0KICAgICAgICBfdGhpcy5fY2hpbGRyZW5zLnB1c2goY2hpbGRyZW5zKTsNCg0KICAgICAgICAvKg0KICAgICAgICBfdGhpcy5fY2hpbGRyZW5zLmZvckVhY2goKGNoaWxkKSA9PiB7DQogICAgICAgICAgbGV0IGNoaWxkSWQgPSBjaGlsZEJhc2VVUkwgKyBjaGlsZDsNCiAgICAgICAgICAgbGV0IHNlbGZGb3J3YXJkID0gX3RoaXMuX2J1cy5hZGRGb3J3YXJkKGNoaWxkSWQsIG93bmVyKTsNCiAgICAgICAgICBfdGhpcy5fY2hpbGRyZW5MaXN0ZW5lcnMucHVzaChzZWxmRm9yd2FyZCk7DQogICAgICAgIH0pOyovDQoNCiAgICAgICAgdmFyIHN1YnNjcmlwdGlvbnMgPSBbXTsNCiAgICAgICAgY2hpbGRyZW5zLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkKSB7DQogICAgICAgICAgcmV0dXJuIHN1YnNjcmlwdGlvbnMucHVzaChjaGlsZEJhc2VVUkwgKyBjaGlsZCk7DQogICAgICAgIH0pOw0KDQogICAgICAgIC8vRkxPVy1PVVQ6IG1lc3NhZ2Ugc2VudCB0byB0aGUgbXNnLW5vZGUgU3Vic2NyaXB0aW9uTWFuYWdlciBjb21wb25lbnQNCiAgICAgICAgdmFyIG5vZGVTdWJzY3JpYmVNc2cgPSB7DQogICAgICAgICAgdHlwZTogJ3N1YnNjcmliZScsIGZyb206IF90aGlzLl9wYXJlbnQuX3VybCwgdG86ICdkb21haW46Ly9tc2ctbm9kZS4nICsgX3RoaXMuX2RvbWFpbiArICcvc20nLA0KICAgICAgICAgIGJvZHk6IHsgc3Vic2NyaWJlOiBzdWJzY3JpcHRpb25zLCBzb3VyY2U6IF90aGlzLl9vd25lciB9DQogICAgICAgIH07DQoNCiAgICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZShub2RlU3Vic2NyaWJlTXNnLCBmdW5jdGlvbiAocmVwbHkpIHsNCiAgICAgICAgICBjb25zb2xlLmxvZygnbm9kZS1zdWJzY3JpYmUtcmVzcG9uc2UocmVwb3J0ZXIpOiAnLCByZXBseSk7DQogICAgICAgICAgaWYgKHJlcGx5LmJvZHkuY29kZSA9PT0gMjAwKSB7DQoNCiAgICAgICAgICAgIC8vYWRkIGNoaWxkcmVuIGxpc3RlbmVycyBvbiBsb2NhbCAuLi4NCiAgICAgICAgICAgIHN1YnNjcmlwdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAoY2hpbGRVUkwpIHsNCiAgICAgICAgICAgICAgdmFyIGNoaWxkTGlzdGVuZXIgPSBfdGhpcy5fYnVzLmFkZExpc3RlbmVyKGNoaWxkVVJMLCBmdW5jdGlvbiAobXNnKSB7DQogICAgICAgICAgICAgICAgLy9UT0RPOiB3aGF0IHRvZG8gaGVyZT8gU2F2ZSBjaGlsZHJlbnM/DQogICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1N5bmNoZXJNYW5hZ2VyLScgKyBjaGlsZFVSTCArICctUkNWOiAnLCBtc2cpOw0KICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgX3RoaXMuX2NoaWxkcmVuTGlzdGVuZXJzLnB1c2goY2hpbGRMaXN0ZW5lcik7DQoNCiAgICAgICAgICAgICAgdmFyIHNlbGZGb3J3YXJkID0gX3RoaXMuX2J1cy5hZGRGb3J3YXJkKGNoaWxkVVJMLCBfdGhpcy5fb3duZXIpOw0KICAgICAgICAgICAgICBfdGhpcy5fY2hpbGRyZW5MaXN0ZW5lcnMucHVzaChzZWxmRm9yd2FyZCk7DQogICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgcmVzb2x2ZSgpOw0KICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICByZWplY3QoJ0Vycm9yIG9uIG1zZy1ub2RlIHN1YnNjcmlwdGlvbjogJyArIHJlcGx5LmJvZHkuZGVzYyk7DQogICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICAgIH0pOw0KICAgIH0NCiAgfSwgew0KICAgIGtleTogJ2RlbGV0ZScsDQogICAgdmFsdWU6IGZ1bmN0aW9uIF9kZWxldGUoKSB7DQogICAgICB2YXIgX3RoaXMgPSB0aGlzOw0KICAgICAgdmFyIGRvbWFpbiA9ICgwLCBfdXRpbHMuZGl2aWRlVVJMKShfdGhpcy5fb3duZXIpLmRvbWFpbjsNCg0KICAgICAgLy9GTE9XLU9VVDogbWVzc2FnZSBzZW50IGRpcmVjdGx5IHRvIGFsbCBzdWJzY3JpYmVycyBvZiB0aGUgcmVwb3J0ZXINCiAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2Uoew0KICAgICAgICB0eXBlOiAnZGVsZXRlJywgZnJvbTogX3RoaXMuX29ialN1YnNjcmlwdG9yVVJMLCB0bzogX3RoaXMuX3VybCArICcvY2hhbmdlcycNCiAgICAgIH0pOw0KDQogICAgICAvL0ZMT1ctT1VUOiBtZXNzYWdlIHNlbnQgdG8gdGhlIG1zZy1ub2RlIE9iamVjdEFsbG9jYXRpb25NYW5hZ2VyIGNvbXBvbmVudA0KICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZSh7DQogICAgICAgIHR5cGU6ICdkZWxldGUnLCBmcm9tOiBfdGhpcy5fcGFyZW50Ll91cmwsIHRvOiAnZG9tYWluOi8vbXNnLW5vZGUuJyArIGRvbWFpbiArICcvb2JqZWN0LWFkZHJlc3MtYWxsb2NhdGlvbicsDQogICAgICAgIGJvZHk6IHsgcmVzb3VyY2U6IF90aGlzLl91cmwsIGNoaWxkcmVuUmVzb3VyY2VzOiBfdGhpcy5fY2hpbGRyZW5zIH0NCiAgICAgIH0pOw0KDQogICAgICBfdGhpcy5fcmVsZWFzZUxpc3RlbmVycygpOw0KICAgICAgZGVsZXRlIF90aGlzLl9wYXJlbnQuX3JlcG9ydGVyc1tfdGhpcy5fdXJsXTsNCiAgICB9DQogIH0sIHsNCiAgICBrZXk6ICdfb25SZW1vdGVSZXNwb25zZScsDQogICAgdmFsdWU6IGZ1bmN0aW9uIF9vblJlbW90ZVJlc3BvbnNlKG1zZykgew0KICAgICAgdmFyIF90aGlzID0gdGhpczsNCg0KICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZSh7DQogICAgICAgIGlkOiBtc2cuaWQsIHR5cGU6ICdyZXNwb25zZScsIGZyb206IG1zZy50bywgdG86IF90aGlzLl91cmwsDQogICAgICAgIGJvZHk6IHsgY29kZTogbXNnLmJvZHkuY29kZSwgc291cmNlOiBtc2cuZnJvbSB9DQogICAgICB9KTsNCiAgICB9DQoNCiAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBTeW5jaGVyIC0+IHN1YnNjcmliZQ0KDQogIH0sIHsNCiAgICBrZXk6ICdfb25SZW1vdGVTdWJzY3JpYmUnLA0KICAgIHZhbHVlOiBmdW5jdGlvbiBfb25SZW1vdGVTdWJzY3JpYmUobXNnKSB7DQogICAgICB2YXIgX3RoaXMgPSB0aGlzOw0KICAgICAgdmFyIGh5cGVydHlVUkwgPSBtc2cuYm9keS5zdWJzY3JpYmVyOw0KDQogICAgICAvL3ZhbGlkYXRlIGlmIHN1YnNjcmlwdGlvbiBhbHJlYWR5IGV4aXN0cz8NCiAgICAgIGlmIChfdGhpcy5fc3Vic2NyaXB0aW9uc1toeXBlcnR5VVJMXSkgew0KICAgICAgICB2YXIgZXJyb3JNc2cgPSB7DQogICAgICAgICAgaWQ6IG1zZy5pZCwgdHlwZTogJ3Jlc3BvbnNlJywgZnJvbTogbXNnLnRvLCB0bzogaHlwZXJ0eVVSTCwNCiAgICAgICAgICBib2R5OiB7IGNvZGU6IDUwMCwgZGVzYzogJ1N1YnNjcmlwdGlvbiBmb3IgKCcgKyBfdGhpcy5fdXJsICsgJyA6ICcgKyBoeXBlcnR5VVJMICsgJykgYWxyZWFkeSBleGlzdHMhJyB9DQogICAgICAgIH07DQoNCiAgICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZShlcnJvck1zZyk7DQogICAgICAgIHJldHVybjsNCiAgICAgIH0NCg0KICAgICAgLy9hc2sgdG8gc3Vic2NyaWJlIHRvIFN5bmNoZXI/IChkZXBlbmRzIG9uIHRoZSBvcGVyYXRpb24gbW9kZSkNCiAgICAgIC8vVE9ETzogZ2V0IG1vZGUgZnJvbSBvYmplY3QhDQogICAgICB2YXIgbW9kZSA9ICdzdWIvcHViJzsNCg0KICAgICAgaWYgKG1vZGUgPT09ICdzdWIvcHViJykgew0KICAgICAgICAvL0ZMT1ctT1VUOiBtZXNzYWdlIHNlbnQgdG8gbG9jYWwgaHlwZXJ0eSBhZGRyZXNzIFN5bmNoZXIgLT4gX29uRm9yd2FyZA0KICAgICAgICB2YXIgZm9yd2FyZE1zZyA9IHsNCiAgICAgICAgICB0eXBlOiAnZm9yd2FyZCcsIGZyb206IF90aGlzLl91cmwsIHRvOiBfdGhpcy5fb3duZXIsDQogICAgICAgICAgYm9keTogeyB0eXBlOiBtc2cudHlwZSwgZnJvbTogaHlwZXJ0eVVSTCwgdG86IF90aGlzLl91cmwgfQ0KICAgICAgICB9Ow0KDQogICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2UoZm9yd2FyZE1zZywgZnVuY3Rpb24gKHJlcGx5KSB7DQogICAgICAgICAgY29uc29sZS5sb2coJ2ZvcndhcmQtcmVwbHk6ICcsIHJlcGx5KTsNCiAgICAgICAgICBpZiAocmVwbHkuYm9keS5jb2RlID09PSAyMDApIHsNCiAgICAgICAgICAgIF90aGlzLl9zdWJzY3JpcHRpb25zW2h5cGVydHlVUkxdID0gbmV3IF9TdWJzY3JpcHRpb24yLmRlZmF1bHQoX3RoaXMuX2J1cywgX3RoaXMuX293bmVyLCBfdGhpcy5fdXJsLCBfdGhpcy5fY2hpbGRyZW5zLCB0cnVlKTsNCiAgICAgICAgICB9DQoNCiAgICAgICAgICAvL0ZMT1ctT1VUOiBzdWJzY3JpcHRpb24gcmVzcG9uc2Ugc2VudCAoZm9yd2FyZCBmcm9tIGludGVybmFsIEh5cGVydHkpDQogICAgICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZSh7DQogICAgICAgICAgICBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCBmcm9tOiBtc2cudG8sIHRvOiBtc2cuZnJvbSwNCiAgICAgICAgICAgIGJvZHk6IHJlcGx5LmJvZHkNCiAgICAgICAgICB9KTsNCiAgICAgICAgfSk7DQogICAgICB9DQogICAgfQ0KDQogICAgLy9GTE9XLUlOOiBtZXNzYWdlIHJlY2VpdmVkIGZyb20gcmVtb3RlIE9ic2VydmVyT2JqZWN0IC0+IHJlbW92ZVN1YnNjcmlwdGlvbg0KDQogIH0sIHsNCiAgICBrZXk6ICdfb25SZW1vdGVVblN1YnNjcmliZScsDQogICAgdmFsdWU6IGZ1bmN0aW9uIF9vblJlbW90ZVVuU3Vic2NyaWJlKG1zZykgew0KICAgICAgdmFyIF90aGlzID0gdGhpczsNCiAgICAgIHZhciBoeXBlcnR5VVJMID0gbXNnLmJvZHkuc3Vic2NyaWJlcjsNCg0KICAgICAgdmFyIHN1YnNjcmlwdGlvbiA9IF90aGlzLl9zdWJzY3JpcHRpb25zW2h5cGVydHlVUkxdOw0KICAgICAgaWYgKHN1YnNjcmlwdGlvbikgew0KICAgICAgICBzdWJzY3JpcHRpb24uX3JlbGVhc2VMaXN0ZW5lcnMoKTsNCiAgICAgICAgZGVsZXRlIF90aGlzLl9zdWJzY3JpcHRpb25zW2h5cGVydHlVUkxdOw0KDQogICAgICAgIC8vVE9ETzogc2VuZCB1bi1zdWJzY3JpYmUgbWVzc2FnZSB0byBTeW5jaGVyPyAoZGVwZW5kcyBvbiB0aGUgb3BlcmF0aW9uIG1vZGUpDQogICAgICB9DQogICAgfQ0KICB9XSk7DQoNCiAgcmV0dXJuIFJlcG9ydGVyT2JqZWN0Ow0KfSgpOw0KDQpleHBvcnRzLmRlZmF1bHQgPSBSZXBvcnRlck9iamVjdDsNCn0seyIuLi91dGlscy91dGlscyI6MzIyLCIuL1N1YnNjcmlwdGlvbiI6MzE5fV0sMzE5OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCid1c2Ugc3RyaWN0JzsNCg0KT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgew0KICB2YWx1ZTogdHJ1ZQ0KfSk7DQoNCnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoInZhbHVlIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpOw0KDQpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOyB9IH0NCg0KdmFyIFN1YnNjcmlwdGlvbiA9IGZ1bmN0aW9uICgpIHsNCiAgZnVuY3Rpb24gU3Vic2NyaXB0aW9uKGJ1cywgb3duZXIsIHVybCwgY2hpbGRyZW5zLCBpc1JlcG9ydGVyKSB7DQogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFN1YnNjcmlwdGlvbik7DQoNCiAgICB2YXIgX3RoaXMgPSB0aGlzOw0KICAgIHZhciBjaGlsZEJhc2VVUkwgPSB1cmwgKyAnL2NoaWxkcmVuLyc7DQogICAgdmFyIGNoYW5nZVVSTCA9IHVybCArICcvY2hhbmdlcyc7DQoNCiAgICAvL3Byb2Nlc3MgZGVsZXRlIG1lc3NhZ2UNCiAgICBfdGhpcy5fZGVsZXRlTGlzdGVuZXIgPSBidXMuYWRkTGlzdGVuZXIoY2hhbmdlVVJMLCBmdW5jdGlvbiAobXNnKSB7DQogICAgICBpZiAobXNnLnR5cGUgPT09ICdkZWxldGUnKSB7DQogICAgICAgIGNvbnNvbGUubG9nKCdTdWJzY3JpcHRpb24tREVMRVRFOiAnLCBtc2cpOw0KDQogICAgICAgIC8vRkxPVy1PVVQ6IG1lc3NhZ2Ugc2VudCB0byBhbGwgc3Vic2NyaWJlcnMNCiAgICAgICAgdmFyIGRlbGV0ZU1lc3NhZ2VUb0h5cGVydHkgPSB7DQogICAgICAgICAgdHlwZTogJ2RlbGV0ZScsIGZyb206IG1zZy5mcm9tLCB0bzogb3duZXIsDQogICAgICAgICAgYm9keTogeyByZXNvdXJjZTogdXJsIH0NCiAgICAgICAgfTsNCg0KICAgICAgICAvL3NlbmQgZGVsZXRlIHRvIGh5cGVydHkNCiAgICAgICAgYnVzLnBvc3RNZXNzYWdlKGRlbGV0ZU1lc3NhZ2VUb0h5cGVydHksIGZ1bmN0aW9uIChyZXBseSkgew0KICAgICAgICAgIGNvbnNvbGUubG9nKCdTdWJzY3JpcHRpb24tREVMRVRFLVJFUExZOiAnLCByZXBseSk7DQogICAgICAgICAgaWYgKHJlcGx5LmJvZHkuY29kZSA9PT0gMjAwKSB7DQogICAgICAgICAgICBfdGhpcy5fcmVsZWFzZUxpc3RlbmVycygpOw0KICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgICB9DQogICAgfSk7DQoNCiAgICAvL2FkZCBjaGFuZ2UgcHVibGlzaCBhZGRyZXNzIG9yIGZvcndhcmQNCiAgICBpZiAoaXNSZXBvcnRlcikgew0KICAgICAgX3RoaXMuX2NoYW5nZUxpc3RlbmVyID0gYnVzLmFkZFB1Ymxpc2goY2hhbmdlVVJMKTsNCiAgICB9IGVsc2Ugew0KICAgICAgX3RoaXMuX2NoYW5nZUxpc3RlbmVyID0gYnVzLmFkZEZvcndhcmQoY2hhbmdlVVJMLCBvd25lcik7DQogICAgfQ0KDQogICAgX3RoaXMuX2NoaWxkcmVuTGlzdGVuZXJzID0gW107DQogICAgY2hpbGRyZW5zLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkKSB7DQogICAgICB2YXIgY2hpbGRJZCA9IGNoaWxkQmFzZVVSTCArIGNoaWxkOw0KDQogICAgICAvL2FkZCBjaGlsZHJlbiBwdWJsaXNoIGFkZHJlc3MNCiAgICAgIHZhciBjaGlsZHJlbkZvcndhcmQgPSBidXMuYWRkUHVibGlzaChjaGlsZElkKTsNCiAgICAgIF90aGlzLl9jaGlsZHJlbkxpc3RlbmVycy5wdXNoKGNoaWxkcmVuRm9yd2FyZCk7DQoNCiAgICAgIC8vYWRkIHNlbGYgZm9yd2FyZCBpZiBhbiBvYnNlcnZlcg0KICAgICAgaWYgKCFpc1JlcG9ydGVyKSB7DQogICAgICAgIHZhciBzZWxmRm9yd2FyZCA9IGJ1cy5hZGRGb3J3YXJkKGNoaWxkSWQsIG93bmVyKTsNCiAgICAgICAgX3RoaXMuX2NoaWxkcmVuTGlzdGVuZXJzLnB1c2goc2VsZkZvcndhcmQpOw0KICAgICAgfQ0KICAgIH0pOw0KICB9DQoNCiAgX2NyZWF0ZUNsYXNzKFN1YnNjcmlwdGlvbiwgW3sNCiAgICBrZXk6ICdfcmVsZWFzZUxpc3RlbmVycycsDQogICAgdmFsdWU6IGZ1bmN0aW9uIF9yZWxlYXNlTGlzdGVuZXJzKCkgew0KICAgICAgdmFyIF90aGlzID0gdGhpczsNCg0KICAgICAgX3RoaXMuX2RlbGV0ZUxpc3RlbmVyLnJlbW92ZSgpOw0KDQogICAgICBfdGhpcy5fY2hhbmdlTGlzdGVuZXIucmVtb3ZlKCk7DQoNCiAgICAgIF90aGlzLl9jaGlsZHJlbkxpc3RlbmVycy5mb3JFYWNoKGZ1bmN0aW9uIChmb3J3YXJkKSB7DQogICAgICAgIGZvcndhcmQucmVtb3ZlKCk7DQogICAgICB9KTsNCiAgICB9DQogIH1dKTsNCg0KICByZXR1cm4gU3Vic2NyaXB0aW9uOw0KfSgpOw0KDQpleHBvcnRzLmRlZmF1bHQgPSBTdWJzY3JpcHRpb247DQp9LHt9XSwzMjA6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpew0KJ3VzZSBzdHJpY3QnOw0KDQpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7DQogIHZhbHVlOiB0cnVlDQp9KTsNCg0KdmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmICgidmFsdWUiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7IC8qKg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgUFQgSW5vdmHn428gZSBTaXN0ZW1hcyBTQQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSUQNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgRlJBVU5IT0ZFUi1HRVNFTExTQ0hBRlQgWlVSIEZPRVJERVJVTkcgREVSIEFOR0VXQU5EVEVOIEZPUlNDSFVORyBFLlYNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IDIwMTYgQXBpemVlDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqKi8NCg0KDQp2YXIgX3V0aWxzID0gcmVxdWlyZSgnLi4vdXRpbHMvdXRpbHMnKTsNCg0KdmFyIF9PYmplY3RBbGxvY2F0aW9uID0gcmVxdWlyZSgnLi9PYmplY3RBbGxvY2F0aW9uJyk7DQoNCnZhciBfT2JqZWN0QWxsb2NhdGlvbjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9PYmplY3RBbGxvY2F0aW9uKTsNCg0KdmFyIF9SZXBvcnRlck9iamVjdCA9IHJlcXVpcmUoJy4vUmVwb3J0ZXJPYmplY3QnKTsNCg0KdmFyIF9SZXBvcnRlck9iamVjdDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9SZXBvcnRlck9iamVjdCk7DQoNCnZhciBfT2JzZXJ2ZXJPYmplY3QgPSByZXF1aXJlKCcuL09ic2VydmVyT2JqZWN0Jyk7DQoNCnZhciBfT2JzZXJ2ZXJPYmplY3QyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfT2JzZXJ2ZXJPYmplY3QpOw0KDQp2YXIgX01lc3NhZ2VGYWN0b3J5ID0gcmVxdWlyZSgnc2VydmljZS1mcmFtZXdvcmsvZGlzdC9NZXNzYWdlRmFjdG9yeScpOw0KDQpmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfQ0KDQpmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbiIpOyB9IH0NCg0KLyoqDQogKiBAYXV0aG9yIG1pY2FlbHBlZHJvc2FAZ21haWwuY29tDQogKiBDb3JlIFN5bmNyb25pemF0aW9uIHN5c3RlbS4NCiAqLw0KDQp2YXIgU3luY2hlck1hbmFnZXIgPSBmdW5jdGlvbiAoKSB7DQogIC8qIHByaXZhdGUNCiAgX3VybDogVVJMDQogIF9idXM6IE1pbmlCdXMNCiAgX3JlZ2lzdHJ5OiBSZWdpc3RyeQ0KICBfYWxsb2NhdG9yOiBPYmplY3RBbGxvY2F0aW9uDQogICBfcmVwb3J0ZXJzOiB7IE9iamVjdFVSTDogUmVwb3J0ZXJPYmplY3QgfQ0KICBfb2JzZXJ2ZXJzOiB7IE9iamVjdFVSTDogT2JzZXJ2ZXJPYmplY3QgfQ0KICAqLw0KDQogIGZ1bmN0aW9uIFN5bmNoZXJNYW5hZ2VyKHJ1bnRpbWVVUkwsIGJ1cywgcmVnaXN0cnksIGNhdGFsb2csIGFsbG9jYXRvcikgew0KICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBTeW5jaGVyTWFuYWdlcik7DQoNCiAgICB2YXIgX3RoaXMgPSB0aGlzOw0KDQogICAgX3RoaXMuX2J1cyA9IGJ1czsNCiAgICBfdGhpcy5fcmVnaXN0cnkgPSByZWdpc3RyeTsNCiAgICBfdGhpcy5fY2F0YWxvZyA9IGNhdGFsb2c7DQoNCiAgICAvL1RPRE86IHRoZXNlIHNob3VsZCBiZSBzYXZlZCBpbiBwZXJzaXN0ZW5jZSBlbmdpbmU/DQogICAgX3RoaXMuX3VybCA9IHJ1bnRpbWVVUkwgKyAnL3NtJzsNCiAgICBfdGhpcy5fb2JqZWN0VVJMID0gcnVudGltZVVSTCArICcvb2JqZWN0LWFsbG9jYXRpb24nOw0KDQogICAgX3RoaXMuX3JlcG9ydGVycyA9IHt9Ow0KICAgIF90aGlzLl9vYnNlcnZlcnMgPSB7fTsNCg0KICAgIC8vVE9ETzogdGhpcyBzaG91bGQgbm90IGJlIGhhcmRjb2RlZCENCiAgICBfdGhpcy5fZG9tYWluID0gKDAsIF91dGlscy5kaXZpZGVVUkwpKHJ1bnRpbWVVUkwpLmRvbWFpbjsNCg0KICAgIF90aGlzLl9tZiA9IG5ldyBfTWVzc2FnZUZhY3RvcnkuTWVzc2FnZUZhY3RvcnkoZmFsc2UsIHt9KTsNCg0KICAgIGlmIChhbGxvY2F0b3IpIHsNCiAgICAgIF90aGlzLl9hbGxvY2F0b3IgPSBhbGxvY2F0b3I7DQogICAgfSBlbHNlIHsNCiAgICAgIF90aGlzLl9hbGxvY2F0b3IgPSBuZXcgX09iamVjdEFsbG9jYXRpb24yLmRlZmF1bHQoX3RoaXMuX29iamVjdFVSTCwgYnVzKTsNCiAgICB9DQoNCiAgICBidXMuYWRkTGlzdGVuZXIoX3RoaXMuX3VybCwgZnVuY3Rpb24gKG1zZykgew0KICAgICAgY29uc29sZS5sb2coJ1N5bmNoZXJNYW5hZ2VyLVJDVjogJywgbXNnKTsNCiAgICAgIHN3aXRjaCAobXNnLnR5cGUpIHsNCiAgICAgICAgY2FzZSAnY3JlYXRlJzoNCiAgICAgICAgICBfdGhpcy5fb25DcmVhdGUobXNnKTticmVhazsNCiAgICAgICAgY2FzZSAnZGVsZXRlJzoNCiAgICAgICAgICBfdGhpcy5fb25EZWxldGUobXNnKTticmVhazsNCiAgICAgICAgY2FzZSAnc3Vic2NyaWJlJzoNCiAgICAgICAgICBfdGhpcy5fb25Mb2NhbFN1YnNjcmliZShtc2cpO2JyZWFrOw0KICAgICAgICBjYXNlICd1bnN1YnNjcmliZSc6DQogICAgICAgICAgX3RoaXMuX29uTG9jYWxVblN1YnNjcmliZShtc2cpO2JyZWFrOw0KICAgICAgfQ0KICAgIH0pOw0KICB9DQoNCiAgX2NyZWF0ZUNsYXNzKFN5bmNoZXJNYW5hZ2VyLCBbew0KICAgIGtleTogJ19vbkNyZWF0ZScsDQoNCg0KICAgIC8vRkxPVy1JTjogbWVzc2FnZSByZWNlaXZlZCBmcm9tIFN5bmNoZXIgLT4gY3JlYXRlDQogICAgdmFsdWU6IGZ1bmN0aW9uIF9vbkNyZWF0ZShtc2cpIHsNCg0KICAgICAgdmFyIF90aGlzID0gdGhpczsNCiAgICAgIHZhciBvd25lciA9IG1zZy5mcm9tOw0KICAgICAgdmFyIGRvbWFpbiA9ICgwLCBfdXRpbHMuZGl2aWRlVVJMKShtc2cuZnJvbSkuZG9tYWluOw0KDQogICAgICBpZiAobXNnLmJvZHkucmVzb3VyY2UpIHsNCiAgICAgICAgX3RoaXMuX2F1dGhvcmlzZShtc2csIG1zZy5ib2R5LnJlc291cmNlKTsNCiAgICAgICAgcmV0dXJuOw0KICAgICAgfQ0KDQogICAgICAvL2dldCBzY2hlbWEgZnJvbSBjYXRhbG9ndWUgYW5kIHBhcnNlIC0+IChzY2hlbWUsIGNoaWxkcmVuKQ0KICAgICAgX3RoaXMuX2NhdGFsb2cuZ2V0RGF0YVNjaGVtYURlc2NyaXB0b3IobXNnLmJvZHkuc2NoZW1hKS50aGVuKGZ1bmN0aW9uIChkZXNjcmlwdG9yKSB7DQoNCiAgICAgICAgdmFyIHByb3BlcnRpZXMgPSBkZXNjcmlwdG9yLnNvdXJjZVBhY2thZ2Uuc291cmNlQ29kZS5wcm9wZXJ0aWVzOw0KICAgICAgICB2YXIgc2NoZW1lID0gcHJvcGVydGllcy5zY2hlbWUgPyBwcm9wZXJ0aWVzLnNjaGVtZS5jb25zdGFudCA6ICdyZXNvdXJjZSc7DQogICAgICAgIHZhciBjaGlsZHJlbnMgPSBwcm9wZXJ0aWVzLmNoaWxkcmVuID8gcHJvcGVydGllcy5jaGlsZHJlbi5jb25zdGFudCA6IFtdOw0KDQogICAgICAgIGNvbnNvbGUubG9nKCdTY2hlbWU6ICcsIHNjaGVtZSk7DQoNCiAgICAgICAgLy9yZXF1ZXN0IGFkZHJlc3MgYWxsb2NhdGlvbiBvZiBhIG5ldyBvYmplY3QgZnJvbSB0aGUgbXNnLW5vZGUNCiAgICAgICAgX3RoaXMuX2FsbG9jYXRvci5jcmVhdGUoZG9tYWluLCBzY2hlbWUsIDEpLnRoZW4oZnVuY3Rpb24gKGFsbG9jYXRlZCkgew0KICAgICAgICAgIHZhciBvYmpVUkwgPSBhbGxvY2F0ZWRbMF07DQoNCiAgICAgICAgICBjb25zb2xlLmxvZygnQUxMT0NBVE9SIENSRUFURTonLCBhbGxvY2F0ZWQpOw0KDQogICAgICAgICAgLy9UbyByZWdpc3RlciB0aGUgZGF0YU9iamVjdCBpbiB0aGUgcnVudGltZVJlZ2lzdHJ5DQogICAgICAgICAgX3RoaXMuX3JlZ2lzdHJ5LnJlZ2lzdGVyRGF0YU9iamVjdChtc2cuYm9keS52YWx1ZS5uYW1lLCBtc2cuYm9keS52YWx1ZS5zY2hlbWEsIG9ialVSTCwgbXNnLmJvZHkudmFsdWUucmVwb3J0ZXIsIG1zZy5ib2R5LmF1dGhvcmlzZSkudGhlbihmdW5jdGlvbiAocmVzb2x2ZSkgew0KICAgICAgICAgICAgY29uc29sZS5sb2coJ0RhdGFPYmplY3Qgc3VjY2Vzc2Z1bGx5IHJlZ2lzdGVyZWQnLCByZXNvbHZlKTsNCg0KICAgICAgICAgICAgLy9hbGwgT0sgLT4gY3JlYXRlIHJlcG9ydGVyIGFuZCByZWdpc3RlciBsaXN0ZW5lcnMNCiAgICAgICAgICAgIHZhciByZXBvcnRlciA9IG5ldyBfUmVwb3J0ZXJPYmplY3QyLmRlZmF1bHQoX3RoaXMsIG93bmVyLCBvYmpVUkwpOw0KICAgICAgICAgICAgcmVwb3J0ZXIuZm9yd2FyZFN1YnNjcmliZShvYmpVUkwpLnRoZW4oZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICByZXBvcnRlci5hZGRDaGlsZHJlbnMoY2hpbGRyZW5zKS50aGVuKGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICBfdGhpcy5fcmVwb3J0ZXJzW29ialVSTF0gPSByZXBvcnRlcjsNCg0KICAgICAgICAgICAgICAgIC8vRkxPVy1PVVQ6IG1lc3NhZ2UgcmVzcG9uc2UgdG8gU3luY2hlciAtPiBjcmVhdGUNCiAgICAgICAgICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHsNCiAgICAgICAgICAgICAgICAgIGlkOiBtc2cuaWQsIHR5cGU6ICdyZXNwb25zZScsIGZyb206IG1zZy50bywgdG86IG93bmVyLA0KICAgICAgICAgICAgICAgICAgYm9keTogeyBjb2RlOiAyMDAsIHJlc291cmNlOiBvYmpVUkwsIGNoaWxkcmVuUmVzb3VyY2VzOiBjaGlsZHJlbnMgfQ0KICAgICAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICAgICAgLy9zZW5kIGNyZWF0ZSB0byBhbGwgb2JzZXJ2ZXJzLCByZXNwb25zZXMgd2lsbCBiZSBkZWxpdmVyIHRvIHRoZSBIeXBlcnR5IG93bmVyPw0KICAgICAgICAgICAgICAgIC8vc2NoZWR1bGUgZm9yIG5leHQgY3ljbGUgbmVlZGVkLCBiZWNhdXNlIHRoZSBSZXBvcnRlciBzaG91bGQgYmUgYXZhaWxhYmxlLg0KICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgICAgLy93aWxsIGludml0ZSBvdGhlciBoeXBlcnRpZXMNCiAgICAgICAgICAgICAgICAgIF90aGlzLl9hdXRob3Jpc2UobXNnLCBvYmpVUkwpOw0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIH0pOw0KICAgICAgICAgIH0sIGZ1bmN0aW9uIChlcnJvcikgew0KICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7DQogICAgICAgICAgfSk7DQogICAgICAgIH0pOw0KICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKHJlYXNvbikgew0KICAgICAgICAvL0ZMT1ctT1VUOiBlcnJvciBtZXNzYWdlIHJlc3BvbnNlIHRvIFN5bmNoZXIgLT4gY3JlYXRlDQogICAgICAgIHZhciByZXNwb25zZU1zZyA9IHsNCiAgICAgICAgICBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCBmcm9tOiBtc2cudG8sIHRvOiBvd25lciwNCiAgICAgICAgICBib2R5OiB7IGNvZGU6IDUwMCwgZGVzYzogcmVhc29uIH0NCiAgICAgICAgfTsNCg0KICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHJlc3BvbnNlTXNnKTsNCiAgICAgIH0pOw0KICAgIH0NCiAgfSwgew0KICAgIGtleTogJ19hdXRob3Jpc2UnLA0KICAgIHZhbHVlOiBmdW5jdGlvbiBfYXV0aG9yaXNlKG1zZywgb2JqVVJMKSB7DQogICAgICB2YXIgX3RoaXMgPSB0aGlzOw0KICAgICAgdmFyIG9ialN1YnNjcmlwdG9yVVJMID0gb2JqVVJMICsgJy9zdWJzY3JpcHRpb24nOw0KDQogICAgICBtc2cuYm9keS5hdXRob3Jpc2UuZm9yRWFjaChmdW5jdGlvbiAoaHlwZXJ0eVVSTCkgew0KICAgICAgICAvL0ZMT1ctT1VUOiBzZW5kIGludml0ZXMgdG8gbGlzdCBvZiByZW1vdGUgU3luY2hlciAtPiBfb25SZW1vdGVDcmVhdGUgLT4gb25Ob3RpZmljYXRpb24NCiAgICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZSh7DQogICAgICAgICAgdHlwZTogJ2NyZWF0ZScsIGZyb206IG9ialN1YnNjcmlwdG9yVVJMLCB0bzogaHlwZXJ0eVVSTCwNCiAgICAgICAgICBib2R5OiB7IHNvdXJjZTogbXNnLmZyb20sIHZhbHVlOiBtc2cuYm9keS52YWx1ZSwgc2NoZW1hOiBtc2cuYm9keS5zY2hlbWEgfQ0KICAgICAgICB9KTsNCiAgICAgIH0pOw0KICAgIH0NCg0KICAgIC8vRkxPVy1JTjogbWVzc2FnZSByZWNlaXZlZCBmcm9tIERhdGFPYmplY3RSZXBvcnRlciAtPiBkZWxldGUNCg0KICB9LCB7DQogICAga2V5OiAnX29uRGVsZXRlJywNCiAgICB2YWx1ZTogZnVuY3Rpb24gX29uRGVsZXRlKG1zZykgew0KICAgICAgdmFyIF90aGlzID0gdGhpczsNCg0KICAgICAgdmFyIG9ialVSTCA9IG1zZy5ib2R5LnJlc291cmNlOw0KDQogICAgICB2YXIgb2JqZWN0ID0gX3RoaXMuX3JlcG9ydGVyc1tvYmpVUkxdOw0KICAgICAgaWYgKG9iamVjdCkgew0KICAgICAgICAvL1RPRE86IGlzIHRoZXJlIGFueSBwb2xpY3kgdmVyaWZpY2F0aW9uIGJlZm9yZSBkZWxldGU/DQogICAgICAgIG9iamVjdC5kZWxldGUoKTsNCg0KICAgICAgICAvL1RPRE86IHVucmVnaXN0ZXIgb2JqZWN0Pw0KICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHsNCiAgICAgICAgICBpZDogbXNnLmlkLCB0eXBlOiAncmVzcG9uc2UnLCBmcm9tOiBtc2cudG8sIHRvOiBtc2cuZnJvbSwNCiAgICAgICAgICBib2R5OiB7IGNvZGU6IDIwMCB9DQogICAgICAgIH0pOw0KICAgICAgfQ0KICAgIH0NCg0KICAgIC8vRkxPVy1JTjogbWVzc2FnZSByZWNlaXZlZCBmcm9tIGxvY2FsIFN5bmNoZXIgLT4gc3Vic2NyaWJlDQoNCiAgfSwgew0KICAgIGtleTogJ19vbkxvY2FsU3Vic2NyaWJlJywNCiAgICB2YWx1ZTogZnVuY3Rpb24gX29uTG9jYWxTdWJzY3JpYmUobXNnKSB7DQogICAgICB2YXIgX3RoaXMyID0gdGhpczsNCg0KICAgICAgdmFyIF90aGlzID0gdGhpczsNCg0KICAgICAgdmFyIGh5cGVydHlVUkwgPSBtc2cuZnJvbTsNCiAgICAgIHZhciBvYmpVUkwgPSBtc2cuYm9keS5yZXNvdXJjZTsNCiAgICAgIHZhciBvYmpVUkxTdWJzY3JpcHRpb24gPSBvYmpVUkwgKyAnL3N1YnNjcmlwdGlvbic7DQogICAgICB2YXIgY2hpbGRCYXNlVVJMID0gb2JqVVJMICsgJy9jaGlsZHJlbi8nOw0KDQogICAgICB2YXIgZG9tYWluID0gKDAsIF91dGlscy5kaXZpZGVVUkwpKG9ialVSTCkuZG9tYWluOw0KDQogICAgICAvL2dldCBzY2hlbWEgZnJvbSBjYXRhbG9ndWUgYW5kIHBhcnNlIC0+IChjaGlsZHJlbikNCiAgICAgIF90aGlzLl9jYXRhbG9nLmdldERhdGFTY2hlbWFEZXNjcmlwdG9yKG1zZy5ib2R5LnNjaGVtYSkudGhlbihmdW5jdGlvbiAoZGVzY3JpcHRvcikgew0KICAgICAgICB2YXIgcHJvcGVydGllcyA9IGRlc2NyaXB0b3Iuc291cmNlUGFja2FnZS5zb3VyY2VDb2RlLnByb3BlcnRpZXM7DQogICAgICAgIHZhciBjaGlsZHJlbnMgPSBwcm9wZXJ0aWVzLmNoaWxkcmVuID8gcHJvcGVydGllcy5jaGlsZHJlbi5jb25zdGFudCA6IFtdOw0KDQogICAgICAgIC8vY2hpbGRyZW4gYWRkcmVzc2VzDQogICAgICAgIHZhciBzdWJzY3JpcHRpb25zID0gW107DQogICAgICAgIHN1YnNjcmlwdGlvbnMucHVzaChvYmpVUkwgKyAnL2NoYW5nZXMnKTsNCiAgICAgICAgY2hpbGRyZW5zLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkKSB7DQogICAgICAgICAgcmV0dXJuIHN1YnNjcmlwdGlvbnMucHVzaChjaGlsZEJhc2VVUkwgKyBjaGlsZCk7DQogICAgICAgIH0pOw0KDQogICAgICAgIC8vRkxPVy1PVVQ6IHN1YnNjcmliZSBtZXNzYWdlIHRvIHRoZSBtc2ctbm9kZSwgcmVnaXN0ZXJpbmcgbGlzdGVuZXJzIG9uIHRoZSBicm9rZXINCiAgICAgICAgdmFyIG5vZGVTdWJzY3JpYmVNc2cgPSB7DQogICAgICAgICAgdHlwZTogJ3N1YnNjcmliZScsIGZyb206IF90aGlzLl91cmwsIHRvOiAnZG9tYWluOi8vbXNnLW5vZGUuJyArIGRvbWFpbiArICcvc20nLA0KICAgICAgICAgIGJvZHk6IHsgc3Vic2NyaWJlOiBzdWJzY3JpcHRpb25zLCBzb3VyY2U6IGh5cGVydHlVUkwgfQ0KICAgICAgICB9Ow0KDQogICAgICAgIC8vc3Vic2NyaWJlIGluIG1zZy1ub2RlDQogICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2Uobm9kZVN1YnNjcmliZU1zZywgZnVuY3Rpb24gKHJlcGx5KSB7DQogICAgICAgICAgY29uc29sZS5sb2coJ25vZGUtc3Vic2NyaWJlLXJlc3BvbnNlKG9ic2VydmVyKTogJywgcmVwbHkpOw0KICAgICAgICAgIGlmIChyZXBseS5ib2R5LmNvZGUgPT09IDIwMCkgew0KDQogICAgICAgICAgICAvL0ZMT1ctT1VUOiByZXBseSB3aXRoIHByb3Zpc2lvbmFsIHJlc3BvbnNlDQogICAgICAgICAgICBfdGhpcy5fYnVzLnBvc3RNZXNzYWdlKHsNCiAgICAgICAgICAgICAgaWQ6IG1zZy5pZCwgdHlwZTogJ3Jlc3BvbnNlJywgZnJvbTogbXNnLnRvLCB0bzogaHlwZXJ0eVVSTCwNCiAgICAgICAgICAgICAgYm9keTogeyBjb2RlOiAxMDAsIGNoaWxkcmVuUmVzb3VyY2VzOiBjaGlsZHJlbnMgfQ0KICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgIC8vRkxPVy1PVVQ6IHN1YnNjcmliZSBtZXNzYWdlIHRvIHJlbW90ZSBSZXBvcnRlck9iamVjdCAtPiBfb25SZW1vdGVTdWJzY3JpYmUNCiAgICAgICAgICAgIHZhciBvYmpTdWJzY3JpYmVNc2cgPSB7DQogICAgICAgICAgICAgIHR5cGU6ICdzdWJzY3JpYmUnLCBmcm9tOiBfdGhpcy5fdXJsLCB0bzogb2JqVVJMU3Vic2NyaXB0aW9uLA0KICAgICAgICAgICAgICBib2R5OiB7IHN1YnNjcmliZXI6IGh5cGVydHlVUkwgfQ0KICAgICAgICAgICAgfTsNCg0KICAgICAgICAgICAgLy9zdWJzY3JpYmUgdG8gcmVwb3J0ZXIgU00NCiAgICAgICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2Uob2JqU3Vic2NyaWJlTXNnLCBmdW5jdGlvbiAocmVwbHkpIHsNCiAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3JlcG9ydGVyLXN1YnNjcmliZS1yZXNwb25zZTogJywgcmVwbHkpOw0KICAgICAgICAgICAgICBpZiAocmVwbHkuYm9keS5jb2RlID09PSAyMDApIHsNCg0KICAgICAgICAgICAgICAgIHZhciBvYnNlcnZlciA9IF90aGlzLl9vYnNlcnZlcnNbb2JqVVJMXTsNCiAgICAgICAgICAgICAgICBpZiAoIW9ic2VydmVyKSB7DQogICAgICAgICAgICAgICAgICBvYnNlcnZlciA9IG5ldyBfT2JzZXJ2ZXJPYmplY3QyLmRlZmF1bHQoX3RoaXMsIG9ialVSTCwgY2hpbGRyZW5zKTsNCiAgICAgICAgICAgICAgICAgIF90aGlzLl9vYnNlcnZlcnNbb2JqVVJMXSA9IG9ic2VydmVyOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIC8vcmVnaXN0ZXIgaHlwZXJ0eSBzdWJzY3JpcHRpb24NCiAgICAgICAgICAgICAgICBvYnNlcnZlci5hZGRTdWJzY3JpcHRpb24oaHlwZXJ0eVVSTCk7DQoNCiAgICAgICAgICAgICAgICAvL2ZvcndhcmQgdG8gaHlwZXJ0eToNCiAgICAgICAgICAgICAgICByZXBseS5pZCA9IG1zZy5pZDsNCiAgICAgICAgICAgICAgICByZXBseS5mcm9tID0gX3RoaXMuX3VybDsNCiAgICAgICAgICAgICAgICByZXBseS50byA9IGh5cGVydHlVUkw7DQogICAgICAgICAgICAgICAgX3RoaXMyLl9idXMucG9zdE1lc3NhZ2UocmVwbHkpOw0KICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KTsNCiAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgLy9saXN0ZW5lciByZWplY3RlZA0KICAgICAgICAgICAgX3RoaXMuX2J1cy5wb3N0TWVzc2FnZSh7DQogICAgICAgICAgICAgIGlkOiBtc2cuaWQsIHR5cGU6ICdyZXNwb25zZScsIGZyb206IG1zZy50bywgdG86IGh5cGVydHlVUkwsDQogICAgICAgICAgICAgIGJvZHk6IHJlcGx5LmJvZHkNCiAgICAgICAgICAgIH0pOw0KICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgICB9KTsNCiAgICB9DQoNCiAgICAvL0ZMT1ctSU46IG1lc3NhZ2UgcmVjZWl2ZWQgZnJvbSBsb2NhbCBEYXRhT2JqZWN0T2JzZXJ2ZXIgLT4gdW5zdWJzY3JpYmUNCg0KICB9LCB7DQogICAga2V5OiAnX29uTG9jYWxVblN1YnNjcmliZScsDQogICAgdmFsdWU6IGZ1bmN0aW9uIF9vbkxvY2FsVW5TdWJzY3JpYmUobXNnKSB7DQogICAgICB2YXIgX3RoaXMgPSB0aGlzOw0KDQogICAgICB2YXIgaHlwZXJ0eVVSTCA9IG1zZy5mcm9tOw0KICAgICAgdmFyIG9ialVSTCA9IG1zZy5ib2R5LnJlc291cmNlOw0KDQogICAgICB2YXIgb2JzZXJ2ZXIgPSBfdGhpcy5fb2JzZXJ2ZXJzW29ialVSTF07DQogICAgICBpZiAob2JzZXJ2ZXIpIHsNCiAgICAgICAgLy9UT0RPOiBpcyB0aGVyZSBhbnkgcG9saWN5IHZlcmlmaWNhdGlvbiBiZWZvcmUgZGVsZXRlPw0KICAgICAgICBvYnNlcnZlci5yZW1vdmVTdWJzY3JpcHRpb24oaHlwZXJ0eVVSTCk7DQoNCiAgICAgICAgLy9UT0RPOiBkZXN0cm95IG9iamVjdCBpbiB0aGUgcmVnaXN0cnk/DQogICAgICAgIF90aGlzLl9idXMucG9zdE1lc3NhZ2Uoew0KICAgICAgICAgIGlkOiBtc2cuaWQsIHR5cGU6ICdyZXNwb25zZScsIGZyb206IG1zZy50bywgdG86IG1zZy5mcm9tLA0KICAgICAgICAgIGJvZHk6IHsgY29kZTogMjAwIH0NCiAgICAgICAgfSk7DQoNCiAgICAgICAgLy9UT0RPOiByZW1vdmUgT2JqZWN0IGlmIG5vIG1vcmUgc3Vic2NyaXB0aW9uPw0KICAgICAgICAvL2RlbGV0ZSBfdGhpcy5fb2JzZXJ2ZXJzW29ialVSTF07DQogICAgICB9DQogICAgfQ0KICB9LCB7DQogICAga2V5OiAndXJsJywNCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsNCiAgICAgIHJldHVybiB0aGlzLl91cmw7DQogICAgfQ0KICB9XSk7DQoNCiAgcmV0dXJuIFN5bmNoZXJNYW5hZ2VyOw0KfSgpOw0KDQpleHBvcnRzLmRlZmF1bHQgPSBTeW5jaGVyTWFuYWdlcjsNCn0seyIuLi91dGlscy91dGlscyI6MzIyLCIuL09iamVjdEFsbG9jYXRpb24iOjMxNiwiLi9PYnNlcnZlck9iamVjdCI6MzE3LCIuL1JlcG9ydGVyT2JqZWN0IjozMTgsInNlcnZpY2UtZnJhbWV3b3JrL2Rpc3QvTWVzc2FnZUZhY3RvcnkiOjI5OH1dLDMyMTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7DQoidXNlIHN0cmljdCI7DQoNCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsNCiAgdmFsdWU6IHRydWUNCn0pOw0KDQp2YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCJ2YWx1ZSIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTsNCg0KZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24iKTsgfSB9DQoNCi8qKg0KKiBDb3B5cmlnaHQgMjAxNiBQVCBJbm92YefjbyBlIFNpc3RlbWFzIFNBDQoqIENvcHlyaWdodCAyMDE2IElORVNDLUlEDQoqIENvcHlyaWdodCAyMDE2IFFVT0JJUyBORVRXT1JLUyBTTA0KKiBDb3B5cmlnaHQgMjAxNiBGUkFVTkhPRkVSLUdFU0VMTFNDSEFGVCBaVVIgRk9FUkRFUlVORyBERVIgQU5HRVdBTkRURU4gRk9SU0NIVU5HIEUuVg0KKiBDb3B5cmlnaHQgMjAxNiBPUkFOR0UgU0ENCiogQ29weXJpZ2h0IDIwMTYgRGV1dHNjaGUgVGVsZWtvbSBBRw0KKiBDb3B5cmlnaHQgMjAxNiBBcGl6ZWUNCiogQ29weXJpZ2h0IDIwMTYgVEVDSE5JU0NIRSBVTklWRVJTSVRBVCBCRVJMSU4NCioNCiogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7DQoqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4NCiogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0DQoqDQoqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wDQoqDQoqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUNCiogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywNCiogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuDQoqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQNCiogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuDQoqKi8NCi8qKg0KICogRXZlbnRFbWl0dGVyDQogKiBBbGwgY2xhc3NlcyB3aGljaCBleHRlbmRzIHRoaXMsIGNhbiBoYXZlIGFkZEV2ZW50TGlzdGVuZXIgYW5kIHRyaWdnZXIgZXZlbnRzOw0KICovDQoNCnZhciBFdmVudEVtaXR0ZXIgPSBmdW5jdGlvbiAoKSB7DQogIGZ1bmN0aW9uIEV2ZW50RW1pdHRlcigpIHsNCiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRXZlbnRFbWl0dGVyKTsNCiAgfQ0KDQogIF9jcmVhdGVDbGFzcyhFdmVudEVtaXR0ZXIsIFt7DQogICAga2V5OiAiYWRkRXZlbnRMaXN0ZW5lciIsDQoNCg0KICAgIC8qKg0KICAgICAqIGFkZEV2ZW50TGlzdGVuZXIgbGlzdGVuIGZvciBhbiBldmVudFR5cGUNCiAgICAgKiBAcGFyYW0gIHtzdHJpbmd9ICAgICAgICAgZXZlbnRUeXBlIC0gbGlzdGVuaW5nIGZvciB0aGlzIHR5cGUgb2YgZXZlbnQNCiAgICAgKiBAcGFyYW0gIHtGdW5jdGlvbn0gICAgICAgY2IgICAgICAgIC0gY2FsbGJhY2sgZnVuY3Rpb24gd2lsbCBiZSBleGVjdXRlZCB3aGVuIHRoZSBldmVudCBpdCBpcyBpbnZva2VkDQogICAgICovDQogICAgdmFsdWU6IGZ1bmN0aW9uIGFkZEV2ZW50TGlzdGVuZXIoZXZlbnRUeXBlLCBjYikgew0KICAgICAgdmFyIF90aGlzID0gdGhpczsNCiAgICAgIF90aGlzW2V2ZW50VHlwZV0gPSBjYjsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiBJbnZva2UgdGhlIGV2ZW50VHlwZQ0KICAgICAqIEBwYXJhbSAge3N0cmluZ30gZXZlbnRUeXBlIC0gZXZlbnQgd2lsbCBiZSBpbnZva2VkDQogICAgICogQHBhcmFtICB7b2JqZWN0fSBwYXJhbXMgLSBwYXJhbWV0ZXJzIHdpbGwgYmUgcGFzc2VkIHRvIHRoZSBhZGRFdmVudExpc3RlbmVyDQogICAgICovDQoNCiAgfSwgew0KICAgIGtleTogInRyaWdnZXIiLA0KICAgIHZhbHVlOiBmdW5jdGlvbiB0cmlnZ2VyKGV2ZW50VHlwZSwgcGFyYW1zKSB7DQogICAgICB2YXIgX3RoaXMgPSB0aGlzOw0KDQogICAgICBpZiAoX3RoaXNbZXZlbnRUeXBlXSkgew0KICAgICAgICBfdGhpc1tldmVudFR5cGVdKHBhcmFtcyk7DQogICAgICB9DQogICAgfQ0KICB9XSk7DQoNCiAgcmV0dXJuIEV2ZW50RW1pdHRlcjsNCn0oKTsNCg0KZXhwb3J0cy5kZWZhdWx0ID0gRXZlbnRFbWl0dGVyOw0KfSx7fV0sMzIyOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsNCid1c2Ugc3RyaWN0JzsNCg0KT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgew0KICB2YWx1ZTogdHJ1ZQ0KfSk7DQpleHBvcnRzLmRpdmlkZVVSTCA9IGRpdmlkZVVSTDsNCmV4cG9ydHMuZGl2aWRlRW1haWwgPSBkaXZpZGVFbWFpbDsNCmV4cG9ydHMuZW1wdHlPYmplY3QgPSBlbXB0eU9iamVjdDsNCmV4cG9ydHMuZGVlcENsb25lID0gZGVlcENsb25lOw0KZXhwb3J0cy5nZXRVc2VyVVJMRnJvbUVtYWlsID0gZ2V0VXNlclVSTEZyb21FbWFpbDsNCmV4cG9ydHMuZ2V0VXNlckVtYWlsRnJvbVVSTCA9IGdldFVzZXJFbWFpbEZyb21VUkw7DQpleHBvcnRzLmNvbnZlcnRUb1VzZXJVUkwgPSBjb252ZXJ0VG9Vc2VyVVJMOw0KLyoqDQoqIENvcHlyaWdodCAyMDE2IFBUIElub3Zh5+NvIGUgU2lzdGVtYXMgU0ENCiogQ29weXJpZ2h0IDIwMTYgSU5FU0MtSUQNCiogQ29weXJpZ2h0IDIwMTYgUVVPQklTIE5FVFdPUktTIFNMDQoqIENvcHlyaWdodCAyMDE2IEZSQVVOSE9GRVItR0VTRUxMU0NIQUZUIFpVUiBGT0VSREVSVU5HIERFUiBBTkdFV0FORFRFTiBGT1JTQ0hVTkcgRS5WDQoqIENvcHlyaWdodCAyMDE2IE9SQU5HRSBTQQ0KKiBDb3B5cmlnaHQgMjAxNiBEZXV0c2NoZSBUZWxla29tIEFHDQoqIENvcHlyaWdodCAyMDE2IEFwaXplZQ0KKiBDb3B5cmlnaHQgMjAxNiBURUNITklTQ0hFIFVOSVZFUlNJVEFUIEJFUkxJTg0KKg0KKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsNCiogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLg0KKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQNCioNCiogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjANCioNCiogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQ0KKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLA0KKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4NCiogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZA0KKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4NCioqLw0KLyoqDQogKiBTdXBwb3J0IG1vZHVsZSB3aXRoIHNvbWUgZnVuY3Rpb25zIHdpbGwgYmUgdXNlZnVsDQogKiBAbW9kdWxlIHV0aWxzDQogKi8NCg0KLyoqDQogKiBAdHlwZWRlZiBkaXZpZGVVUkwNCiAqIEB0eXBlIE9iamVjdA0KICogQHByb3BlcnR5IHtzdHJpbmd9IHR5cGUgVGhlIHR5cGUgb2YgVVJMDQogKiBAcHJvcGVydHkge3N0cmluZ30gZG9tYWluIFRoZSBkb21haW4gb2YgVVJMDQogKiBAcHJvcGVydHkge3N0cmluZ30gaWRlbnRpdHkgVGhlIGlkZW50aXR5IG9mIFVSTA0KICovDQoNCi8qKg0KICogRGl2aWRlIGFuIHVybCBpbiB0eXBlLCBkb21haW4gYW5kIGlkZW50aXR5DQogKiBAcGFyYW0gIHtVUkwuVVJMfSB1cmwgLSB1cmwgYWRkcmVzcw0KICogQHJldHVybiB7ZGl2aWRlVVJMfSB0aGUgcmVzdWx0IG9mIGRpdmlkZVVSTA0KICovDQpmdW5jdGlvbiBkaXZpZGVVUkwodXJsKSB7DQoNCiAgaWYgKCF1cmwpIHRocm93IEVycm9yKCdVUkwgaXMgbmVlZGVkIHRvIHNwbGl0Jyk7DQoNCiAgLy8gbGV0IHJlID0gLyhbYS16QS1aLV0qKT86XC9cLyg/OlwuKT8oWy1hLXpBLVowLTlAOiUuX1wrfiM9XXsyLDI1Nn1cLlthLXpdezIsNn1cYikqKFwvW1wvXGRcd1wuLV0qKSooPzpbXD9dKSooLispKi9naTsNCiAgdmFyIHJlID0gLyhbYS16QS1aLV0qKTpcL1wvKD86XC4pPyhbLWEtekEtWjAtOUA6JS5fXCt+Iz1dezIsMjU2fSkoWy1hLXpBLVowLTlAOiUuX1wrfiM9XC9dKikvZ2k7DQogIHZhciBzdWJzdCA9ICckMSwkMiwkMyc7DQogIHZhciBwYXJ0cyA9IHVybC5yZXBsYWNlKHJlLCBzdWJzdCkuc3BsaXQoJywnKTsNCg0KICAvLyBJZiB0aGUgdXJsIGhhcyBubyBwcm90b2NvbCwgdGhlIGRlZmF1bHQgcHJvdG9jb2wgc2V0IGlzIGh0dHBzDQogIGlmIChwYXJ0c1swXSA9PT0gdXJsKSB7DQogICAgcGFydHNbMF0gPSAnaHR0cHMnOw0KICAgIHBhcnRzWzFdID0gdXJsOw0KICB9DQoNCiAgdmFyIHJlc3VsdCA9IHsNCiAgICB0eXBlOiBwYXJ0c1swXSwNCiAgICBkb21haW46IHBhcnRzWzFdLA0KICAgIGlkZW50aXR5OiBwYXJ0c1syXQ0KICB9Ow0KDQogIHJldHVybiByZXN1bHQ7DQp9DQoNCmZ1bmN0aW9uIGRpdmlkZUVtYWlsKGVtYWlsKSB7DQogIHZhciBpbmRleE9mQXQgPSBlbWFpbC5pbmRleE9mKCdAJyk7DQoNCiAgdmFyIHJlc3VsdCA9IHsNCiAgICB1c2VybmFtZTogZW1haWwuc3Vic3RyaW5nKDAsIGluZGV4T2ZBdCksDQogICAgZG9tYWluOiBlbWFpbC5zdWJzdHJpbmcoaW5kZXhPZkF0ICsgMSwgZW1haWwubGVuZ3RoKQ0KICB9Ow0KDQogIHJldHVybiByZXN1bHQ7DQp9DQoNCi8qKg0KICogQ2hlY2sgaWYgYW4gT2JqZWN0IGlzIGVtcHR5DQogKiBAcGFyYW0gIHtPYmplY3R9IG9iamVjdCBPYmplY3QgdG8gYmUgY2hlY2tlZA0KICogQHJldHVybiB7Qm9vbGVhbn0gICAgICAgc3RhdHVzIG9mIE9iamVjdCwgZW1wdHkgb3Igbm90ICh0cnVlfGZhbHNlKTsNCiAqLw0KZnVuY3Rpb24gZW1wdHlPYmplY3Qob2JqZWN0KSB7DQogIHJldHVybiBPYmplY3Qua2V5cyhvYmplY3QpLmxlbmd0aCA+IDAgPyBmYWxzZSA6IHRydWU7DQp9DQoNCi8qKg0KICogTWFrZSBhIENPUFkgb2YgdGhlIG9yaWdpbmFsIGRhdGENCiAqIEBwYXJhbSAge09iamVjdH0gIG9iaiAtIG9iamVjdCB0byBiZSBjbG9uZWQNCiAqIEByZXR1cm4ge09iamVjdH0NCiAqLw0KZnVuY3Rpb24gZGVlcENsb25lKG9iaikgew0KICAvL1RPRE86IHNpbXBsZSBidXQgaW5lZmZpY2llbnQgSlNPTiBkZWVwIGNsb25lLi4uDQogIGlmIChvYmopIHJldHVybiBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KG9iaikpOw0KfQ0KDQovKioNCiAqIE9idGFpbnMgdGhlIHVzZXIgVVJMIHRoYXQgY29ycmVzcG9uZHMgdG8gYSBnaXZlbiBlbWFpbA0KICogQHBhcmFtICB7c3RyaW5nfSB1c2VyRW1haWwgVGhlIHVzZXIgZW1haWwNCiAqIEByZXR1cm4ge1VSTC5VUkx9IHVzZXJVUkwgVGhlIHVzZXIgVVJMDQogKi8NCmZ1bmN0aW9uIGdldFVzZXJVUkxGcm9tRW1haWwodXNlckVtYWlsKSB7DQogIHZhciBpbmRleE9mQXQgPSB1c2VyRW1haWwuaW5kZXhPZignQCcpOw0KICByZXR1cm4gJ3VzZXI6Ly8nICsgdXNlckVtYWlsLnN1YnN0cmluZyhpbmRleE9mQXQgKyAxLCB1c2VyRW1haWwubGVuZ3RoKSArICcvJyArIHVzZXJFbWFpbC5zdWJzdHJpbmcoMCwgaW5kZXhPZkF0KTsNCn0NCg0KLyoqDQogKiBPYnRhaW5zIHRoZSB1c2VyIGVtYWlsIHRoYXQgY29ycmVzcG9uZHMgdG8gYSBnaXZlbiBVUkwNCiAqIEBwYXJhbSAge1VSTC5VUkx9IHVzZXJVUkwgVGhlIHVzZXIgVVJMDQogKiBAcmV0dXJuIHtzdHJpbmd9IHVzZXJFbWFpbCBUaGUgdXNlciBlbWFpbA0KICovDQpmdW5jdGlvbiBnZXRVc2VyRW1haWxGcm9tVVJMKHVzZXJVUkwpIHsNCiAgdmFyIHVybCA9IGRpdmlkZVVSTCh1c2VyVVJMKTsNCiAgcmV0dXJuIHVybC5pZGVudGl0eS5yZXBsYWNlKCcvJywgJycpICsgJ0AnICsgdXJsLmRvbWFpbjsgLy8gaWRlbnRpdHkgZmllbGQgaGFzICcvZXhhbXBsZUlEJyBpbnN0ZWFkIG9mICdleGFtcGxlSUQnDQp9DQoNCi8qKg0KICogQ2hlY2sgaWYgdGhlIHVzZXIgaWRlbnRpZmllciBpcyBhbHJlYWR5IGluIHRoZSBVUkwgZm9ybWF0LCBpZiBub3QsIGNvbnZlcnQgdG8gVVJMIGZvcm1hdA0KICogQHBhcmFtICB7c3RyaW5nfSAgIGlkZW50aWZpZXIgIHVzZXIgaWRlbnRpZmllcg0KICogQHJldHVybiB7c3RyaW5nfSAgIHVzZXJVUkwgICAgdGhlIHVzZXIgVVJMDQogKi8NCmZ1bmN0aW9uIGNvbnZlcnRUb1VzZXJVUkwoaWRlbnRpZmllcikgew0KDQogIC8vIGNoZWNrIGlmIHRoZSBpZGVudGlmaWVyIGlzIGFscmVhZHkgaW4gdGhlIHVybCBmb3JtYXQNCiAgaWYgKGlkZW50aWZpZXIuc3Vic3RyaW5nKDAsIDcpID09PSAndXNlcjovLycpIHsNCiAgICB2YXIgZGl2aWRlZFVSTCA9IGRpdmlkZVVSTChpZGVudGlmaWVyKTsNCg0KICAgIC8vY2hlY2sgaWYgdGhlIHVybCBpcyB3ZWxsIGZvcm1hdGVkDQogICAgaWYgKGRpdmlkZWRVUkwuZG9tYWluICYmIGRpdmlkZWRVUkwuaWRlbnRpdHkpIHsNCiAgICAgIHJldHVybiBpZGVudGlmaWVyOw0KICAgIH0gZWxzZSB7DQogICAgICB0aHJvdyAndXNlclVSTCB3aXRoIHdyb25nIGZvcm1hdCc7DQogICAgfQ0KDQogICAgLy9pZiBub3QsIGNvbnZlcnQgdGhlIHVzZXIgZW1haWwgdG8gVVJMIGZvcm1hdA0KICB9IGVsc2Ugew0KICAgICAgcmV0dXJuIGdldFVzZXJVUkxGcm9tRW1haWwoaWRlbnRpZmllcik7DQogICAgfQ0KfQ0KfSx7fV19LHt9LFszMTVdKTsNCg==","sourceCodeClassname":"Runtime","encoding":"base64","signature":""},"cguid":30001,"type":"Runtimes","version":"0.1","description":"DescriptionofRuntime","objectName":"Runtime","configuration":{},"runtimeType":"browser","hypertyCapabilities":{"mic":true,"camera":true,"sensor":false,"webrtc":true,"ortc":true},"protocolCapabilities":{"http":true,"https":true,"ws":true,"wss":true,"coap":false,"datachannel":false},
                "sourcePackageURL":"/sourcePackage",
                "language":"javascript",
                "signature":"",
                "messageSchemas":"",
                "dataObjects":[],
                "accessControlPolicy":"somePolicy"
                }
}
